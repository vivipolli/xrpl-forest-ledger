/*! For license information please see defaultEvmAdapter.umd.min.js.LICENSE.txt */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.DefaultEvmAdapter=t():e.DefaultEvmAdapter=t()}(self,(()=>(()=>{var e={3035:(e,t,r)=>{"use strict";t.I0=t.DH=t.NX=t.u8=t.cY=void 0,t.av=t.O6=t.w3=t.Wg=void 0;const n=r(1429);function i(e){if(!(e instanceof Uint8Array))throw new TypeError("b must be a Uint8Array")}function o(e){return i(e),n.Buffer.from(e.buffer,e.byteOffset,e.length)}class s{constructor(e,t){if(!Number.isInteger(e))throw new TypeError("span must be an integer");this.span=e,this.property=t}makeDestinationObject(){return{}}getSpan(e,t){if(0>this.span)throw new RangeError("indeterminate span");return this.span}replicate(e){const t=Object.create(this.constructor.prototype);return Object.assign(t,this),t.property=e,t}fromArray(e){}}function a(e,t){return t.property?e+"["+t.property+"]":e}class c extends s{isCount(){throw new Error("ExternalLayout is abstract")}}class u extends c{constructor(e,t=0,r){if(!(e instanceof s))throw new TypeError("layout must be a Layout");if(!Number.isInteger(t))throw new TypeError("offset must be integer or undefined");super(e.span,r||e.property),this.layout=e,this.offset=t}isCount(){return this.layout instanceof h||this.layout instanceof l}decode(e,t=0){return this.layout.decode(e,t+this.offset)}encode(e,t,r=0){return this.layout.encode(e,t,r+this.offset)}}class h extends s{constructor(e,t){if(super(e,t),6<this.span)throw new RangeError("span must not exceed 6 bytes")}decode(e,t=0){return o(e).readUIntLE(t,this.span)}encode(e,t,r=0){return o(t).writeUIntLE(e,r,this.span),this.span}}class l extends s{constructor(e,t){if(super(e,t),6<this.span)throw new RangeError("span must not exceed 6 bytes")}decode(e,t=0){return o(e).readUIntBE(t,this.span)}encode(e,t,r=0){return o(t).writeUIntBE(e,r,this.span),this.span}}const d=Math.pow(2,32);function f(e){const t=Math.floor(e/d);return{hi32:t,lo32:e-t*d}}function p(e,t){return e*d+t}class g extends s{constructor(e){super(8,e)}decode(e,t=0){const r=o(e),n=r.readUInt32LE(t);return p(r.readUInt32LE(t+4),n)}encode(e,t,r=0){const n=f(e),i=o(t);return i.writeUInt32LE(n.lo32,r),i.writeUInt32LE(n.hi32,r+4),8}}class y extends s{constructor(e){super(8,e)}decode(e,t=0){const r=o(e),n=r.readUInt32LE(t);return p(r.readInt32LE(t+4),n)}encode(e,t,r=0){const n=f(e),i=o(t);return i.writeUInt32LE(n.lo32,r),i.writeInt32LE(n.hi32,r+4),8}}class b extends s{constructor(e,t,r){if(!(e instanceof s))throw new TypeError("elementLayout must be a Layout");if(!(t instanceof c&&t.isCount()||Number.isInteger(t)&&0<=t))throw new TypeError("count must be non-negative integer or an unsigned integer ExternalLayout");let n=-1;!(t instanceof c)&&0<e.span&&(n=t*e.span),super(n,r),this.elementLayout=e,this.count=t}getSpan(e,t=0){if(0<=this.span)return this.span;let r=0,n=this.count;if(n instanceof c&&(n=n.decode(e,t)),0<this.elementLayout.span)r=n*this.elementLayout.span;else{let i=0;for(;i<n;)r+=this.elementLayout.getSpan(e,t+r),++i}return r}decode(e,t=0){const r=[];let n=0,i=this.count;for(i instanceof c&&(i=i.decode(e,t));n<i;)r.push(this.elementLayout.decode(e,t)),t+=this.elementLayout.getSpan(e,t),n+=1;return r}encode(e,t,r=0){const n=this.elementLayout,i=e.reduce(((e,i)=>e+n.encode(i,t,r+e)),0);return this.count instanceof c&&this.count.encode(e.length,t,r),i}}class m extends s{constructor(e,t,r){if(!Array.isArray(e)||!e.reduce(((e,t)=>e&&t instanceof s),!0))throw new TypeError("fields must be array of Layout instances");"boolean"==typeof t&&void 0===r&&(r=t,t=void 0);for(const t of e)if(0>t.span&&void 0===t.property)throw new Error("fields cannot contain unnamed variable-length layout");let n=-1;try{n=e.reduce(((e,t)=>e+t.getSpan()),0)}catch(e){}super(n,t),this.fields=e,this.decodePrefixes=!!r}getSpan(e,t=0){if(0<=this.span)return this.span;let r=0;try{r=this.fields.reduce(((r,n)=>{const i=n.getSpan(e,t);return t+=i,r+i}),0)}catch(e){throw new RangeError("indeterminate span")}return r}decode(e,t=0){i(e);const r=this.makeDestinationObject();for(const n of this.fields)if(void 0!==n.property&&(r[n.property]=n.decode(e,t)),t+=n.getSpan(e,t),this.decodePrefixes&&e.length===t)break;return r}encode(e,t,r=0){const n=r;let i=0,o=0;for(const n of this.fields){let s=n.span;if(o=0<s?s:0,void 0!==n.property){const i=e[n.property];void 0!==i&&(o=n.encode(i,t,r),0>s&&(s=n.getSpan(t,r)))}i=r,r+=s}return i+o-n}fromArray(e){const t=this.makeDestinationObject();for(const r of this.fields)void 0!==r.property&&0<e.length&&(t[r.property]=e.shift());return t}layoutFor(e){if("string"!=typeof e)throw new TypeError("property must be string");for(const t of this.fields)if(t.property===e)return t}offsetOf(e){if("string"!=typeof e)throw new TypeError("property must be string");let t=0;for(const r of this.fields){if(r.property===e)return t;0>r.span?t=-1:0<=t&&(t+=r.span)}}}class w extends s{constructor(e,t){if(!(e instanceof c&&e.isCount()||Number.isInteger(e)&&0<=e))throw new TypeError("length must be positive integer or an unsigned integer ExternalLayout");let r=-1;e instanceof c||(r=e),super(r,t),this.length=e}getSpan(e,t){let r=this.span;return 0>r&&(r=this.length.decode(e,t)),r}decode(e,t=0){let r=this.span;return 0>r&&(r=this.length.decode(e,t)),o(e).slice(t,t+r)}encode(e,t,r){let n=this.length;if(this.length instanceof c&&(n=e.length),!(e instanceof Uint8Array&&n===e.length))throw new TypeError(a("Blob.encode",this)+" requires (length "+n+") Uint8Array as src");if(r+n>t.length)throw new RangeError("encoding overruns Uint8Array");const i=o(e);return o(t).write(i.toString("hex"),r,n,"hex"),this.length instanceof c&&this.length.encode(n,t,r),n}}t.cY=(e,t,r)=>new u(e,t,r),t.u8=e=>new h(1,e),t.NX=e=>new h(2,e),t.DH=e=>new h(4,e),t.I0=e=>new g(e),t.Wg=e=>new y(e),t.w3=(e,t,r)=>new m(e,t,r),t.O6=(e,t,r)=>new b(e,t,r),t.av=(e,t)=>new w(e,t)},3893:(e,t,r)=>{"use strict";r.r(t),r.d(t,{Account:()=>zr,AddressLookupTableAccount:()=>Qn,AddressLookupTableInstruction:()=>Jo,AddressLookupTableProgram:()=>Xo,Authorized:()=>cs,BLOCKHASH_CACHE_TIMEOUT_MS:()=>oi,BPF_LOADER_DEPRECATED_PROGRAM_ID:()=>qr,BPF_LOADER_PROGRAM_ID:()=>$n,BpfLoader:()=>Kn,COMPUTE_BUDGET_INSTRUCTION_LAYOUTS:()=>Qo,ComputeBudgetInstruction:()=>Zo,ComputeBudgetProgram:()=>es,Connection:()=>Vo,Ed25519Program:()=>rs,Enum:()=>Mr,EpochSchedule:()=>Jn,FeeCalculatorLayout:()=>Nn,Keypair:()=>Go,LAMPORTS_PER_SOL:()=>Ts,LOOKUP_TABLE_INSTRUCTION_LAYOUTS:()=>Yo,Loader:()=>qn,Lockup:()=>us,MAX_SEED_LENGTH:()=>Lr,Message:()=>an,MessageAccountKeys:()=>Gr,MessageV0:()=>cn,NONCE_ACCOUNT_LENGTH:()=>Cn,NonceAccount:()=>Bn,PACKET_DATA_SIZE:()=>$r,PUBLIC_KEY_LENGTH:()=>Ur,PublicKey:()=>jr,SIGNATURE_LENGTH_IN_BYTES:()=>Fr,SOLANA_SCHEMA:()=>Cr,STAKE_CONFIG_ID:()=>as,STAKE_INSTRUCTION_LAYOUTS:()=>ls,SYSTEM_INSTRUCTION_LAYOUTS:()=>Dn,SYSVAR_CLOCK_PUBKEY:()=>yn,SYSVAR_EPOCH_SCHEDULE_PUBKEY:()=>bn,SYSVAR_INSTRUCTIONS_PUBKEY:()=>mn,SYSVAR_RECENT_BLOCKHASHES_PUBKEY:()=>wn,SYSVAR_RENT_PUBKEY:()=>vn,SYSVAR_REWARDS_PUBKEY:()=>Sn,SYSVAR_SLOT_HASHES_PUBKEY:()=>_n,SYSVAR_SLOT_HISTORY_PUBKEY:()=>En,SYSVAR_STAKE_HISTORY_PUBKEY:()=>In,Secp256k1Program:()=>os,SendTransactionError:()=>An,SolanaJSONRPCError:()=>xn,SolanaJSONRPCErrorCode:()=>kn,StakeAuthorizationLayout:()=>ds,StakeInstruction:()=>hs,StakeProgram:()=>fs,Struct:()=>Nr,SystemInstruction:()=>Un,SystemProgram:()=>jn,Transaction:()=>fn,TransactionExpiredBlockheightExceededError:()=>Wr,TransactionExpiredNonceInvalidError:()=>Vr,TransactionExpiredTimeoutError:()=>Hr,TransactionInstruction:()=>dn,TransactionMessage:()=>pn,TransactionStatus:()=>hn,VALIDATOR_INFO_KEY:()=>ws,VERSION_PREFIX_MASK:()=>Kr,VOTE_PROGRAM_ID:()=>_s,ValidatorInfo:()=>Ss,VersionedMessage:()=>un,VersionedTransaction:()=>gn,VoteAccount:()=>Is,VoteAuthorizationLayout:()=>bs,VoteInit:()=>ps,VoteInstruction:()=>gs,VoteProgram:()=>ms,clusterApiUrl:()=>Os,sendAndConfirmRawTransaction:()=>Rs,sendAndConfirmTransaction:()=>Pn});var n={};r.r(n),r.d(n,{aK:()=>re,e8:()=>z,DO:()=>j,dJ:()=>ne,OG:()=>ie,My:()=>$,Ph:()=>G,lX:()=>Y,Id:()=>Q,fg:()=>ae,qj:()=>Z,aT:()=>V,r4:()=>te,aY:()=>D,x:()=>he,lq:()=>J,z:()=>X,zW:()=>K,Q5:()=>ue});var i=r(1429);function o(e){if(!Number.isSafeInteger(e)||e<0)throw new Error("positive integer expected, got "+e)}function s(e,...t){if(!((r=e)instanceof Uint8Array||ArrayBuffer.isView(r)&&"Uint8Array"===r.constructor.name))throw new Error("Uint8Array expected");var r;if(t.length>0&&!t.includes(e.length))throw new Error("Uint8Array expected of length "+t+", got length="+e.length)}function a(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function c(e,t){s(e);const r=t.outputLen;if(e.length<r)throw new Error("digestInto() expects output buffer of length at least "+r)}const u="object"==typeof globalThis&&"crypto"in globalThis?globalThis.crypto:void 0;function h(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function l(e,t){return e<<32-t|e>>>t}const d=(()=>68===new Uint8Array(new Uint32Array([287454020]).buffer)[0])();function f(e){for(let r=0;r<e.length;r++)e[r]=(t=e[r])<<24&4278190080|t<<8&16711680|t>>>8&65280|t>>>24&255;var t}function p(e){return"string"==typeof e&&(e=function(e){if("string"!=typeof e)throw new Error("utf8ToBytes expected string, got "+typeof e);return new Uint8Array((new TextEncoder).encode(e))}(e)),s(e),e}class g{clone(){return this._cloneInto()}}function y(e){const t=t=>e().update(p(t)).digest(),r=e();return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=()=>e(),t}function b(e=32){if(u&&"function"==typeof u.getRandomValues)return u.getRandomValues(new Uint8Array(e));if(u&&"function"==typeof u.randomBytes)return u.randomBytes(e);throw new Error("crypto.getRandomValues must be defined")}function m(e,t,r){return e&t^e&r^t&r}class w extends g{constructor(e,t,r,n){super(),this.blockLen=e,this.outputLen=t,this.padOffset=r,this.isLE=n,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=h(this.buffer)}update(e){a(this);const{view:t,buffer:r,blockLen:n}=this,i=(e=p(e)).length;for(let o=0;o<i;){const s=Math.min(n-this.pos,i-o);if(s!==n)r.set(e.subarray(o,o+s),this.pos),this.pos+=s,o+=s,this.pos===n&&(this.process(t,0),this.pos=0);else{const t=h(e);for(;n<=i-o;o+=n)this.process(t,o)}}return this.length+=e.length,this.roundClean(),this}digestInto(e){a(this),c(e,this),this.finished=!0;const{buffer:t,view:r,blockLen:n,isLE:i}=this;let{pos:o}=this;t[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>n-o&&(this.process(r,0),o=0);for(let e=o;e<n;e++)t[e]=0;!function(e,t,r,n){if("function"==typeof e.setBigUint64)return e.setBigUint64(t,r,n);const i=BigInt(32),o=BigInt(4294967295),s=Number(r>>i&o),a=Number(r&o),c=n?4:0,u=n?0:4;e.setUint32(t+c,s,n),e.setUint32(t+u,a,n)}(r,n-8,BigInt(8*this.length),i),this.process(r,0);const s=h(e),u=this.outputLen;if(u%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const l=u/4,d=this.get();if(l>d.length)throw new Error("_sha2: outputLen bigger than state");for(let e=0;e<l;e++)s.setUint32(4*e,d[e],i)}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const r=e.slice(0,t);return this.destroy(),r}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:t,buffer:r,length:n,finished:i,destroyed:o,pos:s}=this;return e.length=n,e.pos=s,e.finished=i,e.destroyed=o,n%t&&e.buffer.set(r),e}}const v=BigInt(2**32-1),S=BigInt(32);function _(e,t=!1){return t?{h:Number(e&v),l:Number(e>>S&v)}:{h:0|Number(e>>S&v),l:0|Number(e&v)}}function E(e,t=!1){let r=new Uint32Array(e.length),n=new Uint32Array(e.length);for(let i=0;i<e.length;i++){const{h:o,l:s}=_(e[i],t);[r[i],n[i]]=[o,s]}return[r,n]}const I=(e,t,r)=>e<<r|t>>>32-r,A=(e,t,r)=>t<<r|e>>>32-r,k=(e,t,r)=>t<<r-32|e>>>64-r,x=(e,t,r)=>e<<r-32|t>>>64-r,P={fromBig:_,split:E,toBig:(e,t)=>BigInt(e>>>0)<<S|BigInt(t>>>0),shrSH:(e,t,r)=>e>>>r,shrSL:(e,t,r)=>e<<32-r|t>>>r,rotrSH:(e,t,r)=>e>>>r|t<<32-r,rotrSL:(e,t,r)=>e<<32-r|t>>>r,rotrBH:(e,t,r)=>e<<64-r|t>>>r-32,rotrBL:(e,t,r)=>e>>>r-32|t<<64-r,rotr32H:(e,t)=>t,rotr32L:(e,t)=>e,rotlSH:I,rotlSL:A,rotlBH:k,rotlBL:x,add:function(e,t,r,n){const i=(t>>>0)+(n>>>0);return{h:e+r+(i/2**32|0)|0,l:0|i}},add3L:(e,t,r)=>(e>>>0)+(t>>>0)+(r>>>0),add3H:(e,t,r,n)=>t+r+n+(e/2**32|0)|0,add4L:(e,t,r,n)=>(e>>>0)+(t>>>0)+(r>>>0)+(n>>>0),add4H:(e,t,r,n,i)=>t+r+n+i+(e/2**32|0)|0,add5H:(e,t,r,n,i,o)=>t+r+n+i+o+(e/2**32|0)|0,add5L:(e,t,r,n,i)=>(e>>>0)+(t>>>0)+(r>>>0)+(n>>>0)+(i>>>0)},[O,R]=(()=>P.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map((e=>BigInt(e)))))(),T=new Uint32Array(80),N=new Uint32Array(80);class M extends w{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:e,Al:t,Bh:r,Bl:n,Ch:i,Cl:o,Dh:s,Dl:a,Eh:c,El:u,Fh:h,Fl:l,Gh:d,Gl:f,Hh:p,Hl:g}=this;return[e,t,r,n,i,o,s,a,c,u,h,l,d,f,p,g]}set(e,t,r,n,i,o,s,a,c,u,h,l,d,f,p,g){this.Ah=0|e,this.Al=0|t,this.Bh=0|r,this.Bl=0|n,this.Ch=0|i,this.Cl=0|o,this.Dh=0|s,this.Dl=0|a,this.Eh=0|c,this.El=0|u,this.Fh=0|h,this.Fl=0|l,this.Gh=0|d,this.Gl=0|f,this.Hh=0|p,this.Hl=0|g}process(e,t){for(let r=0;r<16;r++,t+=4)T[r]=e.getUint32(t),N[r]=e.getUint32(t+=4);for(let e=16;e<80;e++){const t=0|T[e-15],r=0|N[e-15],n=P.rotrSH(t,r,1)^P.rotrSH(t,r,8)^P.shrSH(t,r,7),i=P.rotrSL(t,r,1)^P.rotrSL(t,r,8)^P.shrSL(t,r,7),o=0|T[e-2],s=0|N[e-2],a=P.rotrSH(o,s,19)^P.rotrBH(o,s,61)^P.shrSH(o,s,6),c=P.rotrSL(o,s,19)^P.rotrBL(o,s,61)^P.shrSL(o,s,6),u=P.add4L(i,c,N[e-7],N[e-16]),h=P.add4H(u,n,a,T[e-7],T[e-16]);T[e]=0|h,N[e]=0|u}let{Ah:r,Al:n,Bh:i,Bl:o,Ch:s,Cl:a,Dh:c,Dl:u,Eh:h,El:l,Fh:d,Fl:f,Gh:p,Gl:g,Hh:y,Hl:b}=this;for(let e=0;e<80;e++){const t=P.rotrSH(h,l,14)^P.rotrSH(h,l,18)^P.rotrBH(h,l,41),m=P.rotrSL(h,l,14)^P.rotrSL(h,l,18)^P.rotrBL(h,l,41),w=h&d^~h&p,v=l&f^~l&g,S=P.add5L(b,m,v,R[e],N[e]),_=P.add5H(S,y,t,w,O[e],T[e]),E=0|S,I=P.rotrSH(r,n,28)^P.rotrBH(r,n,34)^P.rotrBH(r,n,39),A=P.rotrSL(r,n,28)^P.rotrBL(r,n,34)^P.rotrBL(r,n,39),k=r&i^r&s^i&s,x=n&o^n&a^o&a;y=0|p,b=0|g,p=0|d,g=0|f,d=0|h,f=0|l,({h,l}=P.add(0|c,0|u,0|_,0|E)),c=0|s,u=0|a,s=0|i,a=0|o,i=0|r,o=0|n;const M=P.add3L(E,A,x);r=P.add3H(M,_,I,k),n=0|M}({h:r,l:n}=P.add(0|this.Ah,0|this.Al,0|r,0|n)),({h:i,l:o}=P.add(0|this.Bh,0|this.Bl,0|i,0|o)),({h:s,l:a}=P.add(0|this.Ch,0|this.Cl,0|s,0|a)),({h:c,l:u}=P.add(0|this.Dh,0|this.Dl,0|c,0|u)),({h,l}=P.add(0|this.Eh,0|this.El,0|h,0|l)),({h:d,l:f}=P.add(0|this.Fh,0|this.Fl,0|d,0|f)),({h:p,l:g}=P.add(0|this.Gh,0|this.Gl,0|p,0|g)),({h:y,l:b}=P.add(0|this.Hh,0|this.Hl,0|y,0|b)),this.set(r,n,i,o,s,a,c,u,h,l,d,f,p,g,y,b)}roundClean(){T.fill(0),N.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}const C=y((()=>new M)),B=BigInt(0),L=BigInt(1),U=BigInt(2);function D(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&"Uint8Array"===e.constructor.name}function j(e){if(!D(e))throw new Error("Uint8Array expected")}function z(e,t){if("boolean"!=typeof t)throw new Error(e+" boolean expected, got "+t)}const q=Array.from({length:256},((e,t)=>t.toString(16).padStart(2,"0")));function $(e){j(e);let t="";for(let r=0;r<e.length;r++)t+=q[e[r]];return t}function K(e){const t=e.toString(16);return 1&t.length?"0"+t:t}function F(e){if("string"!=typeof e)throw new Error("hex string expected, got "+typeof e);return""===e?B:BigInt("0x"+e)}const W={_0:48,_9:57,A:65,F:70,a:97,f:102};function H(e){return e>=W._0&&e<=W._9?e-W._0:e>=W.A&&e<=W.F?e-(W.A-10):e>=W.a&&e<=W.f?e-(W.a-10):void 0}function V(e){if("string"!=typeof e)throw new Error("hex string expected, got "+typeof e);const t=e.length,r=t/2;if(t%2)throw new Error("hex string expected, got unpadded hex of length "+t);const n=new Uint8Array(r);for(let t=0,i=0;t<r;t++,i+=2){const r=H(e.charCodeAt(i)),o=H(e.charCodeAt(i+1));if(void 0===r||void 0===o){const t=e[i]+e[i+1];throw new Error('hex string expected, got non-hex character "'+t+'" at index '+i)}n[t]=16*r+o}return n}function G(e){return F($(e))}function Y(e){return j(e),F($(Uint8Array.from(e).reverse()))}function J(e,t){return V(e.toString(16).padStart(2*t,"0"))}function X(e,t){return J(e,t).reverse()}function Z(e,t,r){let n;if("string"==typeof t)try{n=V(t)}catch(t){throw new Error(e+" must be hex string or Uint8Array, cause: "+t)}else{if(!D(t))throw new Error(e+" must be hex string or Uint8Array");n=Uint8Array.from(t)}const i=n.length;if("number"==typeof r&&i!==r)throw new Error(e+" of length "+r+" expected, got "+i);return n}function Q(...e){let t=0;for(let r=0;r<e.length;r++){const n=e[r];j(n),t+=n.length}const r=new Uint8Array(t);for(let t=0,n=0;t<e.length;t++){const i=e[t];r.set(i,n),n+=i.length}return r}const ee=e=>"bigint"==typeof e&&B<=e;function te(e,t,r){return ee(e)&&ee(t)&&ee(r)&&t<=e&&e<r}function re(e,t,r,n){if(!te(t,r,n))throw new Error("expected valid "+e+": "+r+" <= n < "+n+", got "+t)}function ne(e){let t;for(t=0;e>B;e>>=L,t+=1);return t}const ie=e=>(U<<BigInt(e-1))-L,oe=e=>new Uint8Array(e),se=e=>Uint8Array.from(e);function ae(e,t,r){if("number"!=typeof e||e<2)throw new Error("hashLen must be a number");if("number"!=typeof t||t<2)throw new Error("qByteLen must be a number");if("function"!=typeof r)throw new Error("hmacFn must be a function");let n=oe(e),i=oe(e),o=0;const s=()=>{n.fill(1),i.fill(0),o=0},a=(...e)=>r(i,n,...e),c=(e=oe())=>{i=a(se([0]),e),n=a(),0!==e.length&&(i=a(se([1]),e),n=a())},u=()=>{if(o++>=1e3)throw new Error("drbg: tried 1000 values");let e=0;const r=[];for(;e<t;){n=a();const t=n.slice();r.push(t),e+=n.length}return Q(...r)};return(e,t)=>{let r;for(s(),c(e);!(r=t(u()));)c();return s(),r}}const ce={bigint:e=>"bigint"==typeof e,function:e=>"function"==typeof e,boolean:e=>"boolean"==typeof e,string:e=>"string"==typeof e,stringOrUint8Array:e=>"string"==typeof e||D(e),isSafeInteger:e=>Number.isSafeInteger(e),array:e=>Array.isArray(e),field:(e,t)=>t.Fp.isValid(e),hash:e=>"function"==typeof e&&Number.isSafeInteger(e.outputLen)};function ue(e,t,r={}){const n=(t,r,n)=>{const i=ce[r];if("function"!=typeof i)throw new Error("invalid validator function");const o=e[t];if(!(n&&void 0===o||i(o,e)))throw new Error("param "+String(t)+" is invalid. Expected "+r+", got "+o)};for(const[e,r]of Object.entries(t))n(e,r,!1);for(const[e,t]of Object.entries(r))n(e,t,!0);return e}function he(e){const t=new WeakMap;return(r,...n)=>{const i=t.get(r);if(void 0!==i)return i;const o=e(r,...n);return t.set(r,o),o}}const le=BigInt(0),de=BigInt(1),fe=BigInt(2),pe=BigInt(3),ge=BigInt(4),ye=BigInt(5),be=BigInt(8);function me(e,t){const r=e%t;return r>=le?r:t+r}function we(e,t,r){if(t<le)throw new Error("invalid exponent, negatives unsupported");if(r<=le)throw new Error("invalid modulus");if(r===de)return le;let n=de;for(;t>le;)t&de&&(n=n*e%r),e=e*e%r,t>>=de;return n}function ve(e,t,r){let n=e;for(;t-- >le;)n*=n,n%=r;return n}function Se(e,t){if(e===le)throw new Error("invert: expected non-zero number");if(t<=le)throw new Error("invert: expected positive modulus, got "+t);let r=me(e,t),n=t,i=le,o=de,s=de,a=le;for(;r!==le;){const e=n/r,t=n%r,c=i-s*e,u=o-a*e;n=r,r=t,i=s,o=a,s=c,a=u}if(n!==de)throw new Error("invert: does not exist");return me(i,t)}const _e=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function Ee(e,t){const r=void 0!==t?t:e.toString(2).length;return{nBitLength:r,nByteLength:Math.ceil(r/8)}}function Ie(e,t,r=!1,n={}){if(e<=le)throw new Error("invalid field: expected ORDER > 0, got "+e);const{nBitLength:i,nByteLength:o}=Ee(e,t);if(o>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let s;const a=Object.freeze({ORDER:e,isLE:r,BITS:i,BYTES:o,MASK:ie(i),ZERO:le,ONE:de,create:t=>me(t,e),isValid:t=>{if("bigint"!=typeof t)throw new Error("invalid field element: expected bigint, got "+typeof t);return le<=t&&t<e},is0:e=>e===le,isOdd:e=>(e&de)===de,neg:t=>me(-t,e),eql:(e,t)=>e===t,sqr:t=>me(t*t,e),add:(t,r)=>me(t+r,e),sub:(t,r)=>me(t-r,e),mul:(t,r)=>me(t*r,e),pow:(e,t)=>function(e,t,r){if(r<le)throw new Error("invalid exponent, negatives unsupported");if(r===le)return e.ONE;if(r===de)return t;let n=e.ONE,i=t;for(;r>le;)r&de&&(n=e.mul(n,i)),i=e.sqr(i),r>>=de;return n}(a,e,t),div:(t,r)=>me(t*Se(r,e),e),sqrN:e=>e*e,addN:(e,t)=>e+t,subN:(e,t)=>e-t,mulN:(e,t)=>e*t,inv:t=>Se(t,e),sqrt:n.sqrt||(t=>(s||(s=function(e){if(e%ge===pe){const t=(e+de)/ge;return function(e,r){const n=e.pow(r,t);if(!e.eql(e.sqr(n),r))throw new Error("Cannot find square root");return n}}if(e%be===ye){const t=(e-ye)/be;return function(e,r){const n=e.mul(r,fe),i=e.pow(n,t),o=e.mul(r,i),s=e.mul(e.mul(o,fe),i),a=e.mul(o,e.sub(s,e.ONE));if(!e.eql(e.sqr(a),r))throw new Error("Cannot find square root");return a}}return function(e){const t=(e-de)/fe;let r,n,i;for(r=e-de,n=0;r%fe===le;r/=fe,n++);for(i=fe;i<e&&we(i,t,e)!==e-de;i++)if(i>1e3)throw new Error("Cannot find square root: likely non-prime P");if(1===n){const t=(e+de)/ge;return function(e,r){const n=e.pow(r,t);if(!e.eql(e.sqr(n),r))throw new Error("Cannot find square root");return n}}const o=(r+de)/fe;return function(e,s){if(e.pow(s,t)===e.neg(e.ONE))throw new Error("Cannot find square root");let a=n,c=e.pow(e.mul(e.ONE,i),r),u=e.pow(s,o),h=e.pow(s,r);for(;!e.eql(h,e.ONE);){if(e.eql(h,e.ZERO))return e.ZERO;let t=1;for(let r=e.sqr(h);t<a&&!e.eql(r,e.ONE);t++)r=e.sqr(r);const r=e.pow(c,de<<BigInt(a-t-1));c=e.sqr(r),u=e.mul(u,r),h=e.mul(h,c),a=t}return u}}(e)}(e)),s(a,t))),invertBatch:e=>function(e,t){const r=new Array(t.length),n=t.reduce(((t,n,i)=>e.is0(n)?t:(r[i]=t,e.mul(t,n))),e.ONE),i=e.inv(n);return t.reduceRight(((t,n,i)=>e.is0(n)?t:(r[i]=e.mul(t,r[i]),e.mul(t,n))),i),r}(a,e),cmov:(e,t,r)=>r?t:e,toBytes:e=>r?X(e,o):J(e,o),fromBytes:e=>{if(e.length!==o)throw new Error("Field.fromBytes: expected "+o+" bytes, got "+e.length);return r?Y(e):G(e)}});return Object.freeze(a)}function Ae(e){if("bigint"!=typeof e)throw new Error("field order must be bigint");const t=e.toString(2).length;return Math.ceil(t/8)}function ke(e){const t=Ae(e);return t+Math.ceil(t/2)}const xe=BigInt(0),Pe=BigInt(1);function Oe(e,t){const r=t.negate();return e?r:t}function Re(e,t){if(!Number.isSafeInteger(e)||e<=0||e>t)throw new Error("invalid window size, expected [1.."+t+"], got W="+e)}function Te(e,t){return Re(e,t),{windows:Math.ceil(t/e)+1,windowSize:2**(e-1)}}const Ne=new WeakMap,Me=new WeakMap;function Ce(e){return Me.get(e)||1}function Be(e,t){return{constTimeNegate:Oe,hasPrecomputes:e=>1!==Ce(e),unsafeLadder(t,r,n=e.ZERO){let i=t;for(;r>xe;)r&Pe&&(n=n.add(i)),i=i.double(),r>>=Pe;return n},precomputeWindow(e,r){const{windows:n,windowSize:i}=Te(r,t),o=[];let s=e,a=s;for(let e=0;e<n;e++){a=s,o.push(a);for(let e=1;e<i;e++)a=a.add(s),o.push(a);s=a.double()}return o},wNAF(r,n,i){const{windows:o,windowSize:s}=Te(r,t);let a=e.ZERO,c=e.BASE;const u=BigInt(2**r-1),h=2**r,l=BigInt(r);for(let e=0;e<o;e++){const t=e*s;let r=Number(i&u);i>>=l,r>s&&(r-=h,i+=Pe);const o=t,d=t+Math.abs(r)-1,f=e%2!=0,p=r<0;0===r?c=c.add(Oe(f,n[o])):a=a.add(Oe(p,n[d]))}return{p:a,f:c}},wNAFUnsafe(r,n,i,o=e.ZERO){const{windows:s,windowSize:a}=Te(r,t),c=BigInt(2**r-1),u=2**r,h=BigInt(r);for(let e=0;e<s;e++){const t=e*a;if(i===xe)break;let r=Number(i&c);if(i>>=h,r>a&&(r-=u,i+=Pe),0===r)continue;let s=n[t+Math.abs(r)-1];r<0&&(s=s.negate()),o=o.add(s)}return o},getPrecomputes(e,t,r){let n=Ne.get(t);return n||(n=this.precomputeWindow(t,e),1!==e&&Ne.set(t,r(n))),n},wNAFCached(e,t,r){const n=Ce(e);return this.wNAF(n,this.getPrecomputes(n,e,r),t)},wNAFCachedUnsafe(e,t,r,n){const i=Ce(e);return 1===i?this.unsafeLadder(e,t,n):this.wNAFUnsafe(i,this.getPrecomputes(i,e,r),t,n)},setWindowSize(e,r){Re(r,t),Me.set(e,r),Ne.delete(e)}}}function Le(e,t,r,n){if(function(e,t){if(!Array.isArray(e))throw new Error("array expected");e.forEach(((e,r)=>{if(!(e instanceof t))throw new Error("invalid point at index "+r)}))}(r,e),function(e,t){if(!Array.isArray(e))throw new Error("array of scalars expected");e.forEach(((e,r)=>{if(!t.isValid(e))throw new Error("invalid scalar at index "+r)}))}(n,t),r.length!==n.length)throw new Error("arrays of points and scalars must have equal length");const i=e.ZERO,o=ne(BigInt(r.length)),s=o>12?o-3:o>4?o-2:o?2:1,a=(1<<s)-1,c=new Array(a+1).fill(i);let u=i;for(let e=Math.floor((t.BITS-1)/s)*s;e>=0;e-=s){c.fill(i);for(let t=0;t<n.length;t++){const i=n[t],o=Number(i>>BigInt(e)&BigInt(a));c[o]=c[o].add(r[t])}let t=i;for(let e=c.length-1,r=i;e>0;e--)r=r.add(c[e]),t=t.add(r);if(u=u.add(t),0!==e)for(let e=0;e<s;e++)u=u.double()}return u}function Ue(e){return ue(e.Fp,_e.reduce(((e,t)=>(e[t]="function",e)),{ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"})),ue(e,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...Ee(e.n,e.nBitLength),...e,p:e.Fp.ORDER})}const De=BigInt(0),je=BigInt(1),ze=BigInt(2),qe=BigInt(8),$e={zip215:!0};const Ke=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),Fe=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752"),We=(BigInt(0),BigInt(1)),He=BigInt(2),Ve=(BigInt(3),BigInt(5)),Ge=BigInt(8);function Ye(e){return e[0]&=248,e[31]&=127,e[31]|=64,e}function Je(e,t){const r=Ke,n=me(t*t*t,r),i=me(n*n*t,r);let o=me(e*n*function(e){const t=BigInt(10),r=BigInt(20),n=BigInt(40),i=BigInt(80),o=Ke,s=e*e%o*e%o,a=ve(s,He,o)*s%o,c=ve(a,We,o)*e%o,u=ve(c,Ve,o)*c%o,h=ve(u,t,o)*u%o,l=ve(h,r,o)*h%o,d=ve(l,n,o)*l%o,f=ve(d,i,o)*d%o,p=ve(f,i,o)*d%o,g=ve(p,t,o)*u%o;return{pow_p_5_8:ve(g,He,o)*e%o,b2:s}}(e*i).pow_p_5_8,r);const s=me(t*o*o,r),a=o,c=me(o*Fe,r),u=s===e,h=s===me(-e,r),l=s===me(-e*Fe,r);return u&&(o=a),(h||l)&&(o=c),(me(o,r)&de)===de&&(o=me(-o,r)),{isValid:u||h,value:o}}const Xe=(()=>Ie(Ke,void 0,!0))(),Ze=(()=>({a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),Fp:Xe,n:BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),h:Ge,Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960"),hash:C,randomBytes:b,adjustScalarBytes:Ye,uvRatio:Je}))(),Qe=(()=>function(e){const t=function(e){const t=Ue(e);return ue(e,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...t})}(e),{Fp:r,n,prehash:i,hash:o,randomBytes:s,nByteLength:a,h:c}=t,u=ze<<BigInt(8*a)-je,h=r.create,l=Ie(t.n,t.nBitLength),d=t.uvRatio||((e,t)=>{try{return{isValid:!0,value:r.sqrt(e*r.inv(t))}}catch(e){return{isValid:!1,value:De}}}),f=t.adjustScalarBytes||(e=>e),p=t.domain||((e,t,r)=>{if(z("phflag",r),t.length||r)throw new Error("Contexts/pre-hash are not supported");return e});function g(e,t){re("coordinate "+e,t,De,u)}function y(e){if(!(e instanceof w))throw new Error("ExtendedPoint expected")}const b=he(((e,t)=>{const{ex:n,ey:i,ez:o}=e,s=e.is0();null==t&&(t=s?qe:r.inv(o));const a=h(n*t),c=h(i*t),u=h(o*t);if(s)return{x:De,y:je};if(u!==je)throw new Error("invZ was invalid");return{x:a,y:c}})),m=he((e=>{const{a:r,d:n}=t;if(e.is0())throw new Error("bad point: ZERO");const{ex:i,ey:o,ez:s,et:a}=e,c=h(i*i),u=h(o*o),l=h(s*s),d=h(l*l),f=h(c*r);if(h(l*h(f+u))!==h(d+h(n*h(c*u))))throw new Error("bad point: equation left != right (1)");if(h(i*o)!==h(s*a))throw new Error("bad point: equation left != right (2)");return!0}));class w{constructor(e,t,r,n){this.ex=e,this.ey=t,this.ez=r,this.et=n,g("x",e),g("y",t),g("z",r),g("t",n),Object.freeze(this)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(e){if(e instanceof w)throw new Error("extended point not allowed");const{x:t,y:r}=e||{};return g("x",t),g("y",r),new w(t,r,je,h(t*r))}static normalizeZ(e){const t=r.invertBatch(e.map((e=>e.ez)));return e.map(((e,r)=>e.toAffine(t[r]))).map(w.fromAffine)}static msm(e,t){return Le(w,l,e,t)}_setWindowSize(e){_.setWindowSize(this,e)}assertValidity(){m(this)}equals(e){y(e);const{ex:t,ey:r,ez:n}=this,{ex:i,ey:o,ez:s}=e,a=h(t*s),c=h(i*n),u=h(r*s),l=h(o*n);return a===c&&u===l}is0(){return this.equals(w.ZERO)}negate(){return new w(h(-this.ex),this.ey,this.ez,h(-this.et))}double(){const{a:e}=t,{ex:r,ey:n,ez:i}=this,o=h(r*r),s=h(n*n),a=h(ze*h(i*i)),c=h(e*o),u=r+n,l=h(h(u*u)-o-s),d=c+s,f=d-a,p=c-s,g=h(l*f),y=h(d*p),b=h(l*p),m=h(f*d);return new w(g,y,m,b)}add(e){y(e);const{a:r,d:n}=t,{ex:i,ey:o,ez:s,et:a}=this,{ex:c,ey:u,ez:l,et:d}=e;if(r===BigInt(-1)){const e=h((o-i)*(u+c)),t=h((o+i)*(u-c)),r=h(t-e);if(r===De)return this.double();const n=h(s*ze*d),f=h(a*ze*l),p=f+n,g=t+e,y=f-n,b=h(p*r),m=h(g*y),v=h(p*y),S=h(r*g);return new w(b,m,S,v)}const f=h(i*c),p=h(o*u),g=h(a*n*d),b=h(s*l),m=h((i+o)*(c+u)-f-p),v=b-g,S=b+g,_=h(p-r*f),E=h(m*v),I=h(S*_),A=h(m*_),k=h(v*S);return new w(E,I,k,A)}subtract(e){return this.add(e.negate())}wNAF(e){return _.wNAFCached(this,e,w.normalizeZ)}multiply(e){const t=e;re("scalar",t,je,n);const{p:r,f:i}=this.wNAF(t);return w.normalizeZ([r,i])[0]}multiplyUnsafe(e,t=w.ZERO){const r=e;return re("scalar",r,De,n),r===De?S:this.is0()||r===je?this:_.wNAFCachedUnsafe(this,r,w.normalizeZ,t)}isSmallOrder(){return this.multiplyUnsafe(c).is0()}isTorsionFree(){return _.unsafeLadder(this,n).is0()}toAffine(e){return b(this,e)}clearCofactor(){const{h:e}=t;return e===je?this:this.multiplyUnsafe(e)}static fromHex(e,n=!1){const{d:i,a:o}=t,s=r.BYTES;e=Z("pointHex",e,s),z("zip215",n);const a=e.slice(),c=e[s-1];a[s-1]=-129&c;const l=Y(a),f=n?u:r.ORDER;re("pointHex.y",l,De,f);const p=h(l*l),g=h(p-je),y=h(i*p-o);let{isValid:b,value:m}=d(g,y);if(!b)throw new Error("Point.fromHex: invalid y coordinate");const v=(m&je)===je,S=!!(128&c);if(!n&&m===De&&S)throw new Error("Point.fromHex: x=0 and x_0=1");return S!==v&&(m=h(-m)),w.fromAffine({x:m,y:l})}static fromPrivateKey(e){return A(e).point}toRawBytes(){const{x:e,y:t}=this.toAffine(),n=X(t,r.BYTES);return n[n.length-1]|=e&je?128:0,n}toHex(){return $(this.toRawBytes())}}w.BASE=new w(t.Gx,t.Gy,je,h(t.Gx*t.Gy)),w.ZERO=new w(De,je,je,De);const{BASE:v,ZERO:S}=w,_=Be(w,8*a);function E(e){return me(e,n)}function I(e){return E(Y(e))}function A(e){const t=r.BYTES;e=Z("private key",e,t);const n=Z("hashed private key",o(e),2*t),i=f(n.slice(0,t)),s=n.slice(t,2*t),a=I(i),c=v.multiply(a),u=c.toRawBytes();return{head:i,prefix:s,scalar:a,point:c,pointBytes:u}}function k(e=new Uint8Array,...t){const r=Q(...t);return I(o(p(r,Z("context",e),!!i)))}const x=$e;return v._setWindowSize(8),{CURVE:t,getPublicKey:function(e){return A(e).pointBytes},sign:function(e,t,o={}){e=Z("message",e),i&&(e=i(e));const{prefix:s,scalar:a,pointBytes:c}=A(t),u=k(o.context,s,e),h=v.multiply(u).toRawBytes(),l=E(u+k(o.context,h,c,e)*a);return re("signature.s",l,De,n),Z("result",Q(h,X(l,r.BYTES)),2*r.BYTES)},verify:function(e,t,n,o=x){const{context:s,zip215:a}=o,c=r.BYTES;e=Z("signature",e,2*c),t=Z("message",t),n=Z("publicKey",n,c),void 0!==a&&z("zip215",a),i&&(t=i(t));const u=Y(e.slice(c,2*c));let h,l,d;try{h=w.fromHex(n,a),l=w.fromHex(e.slice(0,c),a),d=v.multiplyUnsafe(u)}catch(e){return!1}if(!a&&h.isSmallOrder())return!1;const f=k(s,l.toRawBytes(),h.toRawBytes(),t);return l.add(h.multiplyUnsafe(f)).subtract(d).clearCofactor().equals(w.ZERO)},ExtendedPoint:w,utils:{getExtendedPublicKey:A,randomPrivateKey:()=>s(r.BYTES),precompute:(e=8,t=w.BASE)=>(t._setWindowSize(e),t.multiply(BigInt(3)),t)}}}(Ze))();var et=r(5530),tt=r.n(et),rt=r(2112),nt=r.n(rt);const it=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),ot=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),st=new Uint32Array(64);class at extends w{constructor(){super(64,32,8,!1),this.A=0|ot[0],this.B=0|ot[1],this.C=0|ot[2],this.D=0|ot[3],this.E=0|ot[4],this.F=0|ot[5],this.G=0|ot[6],this.H=0|ot[7]}get(){const{A:e,B:t,C:r,D:n,E:i,F:o,G:s,H:a}=this;return[e,t,r,n,i,o,s,a]}set(e,t,r,n,i,o,s,a){this.A=0|e,this.B=0|t,this.C=0|r,this.D=0|n,this.E=0|i,this.F=0|o,this.G=0|s,this.H=0|a}process(e,t){for(let r=0;r<16;r++,t+=4)st[r]=e.getUint32(t,!1);for(let e=16;e<64;e++){const t=st[e-15],r=st[e-2],n=l(t,7)^l(t,18)^t>>>3,i=l(r,17)^l(r,19)^r>>>10;st[e]=i+st[e-7]+n+st[e-16]|0}let{A:r,B:n,C:i,D:o,E:s,F:a,G:c,H:u}=this;for(let e=0;e<64;e++){const t=u+(l(s,6)^l(s,11)^l(s,25))+((h=s)&a^~h&c)+it[e]+st[e]|0,d=(l(r,2)^l(r,13)^l(r,22))+m(r,n,i)|0;u=c,c=a,a=s,s=o+t|0,o=i,i=n,n=r,r=t+d|0}var h;r=r+this.A|0,n=n+this.B|0,i=i+this.C|0,o=o+this.D|0,s=s+this.E|0,a=a+this.F|0,c=c+this.G|0,u=u+this.H|0,this.set(r,n,i,o,s,a,c,u)}roundClean(){st.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}const ct=y((()=>new at));var ut=r(9461),ht=r(3035),lt=r(2550);class dt extends TypeError{constructor(e,t){let r;const{message:n,explanation:i,...o}=e,{path:s}=e,a=0===s.length?n:`At path: ${s.join(".")} -- ${n}`;super(i??a),null!=i&&(this.cause=a),Object.assign(this,o),this.name=this.constructor.name,this.failures=()=>r??(r=[e,...t()])}}function ft(e){return"object"==typeof e&&null!=e}function pt(e){return ft(e)&&!Array.isArray(e)}function gt(e){return"symbol"==typeof e?e.toString():"string"==typeof e?JSON.stringify(e):`${e}`}function yt(e,t,r,n){if(!0===e)return;!1===e?e={}:"string"==typeof e&&(e={message:e});const{path:i,branch:o}=t,{type:s}=r,{refinement:a,message:c=`Expected a value of type \`${s}\`${a?` with refinement \`${a}\``:""}, but received: \`${gt(n)}\``}=e;return{value:n,type:s,refinement:a,key:i[i.length-1],path:i,branch:o,...e,message:c}}function*bt(e,t,r,n){var i;ft(i=e)&&"function"==typeof i[Symbol.iterator]||(e=[e]);for(const i of e){const e=yt(i,t,r,n);e&&(yield e)}}function*mt(e,t,r={}){const{path:n=[],branch:i=[e],coerce:o=!1,mask:s=!1}=r,a={path:n,branch:i,mask:s};o&&(e=t.coercer(e,a));let c="valid";for(const n of t.validator(e,a))n.explanation=r.message,c="not_valid",yield[n,void 0];for(let[u,h,l]of t.entries(e,a)){const t=mt(h,l,{path:void 0===u?n:[...n,u],branch:void 0===u?i:[...i,h],coerce:o,mask:s,message:r.message});for(const r of t)r[0]?(c=null!=r[0].refinement?"not_refined":"not_valid",yield[r[0],void 0]):o&&(h=r[1],void 0===u?e=h:e instanceof Map?e.set(u,h):e instanceof Set?e.add(h):ft(e)&&(void 0!==h||u in e)&&(e[u]=h))}if("not_valid"!==c)for(const n of t.refiner(e,a))n.explanation=r.message,c="not_refined",yield[n,void 0];"valid"===c&&(yield[void 0,e])}class wt{constructor(e){const{type:t,schema:r,validator:n,refiner:i,coercer:o=e=>e,entries:s=function*(){}}=e;this.type=t,this.schema=r,this.entries=s,this.coercer=o,this.validator=n?(e,t)=>bt(n(e,t),t,this,e):()=>[],this.refiner=i?(e,t)=>bt(i(e,t),t,this,e):()=>[]}assert(e,t){return vt(e,this,t)}create(e,t){return St(e,this,t)}is(e){return _t(e,this)}mask(e,t){return function(e,t,r){const n=Et(e,t,{coerce:!0,mask:!0,message:r});if(n[0])throw n[0];return n[1]}(e,this,t)}validate(e,t={}){return Et(e,this,t)}}function vt(e,t,r){const n=Et(e,t,{message:r});if(n[0])throw n[0]}function St(e,t,r){const n=Et(e,t,{coerce:!0,message:r});if(n[0])throw n[0];return n[1]}function _t(e,t){return!Et(e,t)[0]}function Et(e,t,r={}){const n=mt(e,t,r),i=function(e){const{done:t,value:r}=e.next();return t?void 0:r}(n);return i[0]?[new dt(i[0],(function*(){for(const e of n)e[0]&&(yield e[0])})),void 0]:[void 0,i[1]]}function It(e,t){return new wt({type:e,schema:null,validator:t})}function At(e){return new wt({type:"array",schema:e,*entries(t){if(e&&Array.isArray(t))for(const[r,n]of t.entries())yield[r,n,e]},coercer:e=>Array.isArray(e)?e.slice():e,validator:e=>Array.isArray(e)||`Expected an array value, but received: ${gt(e)}`})}function kt(){return It("boolean",(e=>"boolean"==typeof e))}function xt(e){return It("instance",(t=>t instanceof e||`Expected a \`${e.name}\` instance, but received: ${gt(t)}`))}function Pt(e){const t=gt(e),r=typeof e;return new wt({type:"literal",schema:"string"===r||"number"===r||"boolean"===r?e:null,validator:r=>r===e||`Expected the literal \`${t}\`, but received: ${gt(r)}`})}function Ot(e){return new wt({...e,validator:(t,r)=>null===t||e.validator(t,r),refiner:(t,r)=>null===t||e.refiner(t,r)})}function Rt(){return It("number",(e=>"number"==typeof e&&!isNaN(e)||`Expected a number, but received: ${gt(e)}`))}function Tt(e){return new wt({...e,validator:(t,r)=>void 0===t||e.validator(t,r),refiner:(t,r)=>void 0===t||e.refiner(t,r)})}function Nt(e,t){return new wt({type:"record",schema:null,*entries(r){if(ft(r))for(const n in r){const i=r[n];yield[n,n,e],yield[n,i,t]}},validator:e=>pt(e)||`Expected an object, but received: ${gt(e)}`,coercer:e=>pt(e)?{...e}:e})}function Mt(){return It("string",(e=>"string"==typeof e||`Expected a string, but received: ${gt(e)}`))}function Ct(e){const t=It("never",(()=>!1));return new wt({type:"tuple",schema:null,*entries(r){if(Array.isArray(r)){const n=Math.max(e.length,r.length);for(let i=0;i<n;i++)yield[i,r[i],e[i]||t]}},validator:e=>Array.isArray(e)||`Expected an array, but received: ${gt(e)}`,coercer:e=>Array.isArray(e)?e.slice():e})}function Bt(e){const t=Object.keys(e);return new wt({type:"type",schema:e,*entries(r){if(ft(r))for(const n of t)yield[n,r[n],e[n]]},validator:e=>pt(e)||`Expected an object, but received: ${gt(e)}`,coercer:e=>pt(e)?{...e}:e})}function Lt(e){const t=e.map((e=>e.type)).join(" | ");return new wt({type:"union",schema:null,coercer(t,r){for(const n of e){const[e,i]=n.validate(t,{coerce:!0,mask:r.mask});if(!e)return i}return t},validator(r,n){const i=[];for(const t of e){const[...e]=mt(r,t,n),[o]=e;if(!o[0])return[];for(const[t]of e)t&&i.push(t)}return[`Expected the value to satisfy a union of \`${t}\`, but received: ${gt(r)}`,...i]}})}function Ut(){return It("unknown",(()=>!0))}function Dt(e,t,r){return new wt({...e,coercer:(n,i)=>_t(n,t)?e.coercer(r(n,i),i):e.coercer(n,i)})}var jt=r(5864),zt=r.n(jt),qt=r(2646),$t=class extends qt{socket;constructor(e,t,r){super(),this.socket=new window.WebSocket(e,r),this.socket.onopen=()=>this.emit("open"),this.socket.onmessage=e=>this.emit("message",e.data),this.socket.onerror=e=>this.emit("error",e),this.socket.onclose=e=>{this.emit("close",e.code,e.reason)}}send(e,t,r){const n=r||t;try{this.socket.send(e),n()}catch(e){n(e)}}close(e,t){this.socket.close(e,t)}addEventListener(e,t,r){this.socket.addEventListener(e,t,r)}};var Kt=class{encode(e){return JSON.stringify(e)}decode(e){return JSON.parse(e)}},Ft=class extends qt{address;rpc_id;queue;options;autoconnect;ready;reconnect;reconnect_timer_id;reconnect_interval;max_reconnects;rest_options;current_reconnects;generate_request_id;socket;webSocketFactory;dataPack;constructor(e,t="ws://localhost:8080",{autoconnect:r=!0,reconnect:n=!0,reconnect_interval:i=1e3,max_reconnects:o=5,...s}={},a,c){super(),this.webSocketFactory=e,this.queue={},this.rpc_id=0,this.address=t,this.autoconnect=r,this.ready=!1,this.reconnect=n,this.reconnect_timer_id=void 0,this.reconnect_interval=i,this.max_reconnects=o,this.rest_options=s,this.current_reconnects=0,this.generate_request_id=a||(()=>++this.rpc_id),this.dataPack=c||new Kt,this.autoconnect&&this._connect(this.address,{autoconnect:this.autoconnect,reconnect:this.reconnect,reconnect_interval:this.reconnect_interval,max_reconnects:this.max_reconnects,...this.rest_options})}connect(){this.socket||this._connect(this.address,{autoconnect:this.autoconnect,reconnect:this.reconnect,reconnect_interval:this.reconnect_interval,max_reconnects:this.max_reconnects,...this.rest_options})}call(e,t,r,n){return n||"object"!=typeof r||(n=r,r=null),new Promise(((i,o)=>{if(!this.ready)return o(new Error("socket not ready"));const s=this.generate_request_id(e,t),a={jsonrpc:"2.0",method:e,params:t||void 0,id:s};this.socket.send(this.dataPack.encode(a),n,(e=>{if(e)return o(e);this.queue[s]={promise:[i,o]},r&&(this.queue[s].timeout=setTimeout((()=>{delete this.queue[s],o(new Error("reply timeout"))}),r))}))}))}async login(e){const t=await this.call("rpc.login",e);if(!t)throw new Error("authentication failed");return t}async listMethods(){return await this.call("__listMethods")}notify(e,t){return new Promise(((r,n)=>{if(!this.ready)return n(new Error("socket not ready"));const i={jsonrpc:"2.0",method:e,params:t};this.socket.send(this.dataPack.encode(i),(e=>{if(e)return n(e);r()}))}))}async subscribe(e){"string"==typeof e&&(e=[e]);const t=await this.call("rpc.on",e);if("string"==typeof e&&"ok"!==t[e])throw new Error("Failed subscribing to an event '"+e+"' with: "+t[e]);return t}async unsubscribe(e){"string"==typeof e&&(e=[e]);const t=await this.call("rpc.off",e);if("string"==typeof e&&"ok"!==t[e])throw new Error("Failed unsubscribing from an event with: "+t);return t}close(e,t){this.socket.close(e||1e3,t)}setAutoReconnect(e){this.reconnect=e}setReconnectInterval(e){this.reconnect_interval=e}setMaxReconnects(e){this.max_reconnects=e}_connect(e,t){clearTimeout(this.reconnect_timer_id),this.socket=this.webSocketFactory(e,t),this.socket.addEventListener("open",(()=>{this.ready=!0,this.emit("open"),this.current_reconnects=0})),this.socket.addEventListener("message",(({data:e})=>{e instanceof ArrayBuffer&&(e=i.Buffer.from(e).toString());try{e=this.dataPack.decode(e)}catch(e){return}if(e.notification&&this.listeners(e.notification).length){if(!Object.keys(e.params).length)return this.emit(e.notification);const t=[e.notification];if(e.params.constructor===Object)t.push(e.params);else for(let r=0;r<e.params.length;r++)t.push(e.params[r]);return Promise.resolve().then((()=>{this.emit.apply(this,t)}))}if(!this.queue[e.id])return e.method?Promise.resolve().then((()=>{this.emit(e.method,e?.params)})):void 0;"error"in e=="result"in e&&this.queue[e.id].promise[1](new Error('Server response malformed. Response must include either "result" or "error", but not both.')),this.queue[e.id].timeout&&clearTimeout(this.queue[e.id].timeout),e.error?this.queue[e.id].promise[1](e.error):this.queue[e.id].promise[0](e.result),delete this.queue[e.id]})),this.socket.addEventListener("error",(e=>this.emit("error",e))),this.socket.addEventListener("close",(({code:r,reason:n})=>{this.ready&&setTimeout((()=>this.emit("close",r,n)),0),this.ready=!1,this.socket=void 0,1e3!==r&&(this.current_reconnects++,this.reconnect&&(this.max_reconnects>this.current_reconnects||0===this.max_reconnects)&&(this.reconnect_timer_id=setTimeout((()=>this._connect(e,t)),this.reconnect_interval)))}))}};const Wt=[],Ht=[],Vt=[],Gt=BigInt(0),Yt=BigInt(1),Jt=BigInt(2),Xt=BigInt(7),Zt=BigInt(256),Qt=BigInt(113);for(let e=0,t=Yt,r=1,n=0;e<24;e++){[r,n]=[n,(2*r+3*n)%5],Wt.push(2*(5*n+r)),Ht.push((e+1)*(e+2)/2%64);let i=Gt;for(let e=0;e<7;e++)t=(t<<Yt^(t>>Xt)*Qt)%Zt,t&Jt&&(i^=Yt<<(Yt<<BigInt(e))-Yt);Vt.push(i)}const[er,tr]=E(Vt,!0),rr=(e,t,r)=>r>32?k(e,t,r):I(e,t,r),nr=(e,t,r)=>r>32?x(e,t,r):A(e,t,r);class ir extends g{constructor(e,t,r,n=!1,i=24){if(super(),this.blockLen=e,this.suffix=t,this.outputLen=r,this.enableXOF=n,this.rounds=i,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,o(r),0>=this.blockLen||this.blockLen>=200)throw new Error("Sha3 supports only keccak-f1600 function");var s;this.state=new Uint8Array(200),this.state32=(s=this.state,new Uint32Array(s.buffer,s.byteOffset,Math.floor(s.byteLength/4)))}keccak(){d||f(this.state32),function(e,t=24){const r=new Uint32Array(10);for(let n=24-t;n<24;n++){for(let t=0;t<10;t++)r[t]=e[t]^e[t+10]^e[t+20]^e[t+30]^e[t+40];for(let t=0;t<10;t+=2){const n=(t+8)%10,i=(t+2)%10,o=r[i],s=r[i+1],a=rr(o,s,1)^r[n],c=nr(o,s,1)^r[n+1];for(let r=0;r<50;r+=10)e[t+r]^=a,e[t+r+1]^=c}let t=e[2],i=e[3];for(let r=0;r<24;r++){const n=Ht[r],o=rr(t,i,n),s=nr(t,i,n),a=Wt[r];t=e[a],i=e[a+1],e[a]=o,e[a+1]=s}for(let t=0;t<50;t+=10){for(let n=0;n<10;n++)r[n]=e[t+n];for(let n=0;n<10;n++)e[t+n]^=~r[(n+2)%10]&r[(n+4)%10]}e[0]^=er[n],e[1]^=tr[n]}r.fill(0)}(this.state32,this.rounds),d||f(this.state32),this.posOut=0,this.pos=0}update(e){a(this);const{blockLen:t,state:r}=this,n=(e=p(e)).length;for(let i=0;i<n;){const o=Math.min(t-this.pos,n-i);for(let t=0;t<o;t++)r[this.pos++]^=e[i++];this.pos===t&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:t,pos:r,blockLen:n}=this;e[r]^=t,128&t&&r===n-1&&this.keccak(),e[n-1]^=128,this.keccak()}writeInto(e){a(this,!1),s(e),this.finish();const t=this.state,{blockLen:r}=this;for(let n=0,i=e.length;n<i;){this.posOut>=r&&this.keccak();const o=Math.min(r-this.posOut,i-n);e.set(t.subarray(this.posOut,this.posOut+o),n),this.posOut+=o,n+=o}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return o(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(c(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(e){const{blockLen:t,suffix:r,outputLen:n,rounds:i,enableXOF:o}=this;return e||(e=new ir(t,r,n,o,i)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=i,e.suffix=r,e.outputLen=n,e.enableXOF=o,e.destroyed=this.destroyed,e}}const or=((e,t,r)=>y((()=>new ir(t,e,r))))(1,136,32);class sr extends g{constructor(e,t){super(),this.finished=!1,this.destroyed=!1,function(e){if("function"!=typeof e||"function"!=typeof e.create)throw new Error("Hash should be wrapped by utils.wrapConstructor");o(e.outputLen),o(e.blockLen)}(e);const r=p(t);if(this.iHash=e.create(),"function"!=typeof this.iHash.update)throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const n=this.blockLen,i=new Uint8Array(n);i.set(r.length>n?e.create().update(r).digest():r);for(let e=0;e<i.length;e++)i[e]^=54;this.iHash.update(i),this.oHash=e.create();for(let e=0;e<i.length;e++)i[e]^=106;this.oHash.update(i),i.fill(0)}update(e){return a(this),this.iHash.update(e),this}digestInto(e){a(this),s(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:t,iHash:r,finished:n,destroyed:i,blockLen:o,outputLen:s}=this;return e.finished=n,e.destroyed=i,e.blockLen=o,e.outputLen=s,e.oHash=t._cloneInto(e.oHash),e.iHash=r._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const ar=(e,t,r)=>new sr(e,t).update(r).digest();function cr(e){void 0!==e.lowS&&z("lowS",e.lowS),void 0!==e.prehash&&z("prehash",e.prehash)}ar.create=(e,t)=>new sr(e,t);const{Ph:ur,aT:hr}=n;class lr extends Error{constructor(e=""){super(e)}}const dr={Err:lr,_tlv:{encode:(e,t)=>{const{Err:r}=dr;if(e<0||e>256)throw new r("tlv.encode: wrong tag");if(1&t.length)throw new r("tlv.encode: unpadded data");const n=t.length/2,i=K(n);if(i.length/2&128)throw new r("tlv.encode: long form length too big");const o=n>127?K(i.length/2|128):"";return K(e)+o+i+t},decode(e,t){const{Err:r}=dr;let n=0;if(e<0||e>256)throw new r("tlv.encode: wrong tag");if(t.length<2||t[n++]!==e)throw new r("tlv.decode: wrong tlv");const i=t[n++];let o=0;if(128&i){const e=127&i;if(!e)throw new r("tlv.decode(long): indefinite length not supported");if(e>4)throw new r("tlv.decode(long): byte length is too big");const s=t.subarray(n,n+e);if(s.length!==e)throw new r("tlv.decode: length bytes not complete");if(0===s[0])throw new r("tlv.decode(long): zero leftmost byte");for(const e of s)o=o<<8|e;if(n+=e,o<128)throw new r("tlv.decode(long): not minimal encoding")}else o=i;const s=t.subarray(n,n+o);if(s.length!==o)throw new r("tlv.decode: wrong value length");return{v:s,l:t.subarray(n+o)}}},_int:{encode(e){const{Err:t}=dr;if(e<fr)throw new t("integer: negative integers are not allowed");let r=K(e);if(8&Number.parseInt(r[0],16)&&(r="00"+r),1&r.length)throw new t("unexpected DER parsing assertion: unpadded hex");return r},decode(e){const{Err:t}=dr;if(128&e[0])throw new t("invalid signature integer: negative");if(0===e[0]&&!(128&e[1]))throw new t("invalid signature integer: unnecessary leading zero");return ur(e)}},toSig(e){const{Err:t,_int:r,_tlv:n}=dr,i="string"==typeof e?hr(e):e;j(i);const{v:o,l:s}=n.decode(48,i);if(s.length)throw new t("invalid signature: left bytes after parsing");const{v:a,l:c}=n.decode(2,o),{v:u,l:h}=n.decode(2,c);if(h.length)throw new t("invalid signature: left bytes after parsing");return{r:r.decode(a),s:r.decode(u)}},hexFromSig(e){const{_tlv:t,_int:r}=dr,n=t.encode(2,r.encode(e.r))+t.encode(2,r.encode(e.s));return t.encode(48,n)}},fr=BigInt(0),pr=BigInt(1),gr=(BigInt(2),BigInt(3));function yr(e){const t=function(e){const t=Ue(e);return ue(t,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...t})}(e),{Fp:r,n}=t,i=r.BYTES+1,o=2*r.BYTES+1;function s(e){return me(e,n)}function a(e){return Se(e,n)}const{ProjectivePoint:c,normPrivateKeyToScalar:u,weierstrassEquation:h,isWithinCurveOrder:l}=function(e){const t=function(e){const t=Ue(e);ue(t,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});const{endo:r,Fp:n,a:i}=t;if(r){if(!n.eql(i,n.ZERO))throw new Error("invalid endomorphism, can only be defined for Koblitz curves that have a=0");if("object"!=typeof r||"bigint"!=typeof r.beta||"function"!=typeof r.splitScalar)throw new Error("invalid endomorphism, expected beta: bigint and splitScalar: function")}return Object.freeze({...t})}(e),{Fp:r}=t,n=Ie(t.n,t.nBitLength),i=t.toBytes||((e,t,n)=>{const i=t.toAffine();return Q(Uint8Array.from([4]),r.toBytes(i.x),r.toBytes(i.y))}),o=t.fromBytes||(e=>{const t=e.subarray(1);return{x:r.fromBytes(t.subarray(0,r.BYTES)),y:r.fromBytes(t.subarray(r.BYTES,2*r.BYTES))}});function s(e){const{a:n,b:i}=t,o=r.sqr(e),s=r.mul(o,e);return r.add(r.add(s,r.mul(e,n)),i)}if(!r.eql(r.sqr(t.Gy),s(t.Gx)))throw new Error("bad generator point: equation left != right");function a(e){const{allowedPrivateKeyLengths:r,nByteLength:n,wrapPrivateKey:i,n:o}=t;if(r&&"bigint"!=typeof e){if(D(e)&&(e=$(e)),"string"!=typeof e||!r.includes(e.length))throw new Error("invalid private key");e=e.padStart(2*n,"0")}let s;try{s="bigint"==typeof e?e:G(Z("private key",e,n))}catch(t){throw new Error("invalid private key, expected hex or "+n+" bytes, got "+typeof e)}return i&&(s=me(s,o)),re("private key",s,pr,o),s}function c(e){if(!(e instanceof l))throw new Error("ProjectivePoint expected")}const u=he(((e,t)=>{const{px:n,py:i,pz:o}=e;if(r.eql(o,r.ONE))return{x:n,y:i};const s=e.is0();null==t&&(t=s?r.ONE:r.inv(o));const a=r.mul(n,t),c=r.mul(i,t),u=r.mul(o,t);if(s)return{x:r.ZERO,y:r.ZERO};if(!r.eql(u,r.ONE))throw new Error("invZ was invalid");return{x:a,y:c}})),h=he((e=>{if(e.is0()){if(t.allowInfinityPoint&&!r.is0(e.py))return;throw new Error("bad point: ZERO")}const{x:n,y:i}=e.toAffine();if(!r.isValid(n)||!r.isValid(i))throw new Error("bad point: x or y not FE");const o=r.sqr(i),a=s(n);if(!r.eql(o,a))throw new Error("bad point: equation left != right");if(!e.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0}));class l{constructor(e,t,n){if(this.px=e,this.py=t,this.pz=n,null==e||!r.isValid(e))throw new Error("x required");if(null==t||!r.isValid(t))throw new Error("y required");if(null==n||!r.isValid(n))throw new Error("z required");Object.freeze(this)}static fromAffine(e){const{x:t,y:n}=e||{};if(!e||!r.isValid(t)||!r.isValid(n))throw new Error("invalid affine point");if(e instanceof l)throw new Error("projective point not allowed");const i=e=>r.eql(e,r.ZERO);return i(t)&&i(n)?l.ZERO:new l(t,n,r.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(e){const t=r.invertBatch(e.map((e=>e.pz)));return e.map(((e,r)=>e.toAffine(t[r]))).map(l.fromAffine)}static fromHex(e){const t=l.fromAffine(o(Z("pointHex",e)));return t.assertValidity(),t}static fromPrivateKey(e){return l.BASE.multiply(a(e))}static msm(e,t){return Le(l,n,e,t)}_setWindowSize(e){f.setWindowSize(this,e)}assertValidity(){h(this)}hasEvenY(){const{y:e}=this.toAffine();if(r.isOdd)return!r.isOdd(e);throw new Error("Field doesn't support isOdd")}equals(e){c(e);const{px:t,py:n,pz:i}=this,{px:o,py:s,pz:a}=e,u=r.eql(r.mul(t,a),r.mul(o,i)),h=r.eql(r.mul(n,a),r.mul(s,i));return u&&h}negate(){return new l(this.px,r.neg(this.py),this.pz)}double(){const{a:e,b:n}=t,i=r.mul(n,gr),{px:o,py:s,pz:a}=this;let c=r.ZERO,u=r.ZERO,h=r.ZERO,d=r.mul(o,o),f=r.mul(s,s),p=r.mul(a,a),g=r.mul(o,s);return g=r.add(g,g),h=r.mul(o,a),h=r.add(h,h),c=r.mul(e,h),u=r.mul(i,p),u=r.add(c,u),c=r.sub(f,u),u=r.add(f,u),u=r.mul(c,u),c=r.mul(g,c),h=r.mul(i,h),p=r.mul(e,p),g=r.sub(d,p),g=r.mul(e,g),g=r.add(g,h),h=r.add(d,d),d=r.add(h,d),d=r.add(d,p),d=r.mul(d,g),u=r.add(u,d),p=r.mul(s,a),p=r.add(p,p),d=r.mul(p,g),c=r.sub(c,d),h=r.mul(p,f),h=r.add(h,h),h=r.add(h,h),new l(c,u,h)}add(e){c(e);const{px:n,py:i,pz:o}=this,{px:s,py:a,pz:u}=e;let h=r.ZERO,d=r.ZERO,f=r.ZERO;const p=t.a,g=r.mul(t.b,gr);let y=r.mul(n,s),b=r.mul(i,a),m=r.mul(o,u),w=r.add(n,i),v=r.add(s,a);w=r.mul(w,v),v=r.add(y,b),w=r.sub(w,v),v=r.add(n,o);let S=r.add(s,u);return v=r.mul(v,S),S=r.add(y,m),v=r.sub(v,S),S=r.add(i,o),h=r.add(a,u),S=r.mul(S,h),h=r.add(b,m),S=r.sub(S,h),f=r.mul(p,v),h=r.mul(g,m),f=r.add(h,f),h=r.sub(b,f),f=r.add(b,f),d=r.mul(h,f),b=r.add(y,y),b=r.add(b,y),m=r.mul(p,m),v=r.mul(g,v),b=r.add(b,m),m=r.sub(y,m),m=r.mul(p,m),v=r.add(v,m),y=r.mul(b,v),d=r.add(d,y),y=r.mul(S,v),h=r.mul(w,h),h=r.sub(h,y),y=r.mul(w,b),f=r.mul(S,f),f=r.add(f,y),new l(h,d,f)}subtract(e){return this.add(e.negate())}is0(){return this.equals(l.ZERO)}wNAF(e){return f.wNAFCached(this,e,l.normalizeZ)}multiplyUnsafe(e){const{endo:n,n:i}=t;re("scalar",e,fr,i);const o=l.ZERO;if(e===fr)return o;if(this.is0()||e===pr)return this;if(!n||f.hasPrecomputes(this))return f.wNAFCachedUnsafe(this,e,l.normalizeZ);let{k1neg:s,k1:a,k2neg:c,k2:u}=n.splitScalar(e),h=o,d=o,p=this;for(;a>fr||u>fr;)a&pr&&(h=h.add(p)),u&pr&&(d=d.add(p)),p=p.double(),a>>=pr,u>>=pr;return s&&(h=h.negate()),c&&(d=d.negate()),d=new l(r.mul(d.px,n.beta),d.py,d.pz),h.add(d)}multiply(e){const{endo:n,n:i}=t;let o,s;if(re("scalar",e,pr,i),n){const{k1neg:t,k1:i,k2neg:a,k2:c}=n.splitScalar(e);let{p:u,f:h}=this.wNAF(i),{p:d,f:p}=this.wNAF(c);u=f.constTimeNegate(t,u),d=f.constTimeNegate(a,d),d=new l(r.mul(d.px,n.beta),d.py,d.pz),o=u.add(d),s=h.add(p)}else{const{p:t,f:r}=this.wNAF(e);o=t,s=r}return l.normalizeZ([o,s])[0]}multiplyAndAddUnsafe(e,t,r){const n=l.BASE,i=(e,t)=>t!==fr&&t!==pr&&e.equals(n)?e.multiply(t):e.multiplyUnsafe(t),o=i(this,t).add(i(e,r));return o.is0()?void 0:o}toAffine(e){return u(this,e)}isTorsionFree(){const{h:e,isTorsionFree:r}=t;if(e===pr)return!0;if(r)return r(l,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:e,clearCofactor:r}=t;return e===pr?this:r?r(l,this):this.multiplyUnsafe(t.h)}toRawBytes(e=!0){return z("isCompressed",e),this.assertValidity(),i(l,this,e)}toHex(e=!0){return z("isCompressed",e),$(this.toRawBytes(e))}}l.BASE=new l(t.Gx,t.Gy,r.ONE),l.ZERO=new l(r.ZERO,r.ONE,r.ZERO);const d=t.nBitLength,f=Be(l,t.endo?Math.ceil(d/2):d);return{CURVE:t,ProjectivePoint:l,normPrivateKeyToScalar:a,weierstrassEquation:s,isWithinCurveOrder:function(e){return te(e,pr,t.n)}}}({...t,toBytes(e,t,n){const i=t.toAffine(),o=r.toBytes(i.x),s=Q;return z("isCompressed",n),n?s(Uint8Array.from([t.hasEvenY()?2:3]),o):s(Uint8Array.from([4]),o,r.toBytes(i.y))},fromBytes(e){const t=e.length,n=e[0],s=e.subarray(1);if(t!==i||2!==n&&3!==n){if(t===o&&4===n)return{x:r.fromBytes(s.subarray(0,r.BYTES)),y:r.fromBytes(s.subarray(r.BYTES,2*r.BYTES))};throw new Error("invalid Point, expected length of "+i+", or uncompressed "+o+", got "+t)}{const e=G(s);if(!te(e,pr,r.ORDER))throw new Error("Point is not on curve");const t=h(e);let i;try{i=r.sqrt(t)}catch(e){const t=e instanceof Error?": "+e.message:"";throw new Error("Point is not on curve"+t)}return!(1&~n)!=((i&pr)===pr)&&(i=r.neg(i)),{x:e,y:i}}}}),d=e=>$(J(e,t.nByteLength));function f(e){return e>n>>pr}const p=(e,t,r)=>G(e.slice(t,r));class g{constructor(e,t,r){this.r=e,this.s=t,this.recovery=r,this.assertValidity()}static fromCompact(e){const r=t.nByteLength;return e=Z("compactSignature",e,2*r),new g(p(e,0,r),p(e,r,2*r))}static fromDER(e){const{r:t,s:r}=dr.toSig(Z("DER",e));return new g(t,r)}assertValidity(){re("r",this.r,pr,n),re("s",this.s,pr,n)}addRecoveryBit(e){return new g(this.r,this.s,e)}recoverPublicKey(e){const{r:n,s:i,recovery:o}=this,u=w(Z("msgHash",e));if(null==o||![0,1,2,3].includes(o))throw new Error("recovery id invalid");const h=2===o||3===o?n+t.n:n;if(h>=r.ORDER)throw new Error("recovery id 2 or 3 invalid");const l=1&o?"03":"02",f=c.fromHex(l+d(h)),p=a(h),g=s(-u*p),y=s(i*p),b=c.BASE.multiplyAndAddUnsafe(f,g,y);if(!b)throw new Error("point at infinify");return b.assertValidity(),b}hasHighS(){return f(this.s)}normalizeS(){return this.hasHighS()?new g(this.r,s(-this.s),this.recovery):this}toDERRawBytes(){return V(this.toDERHex())}toDERHex(){return dr.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return V(this.toCompactHex())}toCompactHex(){return d(this.r)+d(this.s)}}const y={isValidPrivateKey(e){try{return u(e),!0}catch(e){return!1}},normPrivateKeyToScalar:u,randomPrivateKey:()=>{const e=ke(t.n);return function(e,t,r=!1){const n=e.length,i=Ae(t),o=ke(t);if(n<16||n<o||n>1024)throw new Error("expected "+o+"-1024 bytes of input, got "+n);const s=me(r?Y(e):G(e),t-de)+de;return r?X(s,i):J(s,i)}(t.randomBytes(e),t.n)},precompute:(e=8,t=c.BASE)=>(t._setWindowSize(e),t.multiply(BigInt(3)),t)};function b(e){const t=D(e),r="string"==typeof e,n=(t||r)&&e.length;return t?n===i||n===o:r?n===2*i||n===2*o:e instanceof c}const m=t.bits2int||function(e){if(e.length>8192)throw new Error("input is too large");const r=G(e),n=8*e.length-t.nBitLength;return n>0?r>>BigInt(n):r},w=t.bits2int_modN||function(e){return s(m(e))},v=ie(t.nBitLength);function S(e){return re("num < 2^"+t.nBitLength,e,fr,v),J(e,t.nByteLength)}const _={lowS:t.lowS,prehash:!1},E={lowS:t.lowS,prehash:!1};return c.BASE._setWindowSize(8),{CURVE:t,getPublicKey:function(e,t=!0){return c.fromPrivateKey(e).toRawBytes(t)},getSharedSecret:function(e,t,r=!0){if(b(e))throw new Error("first arg must be private key");if(!b(t))throw new Error("second arg must be public key");return c.fromHex(t).multiply(u(e)).toRawBytes(r)},sign:function(e,n,i=_){const{seed:o,k2sig:h}=function(e,n,i=_){if(["recovered","canonical"].some((e=>e in i)))throw new Error("sign() legacy options not supported");const{hash:o,randomBytes:h}=t;let{lowS:d,prehash:p,extraEntropy:y}=i;null==d&&(d=!0),e=Z("msgHash",e),cr(i),p&&(e=Z("prehashed msgHash",o(e)));const b=w(e),v=u(n),E=[S(v),S(b)];if(null!=y&&!1!==y){const e=!0===y?h(r.BYTES):y;E.push(Z("extraEntropy",e))}const I=Q(...E),A=b;return{seed:I,k2sig:function(e){const t=m(e);if(!l(t))return;const r=a(t),n=c.BASE.multiply(t).toAffine(),i=s(n.x);if(i===fr)return;const o=s(r*s(A+i*v));if(o===fr)return;let u=(n.x===i?0:2)|Number(n.y&pr),h=o;return d&&f(o)&&(h=function(e){return f(e)?s(-e):e}(o),u^=1),new g(i,h,u)}}}(e,n,i),d=t;return ae(d.hash.outputLen,d.nByteLength,d.hmac)(o,h)},verify:function(e,r,n,i=E){const o=e;r=Z("msgHash",r),n=Z("publicKey",n);const{lowS:u,prehash:h,format:l}=i;if(cr(i),"strict"in i)throw new Error("options.strict was renamed to lowS");if(void 0!==l&&"compact"!==l&&"der"!==l)throw new Error("format must be compact or der");const d="string"==typeof o||D(o),f=!d&&!l&&"object"==typeof o&&null!==o&&"bigint"==typeof o.r&&"bigint"==typeof o.s;if(!d&&!f)throw new Error("invalid signature, expected Uint8Array, hex string or Signature instance");let p,y;try{if(f&&(p=new g(o.r,o.s)),d){try{"compact"!==l&&(p=g.fromDER(o))}catch(e){if(!(e instanceof dr.Err))throw e}p||"der"===l||(p=g.fromCompact(o))}y=c.fromHex(n)}catch(e){return!1}if(!p)return!1;if(u&&p.hasHighS())return!1;h&&(r=t.hash(r));const{r:b,s:m}=p,v=w(r),S=a(m),_=s(v*S),I=s(b*S),A=c.BASE.multiplyAndAddUnsafe(y,_,I)?.toAffine();return!!A&&s(A.x)===b},ProjectivePoint:c,Signature:g,utils:y}}function br(e){return{hash:e,hmac:(t,...r)=>ar(e,t,function(...e){let t=0;for(let r=0;r<e.length;r++){const n=e[r];s(n),t+=n.length}const r=new Uint8Array(t);for(let t=0,n=0;t<e.length;t++){const i=e[t];r.set(i,n),n+=i.length}return r}(...r)),randomBytes:b}}BigInt(4);const mr=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),wr=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),vr=BigInt(1),Sr=BigInt(2),_r=(e,t)=>(e+t/Sr)/t;const Er=Ie(mr,void 0,void 0,{sqrt:function(e){const t=mr,r=BigInt(3),n=BigInt(6),i=BigInt(11),o=BigInt(22),s=BigInt(23),a=BigInt(44),c=BigInt(88),u=e*e*e%t,h=u*u*e%t,l=ve(h,r,t)*h%t,d=ve(l,r,t)*h%t,f=ve(d,Sr,t)*u%t,p=ve(f,i,t)*f%t,g=ve(p,o,t)*p%t,y=ve(g,a,t)*g%t,b=ve(y,c,t)*y%t,m=ve(b,a,t)*g%t,w=ve(m,r,t)*h%t,v=ve(w,s,t)*p%t,S=ve(v,n,t)*u%t,_=ve(S,Sr,t);if(!Er.eql(Er.sqr(_),e))throw new Error("Cannot find square root");return _}}),Ir=function(e,t){const r=t=>yr({...e,...br(t)});return{...r(t),create:r}}({a:BigInt(0),b:BigInt(7),Fp:Er,n:wr,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:e=>{const t=wr,r=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),n=-vr*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),i=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),o=r,s=BigInt("0x100000000000000000000000000000000"),a=_r(o*e,t),c=_r(-n*e,t);let u=me(e-a*r-c*i,t),h=me(-a*n-c*o,t);const l=u>s,d=h>s;if(l&&(u=t-u),d&&(h=t-h),u>s||h>s)throw new Error("splitScalar: Endomorphism failed, k="+e);return{k1neg:l,k1:u,k2neg:d,k2:h}}}},ct);BigInt(0),Ir.ProjectivePoint;const Ar=Qe.utils.randomPrivateKey,kr=()=>{const e=Qe.utils.randomPrivateKey(),t=xr(e),r=new Uint8Array(64);return r.set(e),r.set(t,32),{publicKey:t,secretKey:r}},xr=Qe.getPublicKey;function Pr(e){try{return Qe.ExtendedPoint.fromHex(e),!0}catch{return!1}}const Or=(e,t)=>Qe.sign(e,t.slice(0,32)),Rr=Qe.verify,Tr=e=>i.Buffer.isBuffer(e)?e:e instanceof Uint8Array?i.Buffer.from(e.buffer,e.byteOffset,e.byteLength):i.Buffer.from(e);class Nr{constructor(e){Object.assign(this,e)}encode(){return i.Buffer.from((0,ut.serialize)(Cr,this))}static decode(e){return(0,ut.deserialize)(Cr,this,e)}static decodeUnchecked(e){return(0,ut.deserializeUnchecked)(Cr,this,e)}}class Mr extends Nr{constructor(e){if(super(e),this.enum="",1!==Object.keys(e).length)throw new Error("Enum can only take single value");Object.keys(e).map((e=>{this.enum=e}))}}const Cr=new Map;var Br;const Lr=32,Ur=32;let Dr=1;class jr extends Nr{constructor(e){if(super({}),this._bn=void 0,function(e){return void 0!==e._bn}(e))this._bn=e._bn;else{if("string"==typeof e){const t=nt().decode(e);if(t.length!=Ur)throw new Error("Invalid public key input");this._bn=new(tt())(t)}else this._bn=new(tt())(e);if(this._bn.byteLength()>Ur)throw new Error("Invalid public key input")}}static unique(){const e=new jr(Dr);return Dr+=1,new jr(e.toBuffer())}equals(e){return this._bn.eq(e._bn)}toBase58(){return nt().encode(this.toBytes())}toJSON(){return this.toBase58()}toBytes(){const e=this.toBuffer();return new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}toBuffer(){const e=this._bn.toArrayLike(i.Buffer);if(e.length===Ur)return e;const t=i.Buffer.alloc(32);return e.copy(t,32-e.length),t}get[Symbol.toStringTag](){return`PublicKey(${this.toString()})`}toString(){return this.toBase58()}static async createWithSeed(e,t,r){const n=i.Buffer.concat([e.toBuffer(),i.Buffer.from(t),r.toBuffer()]),o=ct(n);return new jr(o)}static createProgramAddressSync(e,t){let r=i.Buffer.alloc(0);e.forEach((function(e){if(e.length>Lr)throw new TypeError("Max seed length exceeded");r=i.Buffer.concat([r,Tr(e)])})),r=i.Buffer.concat([r,t.toBuffer(),i.Buffer.from("ProgramDerivedAddress")]);const n=ct(r);if(Pr(n))throw new Error("Invalid seeds, address must fall off the curve");return new jr(n)}static async createProgramAddress(e,t){return this.createProgramAddressSync(e,t)}static findProgramAddressSync(e,t){let r,n=255;for(;0!=n;){try{const o=e.concat(i.Buffer.from([n]));r=this.createProgramAddressSync(o,t)}catch(e){if(e instanceof TypeError)throw e;n--;continue}return[r,n]}throw new Error("Unable to find a viable program address nonce")}static async findProgramAddress(e,t){return this.findProgramAddressSync(e,t)}static isOnCurve(e){return Pr(new jr(e).toBytes())}}Br=jr,jr.default=new Br("11111111111111111111111111111111"),Cr.set(jr,{kind:"struct",fields:[["_bn","u256"]]});class zr{constructor(e){if(this._publicKey=void 0,this._secretKey=void 0,e){const t=Tr(e);if(64!==e.length)throw new Error("bad secret key size");this._publicKey=t.slice(32,64),this._secretKey=t.slice(0,32)}else this._secretKey=Tr(Ar()),this._publicKey=Tr(xr(this._secretKey))}get publicKey(){return new jr(this._publicKey)}get secretKey(){return i.Buffer.concat([this._secretKey,this._publicKey],64)}}const qr=new jr("BPFLoader1111111111111111111111111111111111"),$r=1232,Kr=127,Fr=64;class Wr extends Error{constructor(e){super(`Signature ${e} has expired: block height exceeded.`),this.signature=void 0,this.signature=e}}Object.defineProperty(Wr.prototype,"name",{value:"TransactionExpiredBlockheightExceededError"});class Hr extends Error{constructor(e,t){super(`Transaction was not confirmed in ${t.toFixed(2)} seconds. It is unknown if it succeeded or failed. Check signature ${e} using the Solana Explorer or CLI tools.`),this.signature=void 0,this.signature=e}}Object.defineProperty(Hr.prototype,"name",{value:"TransactionExpiredTimeoutError"});class Vr extends Error{constructor(e){super(`Signature ${e} has expired: the nonce is no longer valid.`),this.signature=void 0,this.signature=e}}Object.defineProperty(Vr.prototype,"name",{value:"TransactionExpiredNonceInvalidError"});class Gr{constructor(e,t){this.staticAccountKeys=void 0,this.accountKeysFromLookups=void 0,this.staticAccountKeys=e,this.accountKeysFromLookups=t}keySegments(){const e=[this.staticAccountKeys];return this.accountKeysFromLookups&&(e.push(this.accountKeysFromLookups.writable),e.push(this.accountKeysFromLookups.readonly)),e}get(e){for(const t of this.keySegments()){if(e<t.length)return t[e];e-=t.length}}get length(){return this.keySegments().flat().length}compileInstructions(e){if(this.length>256)throw new Error("Account index overflow encountered during compilation");const t=new Map;this.keySegments().flat().forEach(((e,r)=>{t.set(e.toBase58(),r)}));const r=e=>{const r=t.get(e.toBase58());if(void 0===r)throw new Error("Encountered an unknown instruction account key during compilation");return r};return e.map((e=>({programIdIndex:r(e.programId),accountKeyIndexes:e.keys.map((e=>r(e.pubkey))),data:e.data})))}}const Yr=(e="publicKey")=>ht.av(32,e),Jr=(e="signature")=>ht.av(64,e),Xr=(e="string")=>{const t=ht.w3([ht.DH("length"),ht.DH("lengthPadding"),ht.av(ht.cY(ht.DH(),-8),"chars")],e),r=t.decode.bind(t),n=t.encode.bind(t),o=t;return o.decode=(e,t)=>r(e,t).chars.toString(),o.encode=(e,t,r)=>{const o={chars:i.Buffer.from(e,"utf8")};return n(o,t,r)},o.alloc=e=>ht.DH().span+ht.DH().span+i.Buffer.from(e,"utf8").length,o};function Zr(e,t){const r=e=>{if(e.span>=0)return e.span;if("function"==typeof e.alloc)return e.alloc(t[e.property]);if("count"in e&&"elementLayout"in e){const n=t[e.property];if(Array.isArray(n))return n.length*r(e.elementLayout)}else if("fields"in e)return Zr({layout:e},t[e.property]);return 0};let n=0;return e.layout.fields.forEach((e=>{n+=r(e)})),n}function Qr(e){let t=0,r=0;for(;;){let n=e.shift();if(t|=(127&n)<<7*r,r+=1,!(128&n))break}return t}function en(e,t){let r=t;for(;;){let t=127&r;if(r>>=7,0==r){e.push(t);break}t|=128,e.push(t)}}function tn(e,t){if(!e)throw new Error(t||"Assertion failed")}class rn{constructor(e,t){this.payer=void 0,this.keyMetaMap=void 0,this.payer=e,this.keyMetaMap=t}static compile(e,t){const r=new Map,n=e=>{const t=e.toBase58();let n=r.get(t);return void 0===n&&(n={isSigner:!1,isWritable:!1,isInvoked:!1},r.set(t,n)),n},i=n(t);i.isSigner=!0,i.isWritable=!0;for(const t of e){n(t.programId).isInvoked=!0;for(const e of t.keys){const t=n(e.pubkey);t.isSigner||=e.isSigner,t.isWritable||=e.isWritable}}return new rn(t,r)}getMessageComponents(){const e=[...this.keyMetaMap.entries()];tn(e.length<=256,"Max static account keys length exceeded");const t=e.filter((([,e])=>e.isSigner&&e.isWritable)),r=e.filter((([,e])=>e.isSigner&&!e.isWritable)),n=e.filter((([,e])=>!e.isSigner&&e.isWritable)),i=e.filter((([,e])=>!e.isSigner&&!e.isWritable)),o={numRequiredSignatures:t.length+r.length,numReadonlySignedAccounts:r.length,numReadonlyUnsignedAccounts:i.length};{tn(t.length>0,"Expected at least one writable signer key");const[e]=t[0];tn(e===this.payer.toBase58(),"Expected first writable signer key to be the fee payer")}return[o,[...t.map((([e])=>new jr(e))),...r.map((([e])=>new jr(e))),...n.map((([e])=>new jr(e))),...i.map((([e])=>new jr(e)))]]}extractTableLookup(e){const[t,r]=this.drainKeysFoundInLookupTable(e.state.addresses,(e=>!e.isSigner&&!e.isInvoked&&e.isWritable)),[n,i]=this.drainKeysFoundInLookupTable(e.state.addresses,(e=>!e.isSigner&&!e.isInvoked&&!e.isWritable));if(0!==t.length||0!==n.length)return[{accountKey:e.key,writableIndexes:t,readonlyIndexes:n},{writable:r,readonly:i}]}drainKeysFoundInLookupTable(e,t){const r=new Array,n=new Array;for(const[i,o]of this.keyMetaMap.entries())if(t(o)){const t=new jr(i),o=e.findIndex((e=>e.equals(t)));o>=0&&(tn(o<256,"Max lookup table index exceeded"),r.push(o),n.push(t),this.keyMetaMap.delete(i))}return[r,n]}}const nn="Reached end of buffer unexpectedly";function on(e){if(0===e.length)throw new Error(nn);return e.shift()}function sn(e,...t){const[r]=t;if(2===t.length?r+(t[1]??0)>e.length:r>=e.length)throw new Error(nn);return e.splice(...t)}class an{constructor(e){this.header=void 0,this.accountKeys=void 0,this.recentBlockhash=void 0,this.instructions=void 0,this.indexToProgramIds=new Map,this.header=e.header,this.accountKeys=e.accountKeys.map((e=>new jr(e))),this.recentBlockhash=e.recentBlockhash,this.instructions=e.instructions,this.instructions.forEach((e=>this.indexToProgramIds.set(e.programIdIndex,this.accountKeys[e.programIdIndex])))}get version(){return"legacy"}get staticAccountKeys(){return this.accountKeys}get compiledInstructions(){return this.instructions.map((e=>({programIdIndex:e.programIdIndex,accountKeyIndexes:e.accounts,data:nt().decode(e.data)})))}get addressTableLookups(){return[]}getAccountKeys(){return new Gr(this.staticAccountKeys)}static compile(e){const t=rn.compile(e.instructions,e.payerKey),[r,n]=t.getMessageComponents(),i=new Gr(n).compileInstructions(e.instructions).map((e=>({programIdIndex:e.programIdIndex,accounts:e.accountKeyIndexes,data:nt().encode(e.data)})));return new an({header:r,accountKeys:n,recentBlockhash:e.recentBlockhash,instructions:i})}isAccountSigner(e){return e<this.header.numRequiredSignatures}isAccountWritable(e){const t=this.header.numRequiredSignatures;return e>=this.header.numRequiredSignatures?e-t<this.accountKeys.length-t-this.header.numReadonlyUnsignedAccounts:e<t-this.header.numReadonlySignedAccounts}isProgramId(e){return this.indexToProgramIds.has(e)}programIds(){return[...this.indexToProgramIds.values()]}nonProgramIds(){return this.accountKeys.filter(((e,t)=>!this.isProgramId(t)))}serialize(){const e=this.accountKeys.length;let t=[];en(t,e);const r=this.instructions.map((e=>{const{accounts:t,programIdIndex:r}=e,n=Array.from(nt().decode(e.data));let o=[];en(o,t.length);let s=[];return en(s,n.length),{programIdIndex:r,keyIndicesCount:i.Buffer.from(o),keyIndices:t,dataLength:i.Buffer.from(s),data:n}}));let n=[];en(n,r.length);let o=i.Buffer.alloc($r);i.Buffer.from(n).copy(o);let s=n.length;r.forEach((e=>{const t=ht.w3([ht.u8("programIdIndex"),ht.av(e.keyIndicesCount.length,"keyIndicesCount"),ht.O6(ht.u8("keyIndex"),e.keyIndices.length,"keyIndices"),ht.av(e.dataLength.length,"dataLength"),ht.O6(ht.u8("userdatum"),e.data.length,"data")]).encode(e,o,s);s+=t})),o=o.slice(0,s);const a=ht.w3([ht.av(1,"numRequiredSignatures"),ht.av(1,"numReadonlySignedAccounts"),ht.av(1,"numReadonlyUnsignedAccounts"),ht.av(t.length,"keyCount"),ht.O6(Yr("key"),e,"keys"),Yr("recentBlockhash")]),c={numRequiredSignatures:i.Buffer.from([this.header.numRequiredSignatures]),numReadonlySignedAccounts:i.Buffer.from([this.header.numReadonlySignedAccounts]),numReadonlyUnsignedAccounts:i.Buffer.from([this.header.numReadonlyUnsignedAccounts]),keyCount:i.Buffer.from(t),keys:this.accountKeys.map((e=>Tr(e.toBytes()))),recentBlockhash:nt().decode(this.recentBlockhash)};let u=i.Buffer.alloc(2048);const h=a.encode(c,u);return o.copy(u,h),u.slice(0,h+o.length)}static from(e){let t=[...e];const r=on(t);if(r!==(r&Kr))throw new Error("Versioned messages must be deserialized with VersionedMessage.deserialize()");const n=on(t),o=on(t),s=Qr(t);let a=[];for(let e=0;e<s;e++){const e=sn(t,0,Ur);a.push(new jr(i.Buffer.from(e)))}const c=sn(t,0,Ur),u=Qr(t);let h=[];for(let e=0;e<u;e++){const e=on(t),r=sn(t,0,Qr(t)),n=sn(t,0,Qr(t)),o=nt().encode(i.Buffer.from(n));h.push({programIdIndex:e,accounts:r,data:o})}const l={header:{numRequiredSignatures:r,numReadonlySignedAccounts:n,numReadonlyUnsignedAccounts:o},recentBlockhash:nt().encode(i.Buffer.from(c)),accountKeys:a,instructions:h};return new an(l)}}class cn{constructor(e){this.header=void 0,this.staticAccountKeys=void 0,this.recentBlockhash=void 0,this.compiledInstructions=void 0,this.addressTableLookups=void 0,this.header=e.header,this.staticAccountKeys=e.staticAccountKeys,this.recentBlockhash=e.recentBlockhash,this.compiledInstructions=e.compiledInstructions,this.addressTableLookups=e.addressTableLookups}get version(){return 0}get numAccountKeysFromLookups(){let e=0;for(const t of this.addressTableLookups)e+=t.readonlyIndexes.length+t.writableIndexes.length;return e}getAccountKeys(e){let t;if(e&&"accountKeysFromLookups"in e&&e.accountKeysFromLookups){if(this.numAccountKeysFromLookups!=e.accountKeysFromLookups.writable.length+e.accountKeysFromLookups.readonly.length)throw new Error("Failed to get account keys because of a mismatch in the number of account keys from lookups");t=e.accountKeysFromLookups}else if(e&&"addressLookupTableAccounts"in e&&e.addressLookupTableAccounts)t=this.resolveAddressTableLookups(e.addressLookupTableAccounts);else if(this.addressTableLookups.length>0)throw new Error("Failed to get account keys because address table lookups were not resolved");return new Gr(this.staticAccountKeys,t)}isAccountSigner(e){return e<this.header.numRequiredSignatures}isAccountWritable(e){const t=this.header.numRequiredSignatures,r=this.staticAccountKeys.length;return e>=r?e-r<this.addressTableLookups.reduce(((e,t)=>e+t.writableIndexes.length),0):e>=this.header.numRequiredSignatures?e-t<r-t-this.header.numReadonlyUnsignedAccounts:e<t-this.header.numReadonlySignedAccounts}resolveAddressTableLookups(e){const t={writable:[],readonly:[]};for(const r of this.addressTableLookups){const n=e.find((e=>e.key.equals(r.accountKey)));if(!n)throw new Error(`Failed to find address lookup table account for table key ${r.accountKey.toBase58()}`);for(const e of r.writableIndexes){if(!(e<n.state.addresses.length))throw new Error(`Failed to find address for index ${e} in address lookup table ${r.accountKey.toBase58()}`);t.writable.push(n.state.addresses[e])}for(const e of r.readonlyIndexes){if(!(e<n.state.addresses.length))throw new Error(`Failed to find address for index ${e} in address lookup table ${r.accountKey.toBase58()}`);t.readonly.push(n.state.addresses[e])}}return t}static compile(e){const t=rn.compile(e.instructions,e.payerKey),r=new Array,n={writable:new Array,readonly:new Array},i=e.addressLookupTableAccounts||[];for(const e of i){const i=t.extractTableLookup(e);if(void 0!==i){const[e,{writable:t,readonly:o}]=i;r.push(e),n.writable.push(...t),n.readonly.push(...o)}}const[o,s]=t.getMessageComponents(),a=new Gr(s,n).compileInstructions(e.instructions);return new cn({header:o,staticAccountKeys:s,recentBlockhash:e.recentBlockhash,compiledInstructions:a,addressTableLookups:r})}serialize(){const e=Array();en(e,this.staticAccountKeys.length);const t=this.serializeInstructions(),r=Array();en(r,this.compiledInstructions.length);const n=this.serializeAddressTableLookups(),i=Array();en(i,this.addressTableLookups.length);const o=ht.w3([ht.u8("prefix"),ht.w3([ht.u8("numRequiredSignatures"),ht.u8("numReadonlySignedAccounts"),ht.u8("numReadonlyUnsignedAccounts")],"header"),ht.av(e.length,"staticAccountKeysLength"),ht.O6(Yr(),this.staticAccountKeys.length,"staticAccountKeys"),Yr("recentBlockhash"),ht.av(r.length,"instructionsLength"),ht.av(t.length,"serializedInstructions"),ht.av(i.length,"addressTableLookupsLength"),ht.av(n.length,"serializedAddressTableLookups")]),s=new Uint8Array($r),a=o.encode({prefix:128,header:this.header,staticAccountKeysLength:new Uint8Array(e),staticAccountKeys:this.staticAccountKeys.map((e=>e.toBytes())),recentBlockhash:nt().decode(this.recentBlockhash),instructionsLength:new Uint8Array(r),serializedInstructions:t,addressTableLookupsLength:new Uint8Array(i),serializedAddressTableLookups:n},s);return s.slice(0,a)}serializeInstructions(){let e=0;const t=new Uint8Array($r);for(const r of this.compiledInstructions){const n=Array();en(n,r.accountKeyIndexes.length);const i=Array();en(i,r.data.length),e+=ht.w3([ht.u8("programIdIndex"),ht.av(n.length,"encodedAccountKeyIndexesLength"),ht.O6(ht.u8(),r.accountKeyIndexes.length,"accountKeyIndexes"),ht.av(i.length,"encodedDataLength"),ht.av(r.data.length,"data")]).encode({programIdIndex:r.programIdIndex,encodedAccountKeyIndexesLength:new Uint8Array(n),accountKeyIndexes:r.accountKeyIndexes,encodedDataLength:new Uint8Array(i),data:r.data},t,e)}return t.slice(0,e)}serializeAddressTableLookups(){let e=0;const t=new Uint8Array($r);for(const r of this.addressTableLookups){const n=Array();en(n,r.writableIndexes.length);const i=Array();en(i,r.readonlyIndexes.length),e+=ht.w3([Yr("accountKey"),ht.av(n.length,"encodedWritableIndexesLength"),ht.O6(ht.u8(),r.writableIndexes.length,"writableIndexes"),ht.av(i.length,"encodedReadonlyIndexesLength"),ht.O6(ht.u8(),r.readonlyIndexes.length,"readonlyIndexes")]).encode({accountKey:r.accountKey.toBytes(),encodedWritableIndexesLength:new Uint8Array(n),writableIndexes:r.writableIndexes,encodedReadonlyIndexesLength:new Uint8Array(i),readonlyIndexes:r.readonlyIndexes},t,e)}return t.slice(0,e)}static deserialize(e){let t=[...e];const r=on(t),n=r&Kr;tn(r!==n,"Expected versioned message but received legacy message"),tn(0===n,`Expected versioned message with version 0 but found version ${n}`);const i={numRequiredSignatures:on(t),numReadonlySignedAccounts:on(t),numReadonlyUnsignedAccounts:on(t)},o=[],s=Qr(t);for(let e=0;e<s;e++)o.push(new jr(sn(t,0,Ur)));const a=nt().encode(sn(t,0,Ur)),c=Qr(t),u=[];for(let e=0;e<c;e++){const e=on(t),r=sn(t,0,Qr(t)),n=Qr(t),i=new Uint8Array(sn(t,0,n));u.push({programIdIndex:e,accountKeyIndexes:r,data:i})}const h=Qr(t),l=[];for(let e=0;e<h;e++){const e=new jr(sn(t,0,Ur)),r=sn(t,0,Qr(t)),n=sn(t,0,Qr(t));l.push({accountKey:e,writableIndexes:r,readonlyIndexes:n})}return new cn({header:i,staticAccountKeys:o,recentBlockhash:a,compiledInstructions:u,addressTableLookups:l})}}const un={deserializeMessageVersion(e){const t=e[0],r=t&Kr;return r===t?"legacy":r},deserialize:e=>{const t=un.deserializeMessageVersion(e);if("legacy"===t)return an.from(e);if(0===t)return cn.deserialize(e);throw new Error(`Transaction message version ${t} deserialization is not supported`)}};let hn=function(e){return e[e.BLOCKHEIGHT_EXCEEDED=0]="BLOCKHEIGHT_EXCEEDED",e[e.PROCESSED=1]="PROCESSED",e[e.TIMED_OUT=2]="TIMED_OUT",e[e.NONCE_INVALID=3]="NONCE_INVALID",e}({});const ln=i.Buffer.alloc(Fr).fill(0);class dn{constructor(e){this.keys=void 0,this.programId=void 0,this.data=i.Buffer.alloc(0),this.programId=e.programId,this.keys=e.keys,e.data&&(this.data=e.data)}toJSON(){return{keys:this.keys.map((({pubkey:e,isSigner:t,isWritable:r})=>({pubkey:e.toJSON(),isSigner:t,isWritable:r}))),programId:this.programId.toJSON(),data:[...this.data]}}}class fn{get signature(){return this.signatures.length>0?this.signatures[0].signature:null}constructor(e){if(this.signatures=[],this.feePayer=void 0,this.instructions=[],this.recentBlockhash=void 0,this.lastValidBlockHeight=void 0,this.nonceInfo=void 0,this.minNonceContextSlot=void 0,this._message=void 0,this._json=void 0,e)if(e.feePayer&&(this.feePayer=e.feePayer),e.signatures&&(this.signatures=e.signatures),Object.prototype.hasOwnProperty.call(e,"nonceInfo")){const{minContextSlot:t,nonceInfo:r}=e;this.minNonceContextSlot=t,this.nonceInfo=r}else if(Object.prototype.hasOwnProperty.call(e,"lastValidBlockHeight")){const{blockhash:t,lastValidBlockHeight:r}=e;this.recentBlockhash=t,this.lastValidBlockHeight=r}else{const{recentBlockhash:t,nonceInfo:r}=e;r&&(this.nonceInfo=r),this.recentBlockhash=t}}toJSON(){return{recentBlockhash:this.recentBlockhash||null,feePayer:this.feePayer?this.feePayer.toJSON():null,nonceInfo:this.nonceInfo?{nonce:this.nonceInfo.nonce,nonceInstruction:this.nonceInfo.nonceInstruction.toJSON()}:null,instructions:this.instructions.map((e=>e.toJSON())),signers:this.signatures.map((({publicKey:e})=>e.toJSON()))}}add(...e){if(0===e.length)throw new Error("No instructions");return e.forEach((e=>{"instructions"in e?this.instructions=this.instructions.concat(e.instructions):"data"in e&&"programId"in e&&"keys"in e?this.instructions.push(e):this.instructions.push(new dn(e))})),this}compileMessage(){if(this._message&&JSON.stringify(this.toJSON())===JSON.stringify(this._json))return this._message;let e,t,r;if(this.nonceInfo?(e=this.nonceInfo.nonce,t=this.instructions[0]!=this.nonceInfo.nonceInstruction?[this.nonceInfo.nonceInstruction,...this.instructions]:this.instructions):(e=this.recentBlockhash,t=this.instructions),!e)throw new Error("Transaction recentBlockhash required");if(t.length<1&&console.warn("No instructions provided"),this.feePayer)r=this.feePayer;else{if(!(this.signatures.length>0&&this.signatures[0].publicKey))throw new Error("Transaction fee payer required");r=this.signatures[0].publicKey}for(let e=0;e<t.length;e++)if(void 0===t[e].programId)throw new Error(`Transaction instruction index ${e} has undefined program id`);const n=[],i=[];t.forEach((e=>{e.keys.forEach((e=>{i.push({...e})}));const t=e.programId.toString();n.includes(t)||n.push(t)})),n.forEach((e=>{i.push({pubkey:new jr(e),isSigner:!1,isWritable:!1})}));const o=[];i.forEach((e=>{const t=e.pubkey.toString(),r=o.findIndex((e=>e.pubkey.toString()===t));r>-1?(o[r].isWritable=o[r].isWritable||e.isWritable,o[r].isSigner=o[r].isSigner||e.isSigner):o.push(e)})),o.sort((function(e,t){return e.isSigner!==t.isSigner?e.isSigner?-1:1:e.isWritable!==t.isWritable?e.isWritable?-1:1:e.pubkey.toBase58().localeCompare(t.pubkey.toBase58(),"en",{localeMatcher:"best fit",usage:"sort",sensitivity:"variant",ignorePunctuation:!1,numeric:!1,caseFirst:"lower"})}));const s=o.findIndex((e=>e.pubkey.equals(r)));if(s>-1){const[e]=o.splice(s,1);e.isSigner=!0,e.isWritable=!0,o.unshift(e)}else o.unshift({pubkey:r,isSigner:!0,isWritable:!0});for(const e of this.signatures){const t=o.findIndex((t=>t.pubkey.equals(e.publicKey)));if(!(t>-1))throw new Error(`unknown signer: ${e.publicKey.toString()}`);o[t].isSigner||(o[t].isSigner=!0,console.warn("Transaction references a signature that is unnecessary, only the fee payer and instruction signer accounts should sign a transaction. This behavior is deprecated and will throw an error in the next major version release."))}let a=0,c=0,u=0;const h=[],l=[];o.forEach((({pubkey:e,isSigner:t,isWritable:r})=>{t?(h.push(e.toString()),a+=1,r||(c+=1)):(l.push(e.toString()),r||(u+=1))}));const d=h.concat(l),f=t.map((e=>{const{data:t,programId:r}=e;return{programIdIndex:d.indexOf(r.toString()),accounts:e.keys.map((e=>d.indexOf(e.pubkey.toString()))),data:nt().encode(t)}}));return f.forEach((e=>{tn(e.programIdIndex>=0),e.accounts.forEach((e=>tn(e>=0)))})),new an({header:{numRequiredSignatures:a,numReadonlySignedAccounts:c,numReadonlyUnsignedAccounts:u},accountKeys:d,recentBlockhash:e,instructions:f})}_compile(){const e=this.compileMessage(),t=e.accountKeys.slice(0,e.header.numRequiredSignatures);return this.signatures.length===t.length&&this.signatures.every(((e,r)=>t[r].equals(e.publicKey)))||(this.signatures=t.map((e=>({signature:null,publicKey:e})))),e}serializeMessage(){return this._compile().serialize()}async getEstimatedFee(e){return(await e.getFeeForMessage(this.compileMessage())).value}setSigners(...e){if(0===e.length)throw new Error("No signers");const t=new Set;this.signatures=e.filter((e=>{const r=e.toString();return!t.has(r)&&(t.add(r),!0)})).map((e=>({signature:null,publicKey:e})))}sign(...e){if(0===e.length)throw new Error("No signers");const t=new Set,r=[];for(const n of e){const e=n.publicKey.toString();t.has(e)||(t.add(e),r.push(n))}this.signatures=r.map((e=>({signature:null,publicKey:e.publicKey})));const n=this._compile();this._partialSign(n,...r)}partialSign(...e){if(0===e.length)throw new Error("No signers");const t=new Set,r=[];for(const n of e){const e=n.publicKey.toString();t.has(e)||(t.add(e),r.push(n))}const n=this._compile();this._partialSign(n,...r)}_partialSign(e,...t){const r=e.serialize();t.forEach((e=>{const t=Or(r,e.secretKey);this._addSignature(e.publicKey,Tr(t))}))}addSignature(e,t){this._compile(),this._addSignature(e,t)}_addSignature(e,t){tn(64===t.length);const r=this.signatures.findIndex((t=>e.equals(t.publicKey)));if(r<0)throw new Error(`unknown signer: ${e.toString()}`);this.signatures[r].signature=i.Buffer.from(t)}verifySignatures(e=!0){return!this._getMessageSignednessErrors(this.serializeMessage(),e)}_getMessageSignednessErrors(e,t){const r={};for(const{signature:n,publicKey:i}of this.signatures)null===n?t&&(r.missing||=[]).push(i):Rr(n,e,i.toBytes())||(r.invalid||=[]).push(i);return r.invalid||r.missing?r:void 0}serialize(e){const{requireAllSignatures:t,verifySignatures:r}=Object.assign({requireAllSignatures:!0,verifySignatures:!0},e),n=this.serializeMessage();if(r){const e=this._getMessageSignednessErrors(n,t);if(e){let t="Signature verification failed.";throw e.invalid&&(t+=`\nInvalid signature for public key${1===e.invalid.length?"":"(s)"} [\`${e.invalid.map((e=>e.toBase58())).join("`, `")}\`].`),e.missing&&(t+=`\nMissing signature for public key${1===e.missing.length?"":"(s)"} [\`${e.missing.map((e=>e.toBase58())).join("`, `")}\`].`),new Error(t)}}return this._serialize(n)}_serialize(e){const{signatures:t}=this,r=[];en(r,t.length);const n=r.length+64*t.length+e.length,o=i.Buffer.alloc(n);return tn(t.length<256),i.Buffer.from(r).copy(o,0),t.forEach((({signature:e},t)=>{null!==e&&(tn(64===e.length,"signature has invalid length"),i.Buffer.from(e).copy(o,r.length+64*t))})),e.copy(o,r.length+64*t.length),tn(o.length<=$r,`Transaction too large: ${o.length} > ${$r}`),o}get keys(){return tn(1===this.instructions.length),this.instructions[0].keys.map((e=>e.pubkey))}get programId(){return tn(1===this.instructions.length),this.instructions[0].programId}get data(){return tn(1===this.instructions.length),this.instructions[0].data}static from(e){let t=[...e];const r=Qr(t);let n=[];for(let e=0;e<r;e++){const e=sn(t,0,Fr);n.push(nt().encode(i.Buffer.from(e)))}return fn.populate(an.from(t),n)}static populate(e,t=[]){const r=new fn;return r.recentBlockhash=e.recentBlockhash,e.header.numRequiredSignatures>0&&(r.feePayer=e.accountKeys[0]),t.forEach(((t,n)=>{const i={signature:t==nt().encode(ln)?null:nt().decode(t),publicKey:e.accountKeys[n]};r.signatures.push(i)})),e.instructions.forEach((t=>{const n=t.accounts.map((t=>{const n=e.accountKeys[t];return{pubkey:n,isSigner:r.signatures.some((e=>e.publicKey.toString()===n.toString()))||e.isAccountSigner(t),isWritable:e.isAccountWritable(t)}}));r.instructions.push(new dn({keys:n,programId:e.accountKeys[t.programIdIndex],data:nt().decode(t.data)}))})),r._message=e,r._json=r.toJSON(),r}}class pn{constructor(e){this.payerKey=void 0,this.instructions=void 0,this.recentBlockhash=void 0,this.payerKey=e.payerKey,this.instructions=e.instructions,this.recentBlockhash=e.recentBlockhash}static decompile(e,t){const{header:r,compiledInstructions:n,recentBlockhash:i}=e,{numRequiredSignatures:o,numReadonlySignedAccounts:s,numReadonlyUnsignedAccounts:a}=r,c=o-s;tn(c>0,"Message header is invalid");const u=e.staticAccountKeys.length-o-a;tn(u>=0,"Message header is invalid");const h=e.getAccountKeys(t),l=h.get(0);if(void 0===l)throw new Error("Failed to decompile message because no account keys were found");const d=[];for(const e of n){const t=[];for(const n of e.accountKeyIndexes){const e=h.get(n);if(void 0===e)throw new Error(`Failed to find key for account key index ${n}`);let i;i=n<o?n<c:n<h.staticAccountKeys.length?n-o<u:n-h.staticAccountKeys.length<h.accountKeysFromLookups.writable.length,t.push({pubkey:e,isSigner:n<r.numRequiredSignatures,isWritable:i})}const n=h.get(e.programIdIndex);if(void 0===n)throw new Error(`Failed to find program id for program id index ${e.programIdIndex}`);d.push(new dn({programId:n,data:Tr(e.data),keys:t}))}return new pn({payerKey:l,instructions:d,recentBlockhash:i})}compileToLegacyMessage(){return an.compile({payerKey:this.payerKey,recentBlockhash:this.recentBlockhash,instructions:this.instructions})}compileToV0Message(e){return cn.compile({payerKey:this.payerKey,recentBlockhash:this.recentBlockhash,instructions:this.instructions,addressLookupTableAccounts:e})}}class gn{get version(){return this.message.version}constructor(e,t){if(this.signatures=void 0,this.message=void 0,void 0!==t)tn(t.length===e.header.numRequiredSignatures,"Expected signatures length to be equal to the number of required signatures"),this.signatures=t;else{const t=[];for(let r=0;r<e.header.numRequiredSignatures;r++)t.push(new Uint8Array(Fr));this.signatures=t}this.message=e}serialize(){const e=this.message.serialize(),t=Array();en(t,this.signatures.length);const r=ht.w3([ht.av(t.length,"encodedSignaturesLength"),ht.O6(Jr(),this.signatures.length,"signatures"),ht.av(e.length,"serializedMessage")]),n=new Uint8Array(2048),i=r.encode({encodedSignaturesLength:new Uint8Array(t),signatures:this.signatures,serializedMessage:e},n);return n.slice(0,i)}static deserialize(e){let t=[...e];const r=[],n=Qr(t);for(let e=0;e<n;e++)r.push(new Uint8Array(sn(t,0,Fr)));const i=un.deserialize(new Uint8Array(t));return new gn(i,r)}sign(e){const t=this.message.serialize(),r=this.message.staticAccountKeys.slice(0,this.message.header.numRequiredSignatures);for(const n of e){const e=r.findIndex((e=>e.equals(n.publicKey)));tn(e>=0,`Cannot sign with non signer key ${n.publicKey.toBase58()}`),this.signatures[e]=Or(t,n.secretKey)}}addSignature(e,t){tn(64===t.byteLength,"Signature must be 64 bytes long");const r=this.message.staticAccountKeys.slice(0,this.message.header.numRequiredSignatures).findIndex((t=>t.equals(e)));tn(r>=0,`Can not add signature; \`${e.toBase58()}\` is not required to sign this transaction`),this.signatures[r]=t}}const yn=new jr("SysvarC1ock11111111111111111111111111111111"),bn=new jr("SysvarEpochSchedu1e111111111111111111111111"),mn=new jr("Sysvar1nstructions1111111111111111111111111"),wn=new jr("SysvarRecentB1ockHashes11111111111111111111"),vn=new jr("SysvarRent111111111111111111111111111111111"),Sn=new jr("SysvarRewards111111111111111111111111111111"),_n=new jr("SysvarS1otHashes111111111111111111111111111"),En=new jr("SysvarS1otHistory11111111111111111111111111"),In=new jr("SysvarStakeHistory1111111111111111111111111");class An extends Error{constructor({action:e,signature:t,transactionMessage:r,logs:n}){const i=n?`Logs: \n${JSON.stringify(n.slice(-10),null,2)}. `:"",o="\nCatch the `SendTransactionError` and call `getLogs()` on it for full details.";let s;switch(e){case"send":s=`Transaction ${t} resulted in an error. \n${r}. `+i+o;break;case"simulate":s=`Simulation failed. \nMessage: ${r}. \n`+i+o;break;default:s=`Unknown action '${e}'`}super(s),this.signature=void 0,this.transactionMessage=void 0,this.transactionLogs=void 0,this.signature=t,this.transactionMessage=r,this.transactionLogs=n||void 0}get transactionError(){return{message:this.transactionMessage,logs:Array.isArray(this.transactionLogs)?this.transactionLogs:void 0}}get logs(){const e=this.transactionLogs;if(null==e||"object"!=typeof e||!("then"in e))return e}async getLogs(e){return Array.isArray(this.transactionLogs)||(this.transactionLogs=new Promise(((t,r)=>{e.getTransaction(this.signature).then((e=>{if(e&&e.meta&&e.meta.logMessages){const r=e.meta.logMessages;this.transactionLogs=r,t(r)}else r(new Error("Log messages not found"))})).catch(r)}))),await this.transactionLogs}}const kn={JSON_RPC_SERVER_ERROR_BLOCK_CLEANED_UP:-32001,JSON_RPC_SERVER_ERROR_SEND_TRANSACTION_PREFLIGHT_FAILURE:-32002,JSON_RPC_SERVER_ERROR_TRANSACTION_SIGNATURE_VERIFICATION_FAILURE:-32003,JSON_RPC_SERVER_ERROR_BLOCK_NOT_AVAILABLE:-32004,JSON_RPC_SERVER_ERROR_NODE_UNHEALTHY:-32005,JSON_RPC_SERVER_ERROR_TRANSACTION_PRECOMPILE_VERIFICATION_FAILURE:-32006,JSON_RPC_SERVER_ERROR_SLOT_SKIPPED:-32007,JSON_RPC_SERVER_ERROR_NO_SNAPSHOT:-32008,JSON_RPC_SERVER_ERROR_LONG_TERM_STORAGE_SLOT_SKIPPED:-32009,JSON_RPC_SERVER_ERROR_KEY_EXCLUDED_FROM_SECONDARY_INDEX:-32010,JSON_RPC_SERVER_ERROR_TRANSACTION_HISTORY_NOT_AVAILABLE:-32011,JSON_RPC_SCAN_ERROR:-32012,JSON_RPC_SERVER_ERROR_TRANSACTION_SIGNATURE_LEN_MISMATCH:-32013,JSON_RPC_SERVER_ERROR_BLOCK_STATUS_NOT_AVAILABLE_YET:-32014,JSON_RPC_SERVER_ERROR_UNSUPPORTED_TRANSACTION_VERSION:-32015,JSON_RPC_SERVER_ERROR_MIN_CONTEXT_SLOT_NOT_REACHED:-32016};class xn extends Error{constructor({code:e,message:t,data:r},n){super(null!=n?`${n}: ${t}`:t),this.code=void 0,this.data=void 0,this.code=e,this.data=r,this.name="SolanaJSONRPCError"}}async function Pn(e,t,r,n){const i=n&&{skipPreflight:n.skipPreflight,preflightCommitment:n.preflightCommitment||n.commitment,maxRetries:n.maxRetries,minContextSlot:n.minContextSlot},o=await e.sendTransaction(t,r,i);let s;if(null!=t.recentBlockhash&&null!=t.lastValidBlockHeight)s=(await e.confirmTransaction({abortSignal:n?.abortSignal,signature:o,blockhash:t.recentBlockhash,lastValidBlockHeight:t.lastValidBlockHeight},n&&n.commitment)).value;else if(null!=t.minNonceContextSlot&&null!=t.nonceInfo){const{nonceInstruction:r}=t.nonceInfo,i=r.keys[0].pubkey;s=(await e.confirmTransaction({abortSignal:n?.abortSignal,minContextSlot:t.minNonceContextSlot,nonceAccountPubkey:i,nonceValue:t.nonceInfo.nonce,signature:o},n&&n.commitment)).value}else null!=n?.abortSignal&&console.warn("sendAndConfirmTransaction(): A transaction with a deprecated confirmation strategy was supplied along with an `abortSignal`. Only transactions having `lastValidBlockHeight` or a combination of `nonceInfo` and `minNonceContextSlot` are abortable."),s=(await e.confirmTransaction(o,n&&n.commitment)).value;if(s.err){if(null!=o)throw new An({action:"send",signature:o,transactionMessage:`Status: (${JSON.stringify(s)})`});throw new Error(`Transaction ${o} failed (${JSON.stringify(s)})`)}return o}function On(e){return new Promise((t=>setTimeout(t,e)))}function Rn(e,t){const r=e.layout.span>=0?e.layout.span:Zr(e,t),n=i.Buffer.alloc(r),o=Object.assign({instruction:e.index},t);return e.layout.encode(o,n),n}function Tn(e,t){let r;try{r=e.layout.decode(t)}catch(e){throw new Error("invalid instruction; "+e)}if(r.instruction!==e.index)throw new Error(`invalid instruction; instruction index mismatch ${r.instruction} != ${e.index}`);return r}const Nn=ht.I0("lamportsPerSignature"),Mn=ht.w3([ht.DH("version"),ht.DH("state"),Yr("authorizedPubkey"),Yr("nonce"),ht.w3([Nn],"feeCalculator")]),Cn=Mn.span;class Bn{constructor(e){this.authorizedPubkey=void 0,this.nonce=void 0,this.feeCalculator=void 0,this.authorizedPubkey=e.authorizedPubkey,this.nonce=e.nonce,this.feeCalculator=e.feeCalculator}static fromAccountData(e){const t=Mn.decode(Tr(e),0);return new Bn({authorizedPubkey:new jr(t.authorizedPubkey),nonce:new jr(t.nonce).toString(),feeCalculator:t.feeCalculator})}}const Ln=e=>{const t=(0,ht.av)(8,e),{encode:r,decode:n}=(e=>({decode:e.decode.bind(e),encode:e.encode.bind(e)}))(t),o=t;return o.decode=(e,t)=>{const r=n(e,t);return(0,lt.k5)(i.Buffer.from(r))},o.encode=(e,t,n)=>{const i=(0,lt.Bq)(e,8);return r(i,t,n)},o};class Un{constructor(){}static decodeInstructionType(e){this.checkProgramId(e.programId);const t=ht.DH("instruction").decode(e.data);let r;for(const[e,n]of Object.entries(Dn))if(n.index==t){r=e;break}if(!r)throw new Error("Instruction type incorrect; not a SystemInstruction");return r}static decodeCreateAccount(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,2);const{lamports:t,space:r,programId:n}=Tn(Dn.Create,e.data);return{fromPubkey:e.keys[0].pubkey,newAccountPubkey:e.keys[1].pubkey,lamports:t,space:r,programId:new jr(n)}}static decodeTransfer(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,2);const{lamports:t}=Tn(Dn.Transfer,e.data);return{fromPubkey:e.keys[0].pubkey,toPubkey:e.keys[1].pubkey,lamports:t}}static decodeTransferWithSeed(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,3);const{lamports:t,seed:r,programId:n}=Tn(Dn.TransferWithSeed,e.data);return{fromPubkey:e.keys[0].pubkey,basePubkey:e.keys[1].pubkey,toPubkey:e.keys[2].pubkey,lamports:t,seed:r,programId:new jr(n)}}static decodeAllocate(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,1);const{space:t}=Tn(Dn.Allocate,e.data);return{accountPubkey:e.keys[0].pubkey,space:t}}static decodeAllocateWithSeed(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,1);const{base:t,seed:r,space:n,programId:i}=Tn(Dn.AllocateWithSeed,e.data);return{accountPubkey:e.keys[0].pubkey,basePubkey:new jr(t),seed:r,space:n,programId:new jr(i)}}static decodeAssign(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,1);const{programId:t}=Tn(Dn.Assign,e.data);return{accountPubkey:e.keys[0].pubkey,programId:new jr(t)}}static decodeAssignWithSeed(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,1);const{base:t,seed:r,programId:n}=Tn(Dn.AssignWithSeed,e.data);return{accountPubkey:e.keys[0].pubkey,basePubkey:new jr(t),seed:r,programId:new jr(n)}}static decodeCreateWithSeed(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,2);const{base:t,seed:r,lamports:n,space:i,programId:o}=Tn(Dn.CreateWithSeed,e.data);return{fromPubkey:e.keys[0].pubkey,newAccountPubkey:e.keys[1].pubkey,basePubkey:new jr(t),seed:r,lamports:n,space:i,programId:new jr(o)}}static decodeNonceInitialize(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,3);const{authorized:t}=Tn(Dn.InitializeNonceAccount,e.data);return{noncePubkey:e.keys[0].pubkey,authorizedPubkey:new jr(t)}}static decodeNonceAdvance(e){return this.checkProgramId(e.programId),this.checkKeyLength(e.keys,3),Tn(Dn.AdvanceNonceAccount,e.data),{noncePubkey:e.keys[0].pubkey,authorizedPubkey:e.keys[2].pubkey}}static decodeNonceWithdraw(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,5);const{lamports:t}=Tn(Dn.WithdrawNonceAccount,e.data);return{noncePubkey:e.keys[0].pubkey,toPubkey:e.keys[1].pubkey,authorizedPubkey:e.keys[4].pubkey,lamports:t}}static decodeNonceAuthorize(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,2);const{authorized:t}=Tn(Dn.AuthorizeNonceAccount,e.data);return{noncePubkey:e.keys[0].pubkey,authorizedPubkey:e.keys[1].pubkey,newAuthorizedPubkey:new jr(t)}}static checkProgramId(e){if(!e.equals(jn.programId))throw new Error("invalid instruction; programId is not SystemProgram")}static checkKeyLength(e,t){if(e.length<t)throw new Error(`invalid instruction; found ${e.length} keys, expected at least ${t}`)}}const Dn=Object.freeze({Create:{index:0,layout:ht.w3([ht.DH("instruction"),ht.Wg("lamports"),ht.Wg("space"),Yr("programId")])},Assign:{index:1,layout:ht.w3([ht.DH("instruction"),Yr("programId")])},Transfer:{index:2,layout:ht.w3([ht.DH("instruction"),Ln("lamports")])},CreateWithSeed:{index:3,layout:ht.w3([ht.DH("instruction"),Yr("base"),Xr("seed"),ht.Wg("lamports"),ht.Wg("space"),Yr("programId")])},AdvanceNonceAccount:{index:4,layout:ht.w3([ht.DH("instruction")])},WithdrawNonceAccount:{index:5,layout:ht.w3([ht.DH("instruction"),ht.Wg("lamports")])},InitializeNonceAccount:{index:6,layout:ht.w3([ht.DH("instruction"),Yr("authorized")])},AuthorizeNonceAccount:{index:7,layout:ht.w3([ht.DH("instruction"),Yr("authorized")])},Allocate:{index:8,layout:ht.w3([ht.DH("instruction"),ht.Wg("space")])},AllocateWithSeed:{index:9,layout:ht.w3([ht.DH("instruction"),Yr("base"),Xr("seed"),ht.Wg("space"),Yr("programId")])},AssignWithSeed:{index:10,layout:ht.w3([ht.DH("instruction"),Yr("base"),Xr("seed"),Yr("programId")])},TransferWithSeed:{index:11,layout:ht.w3([ht.DH("instruction"),Ln("lamports"),Xr("seed"),Yr("programId")])},UpgradeNonceAccount:{index:12,layout:ht.w3([ht.DH("instruction")])}});class jn{constructor(){}static createAccount(e){const t=Rn(Dn.Create,{lamports:e.lamports,space:e.space,programId:Tr(e.programId.toBuffer())});return new dn({keys:[{pubkey:e.fromPubkey,isSigner:!0,isWritable:!0},{pubkey:e.newAccountPubkey,isSigner:!0,isWritable:!0}],programId:this.programId,data:t})}static transfer(e){let t,r;return"basePubkey"in e?(t=Rn(Dn.TransferWithSeed,{lamports:BigInt(e.lamports),seed:e.seed,programId:Tr(e.programId.toBuffer())}),r=[{pubkey:e.fromPubkey,isSigner:!1,isWritable:!0},{pubkey:e.basePubkey,isSigner:!0,isWritable:!1},{pubkey:e.toPubkey,isSigner:!1,isWritable:!0}]):(t=Rn(Dn.Transfer,{lamports:BigInt(e.lamports)}),r=[{pubkey:e.fromPubkey,isSigner:!0,isWritable:!0},{pubkey:e.toPubkey,isSigner:!1,isWritable:!0}]),new dn({keys:r,programId:this.programId,data:t})}static assign(e){let t,r;return"basePubkey"in e?(t=Rn(Dn.AssignWithSeed,{base:Tr(e.basePubkey.toBuffer()),seed:e.seed,programId:Tr(e.programId.toBuffer())}),r=[{pubkey:e.accountPubkey,isSigner:!1,isWritable:!0},{pubkey:e.basePubkey,isSigner:!0,isWritable:!1}]):(t=Rn(Dn.Assign,{programId:Tr(e.programId.toBuffer())}),r=[{pubkey:e.accountPubkey,isSigner:!0,isWritable:!0}]),new dn({keys:r,programId:this.programId,data:t})}static createAccountWithSeed(e){const t=Rn(Dn.CreateWithSeed,{base:Tr(e.basePubkey.toBuffer()),seed:e.seed,lamports:e.lamports,space:e.space,programId:Tr(e.programId.toBuffer())});let r=[{pubkey:e.fromPubkey,isSigner:!0,isWritable:!0},{pubkey:e.newAccountPubkey,isSigner:!1,isWritable:!0}];return e.basePubkey.equals(e.fromPubkey)||r.push({pubkey:e.basePubkey,isSigner:!0,isWritable:!1}),new dn({keys:r,programId:this.programId,data:t})}static createNonceAccount(e){const t=new fn;"basePubkey"in e&&"seed"in e?t.add(jn.createAccountWithSeed({fromPubkey:e.fromPubkey,newAccountPubkey:e.noncePubkey,basePubkey:e.basePubkey,seed:e.seed,lamports:e.lamports,space:Cn,programId:this.programId})):t.add(jn.createAccount({fromPubkey:e.fromPubkey,newAccountPubkey:e.noncePubkey,lamports:e.lamports,space:Cn,programId:this.programId}));const r={noncePubkey:e.noncePubkey,authorizedPubkey:e.authorizedPubkey};return t.add(this.nonceInitialize(r)),t}static nonceInitialize(e){const t=Rn(Dn.InitializeNonceAccount,{authorized:Tr(e.authorizedPubkey.toBuffer())}),r={keys:[{pubkey:e.noncePubkey,isSigner:!1,isWritable:!0},{pubkey:wn,isSigner:!1,isWritable:!1},{pubkey:vn,isSigner:!1,isWritable:!1}],programId:this.programId,data:t};return new dn(r)}static nonceAdvance(e){const t=Rn(Dn.AdvanceNonceAccount),r={keys:[{pubkey:e.noncePubkey,isSigner:!1,isWritable:!0},{pubkey:wn,isSigner:!1,isWritable:!1},{pubkey:e.authorizedPubkey,isSigner:!0,isWritable:!1}],programId:this.programId,data:t};return new dn(r)}static nonceWithdraw(e){const t=Rn(Dn.WithdrawNonceAccount,{lamports:e.lamports});return new dn({keys:[{pubkey:e.noncePubkey,isSigner:!1,isWritable:!0},{pubkey:e.toPubkey,isSigner:!1,isWritable:!0},{pubkey:wn,isSigner:!1,isWritable:!1},{pubkey:vn,isSigner:!1,isWritable:!1},{pubkey:e.authorizedPubkey,isSigner:!0,isWritable:!1}],programId:this.programId,data:t})}static nonceAuthorize(e){const t=Rn(Dn.AuthorizeNonceAccount,{authorized:Tr(e.newAuthorizedPubkey.toBuffer())});return new dn({keys:[{pubkey:e.noncePubkey,isSigner:!1,isWritable:!0},{pubkey:e.authorizedPubkey,isSigner:!0,isWritable:!1}],programId:this.programId,data:t})}static allocate(e){let t,r;return"basePubkey"in e?(t=Rn(Dn.AllocateWithSeed,{base:Tr(e.basePubkey.toBuffer()),seed:e.seed,space:e.space,programId:Tr(e.programId.toBuffer())}),r=[{pubkey:e.accountPubkey,isSigner:!1,isWritable:!0},{pubkey:e.basePubkey,isSigner:!0,isWritable:!1}]):(t=Rn(Dn.Allocate,{space:e.space}),r=[{pubkey:e.accountPubkey,isSigner:!0,isWritable:!0}]),new dn({keys:r,programId:this.programId,data:t})}}jn.programId=new jr("11111111111111111111111111111111");const zn=$r-300;class qn{constructor(){}static getMinNumSignatures(e){return 2*(Math.ceil(e/qn.chunkSize)+1+1)}static async load(e,t,r,n,o){{const i=await e.getMinimumBalanceForRentExemption(o.length),s=await e.getAccountInfo(r.publicKey,"confirmed");let a=null;if(null!==s){if(s.executable)return console.error("Program load failed, account is already executable"),!1;s.data.length!==o.length&&(a=a||new fn,a.add(jn.allocate({accountPubkey:r.publicKey,space:o.length}))),s.owner.equals(n)||(a=a||new fn,a.add(jn.assign({accountPubkey:r.publicKey,programId:n}))),s.lamports<i&&(a=a||new fn,a.add(jn.transfer({fromPubkey:t.publicKey,toPubkey:r.publicKey,lamports:i-s.lamports})))}else a=(new fn).add(jn.createAccount({fromPubkey:t.publicKey,newAccountPubkey:r.publicKey,lamports:i>0?i:1,space:o.length,programId:n}));null!==a&&await Pn(e,a,[t,r],{commitment:"confirmed"})}const s=ht.w3([ht.DH("instruction"),ht.DH("offset"),ht.DH("bytesLength"),ht.DH("bytesLengthPadding"),ht.O6(ht.u8("byte"),ht.cY(ht.DH(),-8),"bytes")]),a=qn.chunkSize;let c=0,u=o,h=[];for(;u.length>0;){const o=u.slice(0,a),l=i.Buffer.alloc(a+16);s.encode({instruction:0,offset:c,bytes:o,bytesLength:0,bytesLengthPadding:0},l);const d=(new fn).add({keys:[{pubkey:r.publicKey,isSigner:!0,isWritable:!0}],programId:n,data:l});if(h.push(Pn(e,d,[t,r],{commitment:"confirmed"})),e._rpcEndpoint.includes("solana.com")){const e=4;await On(1e3/e)}c+=a,u=u.slice(a)}await Promise.all(h);{const o=ht.w3([ht.DH("instruction")]),s=i.Buffer.alloc(o.span);o.encode({instruction:1},s);const a=(new fn).add({keys:[{pubkey:r.publicKey,isSigner:!0,isWritable:!0},{pubkey:vn,isSigner:!1,isWritable:!1}],programId:n,data:s}),c="processed",u=await e.sendTransaction(a,[t,r],{preflightCommitment:c}),{context:h,value:l}=await e.confirmTransaction({signature:u,lastValidBlockHeight:a.lastValidBlockHeight,blockhash:a.recentBlockhash},c);if(l.err)throw new Error(`Transaction ${u} failed (${JSON.stringify(l)})`);for(;;){try{if(await e.getSlot({commitment:c})>h.slot)break}catch{}await new Promise((e=>setTimeout(e,Math.round(200))))}}return!0}}qn.chunkSize=zn;const $n=new jr("BPFLoader2111111111111111111111111111111111");class Kn{static getMinNumSignatures(e){return qn.getMinNumSignatures(e)}static load(e,t,r,n,i){return qn.load(e,t,r,i,n)}}function Fn(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Wn,Hn;function Vn(){if(Hn)return Wn;Hn=1;var e=Object.prototype.toString,t=Object.keys||function(e){var t=[];for(var r in e)t.push(r);return t};function r(n,i){var o,s,a,c,u,h,l;if(!0===n)return"true";if(!1===n)return"false";switch(typeof n){case"object":if(null===n)return null;if(n.toJSON&&"function"==typeof n.toJSON)return r(n.toJSON(),i);if("[object Array]"===(l=e.call(n))){for(a="[",s=n.length-1,o=0;o<s;o++)a+=r(n[o],!0)+",";return s>-1&&(a+=r(n[o],!0)),a+"]"}if("[object Object]"===l){for(s=(c=t(n).sort()).length,a="",o=0;o<s;)void 0!==(h=r(n[u=c[o]],!1))&&(a&&(a+=","),a+=JSON.stringify(u)+":"+h),o++;return"{"+a+"}"}return JSON.stringify(n);case"function":case"undefined":return i?null:void 0;case"string":return JSON.stringify(n);default:return isFinite(n)?n:null}}return Wn=function(e){var t=r(e,!1);if(void 0!==t)return""+t}}var Gn=Fn(Vn());function Yn(e){let t=0;for(;e>1;)e/=2,t++;return t}class Jn{constructor(e,t,r,n,i){this.slotsPerEpoch=void 0,this.leaderScheduleSlotOffset=void 0,this.warmup=void 0,this.firstNormalEpoch=void 0,this.firstNormalSlot=void 0,this.slotsPerEpoch=e,this.leaderScheduleSlotOffset=t,this.warmup=r,this.firstNormalEpoch=n,this.firstNormalSlot=i}getEpoch(e){return this.getEpochAndSlotIndex(e)[0]}getEpochAndSlotIndex(e){if(e<this.firstNormalSlot){const r=Yn(0===(t=e+32+1)?1:(t--,t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,t|=t>>16,1+(t|=t>>32)))-Yn(32)-1;return[r,e-(this.getSlotsInEpoch(r)-32)]}{const t=e-this.firstNormalSlot,r=Math.floor(t/this.slotsPerEpoch);return[this.firstNormalEpoch+r,t%this.slotsPerEpoch]}var t}getFirstSlotInEpoch(e){return e<=this.firstNormalEpoch?32*(Math.pow(2,e)-1):(e-this.firstNormalEpoch)*this.slotsPerEpoch+this.firstNormalSlot}getLastSlotInEpoch(e){return this.getFirstSlotInEpoch(e)+this.getSlotsInEpoch(e)-1}getSlotsInEpoch(e){return e<this.firstNormalEpoch?Math.pow(2,e+Yn(32)):this.slotsPerEpoch}}var Xn=globalThis.fetch;class Zn extends Ft{constructor(e,t,r){super((e=>{const r=function(e,t){return new $t(e,t)}(e,{autoconnect:!0,max_reconnects:5,reconnect:!0,reconnect_interval:1e3,...t});return this.underlyingSocket="socket"in r?r.socket:r,r}),e,t,r),this.underlyingSocket=void 0}call(...e){const t=this.underlyingSocket?.readyState;return 1===t?super.call(...e):Promise.reject(new Error("Tried to call a JSON-RPC method `"+e[0]+"` but the socket was not `CONNECTING` or `OPEN` (`readyState` was "+t+")"))}notify(...e){const t=this.underlyingSocket?.readyState;return 1===t?super.notify(...e):Promise.reject(new Error("Tried to send a JSON-RPC notification `"+e[0]+"` but the socket was not `CONNECTING` or `OPEN` (`readyState` was "+t+")"))}}class Qn{constructor(e){this.key=void 0,this.state=void 0,this.key=e.key,this.state=e.state}isActive(){const e=BigInt("0xffffffffffffffff");return this.state.deactivationSlot===e}static deserialize(e){const t=function(e,t){let r;try{r=e.layout.decode(t)}catch(e){throw new Error("invalid instruction; "+e)}if(r.typeIndex!==e.index)throw new Error(`invalid account data; account type mismatch ${r.typeIndex} != ${e.index}`);return r}(ei,e),r=e.length-56;tn(r>=0,"lookup table is invalid"),tn(r%32==0,"lookup table is invalid");const n=r/32,{addresses:i}=ht.w3([ht.O6(Yr(),n,"addresses")]).decode(e.slice(56));return{deactivationSlot:t.deactivationSlot,lastExtendedSlot:t.lastExtendedSlot,lastExtendedSlotStartIndex:t.lastExtendedStartIndex,authority:0!==t.authority.length?new jr(t.authority[0]):void 0,addresses:i.map((e=>new jr(e)))}}}const ei={index:1,layout:ht.w3([ht.DH("typeIndex"),Ln("deactivationSlot"),ht.I0("lastExtendedSlot"),ht.u8("lastExtendedStartIndex"),ht.u8(),ht.O6(Yr(),ht.cY(ht.u8(),-1),"authority")])},ti=/^[^:]+:\/\/([^:[]+|\[[^\]]+\])(:\d+)?(.*)/i,ri=Dt(xt(jr),Mt(),(e=>new jr(e))),ni=Ct([Mt(),Pt("base64")]),ii=Dt(xt(i.Buffer),ni,(e=>i.Buffer.from(e[0],"base64"))),oi=3e4;function si(e){let t,r;if("string"==typeof e)t=e;else if(e){const{commitment:n,...i}=e;t=n,r=i}return{commitment:t,config:r}}function ai(e){return e.map((e=>"memcmp"in e?{...e,memcmp:{...e.memcmp,encoding:e.memcmp.encoding??"base58"}}:e))}function ci(e){return Lt([Bt({jsonrpc:Pt("2.0"),id:Mt(),result:e}),Bt({jsonrpc:Pt("2.0"),id:Mt(),error:Bt({code:Ut(),message:Mt(),data:Tt(It("any",(()=>!0)))})})])}const ui=ci(Ut());function hi(e){return Dt(ci(e),ui,(t=>"error"in t?t:{...t,result:St(t.result,e)}))}function li(e){return hi(Bt({context:Bt({slot:Rt()}),value:e}))}function di(e){return Bt({context:Bt({slot:Rt()}),value:e})}function fi(e,t){return 0===e?new cn({header:t.header,staticAccountKeys:t.accountKeys.map((e=>new jr(e))),recentBlockhash:t.recentBlockhash,compiledInstructions:t.instructions.map((e=>({programIdIndex:e.programIdIndex,accountKeyIndexes:e.accounts,data:nt().decode(e.data)}))),addressTableLookups:t.addressTableLookups}):new an(t)}const pi=Bt({foundation:Rt(),foundationTerm:Rt(),initial:Rt(),taper:Rt(),terminal:Rt()}),gi=hi(At(Ot(Bt({epoch:Rt(),effectiveSlot:Rt(),amount:Rt(),postBalance:Rt(),commission:Tt(Ot(Rt()))})))),yi=At(Bt({slot:Rt(),prioritizationFee:Rt()})),bi=Bt({total:Rt(),validator:Rt(),foundation:Rt(),epoch:Rt()}),mi=Bt({epoch:Rt(),slotIndex:Rt(),slotsInEpoch:Rt(),absoluteSlot:Rt(),blockHeight:Tt(Rt()),transactionCount:Tt(Rt())}),wi=Bt({slotsPerEpoch:Rt(),leaderScheduleSlotOffset:Rt(),warmup:kt(),firstNormalEpoch:Rt(),firstNormalSlot:Rt()}),vi=Nt(Mt(),At(Rt())),Si=Ot(Lt([Bt({}),Mt()])),_i=Bt({err:Si}),Ei=Pt("receivedSignature"),Ii=Bt({"solana-core":Mt(),"feature-set":Tt(Rt())}),Ai=Bt({program:Mt(),programId:ri,parsed:Ut()}),ki=Bt({programId:ri,accounts:At(ri),data:Mt()}),xi=li(Bt({err:Ot(Lt([Bt({}),Mt()])),logs:Ot(At(Mt())),accounts:Tt(Ot(At(Ot(Bt({executable:kt(),owner:Mt(),lamports:Rt(),data:At(Mt()),rentEpoch:Tt(Rt())}))))),unitsConsumed:Tt(Rt()),returnData:Tt(Ot(Bt({programId:Mt(),data:Ct([Mt(),Pt("base64")])}))),innerInstructions:Tt(Ot(At(Bt({index:Rt(),instructions:At(Lt([Ai,ki]))}))))})),Pi=li(Bt({byIdentity:Nt(Mt(),At(Rt())),range:Bt({firstSlot:Rt(),lastSlot:Rt()})})),Oi=hi(pi),Ri=hi(bi),Ti=hi(yi),Ni=hi(mi),Mi=hi(wi),Ci=hi(vi),Bi=hi(Rt()),Li=li(Bt({total:Rt(),circulating:Rt(),nonCirculating:Rt(),nonCirculatingAccounts:At(ri)})),Ui=Bt({amount:Mt(),uiAmount:Ot(Rt()),decimals:Rt(),uiAmountString:Tt(Mt())}),Di=li(At(Bt({address:ri,amount:Mt(),uiAmount:Ot(Rt()),decimals:Rt(),uiAmountString:Tt(Mt())}))),ji=li(At(Bt({pubkey:ri,account:Bt({executable:kt(),owner:ri,lamports:Rt(),data:ii,rentEpoch:Rt()})}))),zi=Bt({program:Mt(),parsed:Ut(),space:Rt()}),qi=li(At(Bt({pubkey:ri,account:Bt({executable:kt(),owner:ri,lamports:Rt(),data:zi,rentEpoch:Rt()})}))),$i=li(At(Bt({lamports:Rt(),address:ri}))),Ki=Bt({executable:kt(),owner:ri,lamports:Rt(),data:ii,rentEpoch:Rt()}),Fi=Bt({pubkey:ri,account:Ki}),Wi=Dt(Lt([xt(i.Buffer),zi]),Lt([ni,zi]),(e=>Array.isArray(e)?St(e,ii):e)),Hi=Bt({executable:kt(),owner:ri,lamports:Rt(),data:Wi,rentEpoch:Rt()}),Vi=Bt({pubkey:ri,account:Hi}),Gi=Bt({state:Lt([Pt("active"),Pt("inactive"),Pt("activating"),Pt("deactivating")]),active:Rt(),inactive:Rt()}),Yi=hi(At(Bt({signature:Mt(),slot:Rt(),err:Si,memo:Ot(Mt()),blockTime:Tt(Ot(Rt()))}))),Ji=hi(At(Bt({signature:Mt(),slot:Rt(),err:Si,memo:Ot(Mt()),blockTime:Tt(Ot(Rt()))}))),Xi=Bt({subscription:Rt(),result:di(Ki)}),Zi=Bt({pubkey:ri,account:Ki}),Qi=Bt({subscription:Rt(),result:di(Zi)}),eo=Bt({parent:Rt(),slot:Rt(),root:Rt()}),to=Bt({subscription:Rt(),result:eo}),ro=Lt([Bt({type:Lt([Pt("firstShredReceived"),Pt("completed"),Pt("optimisticConfirmation"),Pt("root")]),slot:Rt(),timestamp:Rt()}),Bt({type:Pt("createdBank"),parent:Rt(),slot:Rt(),timestamp:Rt()}),Bt({type:Pt("frozen"),slot:Rt(),timestamp:Rt(),stats:Bt({numTransactionEntries:Rt(),numSuccessfulTransactions:Rt(),numFailedTransactions:Rt(),maxTransactionsPerEntry:Rt()})}),Bt({type:Pt("dead"),slot:Rt(),timestamp:Rt(),err:Mt()})]),no=Bt({subscription:Rt(),result:ro}),io=Bt({subscription:Rt(),result:di(Lt([_i,Ei]))}),oo=Bt({subscription:Rt(),result:Rt()}),so=Bt({pubkey:Mt(),gossip:Ot(Mt()),tpu:Ot(Mt()),rpc:Ot(Mt()),version:Ot(Mt())}),ao=Bt({votePubkey:Mt(),nodePubkey:Mt(),activatedStake:Rt(),epochVoteAccount:kt(),epochCredits:At(Ct([Rt(),Rt(),Rt()])),commission:Rt(),lastVote:Rt(),rootSlot:Ot(Rt())}),co=hi(Bt({current:At(ao),delinquent:At(ao)})),uo=Lt([Pt("processed"),Pt("confirmed"),Pt("finalized")]),ho=Bt({slot:Rt(),confirmations:Ot(Rt()),err:Si,confirmationStatus:Tt(uo)}),lo=li(At(Ot(ho))),fo=hi(Rt()),po=Bt({accountKey:ri,writableIndexes:At(Rt()),readonlyIndexes:At(Rt())}),go=Bt({signatures:At(Mt()),message:Bt({accountKeys:At(Mt()),header:Bt({numRequiredSignatures:Rt(),numReadonlySignedAccounts:Rt(),numReadonlyUnsignedAccounts:Rt()}),instructions:At(Bt({accounts:At(Rt()),data:Mt(),programIdIndex:Rt()})),recentBlockhash:Mt(),addressTableLookups:Tt(At(po))})}),yo=Bt({pubkey:ri,signer:kt(),writable:kt(),source:Tt(Lt([Pt("transaction"),Pt("lookupTable")]))}),bo=Bt({accountKeys:At(yo),signatures:At(Mt())}),mo=Bt({parsed:Ut(),program:Mt(),programId:ri}),wo=Bt({accounts:At(ri),data:Mt(),programId:ri}),vo=Dt(Lt([wo,mo]),Lt([Bt({parsed:Ut(),program:Mt(),programId:Mt()}),Bt({accounts:At(Mt()),data:Mt(),programId:Mt()})]),(e=>St(e,"accounts"in e?wo:mo))),So=Bt({signatures:At(Mt()),message:Bt({accountKeys:At(yo),instructions:At(vo),recentBlockhash:Mt(),addressTableLookups:Tt(Ot(At(po)))})}),_o=Bt({accountIndex:Rt(),mint:Mt(),owner:Tt(Mt()),programId:Tt(Mt()),uiTokenAmount:Ui}),Eo=Bt({writable:At(ri),readonly:At(ri)}),Io=Bt({err:Si,fee:Rt(),innerInstructions:Tt(Ot(At(Bt({index:Rt(),instructions:At(Bt({accounts:At(Rt()),data:Mt(),programIdIndex:Rt()}))})))),preBalances:At(Rt()),postBalances:At(Rt()),logMessages:Tt(Ot(At(Mt()))),preTokenBalances:Tt(Ot(At(_o))),postTokenBalances:Tt(Ot(At(_o))),loadedAddresses:Tt(Eo),computeUnitsConsumed:Tt(Rt())}),Ao=Bt({err:Si,fee:Rt(),innerInstructions:Tt(Ot(At(Bt({index:Rt(),instructions:At(vo)})))),preBalances:At(Rt()),postBalances:At(Rt()),logMessages:Tt(Ot(At(Mt()))),preTokenBalances:Tt(Ot(At(_o))),postTokenBalances:Tt(Ot(At(_o))),loadedAddresses:Tt(Eo),computeUnitsConsumed:Tt(Rt())}),ko=Lt([Pt(0),Pt("legacy")]),xo=Bt({pubkey:Mt(),lamports:Rt(),postBalance:Ot(Rt()),rewardType:Ot(Mt()),commission:Tt(Ot(Rt()))}),Po=hi(Ot(Bt({blockhash:Mt(),previousBlockhash:Mt(),parentSlot:Rt(),transactions:At(Bt({transaction:go,meta:Ot(Io),version:Tt(ko)})),rewards:Tt(At(xo)),blockTime:Ot(Rt()),blockHeight:Ot(Rt())}))),Oo=hi(Ot(Bt({blockhash:Mt(),previousBlockhash:Mt(),parentSlot:Rt(),rewards:Tt(At(xo)),blockTime:Ot(Rt()),blockHeight:Ot(Rt())}))),Ro=hi(Ot(Bt({blockhash:Mt(),previousBlockhash:Mt(),parentSlot:Rt(),transactions:At(Bt({transaction:bo,meta:Ot(Io),version:Tt(ko)})),rewards:Tt(At(xo)),blockTime:Ot(Rt()),blockHeight:Ot(Rt())}))),To=hi(Ot(Bt({blockhash:Mt(),previousBlockhash:Mt(),parentSlot:Rt(),transactions:At(Bt({transaction:So,meta:Ot(Ao),version:Tt(ko)})),rewards:Tt(At(xo)),blockTime:Ot(Rt()),blockHeight:Ot(Rt())}))),No=hi(Ot(Bt({blockhash:Mt(),previousBlockhash:Mt(),parentSlot:Rt(),transactions:At(Bt({transaction:bo,meta:Ot(Ao),version:Tt(ko)})),rewards:Tt(At(xo)),blockTime:Ot(Rt()),blockHeight:Ot(Rt())}))),Mo=hi(Ot(Bt({blockhash:Mt(),previousBlockhash:Mt(),parentSlot:Rt(),rewards:Tt(At(xo)),blockTime:Ot(Rt()),blockHeight:Ot(Rt())}))),Co=hi(Ot(Bt({blockhash:Mt(),previousBlockhash:Mt(),parentSlot:Rt(),transactions:At(Bt({transaction:go,meta:Ot(Io)})),rewards:Tt(At(xo)),blockTime:Ot(Rt())}))),Bo=hi(Ot(Bt({blockhash:Mt(),previousBlockhash:Mt(),parentSlot:Rt(),signatures:At(Mt()),blockTime:Ot(Rt())}))),Lo=hi(Ot(Bt({slot:Rt(),meta:Ot(Io),blockTime:Tt(Ot(Rt())),transaction:go,version:Tt(ko)}))),Uo=hi(Ot(Bt({slot:Rt(),transaction:So,meta:Ot(Ao),blockTime:Tt(Ot(Rt())),version:Tt(ko)}))),Do=li(Bt({blockhash:Mt(),lastValidBlockHeight:Rt()})),jo=li(kt()),zo=hi(At(Bt({slot:Rt(),numTransactions:Rt(),numSlots:Rt(),samplePeriodSecs:Rt()}))),qo=li(Ot(Bt({feeCalculator:Bt({lamportsPerSignature:Rt()})}))),$o=hi(Mt()),Ko=hi(Mt()),Fo=Bt({err:Si,logs:At(Mt()),signature:Mt()}),Wo=Bt({result:di(Fo),subscription:Rt()}),Ho={"solana-client":"js/1.0.0-maintenance"};class Vo{constructor(e,t){let r,n,i,o,s,a;var c;this._commitment=void 0,this._confirmTransactionInitialTimeout=void 0,this._rpcEndpoint=void 0,this._rpcWsEndpoint=void 0,this._rpcClient=void 0,this._rpcRequest=void 0,this._rpcBatchRequest=void 0,this._rpcWebSocket=void 0,this._rpcWebSocketConnected=!1,this._rpcWebSocketHeartbeat=null,this._rpcWebSocketIdleTimeout=null,this._rpcWebSocketGeneration=0,this._disableBlockhashCaching=!1,this._pollingBlockhash=!1,this._blockhashInfo={latestBlockhash:null,lastFetch:0,transactionSignatures:[],simulatedSignatures:[]},this._nextClientSubscriptionId=0,this._subscriptionDisposeFunctionsByClientSubscriptionId={},this._subscriptionHashByClientSubscriptionId={},this._subscriptionStateChangeCallbacksByHash={},this._subscriptionCallbacksByServerSubscriptionId={},this._subscriptionsByHash={},this._subscriptionsAutoDisposedByRpc=new Set,this.getBlockHeight=(()=>{const e={};return async t=>{const{commitment:r,config:n}=si(t),i=this._buildArgs([],r,void 0,n),o=Gn(i);return e[o]=e[o]??(async()=>{try{const e=St(await this._rpcRequest("getBlockHeight",i),hi(Rt()));if("error"in e)throw new xn(e.error,"failed to get block height information");return e.result}finally{delete e[o]}})(),await e[o]}})(),t&&"string"==typeof t?this._commitment=t:t&&(this._commitment=t.commitment,this._confirmTransactionInitialTimeout=t.confirmTransactionInitialTimeout,r=t.wsEndpoint,n=t.httpHeaders,i=t.fetch,o=t.fetchMiddleware,s=t.disableRetryOnRateLimit,a=t.httpAgent),this._rpcEndpoint=function(e){if(!1===/^https?:/.test(e))throw new TypeError("Endpoint URL must start with `http:` or `https:`.");return e}(e),this._rpcWsEndpoint=r||function(e){const t=e.match(ti);if(null==t)throw TypeError(`Failed to validate endpoint URL \`${e}\``);const[r,n,i,o]=t,s=e.startsWith("https:")?"wss:":"ws:",a=null==i?null:parseInt(i.slice(1),10);return`${s}//${n}${null==a?"":`:${a+1}`}${o}`}(e),this._rpcClient=function(e,t,r,n,i,o){const s=r||Xn;let a;return null!=o&&console.warn("You have supplied an `httpAgent` when creating a `Connection` in a browser environment.It has been ignored; `httpAgent` is only used in Node environments."),n&&(a=async(e,t)=>{const r=await new Promise(((r,i)=>{try{n(e,t,((e,t)=>r([e,t])))}catch(e){i(e)}}));return await s(...r)}),new(zt())((async(r,n)=>{const o={method:"POST",body:r,agent:void 0,headers:Object.assign({"Content-Type":"application/json"},t||{},Ho)};try{let t,r=5,c=500;for(;t=a?await a(e,o):await s(e,o),429===t.status&&!0!==i&&(r-=1,0!==r);)console.error(`Server responded with ${t.status} ${t.statusText}.  Retrying after ${c}ms delay...`),await On(c),c*=2;const u=await t.text();t.ok?n(null,u):n(new Error(`${t.status} ${t.statusText}: ${u}`))}catch(e){e instanceof Error&&n(e)}}),{})}(e,n,i,o,s,a),this._rpcRequest=(c=this._rpcClient,(e,t)=>new Promise(((r,n)=>{c.request(e,t,((e,t)=>{e?n(e):r(t)}))}))),this._rpcBatchRequest=function(e){return t=>new Promise(((r,n)=>{0===t.length&&r([]);const i=t.map((t=>e.request(t.methodName,t.args)));e.request(i,((e,t)=>{e?n(e):r(t)}))}))}(this._rpcClient),this._rpcWebSocket=new Zn(this._rpcWsEndpoint,{autoconnect:!1,max_reconnects:1/0}),this._rpcWebSocket.on("open",this._wsOnOpen.bind(this)),this._rpcWebSocket.on("error",this._wsOnError.bind(this)),this._rpcWebSocket.on("close",this._wsOnClose.bind(this)),this._rpcWebSocket.on("accountNotification",this._wsOnAccountNotification.bind(this)),this._rpcWebSocket.on("programNotification",this._wsOnProgramAccountNotification.bind(this)),this._rpcWebSocket.on("slotNotification",this._wsOnSlotNotification.bind(this)),this._rpcWebSocket.on("slotsUpdatesNotification",this._wsOnSlotUpdatesNotification.bind(this)),this._rpcWebSocket.on("signatureNotification",this._wsOnSignatureNotification.bind(this)),this._rpcWebSocket.on("rootNotification",this._wsOnRootNotification.bind(this)),this._rpcWebSocket.on("logsNotification",this._wsOnLogsNotification.bind(this))}get commitment(){return this._commitment}get rpcEndpoint(){return this._rpcEndpoint}async getBalanceAndContext(e,t){const{commitment:r,config:n}=si(t),i=this._buildArgs([e.toBase58()],r,void 0,n),o=St(await this._rpcRequest("getBalance",i),li(Rt()));if("error"in o)throw new xn(o.error,`failed to get balance for ${e.toBase58()}`);return o.result}async getBalance(e,t){return await this.getBalanceAndContext(e,t).then((e=>e.value)).catch((t=>{throw new Error("failed to get balance of account "+e.toBase58()+": "+t)}))}async getBlockTime(e){const t=St(await this._rpcRequest("getBlockTime",[e]),hi(Ot(Rt())));if("error"in t)throw new xn(t.error,`failed to get block time for slot ${e}`);return t.result}async getMinimumLedgerSlot(){const e=St(await this._rpcRequest("minimumLedgerSlot",[]),hi(Rt()));if("error"in e)throw new xn(e.error,"failed to get minimum ledger slot");return e.result}async getFirstAvailableBlock(){const e=St(await this._rpcRequest("getFirstAvailableBlock",[]),Bi);if("error"in e)throw new xn(e.error,"failed to get first available block");return e.result}async getSupply(e){let t={};t="string"==typeof e?{commitment:e}:e?{...e,commitment:e&&e.commitment||this.commitment}:{commitment:this.commitment};const r=St(await this._rpcRequest("getSupply",[t]),Li);if("error"in r)throw new xn(r.error,"failed to get supply");return r.result}async getTokenSupply(e,t){const r=this._buildArgs([e.toBase58()],t),n=St(await this._rpcRequest("getTokenSupply",r),li(Ui));if("error"in n)throw new xn(n.error,"failed to get token supply");return n.result}async getTokenAccountBalance(e,t){const r=this._buildArgs([e.toBase58()],t),n=St(await this._rpcRequest("getTokenAccountBalance",r),li(Ui));if("error"in n)throw new xn(n.error,"failed to get token account balance");return n.result}async getTokenAccountsByOwner(e,t,r){const{commitment:n,config:i}=si(r);let o=[e.toBase58()];"mint"in t?o.push({mint:t.mint.toBase58()}):o.push({programId:t.programId.toBase58()});const s=this._buildArgs(o,n,"base64",i),a=St(await this._rpcRequest("getTokenAccountsByOwner",s),ji);if("error"in a)throw new xn(a.error,`failed to get token accounts owned by account ${e.toBase58()}`);return a.result}async getParsedTokenAccountsByOwner(e,t,r){let n=[e.toBase58()];"mint"in t?n.push({mint:t.mint.toBase58()}):n.push({programId:t.programId.toBase58()});const i=this._buildArgs(n,r,"jsonParsed"),o=St(await this._rpcRequest("getTokenAccountsByOwner",i),qi);if("error"in o)throw new xn(o.error,`failed to get token accounts owned by account ${e.toBase58()}`);return o.result}async getLargestAccounts(e){const t={...e,commitment:e&&e.commitment||this.commitment},r=t.filter||t.commitment?[t]:[],n=St(await this._rpcRequest("getLargestAccounts",r),$i);if("error"in n)throw new xn(n.error,"failed to get largest accounts");return n.result}async getTokenLargestAccounts(e,t){const r=this._buildArgs([e.toBase58()],t),n=St(await this._rpcRequest("getTokenLargestAccounts",r),Di);if("error"in n)throw new xn(n.error,"failed to get token largest accounts");return n.result}async getAccountInfoAndContext(e,t){const{commitment:r,config:n}=si(t),i=this._buildArgs([e.toBase58()],r,"base64",n),o=St(await this._rpcRequest("getAccountInfo",i),li(Ot(Ki)));if("error"in o)throw new xn(o.error,`failed to get info about account ${e.toBase58()}`);return o.result}async getParsedAccountInfo(e,t){const{commitment:r,config:n}=si(t),i=this._buildArgs([e.toBase58()],r,"jsonParsed",n),o=St(await this._rpcRequest("getAccountInfo",i),li(Ot(Hi)));if("error"in o)throw new xn(o.error,`failed to get info about account ${e.toBase58()}`);return o.result}async getAccountInfo(e,t){try{return(await this.getAccountInfoAndContext(e,t)).value}catch(t){throw new Error("failed to get info about account "+e.toBase58()+": "+t)}}async getMultipleParsedAccounts(e,t){const{commitment:r,config:n}=si(t),i=e.map((e=>e.toBase58())),o=this._buildArgs([i],r,"jsonParsed",n),s=St(await this._rpcRequest("getMultipleAccounts",o),li(At(Ot(Hi))));if("error"in s)throw new xn(s.error,`failed to get info for accounts ${i}`);return s.result}async getMultipleAccountsInfoAndContext(e,t){const{commitment:r,config:n}=si(t),i=e.map((e=>e.toBase58())),o=this._buildArgs([i],r,"base64",n),s=St(await this._rpcRequest("getMultipleAccounts",o),li(At(Ot(Ki))));if("error"in s)throw new xn(s.error,`failed to get info for accounts ${i}`);return s.result}async getMultipleAccountsInfo(e,t){return(await this.getMultipleAccountsInfoAndContext(e,t)).value}async getStakeActivation(e,t,r){const{commitment:n,config:i}=si(t),o=this._buildArgs([e.toBase58()],n,void 0,{...i,epoch:null!=r?r:i?.epoch}),s=St(await this._rpcRequest("getStakeActivation",o),hi(Gi));if("error"in s)throw new xn(s.error,`failed to get Stake Activation ${e.toBase58()}`);return s.result}async getProgramAccounts(e,t){const{commitment:r,config:n}=si(t),{encoding:i,...o}=n||{},s=this._buildArgs([e.toBase58()],r,i||"base64",{...o,...o.filters?{filters:ai(o.filters)}:null}),a=await this._rpcRequest("getProgramAccounts",s),c=At(Fi),u=!0===o.withContext?St(a,li(c)):St(a,hi(c));if("error"in u)throw new xn(u.error,`failed to get accounts owned by program ${e.toBase58()}`);return u.result}async getParsedProgramAccounts(e,t){const{commitment:r,config:n}=si(t),i=this._buildArgs([e.toBase58()],r,"jsonParsed",n),o=St(await this._rpcRequest("getProgramAccounts",i),hi(At(Vi)));if("error"in o)throw new xn(o.error,`failed to get accounts owned by program ${e.toBase58()}`);return o.result}async confirmTransaction(e,t){let r,n;if("string"==typeof e)r=e;else{const t=e;if(t.abortSignal?.aborted)return Promise.reject(t.abortSignal.reason);r=t.signature}try{n=nt().decode(r)}catch(e){throw new Error("signature must be base58 encoded: "+r)}return tn(64===n.length,"signature has invalid length"),"string"==typeof e?await this.confirmTransactionUsingLegacyTimeoutStrategy({commitment:t||this.commitment,signature:r}):"lastValidBlockHeight"in e?await this.confirmTransactionUsingBlockHeightExceedanceStrategy({commitment:t||this.commitment,strategy:e}):await this.confirmTransactionUsingDurableNonceStrategy({commitment:t||this.commitment,strategy:e})}getCancellationPromise(e){return new Promise(((t,r)=>{null!=e&&(e.aborted?r(e.reason):e.addEventListener("abort",(()=>{r(e.reason)})))}))}getTransactionConfirmationPromise({commitment:e,signature:t}){let r,n,i=!1;return{abortConfirmation:()=>{n&&(n(),n=void 0),null!=r&&(this.removeSignatureListener(r),r=void 0)},confirmationPromise:new Promise(((o,s)=>{try{r=this.onSignature(t,((e,t)=>{r=void 0;const n={context:t,value:e};o({__type:hn.PROCESSED,response:n})}),e);const a=new Promise((e=>{null==r?e():n=this._onSubscriptionStateChange(r,(t=>{"subscribed"===t&&e()}))}));(async()=>{if(await a,i)return;const r=await this.getSignatureStatus(t);if(i)return;if(null==r)return;const{context:n,value:c}=r;if(null!=c)if(c?.err)s(c.err);else{switch(e){case"confirmed":case"single":case"singleGossip":if("processed"===c.confirmationStatus)return;break;case"finalized":case"max":case"root":if("processed"===c.confirmationStatus||"confirmed"===c.confirmationStatus)return}i=!0,o({__type:hn.PROCESSED,response:{context:n,value:c}})}})()}catch(e){s(e)}}))}}async confirmTransactionUsingBlockHeightExceedanceStrategy({commitment:e,strategy:{abortSignal:t,lastValidBlockHeight:r,signature:n}}){let i=!1;const o=new Promise((t=>{const n=async()=>{try{return await this.getBlockHeight(e)}catch(e){return-1}};(async()=>{let e=await n();if(!i){for(;e<=r;){if(await On(1e3),i)return;if(e=await n(),i)return}t({__type:hn.BLOCKHEIGHT_EXCEEDED})}})()})),{abortConfirmation:s,confirmationPromise:a}=this.getTransactionConfirmationPromise({commitment:e,signature:n}),c=this.getCancellationPromise(t);let u;try{const e=await Promise.race([c,a,o]);if(e.__type!==hn.PROCESSED)throw new Wr(n);u=e.response}finally{i=!0,s()}return u}async confirmTransactionUsingDurableNonceStrategy({commitment:e,strategy:{abortSignal:t,minContextSlot:r,nonceAccountPubkey:n,nonceValue:i,signature:o}}){let s=!1;const a=new Promise((t=>{let o=i,a=null;const c=async()=>{try{const{context:t,value:i}=await this.getNonceAndContext(n,{commitment:e,minContextSlot:r});return a=t.slot,i?.nonce}catch(e){return o}};(async()=>{if(o=await c(),!s)for(;;){if(i!==o)return void t({__type:hn.NONCE_INVALID,slotInWhichNonceDidAdvance:a});if(await On(2e3),s)return;if(o=await c(),s)return}})()})),{abortConfirmation:c,confirmationPromise:u}=this.getTransactionConfirmationPromise({commitment:e,signature:o}),h=this.getCancellationPromise(t);let l;try{const t=await Promise.race([h,u,a]);if(t.__type===hn.PROCESSED)l=t.response;else{let n;for(;;){const e=await this.getSignatureStatus(o);if(null==e)break;if(!(e.context.slot<(t.slotInWhichNonceDidAdvance??r))){n=e;break}await On(400)}if(!n?.value)throw new Vr(o);{const t=e||"finalized",{confirmationStatus:r}=n.value;switch(t){case"processed":case"recent":if("processed"!==r&&"confirmed"!==r&&"finalized"!==r)throw new Vr(o);break;case"confirmed":case"single":case"singleGossip":if("confirmed"!==r&&"finalized"!==r)throw new Vr(o);break;case"finalized":case"max":case"root":if("finalized"!==r)throw new Vr(o)}l={context:n.context,value:{err:n.value.err}}}}}finally{s=!0,c()}return l}async confirmTransactionUsingLegacyTimeoutStrategy({commitment:e,signature:t}){let r;const n=new Promise((t=>{let n=this._confirmTransactionInitialTimeout||6e4;switch(e){case"processed":case"recent":case"single":case"confirmed":case"singleGossip":n=this._confirmTransactionInitialTimeout||3e4}r=setTimeout((()=>t({__type:hn.TIMED_OUT,timeoutMs:n})),n)})),{abortConfirmation:i,confirmationPromise:o}=this.getTransactionConfirmationPromise({commitment:e,signature:t});let s;try{const e=await Promise.race([o,n]);if(e.__type!==hn.PROCESSED)throw new Hr(t,e.timeoutMs/1e3);s=e.response}finally{clearTimeout(r),i()}return s}async getClusterNodes(){const e=St(await this._rpcRequest("getClusterNodes",[]),hi(At(so)));if("error"in e)throw new xn(e.error,"failed to get cluster nodes");return e.result}async getVoteAccounts(e){const t=this._buildArgs([],e),r=St(await this._rpcRequest("getVoteAccounts",t),co);if("error"in r)throw new xn(r.error,"failed to get vote accounts");return r.result}async getSlot(e){const{commitment:t,config:r}=si(e),n=this._buildArgs([],t,void 0,r),i=St(await this._rpcRequest("getSlot",n),hi(Rt()));if("error"in i)throw new xn(i.error,"failed to get slot");return i.result}async getSlotLeader(e){const{commitment:t,config:r}=si(e),n=this._buildArgs([],t,void 0,r),i=St(await this._rpcRequest("getSlotLeader",n),hi(Mt()));if("error"in i)throw new xn(i.error,"failed to get slot leader");return i.result}async getSlotLeaders(e,t){const r=[e,t],n=St(await this._rpcRequest("getSlotLeaders",r),hi(At(ri)));if("error"in n)throw new xn(n.error,"failed to get slot leaders");return n.result}async getSignatureStatus(e,t){const{context:r,value:n}=await this.getSignatureStatuses([e],t);return tn(1===n.length),{context:r,value:n[0]}}async getSignatureStatuses(e,t){const r=[e];t&&r.push(t);const n=St(await this._rpcRequest("getSignatureStatuses",r),lo);if("error"in n)throw new xn(n.error,"failed to get signature status");return n.result}async getTransactionCount(e){const{commitment:t,config:r}=si(e),n=this._buildArgs([],t,void 0,r),i=St(await this._rpcRequest("getTransactionCount",n),hi(Rt()));if("error"in i)throw new xn(i.error,"failed to get transaction count");return i.result}async getTotalSupply(e){return(await this.getSupply({commitment:e,excludeNonCirculatingAccountsList:!0})).value.total}async getInflationGovernor(e){const t=this._buildArgs([],e),r=St(await this._rpcRequest("getInflationGovernor",t),Oi);if("error"in r)throw new xn(r.error,"failed to get inflation");return r.result}async getInflationReward(e,t,r){const{commitment:n,config:i}=si(r),o=this._buildArgs([e.map((e=>e.toBase58()))],n,void 0,{...i,epoch:null!=t?t:i?.epoch}),s=St(await this._rpcRequest("getInflationReward",o),gi);if("error"in s)throw new xn(s.error,"failed to get inflation reward");return s.result}async getInflationRate(){const e=St(await this._rpcRequest("getInflationRate",[]),Ri);if("error"in e)throw new xn(e.error,"failed to get inflation rate");return e.result}async getEpochInfo(e){const{commitment:t,config:r}=si(e),n=this._buildArgs([],t,void 0,r),i=St(await this._rpcRequest("getEpochInfo",n),Ni);if("error"in i)throw new xn(i.error,"failed to get epoch info");return i.result}async getEpochSchedule(){const e=St(await this._rpcRequest("getEpochSchedule",[]),Mi);if("error"in e)throw new xn(e.error,"failed to get epoch schedule");const t=e.result;return new Jn(t.slotsPerEpoch,t.leaderScheduleSlotOffset,t.warmup,t.firstNormalEpoch,t.firstNormalSlot)}async getLeaderSchedule(){const e=St(await this._rpcRequest("getLeaderSchedule",[]),Ci);if("error"in e)throw new xn(e.error,"failed to get leader schedule");return e.result}async getMinimumBalanceForRentExemption(e,t){const r=this._buildArgs([e],t),n=St(await this._rpcRequest("getMinimumBalanceForRentExemption",r),fo);return"error"in n?(console.warn("Unable to fetch minimum balance for rent exemption"),0):n.result}async getRecentBlockhashAndContext(e){const{context:t,value:{blockhash:r}}=await this.getLatestBlockhashAndContext(e);return{context:t,value:{blockhash:r,feeCalculator:{get lamportsPerSignature(){throw new Error("The capability to fetch `lamportsPerSignature` using the `getRecentBlockhash` API is no longer offered by the network. Use the `getFeeForMessage` API to obtain the fee for a given message.")},toJSON:()=>({})}}}}async getRecentPerformanceSamples(e){const t=St(await this._rpcRequest("getRecentPerformanceSamples",e?[e]:[]),zo);if("error"in t)throw new xn(t.error,"failed to get recent performance samples");return t.result}async getFeeCalculatorForBlockhash(e,t){const r=this._buildArgs([e],t),n=St(await this._rpcRequest("getFeeCalculatorForBlockhash",r),qo);if("error"in n)throw new xn(n.error,"failed to get fee calculator");const{context:i,value:o}=n.result;return{context:i,value:null!==o?o.feeCalculator:null}}async getFeeForMessage(e,t){const r=Tr(e.serialize()).toString("base64"),n=this._buildArgs([r],t),i=St(await this._rpcRequest("getFeeForMessage",n),li(Ot(Rt())));if("error"in i)throw new xn(i.error,"failed to get fee for message");if(null===i.result)throw new Error("invalid blockhash");return i.result}async getRecentPrioritizationFees(e){const t=e?.lockedWritableAccounts?.map((e=>e.toBase58())),r=t?.length?[t]:[],n=St(await this._rpcRequest("getRecentPrioritizationFees",r),Ti);if("error"in n)throw new xn(n.error,"failed to get recent prioritization fees");return n.result}async getRecentBlockhash(e){try{return(await this.getRecentBlockhashAndContext(e)).value}catch(e){throw new Error("failed to get recent blockhash: "+e)}}async getLatestBlockhash(e){try{return(await this.getLatestBlockhashAndContext(e)).value}catch(e){throw new Error("failed to get recent blockhash: "+e)}}async getLatestBlockhashAndContext(e){const{commitment:t,config:r}=si(e),n=this._buildArgs([],t,void 0,r),i=St(await this._rpcRequest("getLatestBlockhash",n),Do);if("error"in i)throw new xn(i.error,"failed to get latest blockhash");return i.result}async isBlockhashValid(e,t){const{commitment:r,config:n}=si(t),i=this._buildArgs([e],r,void 0,n),o=St(await this._rpcRequest("isBlockhashValid",i),jo);if("error"in o)throw new xn(o.error,"failed to determine if the blockhash `"+e+"`is valid");return o.result}async getVersion(){const e=St(await this._rpcRequest("getVersion",[]),hi(Ii));if("error"in e)throw new xn(e.error,"failed to get version");return e.result}async getGenesisHash(){const e=St(await this._rpcRequest("getGenesisHash",[]),hi(Mt()));if("error"in e)throw new xn(e.error,"failed to get genesis hash");return e.result}async getBlock(e,t){const{commitment:r,config:n}=si(t),i=this._buildArgsAtLeastConfirmed([e],r,void 0,n),o=await this._rpcRequest("getBlock",i);try{switch(n?.transactionDetails){case"accounts":{const e=St(o,Ro);if("error"in e)throw e.error;return e.result}case"none":{const e=St(o,Oo);if("error"in e)throw e.error;return e.result}default:{const e=St(o,Po);if("error"in e)throw e.error;const{result:t}=e;return t?{...t,transactions:t.transactions.map((({transaction:e,meta:t,version:r})=>({meta:t,transaction:{...e,message:fi(r,e.message)},version:r})))}:null}}}catch(e){throw new xn(e,"failed to get confirmed block")}}async getParsedBlock(e,t){const{commitment:r,config:n}=si(t),i=this._buildArgsAtLeastConfirmed([e],r,"jsonParsed",n),o=await this._rpcRequest("getBlock",i);try{switch(n?.transactionDetails){case"accounts":{const e=St(o,No);if("error"in e)throw e.error;return e.result}case"none":{const e=St(o,Mo);if("error"in e)throw e.error;return e.result}default:{const e=St(o,To);if("error"in e)throw e.error;return e.result}}}catch(e){throw new xn(e,"failed to get block")}}async getBlockProduction(e){let t,r;if("string"==typeof e)r=e;else if(e){const{commitment:n,...i}=e;r=n,t=i}const n=this._buildArgs([],r,"base64",t),i=St(await this._rpcRequest("getBlockProduction",n),Pi);if("error"in i)throw new xn(i.error,"failed to get block production information");return i.result}async getTransaction(e,t){const{commitment:r,config:n}=si(t),i=this._buildArgsAtLeastConfirmed([e],r,void 0,n),o=St(await this._rpcRequest("getTransaction",i),Lo);if("error"in o)throw new xn(o.error,"failed to get transaction");const s=o.result;return s?{...s,transaction:{...s.transaction,message:fi(s.version,s.transaction.message)}}:s}async getParsedTransaction(e,t){const{commitment:r,config:n}=si(t),i=this._buildArgsAtLeastConfirmed([e],r,"jsonParsed",n),o=St(await this._rpcRequest("getTransaction",i),Uo);if("error"in o)throw new xn(o.error,"failed to get transaction");return o.result}async getParsedTransactions(e,t){const{commitment:r,config:n}=si(t),i=e.map((e=>({methodName:"getTransaction",args:this._buildArgsAtLeastConfirmed([e],r,"jsonParsed",n)})));return(await this._rpcBatchRequest(i)).map((e=>{const t=St(e,Uo);if("error"in t)throw new xn(t.error,"failed to get transactions");return t.result}))}async getTransactions(e,t){const{commitment:r,config:n}=si(t),i=e.map((e=>({methodName:"getTransaction",args:this._buildArgsAtLeastConfirmed([e],r,void 0,n)})));return(await this._rpcBatchRequest(i)).map((e=>{const t=St(e,Lo);if("error"in t)throw new xn(t.error,"failed to get transactions");const r=t.result;return r?{...r,transaction:{...r.transaction,message:fi(r.version,r.transaction.message)}}:r}))}async getConfirmedBlock(e,t){const r=this._buildArgsAtLeastConfirmed([e],t),n=St(await this._rpcRequest("getBlock",r),Co);if("error"in n)throw new xn(n.error,"failed to get confirmed block");const i=n.result;if(!i)throw new Error("Confirmed block "+e+" not found");const o={...i,transactions:i.transactions.map((({transaction:e,meta:t})=>{const r=new an(e.message);return{meta:t,transaction:{...e,message:r}}}))};return{...o,transactions:o.transactions.map((({transaction:e,meta:t})=>({meta:t,transaction:fn.populate(e.message,e.signatures)})))}}async getBlocks(e,t,r){const n=this._buildArgsAtLeastConfirmed(void 0!==t?[e,t]:[e],r),i=St(await this._rpcRequest("getBlocks",n),hi(At(Rt())));if("error"in i)throw new xn(i.error,"failed to get blocks");return i.result}async getBlockSignatures(e,t){const r=this._buildArgsAtLeastConfirmed([e],t,void 0,{transactionDetails:"signatures",rewards:!1}),n=St(await this._rpcRequest("getBlock",r),Bo);if("error"in n)throw new xn(n.error,"failed to get block");const i=n.result;if(!i)throw new Error("Block "+e+" not found");return i}async getConfirmedBlockSignatures(e,t){const r=this._buildArgsAtLeastConfirmed([e],t,void 0,{transactionDetails:"signatures",rewards:!1}),n=St(await this._rpcRequest("getBlock",r),Bo);if("error"in n)throw new xn(n.error,"failed to get confirmed block");const i=n.result;if(!i)throw new Error("Confirmed block "+e+" not found");return i}async getConfirmedTransaction(e,t){const r=this._buildArgsAtLeastConfirmed([e],t),n=St(await this._rpcRequest("getTransaction",r),Lo);if("error"in n)throw new xn(n.error,"failed to get transaction");const i=n.result;if(!i)return i;const o=new an(i.transaction.message),s=i.transaction.signatures;return{...i,transaction:fn.populate(o,s)}}async getParsedConfirmedTransaction(e,t){const r=this._buildArgsAtLeastConfirmed([e],t,"jsonParsed"),n=St(await this._rpcRequest("getTransaction",r),Uo);if("error"in n)throw new xn(n.error,"failed to get confirmed transaction");return n.result}async getParsedConfirmedTransactions(e,t){const r=e.map((e=>({methodName:"getTransaction",args:this._buildArgsAtLeastConfirmed([e],t,"jsonParsed")})));return(await this._rpcBatchRequest(r)).map((e=>{const t=St(e,Uo);if("error"in t)throw new xn(t.error,"failed to get confirmed transactions");return t.result}))}async getConfirmedSignaturesForAddress(e,t,r){let n={},i=await this.getFirstAvailableBlock();for(;!("until"in n)&&!(--t<=0||t<i);)try{const e=await this.getConfirmedBlockSignatures(t,"finalized");e.signatures.length>0&&(n.until=e.signatures[e.signatures.length-1].toString())}catch(e){if(e instanceof Error&&e.message.includes("skipped"))continue;throw e}let o=await this.getSlot("finalized");for(;!("before"in n||++r>o);)try{const e=await this.getConfirmedBlockSignatures(r);e.signatures.length>0&&(n.before=e.signatures[e.signatures.length-1].toString())}catch(e){if(e instanceof Error&&e.message.includes("skipped"))continue;throw e}return(await this.getConfirmedSignaturesForAddress2(e,n)).map((e=>e.signature))}async getConfirmedSignaturesForAddress2(e,t,r){const n=this._buildArgsAtLeastConfirmed([e.toBase58()],r,void 0,t),i=St(await this._rpcRequest("getConfirmedSignaturesForAddress2",n),Yi);if("error"in i)throw new xn(i.error,"failed to get confirmed signatures for address");return i.result}async getSignaturesForAddress(e,t,r){const n=this._buildArgsAtLeastConfirmed([e.toBase58()],r,void 0,t),i=St(await this._rpcRequest("getSignaturesForAddress",n),Ji);if("error"in i)throw new xn(i.error,"failed to get signatures for address");return i.result}async getAddressLookupTable(e,t){const{context:r,value:n}=await this.getAccountInfoAndContext(e,t);let i=null;return null!==n&&(i=new Qn({key:e,state:Qn.deserialize(n.data)})),{context:r,value:i}}async getNonceAndContext(e,t){const{context:r,value:n}=await this.getAccountInfoAndContext(e,t);let i=null;return null!==n&&(i=Bn.fromAccountData(n.data)),{context:r,value:i}}async getNonce(e,t){return await this.getNonceAndContext(e,t).then((e=>e.value)).catch((t=>{throw new Error("failed to get nonce for account "+e.toBase58()+": "+t)}))}async requestAirdrop(e,t){const r=St(await this._rpcRequest("requestAirdrop",[e.toBase58(),t]),$o);if("error"in r)throw new xn(r.error,`airdrop to ${e.toBase58()} failed`);return r.result}async _blockhashWithExpiryBlockHeight(e){if(!e){for(;this._pollingBlockhash;)await On(100);const e=Date.now()-this._blockhashInfo.lastFetch>=oi;if(null!==this._blockhashInfo.latestBlockhash&&!e)return this._blockhashInfo.latestBlockhash}return await this._pollNewBlockhash()}async _pollNewBlockhash(){this._pollingBlockhash=!0;try{const e=Date.now(),t=this._blockhashInfo.latestBlockhash,r=t?t.blockhash:null;for(let e=0;e<50;e++){const e=await this.getLatestBlockhash("finalized");if(r!==e.blockhash)return this._blockhashInfo={latestBlockhash:e,lastFetch:Date.now(),transactionSignatures:[],simulatedSignatures:[]},e;await On(200)}throw new Error(`Unable to obtain a new blockhash after ${Date.now()-e}ms`)}finally{this._pollingBlockhash=!1}}async getStakeMinimumDelegation(e){const{commitment:t,config:r}=si(e),n=this._buildArgs([],t,"base64",r),i=St(await this._rpcRequest("getStakeMinimumDelegation",n),li(Rt()));if("error"in i)throw new xn(i.error,"failed to get stake minimum delegation");return i.result}async simulateTransaction(e,t,r){if("message"in e){const n=e.serialize(),o=i.Buffer.from(n).toString("base64");if(Array.isArray(t)||void 0!==r)throw new Error("Invalid arguments");const s=t||{};s.encoding="base64","commitment"in s||(s.commitment=this.commitment),t&&"object"==typeof t&&"innerInstructions"in t&&(s.innerInstructions=t.innerInstructions);const a=[o,s],c=St(await this._rpcRequest("simulateTransaction",a),xi);if("error"in c)throw new Error("failed to simulate transaction: "+c.error.message);return c.result}let n;if(e instanceof fn){let t=e;n=new fn,n.feePayer=t.feePayer,n.instructions=e.instructions,n.nonceInfo=t.nonceInfo,n.signatures=t.signatures}else n=fn.populate(e),n._message=n._json=void 0;if(void 0!==t&&!Array.isArray(t))throw new Error("Invalid arguments");const o=t;if(n.nonceInfo&&o)n.sign(...o);else{let e=this._disableBlockhashCaching;for(;;){const t=await this._blockhashWithExpiryBlockHeight(e);if(n.lastValidBlockHeight=t.lastValidBlockHeight,n.recentBlockhash=t.blockhash,!o)break;if(n.sign(...o),!n.signature)throw new Error("!signature");const r=n.signature.toString("base64");if(!this._blockhashInfo.simulatedSignatures.includes(r)&&!this._blockhashInfo.transactionSignatures.includes(r)){this._blockhashInfo.simulatedSignatures.push(r);break}e=!0}}const s=n._compile(),a=s.serialize(),c=n._serialize(a).toString("base64"),u={encoding:"base64",commitment:this.commitment};if(r){const e=(Array.isArray(r)?r:s.nonProgramIds()).map((e=>e.toBase58()));u.accounts={encoding:"base64",addresses:e}}o&&(u.sigVerify=!0),t&&"object"==typeof t&&"innerInstructions"in t&&(u.innerInstructions=t.innerInstructions);const h=[c,u],l=St(await this._rpcRequest("simulateTransaction",h),xi);if("error"in l){let e;if("data"in l.error&&(e=l.error.data.logs,e&&Array.isArray(e))){const t="\n    ",r=t+e.join(t);console.error(l.error.message,r)}throw new An({action:"simulate",signature:"",transactionMessage:l.error.message,logs:e})}return l.result}async sendTransaction(e,t,r){if("version"in e){if(t&&Array.isArray(t))throw new Error("Invalid arguments");const r=e.serialize();return await this.sendRawTransaction(r,t)}if(void 0===t||!Array.isArray(t))throw new Error("Invalid arguments");const n=t;if(e.nonceInfo)e.sign(...n);else{let t=this._disableBlockhashCaching;for(;;){const r=await this._blockhashWithExpiryBlockHeight(t);if(e.lastValidBlockHeight=r.lastValidBlockHeight,e.recentBlockhash=r.blockhash,e.sign(...n),!e.signature)throw new Error("!signature");const i=e.signature.toString("base64");if(!this._blockhashInfo.transactionSignatures.includes(i)){this._blockhashInfo.transactionSignatures.push(i);break}t=!0}}const i=e.serialize();return await this.sendRawTransaction(i,r)}async sendRawTransaction(e,t){const r=Tr(e).toString("base64");return await this.sendEncodedTransaction(r,t)}async sendEncodedTransaction(e,t){const r={encoding:"base64"},n=t&&t.skipPreflight,i=!0===n?"processed":t&&t.preflightCommitment||this.commitment;t&&null!=t.maxRetries&&(r.maxRetries=t.maxRetries),t&&null!=t.minContextSlot&&(r.minContextSlot=t.minContextSlot),n&&(r.skipPreflight=n),i&&(r.preflightCommitment=i);const o=[e,r],s=St(await this._rpcRequest("sendTransaction",o),Ko);if("error"in s){let e;throw"data"in s.error&&(e=s.error.data.logs),new An({action:n?"send":"simulate",signature:"",transactionMessage:s.error.message,logs:e})}return s.result}_wsOnOpen(){this._rpcWebSocketConnected=!0,this._rpcWebSocketHeartbeat=setInterval((()=>{(async()=>{try{await this._rpcWebSocket.notify("ping")}catch{}})()}),5e3),this._updateSubscriptions()}_wsOnError(e){this._rpcWebSocketConnected=!1,console.error("ws error:",e.message)}_wsOnClose(e){this._rpcWebSocketConnected=!1,this._rpcWebSocketGeneration=(this._rpcWebSocketGeneration+1)%Number.MAX_SAFE_INTEGER,this._rpcWebSocketIdleTimeout&&(clearTimeout(this._rpcWebSocketIdleTimeout),this._rpcWebSocketIdleTimeout=null),this._rpcWebSocketHeartbeat&&(clearInterval(this._rpcWebSocketHeartbeat),this._rpcWebSocketHeartbeat=null),1e3!==e?(this._subscriptionCallbacksByServerSubscriptionId={},Object.entries(this._subscriptionsByHash).forEach((([e,t])=>{this._setSubscription(e,{...t,state:"pending"})}))):this._updateSubscriptions()}_setSubscription(e,t){const r=this._subscriptionsByHash[e]?.state;if(this._subscriptionsByHash[e]=t,r!==t.state){const r=this._subscriptionStateChangeCallbacksByHash[e];r&&r.forEach((e=>{try{e(t.state)}catch{}}))}}_onSubscriptionStateChange(e,t){const r=this._subscriptionHashByClientSubscriptionId[e];if(null==r)return()=>{};const n=this._subscriptionStateChangeCallbacksByHash[r]||=new Set;return n.add(t),()=>{n.delete(t),0===n.size&&delete this._subscriptionStateChangeCallbacksByHash[r]}}async _updateSubscriptions(){if(0===Object.keys(this._subscriptionsByHash).length)return void(this._rpcWebSocketConnected&&(this._rpcWebSocketConnected=!1,this._rpcWebSocketIdleTimeout=setTimeout((()=>{this._rpcWebSocketIdleTimeout=null;try{this._rpcWebSocket.close()}catch(e){e instanceof Error&&console.log(`Error when closing socket connection: ${e.message}`)}}),500)));if(null!==this._rpcWebSocketIdleTimeout&&(clearTimeout(this._rpcWebSocketIdleTimeout),this._rpcWebSocketIdleTimeout=null,this._rpcWebSocketConnected=!0),!this._rpcWebSocketConnected)return void this._rpcWebSocket.connect();const e=this._rpcWebSocketGeneration,t=()=>e===this._rpcWebSocketGeneration;await Promise.all(Object.keys(this._subscriptionsByHash).map((async e=>{const r=this._subscriptionsByHash[e];if(void 0!==r)switch(r.state){case"pending":case"unsubscribed":if(0===r.callbacks.size)return delete this._subscriptionsByHash[e],"unsubscribed"===r.state&&delete this._subscriptionCallbacksByServerSubscriptionId[r.serverSubscriptionId],void await this._updateSubscriptions();await(async()=>{const{args:n,method:i}=r;try{this._setSubscription(e,{...r,state:"subscribing"});const t=await this._rpcWebSocket.call(i,n);this._setSubscription(e,{...r,serverSubscriptionId:t,state:"subscribed"}),this._subscriptionCallbacksByServerSubscriptionId[t]=r.callbacks,await this._updateSubscriptions()}catch(o){if(console.error(`Received ${o instanceof Error?"":"JSON-RPC "}error calling \`${i}\``,{args:n,error:o}),!t())return;this._setSubscription(e,{...r,state:"pending"}),await this._updateSubscriptions()}})();break;case"subscribed":0===r.callbacks.size&&await(async()=>{const{serverSubscriptionId:n,unsubscribeMethod:i}=r;if(this._subscriptionsAutoDisposedByRpc.has(n))this._subscriptionsAutoDisposedByRpc.delete(n);else{this._setSubscription(e,{...r,state:"unsubscribing"}),this._setSubscription(e,{...r,state:"unsubscribing"});try{await this._rpcWebSocket.call(i,[n])}catch(n){if(n instanceof Error&&console.error(`${i} error:`,n.message),!t())return;return this._setSubscription(e,{...r,state:"subscribed"}),void await this._updateSubscriptions()}}this._setSubscription(e,{...r,state:"unsubscribed"}),await this._updateSubscriptions()})()}})))}_handleServerNotification(e,t){const r=this._subscriptionCallbacksByServerSubscriptionId[e];void 0!==r&&r.forEach((e=>{try{e(...t)}catch(e){console.error(e)}}))}_wsOnAccountNotification(e){const{result:t,subscription:r}=St(e,Xi);this._handleServerNotification(r,[t.value,t.context])}_makeSubscription(e,t){const r=this._nextClientSubscriptionId++,n=Gn([e.method,t]),i=this._subscriptionsByHash[n];return void 0===i?this._subscriptionsByHash[n]={...e,args:t,callbacks:new Set([e.callback]),state:"pending"}:i.callbacks.add(e.callback),this._subscriptionHashByClientSubscriptionId[r]=n,this._subscriptionDisposeFunctionsByClientSubscriptionId[r]=async()=>{delete this._subscriptionDisposeFunctionsByClientSubscriptionId[r],delete this._subscriptionHashByClientSubscriptionId[r];const t=this._subscriptionsByHash[n];tn(void 0!==t,`Could not find a \`Subscription\` when tearing down client subscription #${r}`),t.callbacks.delete(e.callback),await this._updateSubscriptions()},this._updateSubscriptions(),r}onAccountChange(e,t,r){const{commitment:n,config:i}=si(r),o=this._buildArgs([e.toBase58()],n||this._commitment||"finalized","base64",i);return this._makeSubscription({callback:t,method:"accountSubscribe",unsubscribeMethod:"accountUnsubscribe"},o)}async removeAccountChangeListener(e){await this._unsubscribeClientSubscription(e,"account change")}_wsOnProgramAccountNotification(e){const{result:t,subscription:r}=St(e,Qi);this._handleServerNotification(r,[{accountId:t.value.pubkey,accountInfo:t.value.account},t.context])}onProgramAccountChange(e,t,r,n){const{commitment:i,config:o}=si(r),s=this._buildArgs([e.toBase58()],i||this._commitment||"finalized","base64",o||(n?{filters:ai(n)}:void 0));return this._makeSubscription({callback:t,method:"programSubscribe",unsubscribeMethod:"programUnsubscribe"},s)}async removeProgramAccountChangeListener(e){await this._unsubscribeClientSubscription(e,"program account change")}onLogs(e,t,r){const n=this._buildArgs(["object"==typeof e?{mentions:[e.toString()]}:e],r||this._commitment||"finalized");return this._makeSubscription({callback:t,method:"logsSubscribe",unsubscribeMethod:"logsUnsubscribe"},n)}async removeOnLogsListener(e){await this._unsubscribeClientSubscription(e,"logs")}_wsOnLogsNotification(e){const{result:t,subscription:r}=St(e,Wo);this._handleServerNotification(r,[t.value,t.context])}_wsOnSlotNotification(e){const{result:t,subscription:r}=St(e,to);this._handleServerNotification(r,[t])}onSlotChange(e){return this._makeSubscription({callback:e,method:"slotSubscribe",unsubscribeMethod:"slotUnsubscribe"},[])}async removeSlotChangeListener(e){await this._unsubscribeClientSubscription(e,"slot change")}_wsOnSlotUpdatesNotification(e){const{result:t,subscription:r}=St(e,no);this._handleServerNotification(r,[t])}onSlotUpdate(e){return this._makeSubscription({callback:e,method:"slotsUpdatesSubscribe",unsubscribeMethod:"slotsUpdatesUnsubscribe"},[])}async removeSlotUpdateListener(e){await this._unsubscribeClientSubscription(e,"slot update")}async _unsubscribeClientSubscription(e,t){const r=this._subscriptionDisposeFunctionsByClientSubscriptionId[e];r?await r():console.warn(`Ignored unsubscribe request because an active subscription with id \`${e}\` for '${t}' events could not be found.`)}_buildArgs(e,t,r,n){const i=t||this._commitment;if(i||r||n){let t={};r&&(t.encoding=r),i&&(t.commitment=i),n&&(t=Object.assign(t,n)),e.push(t)}return e}_buildArgsAtLeastConfirmed(e,t,r,n){const i=t||this._commitment;if(i&&!["confirmed","finalized"].includes(i))throw new Error("Using Connection with default commitment: `"+this._commitment+"`, but method requires at least `confirmed`");return this._buildArgs(e,t,r,n)}_wsOnSignatureNotification(e){const{result:t,subscription:r}=St(e,io);"receivedSignature"!==t.value&&this._subscriptionsAutoDisposedByRpc.add(r),this._handleServerNotification(r,"receivedSignature"===t.value?[{type:"received"},t.context]:[{type:"status",result:t.value},t.context])}onSignature(e,t,r){const n=this._buildArgs([e],r||this._commitment||"finalized"),i=this._makeSubscription({callback:(e,r)=>{if("status"===e.type){t(e.result,r);try{this.removeSignatureListener(i)}catch(e){}}},method:"signatureSubscribe",unsubscribeMethod:"signatureUnsubscribe"},n);return i}onSignatureWithOptions(e,t,r){const{commitment:n,...i}={...r,commitment:r&&r.commitment||this._commitment||"finalized"},o=this._buildArgs([e],n,void 0,i),s=this._makeSubscription({callback:(e,r)=>{t(e,r);try{this.removeSignatureListener(s)}catch(e){}},method:"signatureSubscribe",unsubscribeMethod:"signatureUnsubscribe"},o);return s}async removeSignatureListener(e){await this._unsubscribeClientSubscription(e,"signature result")}_wsOnRootNotification(e){const{result:t,subscription:r}=St(e,oo);this._handleServerNotification(r,[t])}onRootChange(e){return this._makeSubscription({callback:e,method:"rootSubscribe",unsubscribeMethod:"rootUnsubscribe"},[])}async removeRootChangeListener(e){await this._unsubscribeClientSubscription(e,"root change")}}class Go{constructor(e){this._keypair=void 0,this._keypair=e??kr()}static generate(){return new Go(kr())}static fromSecretKey(e,t){if(64!==e.byteLength)throw new Error("bad secret key size");const r=e.slice(32,64);if(!t||!t.skipValidation){const t=e.slice(0,32),n=xr(t);for(let e=0;e<32;e++)if(r[e]!==n[e])throw new Error("provided secretKey is invalid")}return new Go({publicKey:r,secretKey:e})}static fromSeed(e){const t=xr(e),r=new Uint8Array(64);return r.set(e),r.set(t,32),new Go({publicKey:t,secretKey:r})}get publicKey(){return new jr(this._keypair.publicKey)}get secretKey(){return new Uint8Array(this._keypair.secretKey)}}const Yo=Object.freeze({CreateLookupTable:{index:0,layout:ht.w3([ht.DH("instruction"),Ln("recentSlot"),ht.u8("bumpSeed")])},FreezeLookupTable:{index:1,layout:ht.w3([ht.DH("instruction")])},ExtendLookupTable:{index:2,layout:ht.w3([ht.DH("instruction"),Ln(),ht.O6(Yr(),ht.cY(ht.DH(),-8),"addresses")])},DeactivateLookupTable:{index:3,layout:ht.w3([ht.DH("instruction")])},CloseLookupTable:{index:4,layout:ht.w3([ht.DH("instruction")])}});class Jo{constructor(){}static decodeInstructionType(e){this.checkProgramId(e.programId);const t=ht.DH("instruction").decode(e.data);let r;for(const[e,n]of Object.entries(Yo))if(n.index==t){r=e;break}if(!r)throw new Error("Invalid Instruction. Should be a LookupTable Instruction");return r}static decodeCreateLookupTable(e){this.checkProgramId(e.programId),this.checkKeysLength(e.keys,4);const{recentSlot:t}=Tn(Yo.CreateLookupTable,e.data);return{authority:e.keys[1].pubkey,payer:e.keys[2].pubkey,recentSlot:Number(t)}}static decodeExtendLookupTable(e){if(this.checkProgramId(e.programId),e.keys.length<2)throw new Error(`invalid instruction; found ${e.keys.length} keys, expected at least 2`);const{addresses:t}=Tn(Yo.ExtendLookupTable,e.data);return{lookupTable:e.keys[0].pubkey,authority:e.keys[1].pubkey,payer:e.keys.length>2?e.keys[2].pubkey:void 0,addresses:t.map((e=>new jr(e)))}}static decodeCloseLookupTable(e){return this.checkProgramId(e.programId),this.checkKeysLength(e.keys,3),{lookupTable:e.keys[0].pubkey,authority:e.keys[1].pubkey,recipient:e.keys[2].pubkey}}static decodeFreezeLookupTable(e){return this.checkProgramId(e.programId),this.checkKeysLength(e.keys,2),{lookupTable:e.keys[0].pubkey,authority:e.keys[1].pubkey}}static decodeDeactivateLookupTable(e){return this.checkProgramId(e.programId),this.checkKeysLength(e.keys,2),{lookupTable:e.keys[0].pubkey,authority:e.keys[1].pubkey}}static checkProgramId(e){if(!e.equals(Xo.programId))throw new Error("invalid instruction; programId is not AddressLookupTable Program")}static checkKeysLength(e,t){if(e.length<t)throw new Error(`invalid instruction; found ${e.length} keys, expected at least ${t}`)}}class Xo{constructor(){}static createLookupTable(e){const[t,r]=jr.findProgramAddressSync([e.authority.toBuffer(),(0,lt.Bq)(BigInt(e.recentSlot),8)],this.programId),n=Rn(Yo.CreateLookupTable,{recentSlot:BigInt(e.recentSlot),bumpSeed:r}),i=[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:e.authority,isSigner:!0,isWritable:!1},{pubkey:e.payer,isSigner:!0,isWritable:!0},{pubkey:jn.programId,isSigner:!1,isWritable:!1}];return[new dn({programId:this.programId,keys:i,data:n}),t]}static freezeLookupTable(e){const t=Rn(Yo.FreezeLookupTable),r=[{pubkey:e.lookupTable,isSigner:!1,isWritable:!0},{pubkey:e.authority,isSigner:!0,isWritable:!1}];return new dn({programId:this.programId,keys:r,data:t})}static extendLookupTable(e){const t=Rn(Yo.ExtendLookupTable,{addresses:e.addresses.map((e=>e.toBytes()))}),r=[{pubkey:e.lookupTable,isSigner:!1,isWritable:!0},{pubkey:e.authority,isSigner:!0,isWritable:!1}];return e.payer&&r.push({pubkey:e.payer,isSigner:!0,isWritable:!0},{pubkey:jn.programId,isSigner:!1,isWritable:!1}),new dn({programId:this.programId,keys:r,data:t})}static deactivateLookupTable(e){const t=Rn(Yo.DeactivateLookupTable),r=[{pubkey:e.lookupTable,isSigner:!1,isWritable:!0},{pubkey:e.authority,isSigner:!0,isWritable:!1}];return new dn({programId:this.programId,keys:r,data:t})}static closeLookupTable(e){const t=Rn(Yo.CloseLookupTable),r=[{pubkey:e.lookupTable,isSigner:!1,isWritable:!0},{pubkey:e.authority,isSigner:!0,isWritable:!1},{pubkey:e.recipient,isSigner:!1,isWritable:!0}];return new dn({programId:this.programId,keys:r,data:t})}}Xo.programId=new jr("AddressLookupTab1e1111111111111111111111111");class Zo{constructor(){}static decodeInstructionType(e){this.checkProgramId(e.programId);const t=ht.u8("instruction").decode(e.data);let r;for(const[e,n]of Object.entries(Qo))if(n.index==t){r=e;break}if(!r)throw new Error("Instruction type incorrect; not a ComputeBudgetInstruction");return r}static decodeRequestUnits(e){this.checkProgramId(e.programId);const{units:t,additionalFee:r}=Tn(Qo.RequestUnits,e.data);return{units:t,additionalFee:r}}static decodeRequestHeapFrame(e){this.checkProgramId(e.programId);const{bytes:t}=Tn(Qo.RequestHeapFrame,e.data);return{bytes:t}}static decodeSetComputeUnitLimit(e){this.checkProgramId(e.programId);const{units:t}=Tn(Qo.SetComputeUnitLimit,e.data);return{units:t}}static decodeSetComputeUnitPrice(e){this.checkProgramId(e.programId);const{microLamports:t}=Tn(Qo.SetComputeUnitPrice,e.data);return{microLamports:t}}static checkProgramId(e){if(!e.equals(es.programId))throw new Error("invalid instruction; programId is not ComputeBudgetProgram")}}const Qo=Object.freeze({RequestUnits:{index:0,layout:ht.w3([ht.u8("instruction"),ht.DH("units"),ht.DH("additionalFee")])},RequestHeapFrame:{index:1,layout:ht.w3([ht.u8("instruction"),ht.DH("bytes")])},SetComputeUnitLimit:{index:2,layout:ht.w3([ht.u8("instruction"),ht.DH("units")])},SetComputeUnitPrice:{index:3,layout:ht.w3([ht.u8("instruction"),Ln("microLamports")])}});class es{constructor(){}static requestUnits(e){const t=Rn(Qo.RequestUnits,e);return new dn({keys:[],programId:this.programId,data:t})}static requestHeapFrame(e){const t=Rn(Qo.RequestHeapFrame,e);return new dn({keys:[],programId:this.programId,data:t})}static setComputeUnitLimit(e){const t=Rn(Qo.SetComputeUnitLimit,e);return new dn({keys:[],programId:this.programId,data:t})}static setComputeUnitPrice(e){const t=Rn(Qo.SetComputeUnitPrice,{microLamports:BigInt(e.microLamports)});return new dn({keys:[],programId:this.programId,data:t})}}es.programId=new jr("ComputeBudget111111111111111111111111111111");const ts=ht.w3([ht.u8("numSignatures"),ht.u8("padding"),ht.NX("signatureOffset"),ht.NX("signatureInstructionIndex"),ht.NX("publicKeyOffset"),ht.NX("publicKeyInstructionIndex"),ht.NX("messageDataOffset"),ht.NX("messageDataSize"),ht.NX("messageInstructionIndex")]);class rs{constructor(){}static createInstructionWithPublicKey(e){const{publicKey:t,message:r,signature:n,instructionIndex:o}=e;tn(32===t.length,`Public Key must be 32 bytes but received ${t.length} bytes`),tn(64===n.length,`Signature must be 64 bytes but received ${n.length} bytes`);const s=ts.span,a=s+t.length,c=a+n.length,u=i.Buffer.alloc(c+r.length),h=null==o?65535:o;return ts.encode({numSignatures:1,padding:0,signatureOffset:a,signatureInstructionIndex:h,publicKeyOffset:s,publicKeyInstructionIndex:h,messageDataOffset:c,messageDataSize:r.length,messageInstructionIndex:h},u),u.fill(t,s),u.fill(n,a),u.fill(r,c),new dn({keys:[],programId:rs.programId,data:u})}static createInstructionWithPrivateKey(e){const{privateKey:t,message:r,instructionIndex:n}=e;tn(64===t.length,`Private key must be 64 bytes but received ${t.length} bytes`);try{const e=Go.fromSecretKey(t),i=e.publicKey.toBytes(),o=Or(r,e.secretKey);return this.createInstructionWithPublicKey({publicKey:i,message:r,signature:o,instructionIndex:n})}catch(e){throw new Error(`Error creating instruction; ${e}`)}}}rs.programId=new jr("Ed25519SigVerify111111111111111111111111111"),Ir.utils.isValidPrivateKey;const ns=Ir.getPublicKey,is=ht.w3([ht.u8("numSignatures"),ht.NX("signatureOffset"),ht.u8("signatureInstructionIndex"),ht.NX("ethAddressOffset"),ht.u8("ethAddressInstructionIndex"),ht.NX("messageDataOffset"),ht.NX("messageDataSize"),ht.u8("messageInstructionIndex"),ht.av(20,"ethAddress"),ht.av(64,"signature"),ht.u8("recoveryId")]);class os{constructor(){}static publicKeyToEthAddress(e){tn(64===e.length,`Public key must be 64 bytes but received ${e.length} bytes`);try{return i.Buffer.from(or(Tr(e))).slice(-20)}catch(e){throw new Error(`Error constructing Ethereum address: ${e}`)}}static createInstructionWithPublicKey(e){const{publicKey:t,message:r,signature:n,recoveryId:i,instructionIndex:o}=e;return os.createInstructionWithEthAddress({ethAddress:os.publicKeyToEthAddress(t),message:r,signature:n,recoveryId:i,instructionIndex:o})}static createInstructionWithEthAddress(e){const{ethAddress:t,message:r,signature:n,recoveryId:o,instructionIndex:s=0}=e;let a;a="string"==typeof t?t.startsWith("0x")?i.Buffer.from(t.substr(2),"hex"):i.Buffer.from(t,"hex"):t,tn(20===a.length,`Address must be 20 bytes but received ${a.length} bytes`);const c=12+a.length,u=c+n.length+1,h=i.Buffer.alloc(is.span+r.length);return is.encode({numSignatures:1,signatureOffset:c,signatureInstructionIndex:s,ethAddressOffset:12,ethAddressInstructionIndex:s,messageDataOffset:u,messageDataSize:r.length,messageInstructionIndex:s,signature:Tr(n),ethAddress:Tr(a),recoveryId:o},h),h.fill(Tr(r),is.span),new dn({keys:[],programId:os.programId,data:h})}static createInstructionWithPrivateKey(e){const{privateKey:t,message:r,instructionIndex:n}=e;tn(32===t.length,`Private key must be 32 bytes but received ${t.length} bytes`);try{const e=Tr(t),o=ns(e,!1).slice(1),s=i.Buffer.from(or(Tr(r))),[a,c]=((e,t)=>{const r=Ir.sign(e,t);return[r.toCompactRawBytes(),r.recovery]})(s,e);return this.createInstructionWithPublicKey({publicKey:o,message:r,signature:a,recoveryId:c,instructionIndex:n})}catch(e){throw new Error(`Error creating instruction; ${e}`)}}}var ss;os.programId=new jr("KeccakSecp256k11111111111111111111111111111");const as=new jr("StakeConfig11111111111111111111111111111111");class cs{constructor(e,t){this.staker=void 0,this.withdrawer=void 0,this.staker=e,this.withdrawer=t}}class us{constructor(e,t,r){this.unixTimestamp=void 0,this.epoch=void 0,this.custodian=void 0,this.unixTimestamp=e,this.epoch=t,this.custodian=r}}ss=us,us.default=new ss(0,0,jr.default);class hs{constructor(){}static decodeInstructionType(e){this.checkProgramId(e.programId);const t=ht.DH("instruction").decode(e.data);let r;for(const[e,n]of Object.entries(ls))if(n.index==t){r=e;break}if(!r)throw new Error("Instruction type incorrect; not a StakeInstruction");return r}static decodeInitialize(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,2);const{authorized:t,lockup:r}=Tn(ls.Initialize,e.data);return{stakePubkey:e.keys[0].pubkey,authorized:new cs(new jr(t.staker),new jr(t.withdrawer)),lockup:new us(r.unixTimestamp,r.epoch,new jr(r.custodian))}}static decodeDelegate(e){return this.checkProgramId(e.programId),this.checkKeyLength(e.keys,6),Tn(ls.Delegate,e.data),{stakePubkey:e.keys[0].pubkey,votePubkey:e.keys[1].pubkey,authorizedPubkey:e.keys[5].pubkey}}static decodeAuthorize(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,3);const{newAuthorized:t,stakeAuthorizationType:r}=Tn(ls.Authorize,e.data),n={stakePubkey:e.keys[0].pubkey,authorizedPubkey:e.keys[2].pubkey,newAuthorizedPubkey:new jr(t),stakeAuthorizationType:{index:r}};return e.keys.length>3&&(n.custodianPubkey=e.keys[3].pubkey),n}static decodeAuthorizeWithSeed(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,2);const{newAuthorized:t,stakeAuthorizationType:r,authoritySeed:n,authorityOwner:i}=Tn(ls.AuthorizeWithSeed,e.data),o={stakePubkey:e.keys[0].pubkey,authorityBase:e.keys[1].pubkey,authoritySeed:n,authorityOwner:new jr(i),newAuthorizedPubkey:new jr(t),stakeAuthorizationType:{index:r}};return e.keys.length>3&&(o.custodianPubkey=e.keys[3].pubkey),o}static decodeSplit(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,3);const{lamports:t}=Tn(ls.Split,e.data);return{stakePubkey:e.keys[0].pubkey,splitStakePubkey:e.keys[1].pubkey,authorizedPubkey:e.keys[2].pubkey,lamports:t}}static decodeMerge(e){return this.checkProgramId(e.programId),this.checkKeyLength(e.keys,3),Tn(ls.Merge,e.data),{stakePubkey:e.keys[0].pubkey,sourceStakePubKey:e.keys[1].pubkey,authorizedPubkey:e.keys[4].pubkey}}static decodeWithdraw(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,5);const{lamports:t}=Tn(ls.Withdraw,e.data),r={stakePubkey:e.keys[0].pubkey,toPubkey:e.keys[1].pubkey,authorizedPubkey:e.keys[4].pubkey,lamports:t};return e.keys.length>5&&(r.custodianPubkey=e.keys[5].pubkey),r}static decodeDeactivate(e){return this.checkProgramId(e.programId),this.checkKeyLength(e.keys,3),Tn(ls.Deactivate,e.data),{stakePubkey:e.keys[0].pubkey,authorizedPubkey:e.keys[2].pubkey}}static checkProgramId(e){if(!e.equals(fs.programId))throw new Error("invalid instruction; programId is not StakeProgram")}static checkKeyLength(e,t){if(e.length<t)throw new Error(`invalid instruction; found ${e.length} keys, expected at least ${t}`)}}const ls=Object.freeze({Initialize:{index:0,layout:ht.w3([ht.DH("instruction"),((e="authorized")=>ht.w3([Yr("staker"),Yr("withdrawer")],e))(),((e="lockup")=>ht.w3([ht.Wg("unixTimestamp"),ht.Wg("epoch"),Yr("custodian")],e))()])},Authorize:{index:1,layout:ht.w3([ht.DH("instruction"),Yr("newAuthorized"),ht.DH("stakeAuthorizationType")])},Delegate:{index:2,layout:ht.w3([ht.DH("instruction")])},Split:{index:3,layout:ht.w3([ht.DH("instruction"),ht.Wg("lamports")])},Withdraw:{index:4,layout:ht.w3([ht.DH("instruction"),ht.Wg("lamports")])},Deactivate:{index:5,layout:ht.w3([ht.DH("instruction")])},Merge:{index:7,layout:ht.w3([ht.DH("instruction")])},AuthorizeWithSeed:{index:8,layout:ht.w3([ht.DH("instruction"),Yr("newAuthorized"),ht.DH("stakeAuthorizationType"),Xr("authoritySeed"),Yr("authorityOwner")])}}),ds=Object.freeze({Staker:{index:0},Withdrawer:{index:1}});class fs{constructor(){}static initialize(e){const{stakePubkey:t,authorized:r,lockup:n}=e,i=n||us.default,o=Rn(ls.Initialize,{authorized:{staker:Tr(r.staker.toBuffer()),withdrawer:Tr(r.withdrawer.toBuffer())},lockup:{unixTimestamp:i.unixTimestamp,epoch:i.epoch,custodian:Tr(i.custodian.toBuffer())}}),s={keys:[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:vn,isSigner:!1,isWritable:!1}],programId:this.programId,data:o};return new dn(s)}static createAccountWithSeed(e){const t=new fn;t.add(jn.createAccountWithSeed({fromPubkey:e.fromPubkey,newAccountPubkey:e.stakePubkey,basePubkey:e.basePubkey,seed:e.seed,lamports:e.lamports,space:this.space,programId:this.programId}));const{stakePubkey:r,authorized:n,lockup:i}=e;return t.add(this.initialize({stakePubkey:r,authorized:n,lockup:i}))}static createAccount(e){const t=new fn;t.add(jn.createAccount({fromPubkey:e.fromPubkey,newAccountPubkey:e.stakePubkey,lamports:e.lamports,space:this.space,programId:this.programId}));const{stakePubkey:r,authorized:n,lockup:i}=e;return t.add(this.initialize({stakePubkey:r,authorized:n,lockup:i}))}static delegate(e){const{stakePubkey:t,authorizedPubkey:r,votePubkey:n}=e,i=Rn(ls.Delegate);return(new fn).add({keys:[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!1,isWritable:!1},{pubkey:yn,isSigner:!1,isWritable:!1},{pubkey:In,isSigner:!1,isWritable:!1},{pubkey:as,isSigner:!1,isWritable:!1},{pubkey:r,isSigner:!0,isWritable:!1}],programId:this.programId,data:i})}static authorize(e){const{stakePubkey:t,authorizedPubkey:r,newAuthorizedPubkey:n,stakeAuthorizationType:i,custodianPubkey:o}=e,s=Rn(ls.Authorize,{newAuthorized:Tr(n.toBuffer()),stakeAuthorizationType:i.index}),a=[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:yn,isSigner:!1,isWritable:!0},{pubkey:r,isSigner:!0,isWritable:!1}];return o&&a.push({pubkey:o,isSigner:!0,isWritable:!1}),(new fn).add({keys:a,programId:this.programId,data:s})}static authorizeWithSeed(e){const{stakePubkey:t,authorityBase:r,authoritySeed:n,authorityOwner:i,newAuthorizedPubkey:o,stakeAuthorizationType:s,custodianPubkey:a}=e,c=Rn(ls.AuthorizeWithSeed,{newAuthorized:Tr(o.toBuffer()),stakeAuthorizationType:s.index,authoritySeed:n,authorityOwner:Tr(i.toBuffer())}),u=[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:r,isSigner:!0,isWritable:!1},{pubkey:yn,isSigner:!1,isWritable:!1}];return a&&u.push({pubkey:a,isSigner:!0,isWritable:!1}),(new fn).add({keys:u,programId:this.programId,data:c})}static splitInstruction(e){const{stakePubkey:t,authorizedPubkey:r,splitStakePubkey:n,lamports:i}=e,o=Rn(ls.Split,{lamports:i});return new dn({keys:[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!1,isWritable:!0},{pubkey:r,isSigner:!0,isWritable:!1}],programId:this.programId,data:o})}static split(e,t){const r=new fn;return r.add(jn.createAccount({fromPubkey:e.authorizedPubkey,newAccountPubkey:e.splitStakePubkey,lamports:t,space:this.space,programId:this.programId})),r.add(this.splitInstruction(e))}static splitWithSeed(e,t){const{stakePubkey:r,authorizedPubkey:n,splitStakePubkey:i,basePubkey:o,seed:s,lamports:a}=e,c=new fn;return c.add(jn.allocate({accountPubkey:i,basePubkey:o,seed:s,space:this.space,programId:this.programId})),t&&t>0&&c.add(jn.transfer({fromPubkey:e.authorizedPubkey,toPubkey:i,lamports:t})),c.add(this.splitInstruction({stakePubkey:r,authorizedPubkey:n,splitStakePubkey:i,lamports:a}))}static merge(e){const{stakePubkey:t,sourceStakePubKey:r,authorizedPubkey:n}=e,i=Rn(ls.Merge);return(new fn).add({keys:[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:r,isSigner:!1,isWritable:!0},{pubkey:yn,isSigner:!1,isWritable:!1},{pubkey:In,isSigner:!1,isWritable:!1},{pubkey:n,isSigner:!0,isWritable:!1}],programId:this.programId,data:i})}static withdraw(e){const{stakePubkey:t,authorizedPubkey:r,toPubkey:n,lamports:i,custodianPubkey:o}=e,s=Rn(ls.Withdraw,{lamports:i}),a=[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!1,isWritable:!0},{pubkey:yn,isSigner:!1,isWritable:!1},{pubkey:In,isSigner:!1,isWritable:!1},{pubkey:r,isSigner:!0,isWritable:!1}];return o&&a.push({pubkey:o,isSigner:!0,isWritable:!1}),(new fn).add({keys:a,programId:this.programId,data:s})}static deactivate(e){const{stakePubkey:t,authorizedPubkey:r}=e,n=Rn(ls.Deactivate);return(new fn).add({keys:[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:yn,isSigner:!1,isWritable:!1},{pubkey:r,isSigner:!0,isWritable:!1}],programId:this.programId,data:n})}}fs.programId=new jr("Stake11111111111111111111111111111111111111"),fs.space=200;class ps{constructor(e,t,r,n){this.nodePubkey=void 0,this.authorizedVoter=void 0,this.authorizedWithdrawer=void 0,this.commission=void 0,this.nodePubkey=e,this.authorizedVoter=t,this.authorizedWithdrawer=r,this.commission=n}}class gs{constructor(){}static decodeInstructionType(e){this.checkProgramId(e.programId);const t=ht.DH("instruction").decode(e.data);let r;for(const[e,n]of Object.entries(ys))if(n.index==t){r=e;break}if(!r)throw new Error("Instruction type incorrect; not a VoteInstruction");return r}static decodeInitializeAccount(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,4);const{voteInit:t}=Tn(ys.InitializeAccount,e.data);return{votePubkey:e.keys[0].pubkey,nodePubkey:e.keys[3].pubkey,voteInit:new ps(new jr(t.nodePubkey),new jr(t.authorizedVoter),new jr(t.authorizedWithdrawer),t.commission)}}static decodeAuthorize(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,3);const{newAuthorized:t,voteAuthorizationType:r}=Tn(ys.Authorize,e.data);return{votePubkey:e.keys[0].pubkey,authorizedPubkey:e.keys[2].pubkey,newAuthorizedPubkey:new jr(t),voteAuthorizationType:{index:r}}}static decodeAuthorizeWithSeed(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,3);const{voteAuthorizeWithSeedArgs:{currentAuthorityDerivedKeyOwnerPubkey:t,currentAuthorityDerivedKeySeed:r,newAuthorized:n,voteAuthorizationType:i}}=Tn(ys.AuthorizeWithSeed,e.data);return{currentAuthorityDerivedKeyBasePubkey:e.keys[2].pubkey,currentAuthorityDerivedKeyOwnerPubkey:new jr(t),currentAuthorityDerivedKeySeed:r,newAuthorizedPubkey:new jr(n),voteAuthorizationType:{index:i},votePubkey:e.keys[0].pubkey}}static decodeWithdraw(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,3);const{lamports:t}=Tn(ys.Withdraw,e.data);return{votePubkey:e.keys[0].pubkey,authorizedWithdrawerPubkey:e.keys[2].pubkey,lamports:t,toPubkey:e.keys[1].pubkey}}static checkProgramId(e){if(!e.equals(ms.programId))throw new Error("invalid instruction; programId is not VoteProgram")}static checkKeyLength(e,t){if(e.length<t)throw new Error(`invalid instruction; found ${e.length} keys, expected at least ${t}`)}}const ys=Object.freeze({InitializeAccount:{index:0,layout:ht.w3([ht.DH("instruction"),((e="voteInit")=>ht.w3([Yr("nodePubkey"),Yr("authorizedVoter"),Yr("authorizedWithdrawer"),ht.u8("commission")],e))()])},Authorize:{index:1,layout:ht.w3([ht.DH("instruction"),Yr("newAuthorized"),ht.DH("voteAuthorizationType")])},Withdraw:{index:3,layout:ht.w3([ht.DH("instruction"),ht.Wg("lamports")])},UpdateValidatorIdentity:{index:4,layout:ht.w3([ht.DH("instruction")])},AuthorizeWithSeed:{index:10,layout:ht.w3([ht.DH("instruction"),((e="voteAuthorizeWithSeedArgs")=>ht.w3([ht.DH("voteAuthorizationType"),Yr("currentAuthorityDerivedKeyOwnerPubkey"),Xr("currentAuthorityDerivedKeySeed"),Yr("newAuthorized")],e))()])}}),bs=Object.freeze({Voter:{index:0},Withdrawer:{index:1}});class ms{constructor(){}static initializeAccount(e){const{votePubkey:t,nodePubkey:r,voteInit:n}=e,i=Rn(ys.InitializeAccount,{voteInit:{nodePubkey:Tr(n.nodePubkey.toBuffer()),authorizedVoter:Tr(n.authorizedVoter.toBuffer()),authorizedWithdrawer:Tr(n.authorizedWithdrawer.toBuffer()),commission:n.commission}}),o={keys:[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:vn,isSigner:!1,isWritable:!1},{pubkey:yn,isSigner:!1,isWritable:!1},{pubkey:r,isSigner:!0,isWritable:!1}],programId:this.programId,data:i};return new dn(o)}static createAccount(e){const t=new fn;return t.add(jn.createAccount({fromPubkey:e.fromPubkey,newAccountPubkey:e.votePubkey,lamports:e.lamports,space:this.space,programId:this.programId})),t.add(this.initializeAccount({votePubkey:e.votePubkey,nodePubkey:e.voteInit.nodePubkey,voteInit:e.voteInit}))}static authorize(e){const{votePubkey:t,authorizedPubkey:r,newAuthorizedPubkey:n,voteAuthorizationType:i}=e,o=Rn(ys.Authorize,{newAuthorized:Tr(n.toBuffer()),voteAuthorizationType:i.index}),s=[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:yn,isSigner:!1,isWritable:!1},{pubkey:r,isSigner:!0,isWritable:!1}];return(new fn).add({keys:s,programId:this.programId,data:o})}static authorizeWithSeed(e){const{currentAuthorityDerivedKeyBasePubkey:t,currentAuthorityDerivedKeyOwnerPubkey:r,currentAuthorityDerivedKeySeed:n,newAuthorizedPubkey:i,voteAuthorizationType:o,votePubkey:s}=e,a=Rn(ys.AuthorizeWithSeed,{voteAuthorizeWithSeedArgs:{currentAuthorityDerivedKeyOwnerPubkey:Tr(r.toBuffer()),currentAuthorityDerivedKeySeed:n,newAuthorized:Tr(i.toBuffer()),voteAuthorizationType:o.index}}),c=[{pubkey:s,isSigner:!1,isWritable:!0},{pubkey:yn,isSigner:!1,isWritable:!1},{pubkey:t,isSigner:!0,isWritable:!1}];return(new fn).add({keys:c,programId:this.programId,data:a})}static withdraw(e){const{votePubkey:t,authorizedWithdrawerPubkey:r,lamports:n,toPubkey:i}=e,o=Rn(ys.Withdraw,{lamports:n}),s=[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:i,isSigner:!1,isWritable:!0},{pubkey:r,isSigner:!0,isWritable:!1}];return(new fn).add({keys:s,programId:this.programId,data:o})}static safeWithdraw(e,t,r){if(e.lamports>t-r)throw new Error("Withdraw will leave vote account with insufficient funds.");return ms.withdraw(e)}static updateValidatorIdentity(e){const{votePubkey:t,authorizedWithdrawerPubkey:r,nodePubkey:n}=e,i=Rn(ys.UpdateValidatorIdentity),o=[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!0,isWritable:!1},{pubkey:r,isSigner:!0,isWritable:!1}];return(new fn).add({keys:o,programId:this.programId,data:i})}}ms.programId=new jr("Vote111111111111111111111111111111111111111"),ms.space=3762;const ws=new jr("Va1idator1nfo111111111111111111111111111111"),vs=Bt({name:Mt(),website:Tt(Mt()),details:Tt(Mt()),iconUrl:Tt(Mt()),keybaseUsername:Tt(Mt())});class Ss{constructor(e,t){this.key=void 0,this.info=void 0,this.key=e,this.info=t}static fromConfigData(e){let t=[...e];if(2!==Qr(t))return null;const r=[];for(let e=0;e<2;e++){const e=new jr(sn(t,0,Ur)),n=1===on(t);r.push({publicKey:e,isSigner:n})}if(r[0].publicKey.equals(ws)&&r[1].isSigner){const e=Xr().decode(i.Buffer.from(t)),n=JSON.parse(e);return vt(n,vs),new Ss(r[1].publicKey,n)}return null}}const _s=new jr("Vote111111111111111111111111111111111111111"),Es=ht.w3([Yr("nodePubkey"),Yr("authorizedWithdrawer"),ht.u8("commission"),ht.I0(),ht.O6(ht.w3([ht.I0("slot"),ht.DH("confirmationCount")]),ht.cY(ht.DH(),-8),"votes"),ht.u8("rootSlotValid"),ht.I0("rootSlot"),ht.I0(),ht.O6(ht.w3([ht.I0("epoch"),Yr("authorizedVoter")]),ht.cY(ht.DH(),-8),"authorizedVoters"),ht.w3([ht.O6(ht.w3([Yr("authorizedPubkey"),ht.I0("epochOfLastAuthorizedSwitch"),ht.I0("targetEpoch")]),32,"buf"),ht.I0("idx"),ht.u8("isEmpty")],"priorVoters"),ht.I0(),ht.O6(ht.w3([ht.I0("epoch"),ht.I0("credits"),ht.I0("prevCredits")]),ht.cY(ht.DH(),-8),"epochCredits"),ht.w3([ht.I0("slot"),ht.I0("timestamp")],"lastTimestamp")]);class Is{constructor(e){this.nodePubkey=void 0,this.authorizedWithdrawer=void 0,this.commission=void 0,this.rootSlot=void 0,this.votes=void 0,this.authorizedVoters=void 0,this.priorVoters=void 0,this.epochCredits=void 0,this.lastTimestamp=void 0,this.nodePubkey=e.nodePubkey,this.authorizedWithdrawer=e.authorizedWithdrawer,this.commission=e.commission,this.rootSlot=e.rootSlot,this.votes=e.votes,this.authorizedVoters=e.authorizedVoters,this.priorVoters=e.priorVoters,this.epochCredits=e.epochCredits,this.lastTimestamp=e.lastTimestamp}static fromAccountData(e){const t=Es.decode(Tr(e),4);let r=t.rootSlot;return t.rootSlotValid||(r=null),new Is({nodePubkey:new jr(t.nodePubkey),authorizedWithdrawer:new jr(t.authorizedWithdrawer),commission:t.commission,votes:t.votes,rootSlot:r,authorizedVoters:t.authorizedVoters.map(As),priorVoters:xs(t.priorVoters),epochCredits:t.epochCredits,lastTimestamp:t.lastTimestamp})}}function As({authorizedVoter:e,epoch:t}){return{epoch:t,authorizedVoter:new jr(e)}}function ks({authorizedPubkey:e,epochOfLastAuthorizedSwitch:t,targetEpoch:r}){return{authorizedPubkey:new jr(e),epochOfLastAuthorizedSwitch:t,targetEpoch:r}}function xs({buf:e,idx:t,isEmpty:r}){return r?[]:[...e.slice(t+1).map(ks),...e.slice(0,t).map(ks)]}const Ps={http:{devnet:"http://api.devnet.solana.com",testnet:"http://api.testnet.solana.com","mainnet-beta":"http://api.mainnet-beta.solana.com/"},https:{devnet:"https://api.devnet.solana.com",testnet:"https://api.testnet.solana.com","mainnet-beta":"https://api.mainnet-beta.solana.com/"}};function Os(e,t){const r=!1===t?"http":"https";if(!e)return Ps[r].devnet;const n=Ps[r][e];if(!n)throw new Error(`Unknown ${r} cluster: ${e}`);return n}async function Rs(e,t,r,n){let i,o;r&&Object.prototype.hasOwnProperty.call(r,"lastValidBlockHeight")||r&&Object.prototype.hasOwnProperty.call(r,"nonceValue")?(i=r,o=n):o=r;const s=o&&{skipPreflight:o.skipPreflight,preflightCommitment:o.preflightCommitment||o.commitment,minContextSlot:o.minContextSlot},a=await e.sendRawTransaction(t,s),c=o&&o.commitment,u=i?e.confirmTransaction(i,c):e.confirmTransaction(a,c),h=(await u).value;if(h.err){if(null!=a)throw new An({action:s?.skipPreflight?"send":"simulate",signature:a,transactionMessage:`Status: (${JSON.stringify(h)})`});throw new Error(`Raw transaction ${a} failed (${JSON.stringify(h)})`)}return a}const Ts=1e9},2112:(e,t,r)=>{var n=r(7810);e.exports=n("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz")},7399:(e,t,r)=>{"use strict";function n(){return(null===r.g||void 0===r.g?void 0:r.g.crypto)||(null===r.g||void 0===r.g?void 0:r.g.msCrypto)||{}}function i(){const e=n();return e.subtle||e.webkitSubtle}Object.defineProperty(t,"__esModule",{value:!0}),t.isBrowserCryptoAvailable=t.getSubtleCrypto=t.getBrowerCrypto=void 0,t.getBrowerCrypto=n,t.getSubtleCrypto=i,t.isBrowserCryptoAvailable=function(){return!!n()&&!!i()}},7139:(e,t,r)=>{"use strict";var n=r(3184);function i(){return"undefined"==typeof document&&"undefined"!=typeof navigator&&"ReactNative"===navigator.product}function o(){return void 0!==n&&void 0!==n.versions&&void 0!==n.versions.node}Object.defineProperty(t,"__esModule",{value:!0}),t.isBrowser=t.isNode=t.isReactNative=void 0,t.isReactNative=i,t.isNode=o,t.isBrowser=function(){return!i()&&!o()}},2552:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(2548);n.__exportStar(r(7399),t),n.__exportStar(r(7139),t)},2548:(e,t,r)=>{"use strict";r.r(t),r.d(t,{__assign:()=>o,__asyncDelegator:()=>v,__asyncGenerator:()=>w,__asyncValues:()=>S,__await:()=>m,__awaiter:()=>h,__classPrivateFieldGet:()=>A,__classPrivateFieldSet:()=>k,__createBinding:()=>d,__decorate:()=>a,__exportStar:()=>f,__extends:()=>i,__generator:()=>l,__importDefault:()=>I,__importStar:()=>E,__makeTemplateObject:()=>_,__metadata:()=>u,__param:()=>c,__read:()=>g,__rest:()=>s,__spread:()=>y,__spreadArrays:()=>b,__values:()=>p});var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},n(e,t)};function i(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var o=function(){return o=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},o.apply(this,arguments)};function s(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r}function a(e,t,r,n){var i,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,r,s):i(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s}function c(e,t){return function(r,n){t(r,n,e)}}function u(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function h(e,t,r,n){return new(r||(r=Promise))((function(i,o){function s(e){try{c(n.next(e))}catch(e){o(e)}}function a(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))}function l(e,t){var r,n,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,n=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}}function d(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}function f(e,t){for(var r in e)"default"===r||t.hasOwnProperty(r)||(t[r]=e[r])}function p(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function g(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,i,o=r.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(n=o.next()).done;)s.push(n.value)}catch(e){i={error:e}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}return s}function y(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(g(arguments[t]));return e}function b(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),i=0;for(t=0;t<r;t++)for(var o=arguments[t],s=0,a=o.length;s<a;s++,i++)n[i]=o[s];return n}function m(e){return this instanceof m?(this.v=e,this):new m(e)}function w(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,i=r.apply(e,t||[]),o=[];return n={},s("next"),s("throw"),s("return"),n[Symbol.asyncIterator]=function(){return this},n;function s(e){i[e]&&(n[e]=function(t){return new Promise((function(r,n){o.push([e,t,r,n])>1||a(e,t)}))})}function a(e,t){try{(r=i[e](t)).value instanceof m?Promise.resolve(r.value.v).then(c,u):h(o[0][2],r)}catch(e){h(o[0][3],e)}var r}function c(e){a("next",e)}function u(e){a("throw",e)}function h(e,t){e(t),o.shift(),o.length&&a(o[0][0],o[0][1])}}function v(e){var t,r;return t={},n("next"),n("throw",(function(e){throw e})),n("return"),t[Symbol.iterator]=function(){return this},t;function n(n,i){t[n]=e[n]?function(t){return(r=!r)?{value:m(e[n](t)),done:"return"===n}:i?i(t):t}:i}}function S(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=p(e),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise((function(n,i){!function(e,t,r,n){Promise.resolve(n).then((function(t){e({value:t,done:r})}),t)}(n,i,(t=e[r](t)).done,t.value)}))}}}function _(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}function E(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function I(e){return e&&e.__esModule?e:{default:e}}function A(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)}function k(e,t,r){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,r),r}},1152:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(9190);n.__exportStar(r(7274),t),n.__exportStar(r(6403),t)},7274:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ONE_THOUSAND=t.ONE_HUNDRED=void 0,t.ONE_HUNDRED=100,t.ONE_THOUSAND=1e3},6403:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ONE_YEAR=t.FOUR_WEEKS=t.THREE_WEEKS=t.TWO_WEEKS=t.ONE_WEEK=t.THIRTY_DAYS=t.SEVEN_DAYS=t.FIVE_DAYS=t.THREE_DAYS=t.ONE_DAY=t.TWENTY_FOUR_HOURS=t.TWELVE_HOURS=t.SIX_HOURS=t.THREE_HOURS=t.ONE_HOUR=t.SIXTY_MINUTES=t.THIRTY_MINUTES=t.TEN_MINUTES=t.FIVE_MINUTES=t.ONE_MINUTE=t.SIXTY_SECONDS=t.THIRTY_SECONDS=t.TEN_SECONDS=t.FIVE_SECONDS=t.ONE_SECOND=void 0,t.ONE_SECOND=1,t.FIVE_SECONDS=5,t.TEN_SECONDS=10,t.THIRTY_SECONDS=30,t.SIXTY_SECONDS=60,t.ONE_MINUTE=t.SIXTY_SECONDS,t.FIVE_MINUTES=5*t.ONE_MINUTE,t.TEN_MINUTES=10*t.ONE_MINUTE,t.THIRTY_MINUTES=30*t.ONE_MINUTE,t.SIXTY_MINUTES=60*t.ONE_MINUTE,t.ONE_HOUR=t.SIXTY_MINUTES,t.THREE_HOURS=3*t.ONE_HOUR,t.SIX_HOURS=6*t.ONE_HOUR,t.TWELVE_HOURS=12*t.ONE_HOUR,t.TWENTY_FOUR_HOURS=24*t.ONE_HOUR,t.ONE_DAY=t.TWENTY_FOUR_HOURS,t.THREE_DAYS=3*t.ONE_DAY,t.FIVE_DAYS=5*t.ONE_DAY,t.SEVEN_DAYS=7*t.ONE_DAY,t.THIRTY_DAYS=30*t.ONE_DAY,t.ONE_WEEK=t.SEVEN_DAYS,t.TWO_WEEKS=2*t.ONE_WEEK,t.THREE_WEEKS=3*t.ONE_WEEK,t.FOUR_WEEKS=4*t.ONE_WEEK,t.ONE_YEAR=365*t.ONE_DAY},7318:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(9190);n.__exportStar(r(9152),t),n.__exportStar(r(1497),t),n.__exportStar(r(1636),t),n.__exportStar(r(1152),t)},1636:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r(9190).__exportStar(r(3195),t)},3195:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IWatch=void 0,t.IWatch=class{}},8711:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fromMiliseconds=t.toMiliseconds=void 0;const n=r(1152);t.toMiliseconds=function(e){return e*n.ONE_THOUSAND},t.fromMiliseconds=function(e){return Math.floor(e/n.ONE_THOUSAND)}},6999:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.delay=void 0,t.delay=function(e){return new Promise((t=>{setTimeout((()=>{t(!0)}),e)}))}},9152:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(9190);n.__exportStar(r(6999),t),n.__exportStar(r(8711),t)},1497:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Watch=void 0;class r{constructor(){this.timestamps=new Map}start(e){if(this.timestamps.has(e))throw new Error(`Watch already started for label: ${e}`);this.timestamps.set(e,{started:Date.now()})}stop(e){const t=this.get(e);if(void 0!==t.elapsed)throw new Error(`Watch already stopped for label: ${e}`);const r=Date.now()-t.started;this.timestamps.set(e,{started:t.started,elapsed:r})}get(e){const t=this.timestamps.get(e);if(void 0===t)throw new Error(`No timestamp found for label: ${e}`);return t}elapsed(e){const t=this.get(e);return t.elapsed||Date.now()-t.started}}t.Watch=r,t.default=r},9190:(e,t,r)=>{"use strict";r.r(t),r.d(t,{__assign:()=>o,__asyncDelegator:()=>v,__asyncGenerator:()=>w,__asyncValues:()=>S,__await:()=>m,__awaiter:()=>h,__classPrivateFieldGet:()=>A,__classPrivateFieldSet:()=>k,__createBinding:()=>d,__decorate:()=>a,__exportStar:()=>f,__extends:()=>i,__generator:()=>l,__importDefault:()=>I,__importStar:()=>E,__makeTemplateObject:()=>_,__metadata:()=>u,__param:()=>c,__read:()=>g,__rest:()=>s,__spread:()=>y,__spreadArrays:()=>b,__values:()=>p});var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},n(e,t)};function i(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var o=function(){return o=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},o.apply(this,arguments)};function s(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r}function a(e,t,r,n){var i,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,r,s):i(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s}function c(e,t){return function(r,n){t(r,n,e)}}function u(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function h(e,t,r,n){return new(r||(r=Promise))((function(i,o){function s(e){try{c(n.next(e))}catch(e){o(e)}}function a(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))}function l(e,t){var r,n,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,n=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}}function d(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}function f(e,t){for(var r in e)"default"===r||t.hasOwnProperty(r)||(t[r]=e[r])}function p(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function g(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,i,o=r.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(n=o.next()).done;)s.push(n.value)}catch(e){i={error:e}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}return s}function y(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(g(arguments[t]));return e}function b(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),i=0;for(t=0;t<r;t++)for(var o=arguments[t],s=0,a=o.length;s<a;s++,i++)n[i]=o[s];return n}function m(e){return this instanceof m?(this.v=e,this):new m(e)}function w(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,i=r.apply(e,t||[]),o=[];return n={},s("next"),s("throw"),s("return"),n[Symbol.asyncIterator]=function(){return this},n;function s(e){i[e]&&(n[e]=function(t){return new Promise((function(r,n){o.push([e,t,r,n])>1||a(e,t)}))})}function a(e,t){try{(r=i[e](t)).value instanceof m?Promise.resolve(r.value.v).then(c,u):h(o[0][2],r)}catch(e){h(o[0][3],e)}var r}function c(e){a("next",e)}function u(e){a("throw",e)}function h(e,t){e(t),o.shift(),o.length&&a(o[0][0],o[0][1])}}function v(e){var t,r;return t={},n("next"),n("throw",(function(e){throw e})),n("return"),t[Symbol.iterator]=function(){return this},t;function n(n,i){t[n]=e[n]?function(t){return(r=!r)?{value:m(e[n](t)),done:"return"===n}:i?i(t):t}:i}}function S(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=p(e),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise((function(n,i){!function(e,t,r,n){Promise.resolve(n).then((function(t){e({value:t,done:r})}),t)}(n,i,(t=e[r](t)).done,t.value)}))}}}function _(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}function E(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function I(e){return e&&e.__esModule?e:{default:e}}function A(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)}function k(e,t,r){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,r),r}},6122:(e,t)=>{"use strict";function r(e){let t;return"undefined"!=typeof window&&void 0!==window[e]&&(t=window[e]),t}function n(e){const t=r(e);if(!t)throw new Error(`${e} is not defined in Window`);return t}Object.defineProperty(t,"__esModule",{value:!0}),t.getLocalStorage=t.getLocalStorageOrThrow=t.getCrypto=t.getCryptoOrThrow=t.getLocation=t.getLocationOrThrow=t.getNavigator=t.getNavigatorOrThrow=t.getDocument=t.getDocumentOrThrow=t.getFromWindowOrThrow=t.getFromWindow=void 0,t.getFromWindow=r,t.getFromWindowOrThrow=n,t.getDocumentOrThrow=function(){return n("document")},t.getDocument=function(){return r("document")},t.getNavigatorOrThrow=function(){return n("navigator")},t.getNavigator=function(){return r("navigator")},t.getLocationOrThrow=function(){return n("location")},t.getLocation=function(){return r("location")},t.getCryptoOrThrow=function(){return n("crypto")},t.getCrypto=function(){return r("crypto")},t.getLocalStorageOrThrow=function(){return n("localStorage")},t.getLocalStorage=function(){return r("localStorage")}},8797:(e,t,r)=>{"use strict";t.g=void 0;const n=r(6122);t.g=function(){let e,t;try{e=n.getDocumentOrThrow(),t=n.getLocationOrThrow()}catch(e){return null}function r(...t){const r=e.getElementsByTagName("meta");for(let e=0;e<r.length;e++){const n=r[e],i=["itemprop","property","name"].map((e=>n.getAttribute(e))).filter((e=>!!e&&t.includes(e)));if(i.length&&i){const e=n.getAttribute("content");if(e)return e}}return""}const i=function(){let t=r("name","og:site_name","og:title","twitter:title");return t||(t=e.title),t}();return{description:r("description","og:description","twitter:description","keywords"),url:t.origin,icons:function(){const r=e.getElementsByTagName("link"),n=[];for(let e=0;e<r.length;e++){const i=r[e],o=i.getAttribute("rel");if(o&&o.toLowerCase().indexOf("icon")>-1){const e=i.getAttribute("href");if(e)if(-1===e.toLowerCase().indexOf("https:")&&-1===e.toLowerCase().indexOf("http:")&&0!==e.indexOf("//")){let r=t.protocol+"//"+t.host;if(0===e.indexOf("/"))r+=e;else{const n=t.pathname.split("/");n.pop(),r+=n.join("/")+"/"+e}n.push(r)}else if(0===e.indexOf("//")){const r=t.protocol+e;n.push(r)}else n.push(e)}}return n}(),name:i}}},6313:(e,t,r)=>{"use strict";const{SymbolDispose:n}=r(8744),{AbortError:i,codes:o}=r(8189),{isNodeStream:s,isWebStream:a,kControllerErrorFunction:c}=r(6921),u=r(5444),{ERR_INVALID_ARG_TYPE:h}=o;let l;e.exports.addAbortSignal=function(t,r){if((e=>{if("object"!=typeof e||!("aborted"in e))throw new h("signal","AbortSignal",e)})(t),!s(r)&&!a(r))throw new h("stream",["ReadableStream","WritableStream","Stream"],r);return e.exports.addAbortSignalNoValidate(t,r)},e.exports.addAbortSignalNoValidate=function(e,t){if("object"!=typeof e||!("aborted"in e))return t;const o=s(t)?()=>{t.destroy(new i(void 0,{cause:e.reason}))}:()=>{t[c](new i(void 0,{cause:e.reason}))};if(e.aborted)o();else{l=l||r(4030).addAbortListener;const i=l(e,o);u(t,i[n])}return t}},3291:(e,t,r)=>{"use strict";const{StringPrototypeSlice:n,SymbolIterator:i,TypedArrayPrototypeSet:o,Uint8Array:s}=r(8744),{Buffer:a}=r(1429),{inspect:c}=r(4030);e.exports=class{constructor(){this.head=null,this.tail=null,this.length=0}push(e){const t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length}unshift(e){const t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length}shift(){if(0===this.length)return;const e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}clear(){this.head=this.tail=null,this.length=0}join(e){if(0===this.length)return"";let t=this.head,r=""+t.data;for(;null!==(t=t.next);)r+=e+t.data;return r}concat(e){if(0===this.length)return a.alloc(0);const t=a.allocUnsafe(e>>>0);let r=this.head,n=0;for(;r;)o(t,r.data,n),n+=r.data.length,r=r.next;return t}consume(e,t){const r=this.head.data;if(e<r.length){const t=r.slice(0,e);return this.head.data=r.slice(e),t}return e===r.length?this.shift():t?this._getString(e):this._getBuffer(e)}first(){return this.head.data}*[i](){for(let e=this.head;e;e=e.next)yield e.data}_getString(e){let t="",r=this.head,i=0;do{const o=r.data;if(!(e>o.length)){e===o.length?(t+=o,++i,r.next?this.head=r.next:this.head=this.tail=null):(t+=n(o,0,e),this.head=r,r.data=n(o,e));break}t+=o,e-=o.length,++i}while(null!==(r=r.next));return this.length-=i,t}_getBuffer(e){const t=a.allocUnsafe(e),r=e;let n=this.head,i=0;do{const a=n.data;if(!(e>a.length)){e===a.length?(o(t,a,r-e),++i,n.next?this.head=n.next:this.head=this.tail=null):(o(t,new s(a.buffer,a.byteOffset,e),r-e),this.head=n,n.data=a.slice(e));break}o(t,a,r-e),e-=a.length,++i}while(null!==(n=n.next));return this.length-=i,t}[Symbol.for("nodejs.util.inspect.custom")](e,t){return c(this,{...t,depth:0,customInspect:!1})}}},5648:(e,t,r)=>{"use strict";const{pipeline:n}=r(7608),i=r(4480),{destroyer:o}=r(2094),{isNodeStream:s,isReadable:a,isWritable:c,isWebStream:u,isTransformStream:h,isWritableStream:l,isReadableStream:d}=r(6921),{AbortError:f,codes:{ERR_INVALID_ARG_VALUE:p,ERR_MISSING_ARGS:g}}=r(8189),y=r(5444);e.exports=function(...e){if(0===e.length)throw new g("streams");if(1===e.length)return i.from(e[0]);const t=[...e];if("function"==typeof e[0]&&(e[0]=i.from(e[0])),"function"==typeof e[e.length-1]){const t=e.length-1;e[t]=i.from(e[t])}for(let r=0;r<e.length;++r)if(s(e[r])||u(e[r])){if(r<e.length-1&&!(a(e[r])||d(e[r])||h(e[r])))throw new p(`streams[${r}]`,t[r],"must be readable");if(r>0&&!(c(e[r])||l(e[r])||h(e[r])))throw new p(`streams[${r}]`,t[r],"must be writable")}let r,b,m,w,v;const S=e[0],_=n(e,(function(e){const t=w;w=null,t?t(e):e?v.destroy(e):I||E||v.destroy()})),E=!!(c(S)||l(S)||h(S)),I=!!(a(_)||d(_)||h(_));if(v=new i({writableObjectMode:!(null==S||!S.writableObjectMode),readableObjectMode:!(null==_||!_.readableObjectMode),writable:E,readable:I}),E){if(s(S))v._write=function(e,t,n){S.write(e,t)?n():r=n},v._final=function(e){S.end(),b=e},S.on("drain",(function(){if(r){const e=r;r=null,e()}}));else if(u(S)){const e=(h(S)?S.writable:S).getWriter();v._write=async function(t,r,n){try{await e.ready,e.write(t).catch((()=>{})),n()}catch(e){n(e)}},v._final=async function(t){try{await e.ready,e.close().catch((()=>{})),b=t}catch(e){t(e)}}}const e=h(_)?_.readable:_;y(e,(()=>{if(b){const e=b;b=null,e()}}))}if(I)if(s(_))_.on("readable",(function(){if(m){const e=m;m=null,e()}})),_.on("end",(function(){v.push(null)})),v._read=function(){for(;;){const e=_.read();if(null===e)return void(m=v._read);if(!v.push(e))return}};else if(u(_)){const e=(h(_)?_.readable:_).getReader();v._read=async function(){for(;;)try{const{value:t,done:r}=await e.read();if(!v.push(t))return;if(r)return void v.push(null)}catch{return}}}return v._destroy=function(e,t){e||null===w||(e=new f),m=null,r=null,b=null,null===w?t(e):(w=t,s(_)&&o(_,e))},v}},2094:(e,t,r)=>{"use strict";const n=r(3184),{aggregateTwoErrors:i,codes:{ERR_MULTIPLE_CALLBACK:o},AbortError:s}=r(8189),{Symbol:a}=r(8744),{kIsDestroyed:c,isDestroyed:u,isFinished:h,isServerRequest:l}=r(6921),d=a("kDestroy"),f=a("kConstruct");function p(e,t,r){e&&(e.stack,t&&!t.errored&&(t.errored=e),r&&!r.errored&&(r.errored=e))}function g(e,t,r){let i=!1;function o(t){if(i)return;i=!0;const o=e._readableState,s=e._writableState;p(t,s,o),s&&(s.closed=!0),o&&(o.closed=!0),"function"==typeof r&&r(t),t?n.nextTick(y,e,t):n.nextTick(b,e)}try{e._destroy(t||null,o)}catch(t){o(t)}}function y(e,t){m(e,t),b(e)}function b(e){const t=e._readableState,r=e._writableState;r&&(r.closeEmitted=!0),t&&(t.closeEmitted=!0),(null!=r&&r.emitClose||null!=t&&t.emitClose)&&e.emit("close")}function m(e,t){const r=e._readableState,n=e._writableState;null!=n&&n.errorEmitted||null!=r&&r.errorEmitted||(n&&(n.errorEmitted=!0),r&&(r.errorEmitted=!0),e.emit("error",t))}function w(e,t,r){const i=e._readableState,o=e._writableState;if(null!=o&&o.destroyed||null!=i&&i.destroyed)return this;null!=i&&i.autoDestroy||null!=o&&o.autoDestroy?e.destroy(t):t&&(t.stack,o&&!o.errored&&(o.errored=t),i&&!i.errored&&(i.errored=t),r?n.nextTick(m,e,t):m(e,t))}function v(e){let t=!1;function r(r){if(t)return void w(e,null!=r?r:new o);t=!0;const i=e._readableState,s=e._writableState,a=s||i;i&&(i.constructed=!0),s&&(s.constructed=!0),a.destroyed?e.emit(d,r):r?w(e,r,!0):n.nextTick(S,e)}try{e._construct((e=>{n.nextTick(r,e)}))}catch(e){n.nextTick(r,e)}}function S(e){e.emit(f)}function _(e){return(null==e?void 0:e.setHeader)&&"function"==typeof e.abort}function E(e){e.emit("close")}function I(e,t){e.emit("error",t),n.nextTick(E,e)}e.exports={construct:function(e,t){if("function"!=typeof e._construct)return;const r=e._readableState,i=e._writableState;r&&(r.constructed=!1),i&&(i.constructed=!1),e.once(f,t),e.listenerCount(f)>1||n.nextTick(v,e)},destroyer:function(e,t){e&&!u(e)&&(t||h(e)||(t=new s),l(e)?(e.socket=null,e.destroy(t)):_(e)?e.abort():_(e.req)?e.req.abort():"function"==typeof e.destroy?e.destroy(t):"function"==typeof e.close?e.close():t?n.nextTick(I,e,t):n.nextTick(E,e),e.destroyed||(e[c]=!0))},destroy:function(e,t){const r=this._readableState,n=this._writableState,o=n||r;return null!=n&&n.destroyed||null!=r&&r.destroyed?("function"==typeof t&&t(),this):(p(e,n,r),n&&(n.destroyed=!0),r&&(r.destroyed=!0),o.constructed?g(this,e,t):this.once(d,(function(r){g(this,i(r,e),t)})),this)},undestroy:function(){const e=this._readableState,t=this._writableState;e&&(e.constructed=!0,e.closed=!1,e.closeEmitted=!1,e.destroyed=!1,e.errored=null,e.errorEmitted=!1,e.reading=!1,e.ended=!1===e.readable,e.endEmitted=!1===e.readable),t&&(t.constructed=!0,t.destroyed=!1,t.closed=!1,t.closeEmitted=!1,t.errored=null,t.errorEmitted=!1,t.finalCalled=!1,t.prefinished=!1,t.ended=!1===t.writable,t.ending=!1===t.writable,t.finished=!1===t.writable)},errorOrDestroy:w}},4480:(e,t,r)=>{"use strict";const{ObjectDefineProperties:n,ObjectGetOwnPropertyDescriptor:i,ObjectKeys:o,ObjectSetPrototypeOf:s}=r(8744);e.exports=u;const a=r(710),c=r(4602);s(u.prototype,a.prototype),s(u,a);{const e=o(c.prototype);for(let t=0;t<e.length;t++){const r=e[t];u.prototype[r]||(u.prototype[r]=c.prototype[r])}}function u(e){if(!(this instanceof u))return new u(e);a.call(this,e),c.call(this,e),e?(this.allowHalfOpen=!1!==e.allowHalfOpen,!1===e.readable&&(this._readableState.readable=!1,this._readableState.ended=!0,this._readableState.endEmitted=!0),!1===e.writable&&(this._writableState.writable=!1,this._writableState.ending=!0,this._writableState.ended=!0,this._writableState.finished=!0)):this.allowHalfOpen=!0}let h,l;function d(){return void 0===h&&(h={}),h}n(u.prototype,{writable:{__proto__:null,...i(c.prototype,"writable")},writableHighWaterMark:{__proto__:null,...i(c.prototype,"writableHighWaterMark")},writableObjectMode:{__proto__:null,...i(c.prototype,"writableObjectMode")},writableBuffer:{__proto__:null,...i(c.prototype,"writableBuffer")},writableLength:{__proto__:null,...i(c.prototype,"writableLength")},writableFinished:{__proto__:null,...i(c.prototype,"writableFinished")},writableCorked:{__proto__:null,...i(c.prototype,"writableCorked")},writableEnded:{__proto__:null,...i(c.prototype,"writableEnded")},writableNeedDrain:{__proto__:null,...i(c.prototype,"writableNeedDrain")},destroyed:{__proto__:null,get(){return void 0!==this._readableState&&void 0!==this._writableState&&this._readableState.destroyed&&this._writableState.destroyed},set(e){this._readableState&&this._writableState&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}}}),u.fromWeb=function(e,t){return d().newStreamDuplexFromReadableWritablePair(e,t)},u.toWeb=function(e){return d().newReadableWritablePairFromDuplex(e)},u.from=function(e){return l||(l=r(9888)),l(e,"body")}},9888:(e,t,r)=>{const n=r(3184),i=r(1429),{isReadable:o,isWritable:s,isIterable:a,isNodeStream:c,isReadableNodeStream:u,isWritableNodeStream:h,isDuplexNodeStream:l,isReadableStream:d,isWritableStream:f}=r(6921),p=r(5444),{AbortError:g,codes:{ERR_INVALID_ARG_TYPE:y,ERR_INVALID_RETURN_VALUE:b}}=r(8189),{destroyer:m}=r(2094),w=r(4480),v=r(710),S=r(4602),{createDeferredPromise:_}=r(4030),E=r(4238),I=globalThis.Blob||i.Blob,A=void 0!==I?function(e){return e instanceof I}:function(e){return!1},k=globalThis.AbortController||r(1630).AbortController,{FunctionPrototypeCall:x}=r(8744);class P extends w{constructor(e){super(e),!1===(null==e?void 0:e.readable)&&(this._readableState.readable=!1,this._readableState.ended=!0,this._readableState.endEmitted=!0),!1===(null==e?void 0:e.writable)&&(this._writableState.writable=!1,this._writableState.ending=!0,this._writableState.ended=!0,this._writableState.finished=!0)}}function O(e){const t=e.readable&&"function"!=typeof e.readable.read?v.wrap(e.readable):e.readable,r=e.writable;let n,i,a,c,u,h=!!o(t),l=!!s(r);function d(e){const t=c;c=null,t?t(e):e&&u.destroy(e)}return u=new P({readableObjectMode:!(null==t||!t.readableObjectMode),writableObjectMode:!(null==r||!r.writableObjectMode),readable:h,writable:l}),l&&(p(r,(e=>{l=!1,e&&m(t,e),d(e)})),u._write=function(e,t,i){r.write(e,t)?i():n=i},u._final=function(e){r.end(),i=e},r.on("drain",(function(){if(n){const e=n;n=null,e()}})),r.on("finish",(function(){if(i){const e=i;i=null,e()}}))),h&&(p(t,(e=>{h=!1,e&&m(t,e),d(e)})),t.on("readable",(function(){if(a){const e=a;a=null,e()}})),t.on("end",(function(){u.push(null)})),u._read=function(){for(;;){const e=t.read();if(null===e)return void(a=u._read);if(!u.push(e))return}}),u._destroy=function(e,o){e||null===c||(e=new g),a=null,n=null,i=null,null===c?o(e):(c=o,m(r,e),m(t,e))},u}e.exports=function e(t,r){if(l(t))return t;if(u(t))return O({readable:t});if(h(t))return O({writable:t});if(c(t))return O({writable:!1,readable:!1});if(d(t))return O({readable:v.fromWeb(t)});if(f(t))return O({writable:S.fromWeb(t)});if("function"==typeof t){const{value:e,write:i,final:o,destroy:s}=function(e){let{promise:t,resolve:r}=_();const i=new k,o=i.signal;return{value:e(async function*(){for(;;){const e=t;t=null;const{chunk:i,done:s,cb:a}=await e;if(n.nextTick(a),s)return;if(o.aborted)throw new g(void 0,{cause:o.reason});({promise:t,resolve:r}=_()),yield i}}(),{signal:o}),write(e,t,n){const i=r;r=null,i({chunk:e,done:!1,cb:n})},final(e){const t=r;r=null,t({done:!0,cb:e})},destroy(e,t){i.abort(),t(e)}}}(t);if(a(e))return E(P,e,{objectMode:!0,write:i,final:o,destroy:s});const c=null==e?void 0:e.then;if("function"==typeof c){let t;const r=x(c,e,(e=>{if(null!=e)throw new b("nully","body",e)}),(e=>{m(t,e)}));return t=new P({objectMode:!0,readable:!1,write:i,final(e){o((async()=>{try{await r,n.nextTick(e,null)}catch(t){n.nextTick(e,t)}}))},destroy:s})}throw new b("Iterable, AsyncIterable or AsyncFunction",r,e)}if(A(t))return e(t.arrayBuffer());if(a(t))return E(P,t,{objectMode:!0,writable:!1});if(d(null==t?void 0:t.readable)&&f(null==t?void 0:t.writable))return P.fromWeb(t);if("object"==typeof(null==t?void 0:t.writable)||"object"==typeof(null==t?void 0:t.readable))return O({readable:null!=t&&t.readable?u(null==t?void 0:t.readable)?null==t?void 0:t.readable:e(t.readable):void 0,writable:null!=t&&t.writable?h(null==t?void 0:t.writable)?null==t?void 0:t.writable:e(t.writable):void 0});const i=null==t?void 0:t.then;if("function"==typeof i){let e;return x(i,t,(t=>{null!=t&&e.push(t),e.push(null)}),(t=>{m(e,t)})),e=new P({objectMode:!0,writable:!1,read(){}})}throw new y(r,["Blob","ReadableStream","WritableStream","Stream","Iterable","AsyncIterable","Function","{ readable, writable } pair","Promise"],t)}},5444:(e,t,r)=>{const n=r(3184),{AbortError:i,codes:o}=r(8189),{ERR_INVALID_ARG_TYPE:s,ERR_STREAM_PREMATURE_CLOSE:a}=o,{kEmptyObject:c,once:u}=r(4030),{validateAbortSignal:h,validateFunction:l,validateObject:d,validateBoolean:f}=r(6027),{Promise:p,PromisePrototypeThen:g,SymbolDispose:y}=r(8744),{isClosed:b,isReadable:m,isReadableNodeStream:w,isReadableStream:v,isReadableFinished:S,isReadableErrored:_,isWritable:E,isWritableNodeStream:I,isWritableStream:A,isWritableFinished:k,isWritableErrored:x,isNodeStream:P,willEmitClose:O,kIsClosedPromise:R}=r(6921);let T;const N=()=>{};function M(e,t,o){var f,p;if(2===arguments.length?(o=t,t=c):null==t?t=c:d(t,"options"),l(o,"callback"),h(t.signal,"options.signal"),o=u(o),v(e)||A(e))return function(e,t,o){let s=!1,a=N;if(t.signal)if(a=()=>{s=!0,o.call(e,new i(void 0,{cause:t.signal.reason}))},t.signal.aborted)n.nextTick(a);else{T=T||r(4030).addAbortListener;const n=T(t.signal,a),i=o;o=u(((...t)=>{n[y](),i.apply(e,t)}))}const c=(...t)=>{s||n.nextTick((()=>o.apply(e,t)))};return g(e[R].promise,c,c),N}(e,t,o);if(!P(e))throw new s("stream",["ReadableStream","WritableStream","Stream"],e);const M=null!==(f=t.readable)&&void 0!==f?f:w(e),C=null!==(p=t.writable)&&void 0!==p?p:I(e),B=e._writableState,L=e._readableState,U=()=>{e.writable||z()};let D=O(e)&&w(e)===M&&I(e)===C,j=k(e,!1);const z=()=>{j=!0,e.destroyed&&(D=!1),(!D||e.readable&&!M)&&(M&&!q||o.call(e))};let q=S(e,!1);const $=()=>{q=!0,e.destroyed&&(D=!1),(!D||e.writable&&!C)&&(C&&!j||o.call(e))},K=t=>{o.call(e,t)};let F=b(e);const W=()=>{F=!0;const t=x(e)||_(e);return t&&"boolean"!=typeof t?o.call(e,t):M&&!q&&w(e,!0)&&!S(e,!1)?o.call(e,new a):!C||j||k(e,!1)?void o.call(e):o.call(e,new a)},H=()=>{F=!0;const t=x(e)||_(e);if(t&&"boolean"!=typeof t)return o.call(e,t);o.call(e)},V=()=>{e.req.on("finish",z)};!function(e){return e.setHeader&&"function"==typeof e.abort}(e)?C&&!B&&(e.on("end",U),e.on("close",U)):(e.on("complete",z),D||e.on("abort",W),e.req?V():e.on("request",V)),D||"boolean"!=typeof e.aborted||e.on("aborted",W),e.on("end",$),e.on("finish",z),!1!==t.error&&e.on("error",K),e.on("close",W),F?n.nextTick(W):null!=B&&B.errorEmitted||null!=L&&L.errorEmitted?D||n.nextTick(H):(M||D&&!m(e)||!j&&!1!==E(e))&&(C||D&&!E(e)||!q&&!1!==m(e))?L&&e.req&&e.aborted&&n.nextTick(H):n.nextTick(H);const G=()=>{o=N,e.removeListener("aborted",W),e.removeListener("complete",z),e.removeListener("abort",W),e.removeListener("request",V),e.req&&e.req.removeListener("finish",z),e.removeListener("end",U),e.removeListener("close",U),e.removeListener("finish",z),e.removeListener("end",$),e.removeListener("error",K),e.removeListener("close",W)};if(t.signal&&!F){const s=()=>{const r=o;G(),r.call(e,new i(void 0,{cause:t.signal.reason}))};if(t.signal.aborted)n.nextTick(s);else{T=T||r(4030).addAbortListener;const n=T(t.signal,s),i=o;o=u(((...t)=>{n[y](),i.apply(e,t)}))}}return G}e.exports=M,e.exports.finished=function(e,t){var r;let n=!1;return null===t&&(t=c),null!==(r=t)&&void 0!==r&&r.cleanup&&(f(t.cleanup,"cleanup"),n=t.cleanup),new p(((r,i)=>{const o=M(e,t,(e=>{n&&o(),e?i(e):r()}))}))}},4238:(e,t,r)=>{"use strict";const n=r(3184),{PromisePrototypeThen:i,SymbolAsyncIterator:o,SymbolIterator:s}=r(8744),{Buffer:a}=r(1429),{ERR_INVALID_ARG_TYPE:c,ERR_STREAM_NULL_VALUES:u}=r(8189).codes;e.exports=function(e,t,r){let h,l;if("string"==typeof t||t instanceof a)return new e({objectMode:!0,...r,read(){this.push(t),this.push(null)}});if(t&&t[o])l=!0,h=t[o]();else{if(!t||!t[s])throw new c("iterable",["Iterable"],t);l=!1,h=t[s]()}const d=new e({objectMode:!0,highWaterMark:1,...r});let f=!1;return d._read=function(){f||(f=!0,async function(){for(;;){try{const{value:e,done:t}=l?await h.next():h.next();if(t)d.push(null);else{const t=e&&"function"==typeof e.then?await e:e;if(null===t)throw f=!1,new u;if(d.push(t))continue;f=!1}}catch(e){d.destroy(e)}break}}())},d._destroy=function(e,t){i(async function(e){const t=null!=e,r="function"==typeof h.throw;if(t&&r){const{value:t,done:r}=await h.throw(e);if(await t,r)return}if("function"==typeof h.return){const{value:e}=await h.return();await e}}(e),(()=>n.nextTick(t,e)),(r=>n.nextTick(t,r||e)))},d}},8705:(e,t,r)=>{"use strict";const{ArrayIsArray:n,ObjectSetPrototypeOf:i}=r(8744),{EventEmitter:o}=r(8621);function s(e){o.call(this,e)}function a(e,t,r){if("function"==typeof e.prependListener)return e.prependListener(t,r);e._events&&e._events[t]?n(e._events[t])?e._events[t].unshift(r):e._events[t]=[r,e._events[t]]:e.on(t,r)}i(s.prototype,o.prototype),i(s,o),s.prototype.pipe=function(e,t){const r=this;function n(t){e.writable&&!1===e.write(t)&&r.pause&&r.pause()}function i(){r.readable&&r.resume&&r.resume()}r.on("data",n),e.on("drain",i),e._isStdio||t&&!1===t.end||(r.on("end",c),r.on("close",u));let s=!1;function c(){s||(s=!0,e.end())}function u(){s||(s=!0,"function"==typeof e.destroy&&e.destroy())}function h(e){l(),0===o.listenerCount(this,"error")&&this.emit("error",e)}function l(){r.removeListener("data",n),e.removeListener("drain",i),r.removeListener("end",c),r.removeListener("close",u),r.removeListener("error",h),e.removeListener("error",h),r.removeListener("end",l),r.removeListener("close",l),e.removeListener("close",l)}return a(r,"error",h),a(e,"error",h),r.on("end",l),r.on("close",l),e.on("close",l),e.emit("pipe",r),e},e.exports={Stream:s,prependListener:a}},4069:(e,t,r)=>{"use strict";const n=globalThis.AbortController||r(1630).AbortController,{codes:{ERR_INVALID_ARG_VALUE:i,ERR_INVALID_ARG_TYPE:o,ERR_MISSING_ARGS:s,ERR_OUT_OF_RANGE:a},AbortError:c}=r(8189),{validateAbortSignal:u,validateInteger:h,validateObject:l}=r(6027),d=r(8744).Symbol("kWeak"),f=r(8744).Symbol("kResistStopPropagation"),{finished:p}=r(5444),g=r(5648),{addAbortSignalNoValidate:y}=r(6313),{isWritable:b,isNodeStream:m}=r(6921),{deprecate:w}=r(4030),{ArrayPrototypePush:v,Boolean:S,MathFloor:_,Number:E,NumberIsNaN:I,Promise:A,PromiseReject:k,PromiseResolve:x,PromisePrototypeThen:P,Symbol:O}=r(8744),R=O("kEmpty"),T=O("kEof");function N(e,t){if("function"!=typeof e)throw new o("fn",["Function","AsyncFunction"],e);null!=t&&l(t,"options"),null!=(null==t?void 0:t.signal)&&u(t.signal,"options.signal");let n=1;null!=(null==t?void 0:t.concurrency)&&(n=_(t.concurrency));let i=n-1;return null!=(null==t?void 0:t.highWaterMark)&&(i=_(t.highWaterMark)),h(n,"options.concurrency",1),h(i,"options.highWaterMark",0),i+=n,async function*(){const o=r(4030).AbortSignalAny([null==t?void 0:t.signal].filter(S)),s=this,a=[],u={signal:o};let h,l,d=!1,f=0;function p(){d=!0,g()}function g(){f-=1,y()}function y(){l&&!d&&f<n&&a.length<i&&(l(),l=null)}!async function(){try{for await(let t of s){if(d)return;if(o.aborted)throw new c;try{if(t=e(t,u),t===R)continue;t=x(t)}catch(e){t=k(e)}f+=1,P(t,g,p),a.push(t),h&&(h(),h=null),!d&&(a.length>=i||f>=n)&&await new A((e=>{l=e}))}a.push(T)}catch(e){const t=k(e);P(t,g,p),a.push(t)}finally{d=!0,h&&(h(),h=null)}}();try{for(;;){for(;a.length>0;){const e=await a[0];if(e===T)return;if(o.aborted)throw new c;e!==R&&(yield e),a.shift(),y()}await new A((e=>{h=e}))}}finally{d=!0,l&&(l(),l=null)}}.call(this)}async function M(e,t=void 0){for await(const r of C.call(this,e,t))return!0;return!1}function C(e,t){if("function"!=typeof e)throw new o("fn",["Function","AsyncFunction"],e);return N.call(this,(async function(t,r){return await e(t,r)?t:R}),t)}class B extends s{constructor(){super("reduce"),this.message="Reduce of an empty stream requires an initial value"}}function L(e){if(e=E(e),I(e))return 0;if(e<0)throw new a("number",">= 0",e);return e}e.exports.streamReturningOperators={asIndexedPairs:w((function(e=void 0){return null!=e&&l(e,"options"),null!=(null==e?void 0:e.signal)&&u(e.signal,"options.signal"),async function*(){let t=0;for await(const n of this){var r;if(null!=e&&null!==(r=e.signal)&&void 0!==r&&r.aborted)throw new c({cause:e.signal.reason});yield[t++,n]}}.call(this)}),"readable.asIndexedPairs will be removed in a future version."),drop:function(e,t=void 0){return null!=t&&l(t,"options"),null!=(null==t?void 0:t.signal)&&u(t.signal,"options.signal"),e=L(e),async function*(){var r;if(null!=t&&null!==(r=t.signal)&&void 0!==r&&r.aborted)throw new c;for await(const r of this){var n;if(null!=t&&null!==(n=t.signal)&&void 0!==n&&n.aborted)throw new c;e--<=0&&(yield r)}}.call(this)},filter:C,flatMap:function(e,t){const r=N.call(this,e,t);return async function*(){for await(const e of r)yield*e}.call(this)},map:N,take:function(e,t=void 0){return null!=t&&l(t,"options"),null!=(null==t?void 0:t.signal)&&u(t.signal,"options.signal"),e=L(e),async function*(){var r;if(null!=t&&null!==(r=t.signal)&&void 0!==r&&r.aborted)throw new c;for await(const r of this){var n;if(null!=t&&null!==(n=t.signal)&&void 0!==n&&n.aborted)throw new c;if(e-- >0&&(yield r),e<=0)return}}.call(this)},compose:function(e,t){if(null!=t&&l(t,"options"),null!=(null==t?void 0:t.signal)&&u(t.signal,"options.signal"),m(e)&&!b(e))throw new i("stream",e,"must be writable");const r=g(this,e);return null!=t&&t.signal&&y(t.signal,r),r}},e.exports.promiseReturningOperators={every:async function(e,t=void 0){if("function"!=typeof e)throw new o("fn",["Function","AsyncFunction"],e);return!await M.call(this,(async(...t)=>!await e(...t)),t)},forEach:async function(e,t){if("function"!=typeof e)throw new o("fn",["Function","AsyncFunction"],e);for await(const r of N.call(this,(async function(t,r){return await e(t,r),R}),t));},reduce:async function(e,t,r){var i;if("function"!=typeof e)throw new o("reducer",["Function","AsyncFunction"],e);null!=r&&l(r,"options"),null!=(null==r?void 0:r.signal)&&u(r.signal,"options.signal");let s=arguments.length>1;if(null!=r&&null!==(i=r.signal)&&void 0!==i&&i.aborted){const e=new c(void 0,{cause:r.signal.reason});throw this.once("error",(()=>{})),await p(this.destroy(e)),e}const a=new n,h=a.signal;if(null!=r&&r.signal){const e={once:!0,[d]:this,[f]:!0};r.signal.addEventListener("abort",(()=>a.abort()),e)}let g=!1;try{for await(const n of this){var y;if(g=!0,null!=r&&null!==(y=r.signal)&&void 0!==y&&y.aborted)throw new c;s?t=await e(t,n,{signal:h}):(t=n,s=!0)}if(!g&&!s)throw new B}finally{a.abort()}return t},toArray:async function(e){null!=e&&l(e,"options"),null!=(null==e?void 0:e.signal)&&u(e.signal,"options.signal");const t=[];for await(const n of this){var r;if(null!=e&&null!==(r=e.signal)&&void 0!==r&&r.aborted)throw new c(void 0,{cause:e.signal.reason});v(t,n)}return t},some:M,find:async function(e,t){for await(const r of C.call(this,e,t))return r}}},9010:(e,t,r)=>{"use strict";const{ObjectSetPrototypeOf:n}=r(8744);e.exports=o;const i=r(7920);function o(e){if(!(this instanceof o))return new o(e);i.call(this,e)}n(o.prototype,i.prototype),n(o,i),o.prototype._transform=function(e,t,r){r(null,e)}},7608:(e,t,r)=>{const n=r(3184),{ArrayIsArray:i,Promise:o,SymbolAsyncIterator:s,SymbolDispose:a}=r(8744),c=r(5444),{once:u}=r(4030),h=r(2094),l=r(4480),{aggregateTwoErrors:d,codes:{ERR_INVALID_ARG_TYPE:f,ERR_INVALID_RETURN_VALUE:p,ERR_MISSING_ARGS:g,ERR_STREAM_DESTROYED:y,ERR_STREAM_PREMATURE_CLOSE:b},AbortError:m}=r(8189),{validateFunction:w,validateAbortSignal:v}=r(6027),{isIterable:S,isReadable:_,isReadableNodeStream:E,isNodeStream:I,isTransformStream:A,isWebStream:k,isReadableStream:x,isReadableFinished:P}=r(6921),O=globalThis.AbortController||r(1630).AbortController;let R,T,N;function M(e,t,r){let n=!1;return e.on("close",(()=>{n=!0})),{destroy:t=>{n||(n=!0,h.destroyer(e,t||new y("pipe")))},cleanup:c(e,{readable:t,writable:r},(e=>{n=!e}))}}function C(e){if(S(e))return e;if(E(e))return async function*(e){T||(T=r(710)),yield*T.prototype[s].call(e)}(e);throw new f("val",["Readable","Iterable","AsyncIterable"],e)}async function B(e,t,r,{end:n}){let i,s=null;const a=e=>{if(e&&(i=e),s){const e=s;s=null,e()}},u=()=>new o(((e,t)=>{i?t(i):s=()=>{i?t(i):e()}}));t.on("drain",a);const h=c(t,{readable:!1},a);try{t.writableNeedDrain&&await u();for await(const r of e)t.write(r)||await u();n&&(t.end(),await u()),r()}catch(e){r(i!==e?d(i,e):e)}finally{h(),t.off("drain",a)}}async function L(e,t,r,{end:n}){A(t)&&(t=t.writable);const i=t.getWriter();try{for await(const t of e)await i.ready,i.write(t).catch((()=>{}));await i.ready,n&&await i.close(),r()}catch(e){try{await i.abort(e),r(e)}catch(e){r(e)}}}function U(e,t,o){if(1===e.length&&i(e[0])&&(e=e[0]),e.length<2)throw new g("streams");const s=new O,c=s.signal,u=null==o?void 0:o.signal,h=[];function d(){z(new m)}let y,b,w;v(u,"options.signal"),N=N||r(4030).addAbortListener,u&&(y=N(u,d));const P=[];let T,U=0;function j(e){z(e,0==--U)}function z(e,r){var i;if(!e||b&&"ERR_STREAM_PREMATURE_CLOSE"!==b.code||(b=e),b||r){for(;P.length;)P.shift()(b);null===(i=y)||void 0===i||i[a](),s.abort(),r&&(b||h.forEach((e=>e())),n.nextTick(t,b,w))}}for(let F=0;F<e.length;F++){const W=e[F],H=F<e.length-1,V=F>0,G=H||!1!==(null==o?void 0:o.end),Y=F===e.length-1;if(I(W)){if(G){const{destroy:J,cleanup:X}=M(W,H,V);P.push(J),_(W)&&Y&&h.push(X)}function q(e){e&&"AbortError"!==e.name&&"ERR_STREAM_PREMATURE_CLOSE"!==e.code&&j(e)}W.on("error",q),_(W)&&Y&&h.push((()=>{W.removeListener("error",q)}))}if(0===F)if("function"==typeof W){if(T=W({signal:c}),!S(T))throw new p("Iterable, AsyncIterable or Stream","source",T)}else T=S(W)||E(W)||A(W)?W:l.from(W);else if("function"==typeof W){var $;if(T=A(T)?C(null===($=T)||void 0===$?void 0:$.readable):C(T),T=W(T,{signal:c}),H){if(!S(T,!0))throw new p("AsyncIterable",`transform[${F-1}]`,T)}else{var K;R||(R=r(9010));const Z=new R({objectMode:!0}),Q=null===(K=T)||void 0===K?void 0:K.then;if("function"==typeof Q)U++,Q.call(T,(e=>{w=e,null!=e&&Z.write(e),G&&Z.end(),n.nextTick(j)}),(e=>{Z.destroy(e),n.nextTick(j,e)}));else if(S(T,!0))U++,B(T,Z,j,{end:G});else{if(!x(T)&&!A(T))throw new p("AsyncIterable or Promise","destination",T);{const re=T.readable||T;U++,B(re,Z,j,{end:G})}}T=Z;const{destroy:ee,cleanup:te}=M(T,!1,!0);P.push(ee),Y&&h.push(te)}}else if(I(W)){if(E(T)){U+=2;const ne=D(T,W,j,{end:G});_(W)&&Y&&h.push(ne)}else if(A(T)||x(T)){const ie=T.readable||T;U++,B(ie,W,j,{end:G})}else{if(!S(T))throw new f("val",["Readable","Iterable","AsyncIterable","ReadableStream","TransformStream"],T);U++,B(T,W,j,{end:G})}T=W}else if(k(W)){if(E(T))U++,L(C(T),W,j,{end:G});else if(x(T)||S(T))U++,L(T,W,j,{end:G});else{if(!A(T))throw new f("val",["Readable","Iterable","AsyncIterable","ReadableStream","TransformStream"],T);U++,L(T.readable,W,j,{end:G})}T=W}else T=l.from(W)}return(null!=c&&c.aborted||null!=u&&u.aborted)&&n.nextTick(d),T}function D(e,t,r,{end:i}){let o=!1;if(t.on("close",(()=>{o||r(new b)})),e.pipe(t,{end:!1}),i){function s(){o=!0,t.end()}P(e)?n.nextTick(s):e.once("end",s)}else r();return c(e,{readable:!0,writable:!1},(t=>{const n=e._readableState;t&&"ERR_STREAM_PREMATURE_CLOSE"===t.code&&n&&n.ended&&!n.errored&&!n.errorEmitted?e.once("end",r).once("error",r):r(t)})),c(t,{readable:!1,writable:!0},r)}e.exports={pipelineImpl:U,pipeline:function(...e){return U(e,u(function(e){return w(e[e.length-1],"streams[stream.length - 1]"),e.pop()}(e)))}}},710:(e,t,r)=>{const n=r(3184),{ArrayPrototypeIndexOf:i,NumberIsInteger:o,NumberIsNaN:s,NumberParseInt:a,ObjectDefineProperties:c,ObjectKeys:u,ObjectSetPrototypeOf:h,Promise:l,SafeSet:d,SymbolAsyncDispose:f,SymbolAsyncIterator:p,Symbol:g}=r(8744);e.exports=Y,Y.ReadableState=G;const{EventEmitter:y}=r(8621),{Stream:b,prependListener:m}=r(8705),{Buffer:w}=r(1429),{addAbortSignal:v}=r(6313),S=r(5444);let _=r(4030).debuglog("stream",(e=>{_=e}));const E=r(3291),I=r(2094),{getHighWaterMark:A,getDefaultHighWaterMark:k}=r(9713),{aggregateTwoErrors:x,codes:{ERR_INVALID_ARG_TYPE:P,ERR_METHOD_NOT_IMPLEMENTED:O,ERR_OUT_OF_RANGE:R,ERR_STREAM_PUSH_AFTER_EOF:T,ERR_STREAM_UNSHIFT_AFTER_END_EVENT:N},AbortError:M}=r(8189),{validateObject:C}=r(6027),B=g("kPaused"),{StringDecoder:L}=r(7667),U=r(4238);h(Y.prototype,b.prototype),h(Y,b);const D=()=>{},{errorOrDestroy:j}=I,z=1,q=16,$=32,K=64,F=2048,W=4096,H=65536;function V(e){return{enumerable:!1,get(){return!!(this.state&e)},set(t){t?this.state|=e:this.state&=~e}}}function G(e,t,n){"boolean"!=typeof n&&(n=t instanceof r(4480)),this.state=F|W|q|$,e&&e.objectMode&&(this.state|=z),n&&e&&e.readableObjectMode&&(this.state|=z),this.highWaterMark=e?A(this,e,"readableHighWaterMark",n):k(!1),this.buffer=new E,this.length=0,this.pipes=[],this.flowing=null,this[B]=null,e&&!1===e.emitClose&&(this.state&=~F),e&&!1===e.autoDestroy&&(this.state&=~W),this.errored=null,this.defaultEncoding=e&&e.defaultEncoding||"utf8",this.awaitDrainWriters=null,this.decoder=null,this.encoding=null,e&&e.encoding&&(this.decoder=new L(e.encoding),this.encoding=e.encoding)}function Y(e){if(!(this instanceof Y))return new Y(e);const t=this instanceof r(4480);this._readableState=new G(e,this,t),e&&("function"==typeof e.read&&(this._read=e.read),"function"==typeof e.destroy&&(this._destroy=e.destroy),"function"==typeof e.construct&&(this._construct=e.construct),e.signal&&!t&&v(e.signal,this)),b.call(this,e),I.construct(this,(()=>{this._readableState.needReadable&&te(this,this._readableState)}))}function J(e,t,r,n){_("readableAddChunk",t);const i=e._readableState;let o;if(i.state&z||("string"==typeof t?(r=r||i.defaultEncoding,i.encoding!==r&&(n&&i.encoding?t=w.from(t,r).toString(i.encoding):(t=w.from(t,r),r=""))):t instanceof w?r="":b._isUint8Array(t)?(t=b._uint8ArrayToBuffer(t),r=""):null!=t&&(o=new P("chunk",["string","Buffer","Uint8Array"],t))),o)j(e,o);else if(null===t)i.state&=-9,function(e,t){if(_("onEofChunk"),!t.ended){if(t.decoder){const e=t.decoder.end();e&&e.length&&(t.buffer.push(e),t.length+=t.objectMode?1:e.length)}t.ended=!0,t.sync?Q(e):(t.needReadable=!1,t.emittedReadable=!0,ee(e))}}(e,i);else if(i.state&z||t&&t.length>0)if(n)if(4&i.state)j(e,new N);else{if(i.destroyed||i.errored)return!1;X(e,i,t,!0)}else if(i.ended)j(e,new T);else{if(i.destroyed||i.errored)return!1;i.state&=-9,i.decoder&&!r?(t=i.decoder.write(t),i.objectMode||0!==t.length?X(e,i,t,!1):te(e,i)):X(e,i,t,!1)}else n||(i.state&=-9,te(e,i));return!i.ended&&(i.length<i.highWaterMark||0===i.length)}function X(e,t,r,n){t.flowing&&0===t.length&&!t.sync&&e.listenerCount("data")>0?(t.state&H?t.awaitDrainWriters.clear():t.awaitDrainWriters=null,t.dataEmitted=!0,e.emit("data",r)):(t.length+=t.objectMode?1:r.length,n?t.buffer.unshift(r):t.buffer.push(r),t.state&K&&Q(e)),te(e,t)}function Z(e,t){return e<=0||0===t.length&&t.ended?0:t.state&z?1:s(e)?t.flowing&&t.length?t.buffer.first().length:t.length:e<=t.length?e:t.ended?t.length:0}function Q(e){const t=e._readableState;_("emitReadable",t.needReadable,t.emittedReadable),t.needReadable=!1,t.emittedReadable||(_("emitReadable",t.flowing),t.emittedReadable=!0,n.nextTick(ee,e))}function ee(e){const t=e._readableState;_("emitReadable_",t.destroyed,t.length,t.ended),t.destroyed||t.errored||!t.length&&!t.ended||(e.emit("readable"),t.emittedReadable=!1),t.needReadable=!t.flowing&&!t.ended&&t.length<=t.highWaterMark,se(e)}function te(e,t){!t.readingMore&&t.constructed&&(t.readingMore=!0,n.nextTick(re,e,t))}function re(e,t){for(;!t.reading&&!t.ended&&(t.length<t.highWaterMark||t.flowing&&0===t.length);){const r=t.length;if(_("maybeReadMore read 0"),e.read(0),r===t.length)break}t.readingMore=!1}function ne(e){const t=e._readableState;t.readableListening=e.listenerCount("readable")>0,t.resumeScheduled&&!1===t[B]?t.flowing=!0:e.listenerCount("data")>0?e.resume():t.readableListening||(t.flowing=null)}function ie(e){_("readable nexttick read 0"),e.read(0)}function oe(e,t){_("resume",t.reading),t.reading||e.read(0),t.resumeScheduled=!1,e.emit("resume"),se(e),t.flowing&&!t.reading&&e.read(0)}function se(e){const t=e._readableState;for(_("flow",t.flowing);t.flowing&&null!==e.read(););}function ae(e,t){"function"!=typeof e.read&&(e=Y.wrap(e,{objectMode:!0}));const r=async function*(e,t){let r,n=D;function i(t){this===e?(n(),n=D):n=t}e.on("readable",i);const o=S(e,{writable:!1},(e=>{r=e?x(r,e):null,n(),n=D}));try{for(;;){const t=e.destroyed?null:e.read();if(null!==t)yield t;else{if(r)throw r;if(null===r)return;await new l(i)}}}catch(e){throw r=x(r,e),r}finally{!r&&!1===(null==t?void 0:t.destroyOnReturn)||void 0!==r&&!e._readableState.autoDestroy?(e.off("readable",i),o()):I.destroyer(e,null)}}(e,t);return r.stream=e,r}function ce(e,t){if(0===t.length)return null;let r;return t.objectMode?r=t.buffer.shift():!e||e>=t.length?(r=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.first():t.buffer.concat(t.length),t.buffer.clear()):r=t.buffer.consume(e,t.decoder),r}function ue(e){const t=e._readableState;_("endReadable",t.endEmitted),t.endEmitted||(t.ended=!0,n.nextTick(he,t,e))}function he(e,t){if(_("endReadableNT",e.endEmitted,e.length),!e.errored&&!e.closeEmitted&&!e.endEmitted&&0===e.length)if(e.endEmitted=!0,t.emit("end"),t.writable&&!1===t.allowHalfOpen)n.nextTick(le,t);else if(e.autoDestroy){const e=t._writableState;(!e||e.autoDestroy&&(e.finished||!1===e.writable))&&t.destroy()}}function le(e){e.writable&&!e.writableEnded&&!e.destroyed&&e.end()}let de;function fe(){return void 0===de&&(de={}),de}c(G.prototype,{objectMode:V(z),ended:V(2),endEmitted:V(4),reading:V(8),constructed:V(q),sync:V($),needReadable:V(K),emittedReadable:V(128),readableListening:V(256),resumeScheduled:V(512),errorEmitted:V(1024),emitClose:V(F),autoDestroy:V(W),destroyed:V(8192),closed:V(16384),closeEmitted:V(32768),multiAwaitDrain:V(H),readingMore:V(1<<17),dataEmitted:V(1<<18)}),Y.prototype.destroy=I.destroy,Y.prototype._undestroy=I.undestroy,Y.prototype._destroy=function(e,t){t(e)},Y.prototype[y.captureRejectionSymbol]=function(e){this.destroy(e)},Y.prototype[f]=function(){let e;return this.destroyed||(e=this.readableEnded?null:new M,this.destroy(e)),new l(((t,r)=>S(this,(n=>n&&n!==e?r(n):t(null)))))},Y.prototype.push=function(e,t){return J(this,e,t,!1)},Y.prototype.unshift=function(e,t){return J(this,e,t,!0)},Y.prototype.isPaused=function(){const e=this._readableState;return!0===e[B]||!1===e.flowing},Y.prototype.setEncoding=function(e){const t=new L(e);this._readableState.decoder=t,this._readableState.encoding=this._readableState.decoder.encoding;const r=this._readableState.buffer;let n="";for(const e of r)n+=t.write(e);return r.clear(),""!==n&&r.push(n),this._readableState.length=n.length,this},Y.prototype.read=function(e){_("read",e),void 0===e?e=NaN:o(e)||(e=a(e,10));const t=this._readableState,r=e;if(e>t.highWaterMark&&(t.highWaterMark=function(e){if(e>1073741824)throw new R("size","<= 1GiB",e);return e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,++e}(e)),0!==e&&(t.state&=-129),0===e&&t.needReadable&&((0!==t.highWaterMark?t.length>=t.highWaterMark:t.length>0)||t.ended))return _("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?ue(this):Q(this),null;if(0===(e=Z(e,t))&&t.ended)return 0===t.length&&ue(this),null;let n,i=!!(t.state&K);if(_("need readable",i),(0===t.length||t.length-e<t.highWaterMark)&&(i=!0,_("length less than watermark",i)),t.ended||t.reading||t.destroyed||t.errored||!t.constructed)i=!1,_("reading, ended or constructing",i);else if(i){_("do read"),t.state|=8|$,0===t.length&&(t.state|=K);try{this._read(t.highWaterMark)}catch(e){j(this,e)}t.state&=~$,t.reading||(e=Z(r,t))}return n=e>0?ce(e,t):null,null===n?(t.needReadable=t.length<=t.highWaterMark,e=0):(t.length-=e,t.multiAwaitDrain?t.awaitDrainWriters.clear():t.awaitDrainWriters=null),0===t.length&&(t.ended||(t.needReadable=!0),r!==e&&t.ended&&ue(this)),null===n||t.errorEmitted||t.closeEmitted||(t.dataEmitted=!0,this.emit("data",n)),n},Y.prototype._read=function(e){throw new O("_read()")},Y.prototype.pipe=function(e,t){const r=this,i=this._readableState;1===i.pipes.length&&(i.multiAwaitDrain||(i.multiAwaitDrain=!0,i.awaitDrainWriters=new d(i.awaitDrainWriters?[i.awaitDrainWriters]:[]))),i.pipes.push(e),_("pipe count=%d opts=%j",i.pipes.length,t);const o=t&&!1===t.end||e===n.stdout||e===n.stderr?g:s;function s(){_("onend"),e.end()}let a;i.endEmitted?n.nextTick(o):r.once("end",o),e.on("unpipe",(function t(n,o){_("onunpipe"),n===r&&o&&!1===o.hasUnpiped&&(o.hasUnpiped=!0,_("cleanup"),e.removeListener("close",f),e.removeListener("finish",p),a&&e.removeListener("drain",a),e.removeListener("error",l),e.removeListener("unpipe",t),r.removeListener("end",s),r.removeListener("end",g),r.removeListener("data",h),c=!0,a&&i.awaitDrainWriters&&(!e._writableState||e._writableState.needDrain)&&a())}));let c=!1;function u(){c||(1===i.pipes.length&&i.pipes[0]===e?(_("false write response, pause",0),i.awaitDrainWriters=e,i.multiAwaitDrain=!1):i.pipes.length>1&&i.pipes.includes(e)&&(_("false write response, pause",i.awaitDrainWriters.size),i.awaitDrainWriters.add(e)),r.pause()),a||(a=function(e,t){return function(){const r=e._readableState;r.awaitDrainWriters===t?(_("pipeOnDrain",1),r.awaitDrainWriters=null):r.multiAwaitDrain&&(_("pipeOnDrain",r.awaitDrainWriters.size),r.awaitDrainWriters.delete(t)),r.awaitDrainWriters&&0!==r.awaitDrainWriters.size||!e.listenerCount("data")||e.resume()}}(r,e),e.on("drain",a))}function h(t){_("ondata");const r=e.write(t);_("dest.write",r),!1===r&&u()}function l(t){if(_("onerror",t),g(),e.removeListener("error",l),0===e.listenerCount("error")){const r=e._writableState||e._readableState;r&&!r.errorEmitted?j(e,t):e.emit("error",t)}}function f(){e.removeListener("finish",p),g()}function p(){_("onfinish"),e.removeListener("close",f),g()}function g(){_("unpipe"),r.unpipe(e)}return r.on("data",h),m(e,"error",l),e.once("close",f),e.once("finish",p),e.emit("pipe",r),!0===e.writableNeedDrain?u():i.flowing||(_("pipe resume"),r.resume()),e},Y.prototype.unpipe=function(e){const t=this._readableState;if(0===t.pipes.length)return this;if(!e){const e=t.pipes;t.pipes=[],this.pause();for(let t=0;t<e.length;t++)e[t].emit("unpipe",this,{hasUnpiped:!1});return this}const r=i(t.pipes,e);return-1===r||(t.pipes.splice(r,1),0===t.pipes.length&&this.pause(),e.emit("unpipe",this,{hasUnpiped:!1})),this},Y.prototype.on=function(e,t){const r=b.prototype.on.call(this,e,t),i=this._readableState;return"data"===e?(i.readableListening=this.listenerCount("readable")>0,!1!==i.flowing&&this.resume()):"readable"===e&&(i.endEmitted||i.readableListening||(i.readableListening=i.needReadable=!0,i.flowing=!1,i.emittedReadable=!1,_("on readable",i.length,i.reading),i.length?Q(this):i.reading||n.nextTick(ie,this))),r},Y.prototype.addListener=Y.prototype.on,Y.prototype.removeListener=function(e,t){const r=b.prototype.removeListener.call(this,e,t);return"readable"===e&&n.nextTick(ne,this),r},Y.prototype.off=Y.prototype.removeListener,Y.prototype.removeAllListeners=function(e){const t=b.prototype.removeAllListeners.apply(this,arguments);return"readable"!==e&&void 0!==e||n.nextTick(ne,this),t},Y.prototype.resume=function(){const e=this._readableState;return e.flowing||(_("resume"),e.flowing=!e.readableListening,function(e,t){t.resumeScheduled||(t.resumeScheduled=!0,n.nextTick(oe,e,t))}(this,e)),e[B]=!1,this},Y.prototype.pause=function(){return _("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(_("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState[B]=!0,this},Y.prototype.wrap=function(e){let t=!1;e.on("data",(r=>{!this.push(r)&&e.pause&&(t=!0,e.pause())})),e.on("end",(()=>{this.push(null)})),e.on("error",(e=>{j(this,e)})),e.on("close",(()=>{this.destroy()})),e.on("destroy",(()=>{this.destroy()})),this._read=()=>{t&&e.resume&&(t=!1,e.resume())};const r=u(e);for(let t=1;t<r.length;t++){const n=r[t];void 0===this[n]&&"function"==typeof e[n]&&(this[n]=e[n].bind(e))}return this},Y.prototype[p]=function(){return ae(this)},Y.prototype.iterator=function(e){return void 0!==e&&C(e,"options"),ae(this,e)},c(Y.prototype,{readable:{__proto__:null,get(){const e=this._readableState;return!(!e||!1===e.readable||e.destroyed||e.errorEmitted||e.endEmitted)},set(e){this._readableState&&(this._readableState.readable=!!e)}},readableDidRead:{__proto__:null,enumerable:!1,get:function(){return this._readableState.dataEmitted}},readableAborted:{__proto__:null,enumerable:!1,get:function(){return!(!1===this._readableState.readable||!this._readableState.destroyed&&!this._readableState.errored||this._readableState.endEmitted)}},readableHighWaterMark:{__proto__:null,enumerable:!1,get:function(){return this._readableState.highWaterMark}},readableBuffer:{__proto__:null,enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}},readableFlowing:{__proto__:null,enumerable:!1,get:function(){return this._readableState.flowing},set:function(e){this._readableState&&(this._readableState.flowing=e)}},readableLength:{__proto__:null,enumerable:!1,get(){return this._readableState.length}},readableObjectMode:{__proto__:null,enumerable:!1,get(){return!!this._readableState&&this._readableState.objectMode}},readableEncoding:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.encoding:null}},errored:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.errored:null}},closed:{__proto__:null,get(){return!!this._readableState&&this._readableState.closed}},destroyed:{__proto__:null,enumerable:!1,get(){return!!this._readableState&&this._readableState.destroyed},set(e){this._readableState&&(this._readableState.destroyed=e)}},readableEnded:{__proto__:null,enumerable:!1,get(){return!!this._readableState&&this._readableState.endEmitted}}}),c(G.prototype,{pipesCount:{__proto__:null,get(){return this.pipes.length}},paused:{__proto__:null,get(){return!1!==this[B]},set(e){this[B]=!!e}}}),Y._fromList=ce,Y.from=function(e,t){return U(Y,e,t)},Y.fromWeb=function(e,t){return fe().newStreamReadableFromReadableStream(e,t)},Y.toWeb=function(e,t){return fe().newReadableStreamFromStreamReadable(e,t)},Y.wrap=function(e,t){var r,n;return new Y({objectMode:null===(r=null!==(n=e.readableObjectMode)&&void 0!==n?n:e.objectMode)||void 0===r||r,...t,destroy(t,r){I.destroyer(e,t),r(t)}}).wrap(e)}},9713:(e,t,r)=>{"use strict";const{MathFloor:n,NumberIsInteger:i}=r(8744),{validateInteger:o}=r(6027),{ERR_INVALID_ARG_VALUE:s}=r(8189).codes;let a=16384,c=16;function u(e){return e?c:a}e.exports={getHighWaterMark:function(e,t,r,o){const a=function(e,t,r){return null!=e.highWaterMark?e.highWaterMark:t?e[r]:null}(t,o,r);if(null!=a){if(!i(a)||a<0)throw new s(o?`options.${r}`:"options.highWaterMark",a);return n(a)}return u(e.objectMode)},getDefaultHighWaterMark:u,setDefaultHighWaterMark:function(e,t){o(t,"value",0),e?c=t:a=t}}},7920:(e,t,r)=>{"use strict";const{ObjectSetPrototypeOf:n,Symbol:i}=r(8744);e.exports=u;const{ERR_METHOD_NOT_IMPLEMENTED:o}=r(8189).codes,s=r(4480),{getHighWaterMark:a}=r(9713);n(u.prototype,s.prototype),n(u,s);const c=i("kCallback");function u(e){if(!(this instanceof u))return new u(e);const t=e?a(this,e,"readableHighWaterMark",!0):null;0===t&&(e={...e,highWaterMark:null,readableHighWaterMark:t,writableHighWaterMark:e.writableHighWaterMark||0}),s.call(this,e),this._readableState.sync=!1,this[c]=null,e&&("function"==typeof e.transform&&(this._transform=e.transform),"function"==typeof e.flush&&(this._flush=e.flush)),this.on("prefinish",l)}function h(e){"function"!=typeof this._flush||this.destroyed?(this.push(null),e&&e()):this._flush(((t,r)=>{t?e?e(t):this.destroy(t):(null!=r&&this.push(r),this.push(null),e&&e())}))}function l(){this._final!==h&&h.call(this)}u.prototype._final=h,u.prototype._transform=function(e,t,r){throw new o("_transform()")},u.prototype._write=function(e,t,r){const n=this._readableState,i=this._writableState,o=n.length;this._transform(e,t,((e,t)=>{e?r(e):(null!=t&&this.push(t),i.ended||o===n.length||n.length<n.highWaterMark?r():this[c]=r)}))},u.prototype._read=function(){if(this[c]){const e=this[c];this[c]=null,e()}}},6921:(e,t,r)=>{"use strict";const{SymbolAsyncIterator:n,SymbolIterator:i,SymbolFor:o}=r(8744),s=o("nodejs.stream.destroyed"),a=o("nodejs.stream.errored"),c=o("nodejs.stream.readable"),u=o("nodejs.stream.writable"),h=o("nodejs.stream.disturbed"),l=o("nodejs.webstream.isClosedPromise"),d=o("nodejs.webstream.controllerErrorFunction");function f(e,t=!1){var r;return!(!e||"function"!=typeof e.pipe||"function"!=typeof e.on||t&&("function"!=typeof e.pause||"function"!=typeof e.resume)||e._writableState&&!1===(null===(r=e._readableState)||void 0===r?void 0:r.readable)||e._writableState&&!e._readableState)}function p(e){var t;return!(!e||"function"!=typeof e.write||"function"!=typeof e.on||e._readableState&&!1===(null===(t=e._writableState)||void 0===t?void 0:t.writable))}function g(e){return e&&(e._readableState||e._writableState||"function"==typeof e.write&&"function"==typeof e.on||"function"==typeof e.pipe&&"function"==typeof e.on)}function y(e){return!(!e||g(e)||"function"!=typeof e.pipeThrough||"function"!=typeof e.getReader||"function"!=typeof e.cancel)}function b(e){return!(!e||g(e)||"function"!=typeof e.getWriter||"function"!=typeof e.abort)}function m(e){return!(!e||g(e)||"object"!=typeof e.readable||"object"!=typeof e.writable)}function w(e){if(!g(e))return null;const t=e._writableState,r=e._readableState,n=t||r;return!!(e.destroyed||e[s]||null!=n&&n.destroyed)}function v(e){if(!p(e))return null;if(!0===e.writableEnded)return!0;const t=e._writableState;return(null==t||!t.errored)&&("boolean"!=typeof(null==t?void 0:t.ended)?null:t.ended)}function S(e,t){if(!f(e))return null;const r=e._readableState;return(null==r||!r.errored)&&("boolean"!=typeof(null==r?void 0:r.endEmitted)?null:!!(r.endEmitted||!1===t&&!0===r.ended&&0===r.length))}function _(e){return e&&null!=e[c]?e[c]:"boolean"!=typeof(null==e?void 0:e.readable)?null:!w(e)&&f(e)&&e.readable&&!S(e)}function E(e){return e&&null!=e[u]?e[u]:"boolean"!=typeof(null==e?void 0:e.writable)?null:!w(e)&&p(e)&&e.writable&&!v(e)}function I(e){return"boolean"==typeof e._closed&&"boolean"==typeof e._defaultKeepAlive&&"boolean"==typeof e._removedConnection&&"boolean"==typeof e._removedContLen}function A(e){return"boolean"==typeof e._sent100&&I(e)}e.exports={isDestroyed:w,kIsDestroyed:s,isDisturbed:function(e){var t;return!(!e||!(null!==(t=e[h])&&void 0!==t?t:e.readableDidRead||e.readableAborted))},kIsDisturbed:h,isErrored:function(e){var t,r,n,i,o,s,c,u,h,l;return!(!e||!(null!==(t=null!==(r=null!==(n=null!==(i=null!==(o=null!==(s=e[a])&&void 0!==s?s:e.readableErrored)&&void 0!==o?o:e.writableErrored)&&void 0!==i?i:null===(c=e._readableState)||void 0===c?void 0:c.errorEmitted)&&void 0!==n?n:null===(u=e._writableState)||void 0===u?void 0:u.errorEmitted)&&void 0!==r?r:null===(h=e._readableState)||void 0===h?void 0:h.errored)&&void 0!==t?t:null===(l=e._writableState)||void 0===l?void 0:l.errored))},kIsErrored:a,isReadable:_,kIsReadable:c,kIsClosedPromise:l,kControllerErrorFunction:d,kIsWritable:u,isClosed:function(e){if(!g(e))return null;if("boolean"==typeof e.closed)return e.closed;const t=e._writableState,r=e._readableState;return"boolean"==typeof(null==t?void 0:t.closed)||"boolean"==typeof(null==r?void 0:r.closed)?(null==t?void 0:t.closed)||(null==r?void 0:r.closed):"boolean"==typeof e._closed&&I(e)?e._closed:null},isDuplexNodeStream:function(e){return!(!e||"function"!=typeof e.pipe||!e._readableState||"function"!=typeof e.on||"function"!=typeof e.write)},isFinished:function(e,t){return g(e)?!(!w(e)&&(!1!==(null==t?void 0:t.readable)&&_(e)||!1!==(null==t?void 0:t.writable)&&E(e))):null},isIterable:function(e,t){return null!=e&&(!0===t?"function"==typeof e[n]:!1===t?"function"==typeof e[i]:"function"==typeof e[n]||"function"==typeof e[i])},isReadableNodeStream:f,isReadableStream:y,isReadableEnded:function(e){if(!f(e))return null;if(!0===e.readableEnded)return!0;const t=e._readableState;return!(!t||t.errored)&&("boolean"!=typeof(null==t?void 0:t.ended)?null:t.ended)},isReadableFinished:S,isReadableErrored:function(e){var t,r;return g(e)?e.readableErrored?e.readableErrored:null!==(t=null===(r=e._readableState)||void 0===r?void 0:r.errored)&&void 0!==t?t:null:null},isNodeStream:g,isWebStream:function(e){return y(e)||b(e)||m(e)},isWritable:E,isWritableNodeStream:p,isWritableStream:b,isWritableEnded:v,isWritableFinished:function(e,t){if(!p(e))return null;if(!0===e.writableFinished)return!0;const r=e._writableState;return(null==r||!r.errored)&&("boolean"!=typeof(null==r?void 0:r.finished)?null:!!(r.finished||!1===t&&!0===r.ended&&0===r.length))},isWritableErrored:function(e){var t,r;return g(e)?e.writableErrored?e.writableErrored:null!==(t=null===(r=e._writableState)||void 0===r?void 0:r.errored)&&void 0!==t?t:null:null},isServerRequest:function(e){var t;return"boolean"==typeof e._consuming&&"boolean"==typeof e._dumped&&void 0===(null===(t=e.req)||void 0===t?void 0:t.upgradeOrConnect)},isServerResponse:A,willEmitClose:function(e){if(!g(e))return null;const t=e._writableState,r=e._readableState,n=t||r;return!n&&A(e)||!!(n&&n.autoDestroy&&n.emitClose&&!1===n.closed)},isTransformStream:m}},4602:(e,t,r)=>{const n=r(3184),{ArrayPrototypeSlice:i,Error:o,FunctionPrototypeSymbolHasInstance:s,ObjectDefineProperty:a,ObjectDefineProperties:c,ObjectSetPrototypeOf:u,StringPrototypeToLowerCase:h,Symbol:l,SymbolHasInstance:d}=r(8744);e.exports=C,C.WritableState=N;const{EventEmitter:f}=r(8621),p=r(8705).Stream,{Buffer:g}=r(1429),y=r(2094),{addAbortSignal:b}=r(6313),{getHighWaterMark:m,getDefaultHighWaterMark:w}=r(9713),{ERR_INVALID_ARG_TYPE:v,ERR_METHOD_NOT_IMPLEMENTED:S,ERR_MULTIPLE_CALLBACK:_,ERR_STREAM_CANNOT_PIPE:E,ERR_STREAM_DESTROYED:I,ERR_STREAM_ALREADY_FINISHED:A,ERR_STREAM_NULL_VALUES:k,ERR_STREAM_WRITE_AFTER_END:x,ERR_UNKNOWN_ENCODING:P}=r(8189).codes,{errorOrDestroy:O}=y;function R(){}u(C.prototype,p.prototype),u(C,p);const T=l("kOnFinished");function N(e,t,n){"boolean"!=typeof n&&(n=t instanceof r(4480)),this.objectMode=!(!e||!e.objectMode),n&&(this.objectMode=this.objectMode||!(!e||!e.writableObjectMode)),this.highWaterMark=e?m(this,e,"writableHighWaterMark",n):w(!1),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;const i=!(!e||!1!==e.decodeStrings);this.decodeStrings=!i,this.defaultEncoding=e&&e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=D.bind(void 0,t),this.writecb=null,this.writelen=0,this.afterWriteTickInfo=null,M(this),this.pendingcb=0,this.constructed=!0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!e||!1!==e.emitClose,this.autoDestroy=!e||!1!==e.autoDestroy,this.errored=null,this.closed=!1,this.closeEmitted=!1,this[T]=[]}function M(e){e.buffered=[],e.bufferedIndex=0,e.allBuffers=!0,e.allNoop=!0}function C(e){const t=this instanceof r(4480);if(!t&&!s(C,this))return new C(e);this._writableState=new N(e,this,t),e&&("function"==typeof e.write&&(this._write=e.write),"function"==typeof e.writev&&(this._writev=e.writev),"function"==typeof e.destroy&&(this._destroy=e.destroy),"function"==typeof e.final&&(this._final=e.final),"function"==typeof e.construct&&(this._construct=e.construct),e.signal&&b(e.signal,this)),p.call(this,e),y.construct(this,(()=>{const e=this._writableState;e.writing||$(this,e),F(this,e)}))}function B(e,t,r,i){const o=e._writableState;if("function"==typeof r)i=r,r=o.defaultEncoding;else{if(r){if("buffer"!==r&&!g.isEncoding(r))throw new P(r)}else r=o.defaultEncoding;"function"!=typeof i&&(i=R)}if(null===t)throw new k;if(!o.objectMode)if("string"==typeof t)!1!==o.decodeStrings&&(t=g.from(t,r),r="buffer");else if(t instanceof g)r="buffer";else{if(!p._isUint8Array(t))throw new v("chunk",["string","Buffer","Uint8Array"],t);t=p._uint8ArrayToBuffer(t),r="buffer"}let s;return o.ending?s=new x:o.destroyed&&(s=new I("write")),s?(n.nextTick(i,s),O(e,s,!0),s):(o.pendingcb++,function(e,t,r,n,i){const o=t.objectMode?1:r.length;t.length+=o;const s=t.length<t.highWaterMark;return s||(t.needDrain=!0),t.writing||t.corked||t.errored||!t.constructed?(t.buffered.push({chunk:r,encoding:n,callback:i}),t.allBuffers&&"buffer"!==n&&(t.allBuffers=!1),t.allNoop&&i!==R&&(t.allNoop=!1)):(t.writelen=o,t.writecb=i,t.writing=!0,t.sync=!0,e._write(r,n,t.onwrite),t.sync=!1),s&&!t.errored&&!t.destroyed}(e,o,t,r,i))}function L(e,t,r,n,i,o,s){t.writelen=n,t.writecb=s,t.writing=!0,t.sync=!0,t.destroyed?t.onwrite(new I("write")):r?e._writev(i,t.onwrite):e._write(i,o,t.onwrite),t.sync=!1}function U(e,t,r,n){--t.pendingcb,n(r),q(t),O(e,r)}function D(e,t){const r=e._writableState,i=r.sync,o=r.writecb;"function"==typeof o?(r.writing=!1,r.writecb=null,r.length-=r.writelen,r.writelen=0,t?(t.stack,r.errored||(r.errored=t),e._readableState&&!e._readableState.errored&&(e._readableState.errored=t),i?n.nextTick(U,e,r,t,o):U(e,r,t,o)):(r.buffered.length>r.bufferedIndex&&$(e,r),i?null!==r.afterWriteTickInfo&&r.afterWriteTickInfo.cb===o?r.afterWriteTickInfo.count++:(r.afterWriteTickInfo={count:1,cb:o,stream:e,state:r},n.nextTick(j,r.afterWriteTickInfo)):z(e,r,1,o))):O(e,new _)}function j({stream:e,state:t,count:r,cb:n}){return t.afterWriteTickInfo=null,z(e,t,r,n)}function z(e,t,r,n){for(!t.ending&&!e.destroyed&&0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"));r-- >0;)t.pendingcb--,n();t.destroyed&&q(t),F(e,t)}function q(e){if(e.writing)return;for(let r=e.bufferedIndex;r<e.buffered.length;++r){var t;const{chunk:n,callback:i}=e.buffered[r],o=e.objectMode?1:n.length;e.length-=o,i(null!==(t=e.errored)&&void 0!==t?t:new I("write"))}const r=e[T].splice(0);for(let t=0;t<r.length;t++){var n;r[t](null!==(n=e.errored)&&void 0!==n?n:new I("end"))}M(e)}function $(e,t){if(t.corked||t.bufferProcessing||t.destroyed||!t.constructed)return;const{buffered:r,bufferedIndex:n,objectMode:o}=t,s=r.length-n;if(!s)return;let a=n;if(t.bufferProcessing=!0,s>1&&e._writev){t.pendingcb-=s-1;const n=t.allNoop?R:e=>{for(let t=a;t<r.length;++t)r[t].callback(e)},o=t.allNoop&&0===a?r:i(r,a);o.allBuffers=t.allBuffers,L(e,t,!0,t.length,o,"",n),M(t)}else{do{const{chunk:n,encoding:i,callback:s}=r[a];r[a++]=null,L(e,t,!1,o?1:n.length,n,i,s)}while(a<r.length&&!t.writing);a===r.length?M(t):a>256?(r.splice(0,a),t.bufferedIndex=0):t.bufferedIndex=a}t.bufferProcessing=!1}function K(e){return e.ending&&!e.destroyed&&e.constructed&&0===e.length&&!e.errored&&0===e.buffered.length&&!e.finished&&!e.writing&&!e.errorEmitted&&!e.closeEmitted}function F(e,t,r){K(t)&&(function(e,t){t.prefinished||t.finalCalled||("function"!=typeof e._final||t.destroyed?(t.prefinished=!0,e.emit("prefinish")):(t.finalCalled=!0,function(e,t){let r=!1;function i(i){if(r)O(e,null!=i?i:_());else if(r=!0,t.pendingcb--,i){const r=t[T].splice(0);for(let e=0;e<r.length;e++)r[e](i);O(e,i,t.sync)}else K(t)&&(t.prefinished=!0,e.emit("prefinish"),t.pendingcb++,n.nextTick(W,e,t))}t.sync=!0,t.pendingcb++;try{e._final(i)}catch(e){i(e)}t.sync=!1}(e,t)))}(e,t),0===t.pendingcb&&(r?(t.pendingcb++,n.nextTick(((e,t)=>{K(t)?W(e,t):t.pendingcb--}),e,t)):K(t)&&(t.pendingcb++,W(e,t))))}function W(e,t){t.pendingcb--,t.finished=!0;const r=t[T].splice(0);for(let e=0;e<r.length;e++)r[e]();if(e.emit("finish"),t.autoDestroy){const t=e._readableState;(!t||t.autoDestroy&&(t.endEmitted||!1===t.readable))&&e.destroy()}}N.prototype.getBuffer=function(){return i(this.buffered,this.bufferedIndex)},a(N.prototype,"bufferedRequestCount",{__proto__:null,get(){return this.buffered.length-this.bufferedIndex}}),a(C,d,{__proto__:null,value:function(e){return!!s(this,e)||this===C&&e&&e._writableState instanceof N}}),C.prototype.pipe=function(){O(this,new E)},C.prototype.write=function(e,t,r){return!0===B(this,e,t,r)},C.prototype.cork=function(){this._writableState.corked++},C.prototype.uncork=function(){const e=this._writableState;e.corked&&(e.corked--,e.writing||$(this,e))},C.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=h(e)),!g.isEncoding(e))throw new P(e);return this._writableState.defaultEncoding=e,this},C.prototype._write=function(e,t,r){if(!this._writev)throw new S("_write()");this._writev([{chunk:e,encoding:t}],r)},C.prototype._writev=null,C.prototype.end=function(e,t,r){const i=this._writableState;let s;if("function"==typeof e?(r=e,e=null,t=null):"function"==typeof t&&(r=t,t=null),null!=e){const r=B(this,e,t);r instanceof o&&(s=r)}return i.corked&&(i.corked=1,this.uncork()),s||(i.errored||i.ending?i.finished?s=new A("end"):i.destroyed&&(s=new I("end")):(i.ending=!0,F(this,i,!0),i.ended=!0)),"function"==typeof r&&(s||i.finished?n.nextTick(r,s):i[T].push(r)),this},c(C.prototype,{closed:{__proto__:null,get(){return!!this._writableState&&this._writableState.closed}},destroyed:{__proto__:null,get(){return!!this._writableState&&this._writableState.destroyed},set(e){this._writableState&&(this._writableState.destroyed=e)}},writable:{__proto__:null,get(){const e=this._writableState;return!(!e||!1===e.writable||e.destroyed||e.errored||e.ending||e.ended)},set(e){this._writableState&&(this._writableState.writable=!!e)}},writableFinished:{__proto__:null,get(){return!!this._writableState&&this._writableState.finished}},writableObjectMode:{__proto__:null,get(){return!!this._writableState&&this._writableState.objectMode}},writableBuffer:{__proto__:null,get(){return this._writableState&&this._writableState.getBuffer()}},writableEnded:{__proto__:null,get(){return!!this._writableState&&this._writableState.ending}},writableNeedDrain:{__proto__:null,get(){const e=this._writableState;return!!e&&!e.destroyed&&!e.ending&&e.needDrain}},writableHighWaterMark:{__proto__:null,get(){return this._writableState&&this._writableState.highWaterMark}},writableCorked:{__proto__:null,get(){return this._writableState?this._writableState.corked:0}},writableLength:{__proto__:null,get(){return this._writableState&&this._writableState.length}},errored:{__proto__:null,enumerable:!1,get(){return this._writableState?this._writableState.errored:null}},writableAborted:{__proto__:null,enumerable:!1,get:function(){return!(!1===this._writableState.writable||!this._writableState.destroyed&&!this._writableState.errored||this._writableState.finished)}}});const H=y.destroy;let V;function G(){return void 0===V&&(V={}),V}C.prototype.destroy=function(e,t){const r=this._writableState;return!r.destroyed&&(r.bufferedIndex<r.buffered.length||r[T].length)&&n.nextTick(q,r),H.call(this,e,t),this},C.prototype._undestroy=y.undestroy,C.prototype._destroy=function(e,t){t(e)},C.prototype[f.captureRejectionSymbol]=function(e){this.destroy(e)},C.fromWeb=function(e,t){return G().newStreamWritableFromWritableStream(e,t)},C.toWeb=function(e){return G().newWritableStreamFromStreamWritable(e)}},6027:(e,t,r)=>{"use strict";const{ArrayIsArray:n,ArrayPrototypeIncludes:i,ArrayPrototypeJoin:o,ArrayPrototypeMap:s,NumberIsInteger:a,NumberIsNaN:c,NumberMAX_SAFE_INTEGER:u,NumberMIN_SAFE_INTEGER:h,NumberParseInt:l,ObjectPrototypeHasOwnProperty:d,RegExpPrototypeExec:f,String:p,StringPrototypeToUpperCase:g,StringPrototypeTrim:y}=r(8744),{hideStackFrames:b,codes:{ERR_SOCKET_BAD_PORT:m,ERR_INVALID_ARG_TYPE:w,ERR_INVALID_ARG_VALUE:v,ERR_OUT_OF_RANGE:S,ERR_UNKNOWN_SIGNAL:_}}=r(8189),{normalizeEncoding:E}=r(4030),{isAsyncFunction:I,isArrayBufferView:A}=r(4030).types,k={},x=/^[0-7]+$/,P=b(((e,t,r=h,n=u)=>{if("number"!=typeof e)throw new w(t,"number",e);if(!a(e))throw new S(t,"an integer",e);if(e<r||e>n)throw new S(t,`>= ${r} && <= ${n}`,e)})),O=b(((e,t,r=-2147483648,n=2147483647)=>{if("number"!=typeof e)throw new w(t,"number",e);if(!a(e))throw new S(t,"an integer",e);if(e<r||e>n)throw new S(t,`>= ${r} && <= ${n}`,e)})),R=b(((e,t,r=!1)=>{if("number"!=typeof e)throw new w(t,"number",e);if(!a(e))throw new S(t,"an integer",e);const n=r?1:0,i=4294967295;if(e<n||e>i)throw new S(t,`>= ${n} && <= ${i}`,e)}));function T(e,t){if("string"!=typeof e)throw new w(t,"string",e)}const N=b(((e,t,r)=>{if(!i(r,e)){const n=o(s(r,(e=>"string"==typeof e?`'${e}'`:p(e))),", ");throw new v(t,e,"must be one of: "+n)}}));function M(e,t){if("boolean"!=typeof e)throw new w(t,"boolean",e)}function C(e,t,r){return null!=e&&d(e,t)?e[t]:r}const B=b(((e,t,r=null)=>{const i=C(r,"allowArray",!1),o=C(r,"allowFunction",!1);if(!C(r,"nullable",!1)&&null===e||!i&&n(e)||"object"!=typeof e&&(!o||"function"!=typeof e))throw new w(t,"Object",e)})),L=b(((e,t)=>{if(null!=e&&"object"!=typeof e&&"function"!=typeof e)throw new w(t,"a dictionary",e)})),U=b(((e,t,r=0)=>{if(!n(e))throw new w(t,"Array",e);if(e.length<r)throw new v(t,e,`must be longer than ${r}`)})),D=b(((e,t="buffer")=>{if(!A(e))throw new w(t,["Buffer","TypedArray","DataView"],e)})),j=b(((e,t)=>{if(void 0!==e&&(null===e||"object"!=typeof e||!("aborted"in e)))throw new w(t,"AbortSignal",e)})),z=b(((e,t)=>{if("function"!=typeof e)throw new w(t,"Function",e)})),q=b(((e,t)=>{if("function"!=typeof e||I(e))throw new w(t,"Function",e)})),$=b(((e,t)=>{if(void 0!==e)throw new w(t,"undefined",e)})),K=/^(?:<[^>]*>)(?:\s*;\s*[^;"\s]+(?:=(")?[^;"\s]*\1)?)*$/;function F(e,t){if(void 0===e||!f(K,e))throw new v(t,e,'must be an array or string of format "</styles.css>; rel=preload; as=style"')}e.exports={isInt32:function(e){return e===(0|e)},isUint32:function(e){return e===e>>>0},parseFileMode:function(e,t,r){if(void 0===e&&(e=r),"string"==typeof e){if(null===f(x,e))throw new v(t,e,"must be a 32-bit unsigned integer or an octal string");e=l(e,8)}return R(e,t),e},validateArray:U,validateStringArray:function(e,t){U(e,t);for(let r=0;r<e.length;r++)T(e[r],`${t}[${r}]`)},validateBooleanArray:function(e,t){U(e,t);for(let r=0;r<e.length;r++)M(e[r],`${t}[${r}]`)},validateAbortSignalArray:function(e,t){U(e,t);for(let r=0;r<e.length;r++){const n=e[r],i=`${t}[${r}]`;if(null==n)throw new w(i,"AbortSignal",n);j(n,i)}},validateBoolean:M,validateBuffer:D,validateDictionary:L,validateEncoding:function(e,t){const r=E(t),n=e.length;if("hex"===r&&n%2!=0)throw new v("encoding",t,`is invalid for data of length ${n}`)},validateFunction:z,validateInt32:O,validateInteger:P,validateNumber:function(e,t,r=void 0,n){if("number"!=typeof e)throw new w(t,"number",e);if(null!=r&&e<r||null!=n&&e>n||(null!=r||null!=n)&&c(e))throw new S(t,`${null!=r?`>= ${r}`:""}${null!=r&&null!=n?" && ":""}${null!=n?`<= ${n}`:""}`,e)},validateObject:B,validateOneOf:N,validatePlainFunction:q,validatePort:function(e,t="Port",r=!0){if("number"!=typeof e&&"string"!=typeof e||"string"==typeof e&&0===y(e).length||+e!=+e>>>0||e>65535||0===e&&!r)throw new m(t,e,r);return 0|e},validateSignalName:function(e,t="signal"){if(T(e,t),void 0===k[e]){if(void 0!==k[g(e)])throw new _(e+" (signals must use all capital letters)");throw new _(e)}},validateString:T,validateUint32:R,validateUndefined:$,validateUnion:function(e,t,r){if(!i(r,e))throw new w(t,`('${o(r,"|")}')`,e)},validateAbortSignal:j,validateLinkHeaderValue:function(e){if("string"==typeof e)return F(e,"hints"),e;if(n(e)){const t=e.length;let r="";if(0===t)return r;for(let n=0;n<t;n++){const i=e[n];F(i,"hints"),r+=i,n!==t-1&&(r+=", ")}return r}throw new v("hints",e,'must be an array or string of format "</styles.css>; rel=preload; as=style"')}}},1432:(e,t,r)=>{"use strict";const n=r(5652),i=r(3033),o=n.Readable.destroy;e.exports=n.Readable,e.exports._uint8ArrayToBuffer=n._uint8ArrayToBuffer,e.exports._isUint8Array=n._isUint8Array,e.exports.isDisturbed=n.isDisturbed,e.exports.isErrored=n.isErrored,e.exports.isReadable=n.isReadable,e.exports.Readable=n.Readable,e.exports.Writable=n.Writable,e.exports.Duplex=n.Duplex,e.exports.Transform=n.Transform,e.exports.PassThrough=n.PassThrough,e.exports.addAbortSignal=n.addAbortSignal,e.exports.finished=n.finished,e.exports.destroy=n.destroy,e.exports.destroy=o,e.exports.pipeline=n.pipeline,e.exports.compose=n.compose,Object.defineProperty(n,"promises",{configurable:!0,enumerable:!0,get:()=>i}),e.exports.Stream=n.Stream,e.exports.default=e.exports},8189:(e,t,r)=>{"use strict";const{format:n,inspect:i,AggregateError:o}=r(4030),s=globalThis.AggregateError||o,a=Symbol("kIsNodeError"),c=["string","function","number","object","Function","Object","boolean","bigint","symbol"],u=/^([A-Z][a-z0-9]*)+$/,h={};function l(e,t){if(!e)throw new h.ERR_INTERNAL_ASSERTION(t)}function d(e){let t="",r=e.length;const n="-"===e[0]?1:0;for(;r>=n+4;r-=3)t=`_${e.slice(r-3,r)}${t}`;return`${e.slice(0,r)}${t}`}function f(e,t,r){r||(r=Error);class i extends r{constructor(...r){super(function(e,t,r){if("function"==typeof t)return l(t.length<=r.length,`Code: ${e}; The provided arguments length (${r.length}) does not match the required ones (${t.length}).`),t(...r);const i=(t.match(/%[dfijoOs]/g)||[]).length;return l(i===r.length,`Code: ${e}; The provided arguments length (${r.length}) does not match the required ones (${i}).`),0===r.length?t:n(t,...r)}(e,t,r))}toString(){return`${this.name} [${e}]: ${this.message}`}}Object.defineProperties(i.prototype,{name:{value:r.name,writable:!0,enumerable:!1,configurable:!0},toString:{value(){return`${this.name} [${e}]: ${this.message}`},writable:!0,enumerable:!1,configurable:!0}}),i.prototype.code=e,i.prototype[a]=!0,h[e]=i}function p(e){const t="__node_internal_"+e.name;return Object.defineProperty(e,"name",{value:t}),e}class g extends Error{constructor(e="The operation was aborted",t=void 0){if(void 0!==t&&"object"!=typeof t)throw new h.ERR_INVALID_ARG_TYPE("options","Object",t);super(e,t),this.code="ABORT_ERR",this.name="AbortError"}}f("ERR_ASSERTION","%s",Error),f("ERR_INVALID_ARG_TYPE",((e,t,r)=>{l("string"==typeof e,"'name' must be a string"),Array.isArray(t)||(t=[t]);let n="The ";e.endsWith(" argument")?n+=`${e} `:n+=`"${e}" ${e.includes(".")?"property":"argument"} `,n+="must be ";const o=[],s=[],a=[];for(const e of t)l("string"==typeof e,"All expected entries have to be of type string"),c.includes(e)?o.push(e.toLowerCase()):u.test(e)?s.push(e):(l("object"!==e,'The value "object" should be written as "Object"'),a.push(e));if(s.length>0){const e=o.indexOf("object");-1!==e&&(o.splice(o,e,1),s.push("Object"))}if(o.length>0){switch(o.length){case 1:n+=`of type ${o[0]}`;break;case 2:n+=`one of type ${o[0]} or ${o[1]}`;break;default:{const e=o.pop();n+=`one of type ${o.join(", ")}, or ${e}`}}(s.length>0||a.length>0)&&(n+=" or ")}if(s.length>0){switch(s.length){case 1:n+=`an instance of ${s[0]}`;break;case 2:n+=`an instance of ${s[0]} or ${s[1]}`;break;default:{const e=s.pop();n+=`an instance of ${s.join(", ")}, or ${e}`}}a.length>0&&(n+=" or ")}switch(a.length){case 0:break;case 1:a[0].toLowerCase()!==a[0]&&(n+="an "),n+=`${a[0]}`;break;case 2:n+=`one of ${a[0]} or ${a[1]}`;break;default:{const e=a.pop();n+=`one of ${a.join(", ")}, or ${e}`}}if(null==r)n+=`. Received ${r}`;else if("function"==typeof r&&r.name)n+=`. Received function ${r.name}`;else if("object"==typeof r){var h;null!==(h=r.constructor)&&void 0!==h&&h.name?n+=`. Received an instance of ${r.constructor.name}`:n+=`. Received ${i(r,{depth:-1})}`}else{let e=i(r,{colors:!1});e.length>25&&(e=`${e.slice(0,25)}...`),n+=`. Received type ${typeof r} (${e})`}return n}),TypeError),f("ERR_INVALID_ARG_VALUE",((e,t,r="is invalid")=>{let n=i(t);return n.length>128&&(n=n.slice(0,128)+"..."),`The ${e.includes(".")?"property":"argument"} '${e}' ${r}. Received ${n}`}),TypeError),f("ERR_INVALID_RETURN_VALUE",((e,t,r)=>{var n;return`Expected ${e} to be returned from the "${t}" function but got ${null!=r&&null!==(n=r.constructor)&&void 0!==n&&n.name?`instance of ${r.constructor.name}`:"type "+typeof r}.`}),TypeError),f("ERR_MISSING_ARGS",((...e)=>{let t;l(e.length>0,"At least one arg needs to be specified");const r=e.length;switch(e=(Array.isArray(e)?e:[e]).map((e=>`"${e}"`)).join(" or "),r){case 1:t+=`The ${e[0]} argument`;break;case 2:t+=`The ${e[0]} and ${e[1]} arguments`;break;default:{const r=e.pop();t+=`The ${e.join(", ")}, and ${r} arguments`}}return`${t} must be specified`}),TypeError),f("ERR_OUT_OF_RANGE",((e,t,r)=>{let n;return l(t,'Missing "range" argument'),Number.isInteger(r)&&Math.abs(r)>2**32?n=d(String(r)):"bigint"==typeof r?(n=String(r),(r>2n**32n||r<-(2n**32n))&&(n=d(n)),n+="n"):n=i(r),`The value of "${e}" is out of range. It must be ${t}. Received ${n}`}),RangeError),f("ERR_MULTIPLE_CALLBACK","Callback called multiple times",Error),f("ERR_METHOD_NOT_IMPLEMENTED","The %s method is not implemented",Error),f("ERR_STREAM_ALREADY_FINISHED","Cannot call %s after a stream was finished",Error),f("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable",Error),f("ERR_STREAM_DESTROYED","Cannot call %s after a stream was destroyed",Error),f("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),f("ERR_STREAM_PREMATURE_CLOSE","Premature close",Error),f("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF",Error),f("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event",Error),f("ERR_STREAM_WRITE_AFTER_END","write after end",Error),f("ERR_UNKNOWN_ENCODING","Unknown encoding: %s",TypeError),e.exports={AbortError:g,aggregateTwoErrors:p((function(e,t){if(e&&t&&e!==t){if(Array.isArray(t.errors))return t.errors.push(e),t;const r=new s([t,e],t.message);return r.code=t.code,r}return e||t})),hideStackFrames:p,codes:h}},8744:e=>{"use strict";e.exports={ArrayIsArray:e=>Array.isArray(e),ArrayPrototypeIncludes:(e,t)=>e.includes(t),ArrayPrototypeIndexOf:(e,t)=>e.indexOf(t),ArrayPrototypeJoin:(e,t)=>e.join(t),ArrayPrototypeMap:(e,t)=>e.map(t),ArrayPrototypePop:(e,t)=>e.pop(t),ArrayPrototypePush:(e,t)=>e.push(t),ArrayPrototypeSlice:(e,t,r)=>e.slice(t,r),Error,FunctionPrototypeCall:(e,t,...r)=>e.call(t,...r),FunctionPrototypeSymbolHasInstance:(e,t)=>Function.prototype[Symbol.hasInstance].call(e,t),MathFloor:Math.floor,Number,NumberIsInteger:Number.isInteger,NumberIsNaN:Number.isNaN,NumberMAX_SAFE_INTEGER:Number.MAX_SAFE_INTEGER,NumberMIN_SAFE_INTEGER:Number.MIN_SAFE_INTEGER,NumberParseInt:Number.parseInt,ObjectDefineProperties:(e,t)=>Object.defineProperties(e,t),ObjectDefineProperty:(e,t,r)=>Object.defineProperty(e,t,r),ObjectGetOwnPropertyDescriptor:(e,t)=>Object.getOwnPropertyDescriptor(e,t),ObjectKeys:e=>Object.keys(e),ObjectSetPrototypeOf:(e,t)=>Object.setPrototypeOf(e,t),Promise,PromisePrototypeCatch:(e,t)=>e.catch(t),PromisePrototypeThen:(e,t,r)=>e.then(t,r),PromiseReject:e=>Promise.reject(e),PromiseResolve:e=>Promise.resolve(e),ReflectApply:Reflect.apply,RegExpPrototypeTest:(e,t)=>e.test(t),SafeSet:Set,String,StringPrototypeSlice:(e,t,r)=>e.slice(t,r),StringPrototypeToLowerCase:e=>e.toLowerCase(),StringPrototypeToUpperCase:e=>e.toUpperCase(),StringPrototypeTrim:e=>e.trim(),Symbol,SymbolFor:Symbol.for,SymbolAsyncIterator:Symbol.asyncIterator,SymbolHasInstance:Symbol.hasInstance,SymbolIterator:Symbol.iterator,SymbolDispose:Symbol.dispose||Symbol("Symbol.dispose"),SymbolAsyncDispose:Symbol.asyncDispose||Symbol("Symbol.asyncDispose"),TypedArrayPrototypeSet:(e,t,r)=>e.set(t,r),Boolean,Uint8Array}},4030:(e,t,r)=>{"use strict";const n=r(1429),{kResistStopPropagation:i,SymbolDispose:o}=r(8744),s=globalThis.AbortSignal||r(1630).AbortSignal,a=globalThis.AbortController||r(1630).AbortController,c=Object.getPrototypeOf((async function(){})).constructor,u=globalThis.Blob||n.Blob,h=void 0!==u?function(e){return e instanceof u}:function(e){return!1},l=(e,t)=>{if(void 0!==e&&(null===e||"object"!=typeof e||!("aborted"in e)))throw new ERR_INVALID_ARG_TYPE(t,"AbortSignal",e)};class d extends Error{constructor(e){if(!Array.isArray(e))throw new TypeError("Expected input to be an Array, got "+typeof e);let t="";for(let r=0;r<e.length;r++)t+=`    ${e[r].stack}\n`;super(t),this.name="AggregateError",this.errors=e}}e.exports={AggregateError:d,kEmptyObject:Object.freeze({}),once(e){let t=!1;return function(...r){t||(t=!0,e.apply(this,r))}},createDeferredPromise:function(){let e,t;return{promise:new Promise(((r,n)=>{e=r,t=n})),resolve:e,reject:t}},promisify:e=>new Promise(((t,r)=>{e(((e,...n)=>e?r(e):t(...n)))})),debuglog:()=>function(){},format:(e,...t)=>e.replace(/%([sdifj])/g,(function(...[e,r]){const n=t.shift();return"f"===r?n.toFixed(6):"j"===r?JSON.stringify(n):"s"===r&&"object"==typeof n?`${n.constructor!==Object?n.constructor.name:""} {}`.trim():n.toString()})),inspect(e){switch(typeof e){case"string":if(e.includes("'")){if(!e.includes('"'))return`"${e}"`;if(!e.includes("`")&&!e.includes("${"))return`\`${e}\``}return`'${e}'`;case"number":return isNaN(e)?"NaN":Object.is(e,-0)?String(e):e;case"bigint":return`${String(e)}n`;case"boolean":case"undefined":return String(e);case"object":return"{}"}},types:{isAsyncFunction:e=>e instanceof c,isArrayBufferView:e=>ArrayBuffer.isView(e)},isBlob:h,deprecate:(e,t)=>e,addAbortListener:r(8621).addAbortListener||function(e,t){if(void 0===e)throw new ERR_INVALID_ARG_TYPE("signal","AbortSignal",e);let r;return l(e,"signal"),(e=>{if("function"!=typeof e)throw new ERR_INVALID_ARG_TYPE("listener","Function",e)})(t),e.aborted?queueMicrotask((()=>t())):(e.addEventListener("abort",t,{__proto__:null,once:!0,[i]:!0}),r=()=>{e.removeEventListener("abort",t)}),{__proto__:null,[o](){var e;null===(e=r)||void 0===e||e()}}},AbortSignalAny:s.any||function(e){if(1===e.length)return e[0];const t=new a,r=()=>t.abort();return e.forEach((e=>{l(e,"signals"),e.addEventListener("abort",r,{once:!0})})),t.signal.addEventListener("abort",(()=>{e.forEach((e=>e.removeEventListener("abort",r)))}),{once:!0}),t.signal}},e.exports.promisify.custom=Symbol.for("nodejs.util.promisify.custom")},5652:(e,t,r)=>{const{Buffer:n}=r(1429),{ObjectDefineProperty:i,ObjectKeys:o,ReflectApply:s}=r(8744),{promisify:{custom:a}}=r(4030),{streamReturningOperators:c,promiseReturningOperators:u}=r(4069),{codes:{ERR_ILLEGAL_CONSTRUCTOR:h}}=r(8189),l=r(5648),{setDefaultHighWaterMark:d,getDefaultHighWaterMark:f}=r(9713),{pipeline:p}=r(7608),{destroyer:g}=r(2094),y=r(5444),b=r(3033),m=r(6921),w=e.exports=r(8705).Stream;w.isDestroyed=m.isDestroyed,w.isDisturbed=m.isDisturbed,w.isErrored=m.isErrored,w.isReadable=m.isReadable,w.isWritable=m.isWritable,w.Readable=r(710);for(const _ of o(c)){const E=c[_];function v(...e){if(new.target)throw h();return w.Readable.from(s(E,this,e))}i(v,"name",{__proto__:null,value:E.name}),i(v,"length",{__proto__:null,value:E.length}),i(w.Readable.prototype,_,{__proto__:null,value:v,enumerable:!1,configurable:!0,writable:!0})}for(const I of o(u)){const A=u[I];function v(...e){if(new.target)throw h();return s(A,this,e)}i(v,"name",{__proto__:null,value:A.name}),i(v,"length",{__proto__:null,value:A.length}),i(w.Readable.prototype,I,{__proto__:null,value:v,enumerable:!1,configurable:!0,writable:!0})}w.Writable=r(4602),w.Duplex=r(4480),w.Transform=r(7920),w.PassThrough=r(9010),w.pipeline=p;const{addAbortSignal:S}=r(6313);w.addAbortSignal=S,w.finished=y,w.destroy=g,w.compose=l,w.setDefaultHighWaterMark=d,w.getDefaultHighWaterMark=f,i(w,"promises",{__proto__:null,configurable:!0,enumerable:!0,get:()=>b}),i(p,a,{__proto__:null,enumerable:!0,get:()=>b.pipeline}),i(y,a,{__proto__:null,enumerable:!0,get:()=>b.finished}),w.Stream=w,w._isUint8Array=function(e){return e instanceof Uint8Array},w._uint8ArrayToBuffer=function(e){return n.from(e.buffer,e.byteOffset,e.byteLength)}},3033:(e,t,r)=>{"use strict";const{ArrayPrototypePop:n,Promise:i}=r(8744),{isIterable:o,isNodeStream:s,isWebStream:a}=r(6921),{pipelineImpl:c}=r(7608),{finished:u}=r(5444);r(5652),e.exports={finished:u,pipeline:function(...e){return new i(((t,r)=>{let i,u;const h=e[e.length-1];if(h&&"object"==typeof h&&!s(h)&&!o(h)&&!a(h)){const t=n(e);i=t.signal,u=t.end}c(e,((e,n)=>{e?r(e):t(n)}),{signal:i,end:u})}))}}},7667:(e,t,r)=>{"use strict";var n=r(5719).Buffer,i=n.isEncoding||function(e){switch((e=""+e)&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function o(e){var t;switch(this.encoding=function(e){var t=function(e){if(!e)return"utf8";for(var t;;)switch(e){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return e;default:if(t)return;e=(""+e).toLowerCase(),t=!0}}(e);if("string"!=typeof t&&(n.isEncoding===i||!i(e)))throw new Error("Unknown encoding: "+e);return t||e}(e),this.encoding){case"utf16le":this.text=c,this.end=u,t=4;break;case"utf8":this.fillLast=a,t=4;break;case"base64":this.text=h,this.end=l,t=3;break;default:return this.write=d,void(this.end=f)}this.lastNeed=0,this.lastTotal=0,this.lastChar=n.allocUnsafe(t)}function s(e){return e<=127?0:e>>5==6?2:e>>4==14?3:e>>3==30?4:e>>6==2?-1:-2}function a(e){var t=this.lastTotal-this.lastNeed,r=function(e,t){if(128!=(192&t[0]))return e.lastNeed=0,"�";if(e.lastNeed>1&&t.length>1){if(128!=(192&t[1]))return e.lastNeed=1,"�";if(e.lastNeed>2&&t.length>2&&128!=(192&t[2]))return e.lastNeed=2,"�"}}(this,e);return void 0!==r?r:this.lastNeed<=e.length?(e.copy(this.lastChar,t,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(e.copy(this.lastChar,t,0,e.length),void(this.lastNeed-=e.length))}function c(e,t){if((e.length-t)%2==0){var r=e.toString("utf16le",t);if(r){var n=r.charCodeAt(r.length-1);if(n>=55296&&n<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1],r.slice(0,-1)}return r}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=e[e.length-1],e.toString("utf16le",t,e.length-1)}function u(e){var t=e&&e.length?this.write(e):"";if(this.lastNeed){var r=this.lastTotal-this.lastNeed;return t+this.lastChar.toString("utf16le",0,r)}return t}function h(e,t){var r=(e.length-t)%3;return 0===r?e.toString("base64",t):(this.lastNeed=3-r,this.lastTotal=3,1===r?this.lastChar[0]=e[e.length-1]:(this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1]),e.toString("base64",t,e.length-r))}function l(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+this.lastChar.toString("base64",0,3-this.lastNeed):t}function d(e){return e.toString(this.encoding)}function f(e){return e&&e.length?this.write(e):""}t.StringDecoder=o,o.prototype.write=function(e){if(0===e.length)return"";var t,r;if(this.lastNeed){if(void 0===(t=this.fillLast(e)))return"";r=this.lastNeed,this.lastNeed=0}else r=0;return r<e.length?t?t+this.text(e,r):this.text(e,r):t||""},o.prototype.end=function(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+"�":t},o.prototype.text=function(e,t){var r=function(e,t,r){var n=t.length-1;if(n<r)return 0;var i=s(t[n]);return i>=0?(i>0&&(e.lastNeed=i-1),i):--n<r||-2===i?0:(i=s(t[n]))>=0?(i>0&&(e.lastNeed=i-2),i):--n<r||-2===i?0:(i=s(t[n]))>=0?(i>0&&(2===i?i=0:e.lastNeed=i-3),i):0}(this,e,t);if(!this.lastNeed)return e.toString("utf8",t);this.lastTotal=r;var n=e.length-(r-this.lastNeed);return e.copy(this.lastChar,0,n),e.toString("utf8",t,n)},o.prototype.fillLast=function(e){if(this.lastNeed<=e.length)return e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,e.length),this.lastNeed-=e.length}},1630:e=>{"use strict";const{AbortController:t,AbortSignal:r}="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0;e.exports=t,e.exports.AbortSignal=r,e.exports.default=t},7810:(e,t,r)=>{"use strict";var n=r(5719).Buffer;e.exports=function(e){if(e.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),r=0;r<t.length;r++)t[r]=255;for(var i=0;i<e.length;i++){var o=e.charAt(i),s=o.charCodeAt(0);if(255!==t[s])throw new TypeError(o+" is ambiguous");t[s]=i}var a=e.length,c=e.charAt(0),u=Math.log(a)/Math.log(256),h=Math.log(256)/Math.log(a);function l(e){if("string"!=typeof e)throw new TypeError("Expected String");if(0===e.length)return n.alloc(0);for(var r=0,i=0,o=0;e[r]===c;)i++,r++;for(var s=(e.length-r)*u+1>>>0,h=new Uint8Array(s);r<e.length;){var l=t[e.charCodeAt(r)];if(255===l)return;for(var d=0,f=s-1;(0!==l||d<o)&&-1!==f;f--,d++)l+=a*h[f]>>>0,h[f]=l%256>>>0,l=l/256>>>0;if(0!==l)throw new Error("Non-zero carry");o=d,r++}for(var p=s-o;p!==s&&0===h[p];)p++;var g=n.allocUnsafe(i+(s-p));g.fill(0,0,i);for(var y=i;p!==s;)g[y++]=h[p++];return g}return{encode:function(t){if((Array.isArray(t)||t instanceof Uint8Array)&&(t=n.from(t)),!n.isBuffer(t))throw new TypeError("Expected Buffer");if(0===t.length)return"";for(var r=0,i=0,o=0,s=t.length;o!==s&&0===t[o];)o++,r++;for(var u=(s-o)*h+1>>>0,l=new Uint8Array(u);o!==s;){for(var d=t[o],f=0,p=u-1;(0!==d||f<i)&&-1!==p;p--,f++)d+=256*l[p]>>>0,l[p]=d%a>>>0,d=d/a>>>0;if(0!==d)throw new Error("Non-zero carry");i=f,o++}for(var g=u-i;g!==u&&0===l[g];)g++;for(var y=c.repeat(r);g<u;++g)y+=e.charAt(l[g]);return y},decodeUnsafe:l,decode:function(e){var t=l(e);if(t)return t;throw new Error("Non-base"+a+" character")}}}},4028:(e,t)=>{"use strict";t.byteLength=function(e){var t=a(e),r=t[0],n=t[1];return 3*(r+n)/4-n},t.toByteArray=function(e){var t,r,o=a(e),s=o[0],c=o[1],u=new i(function(e,t,r){return 3*(t+r)/4-r}(0,s,c)),h=0,l=c>0?s-4:s;for(r=0;r<l;r+=4)t=n[e.charCodeAt(r)]<<18|n[e.charCodeAt(r+1)]<<12|n[e.charCodeAt(r+2)]<<6|n[e.charCodeAt(r+3)],u[h++]=t>>16&255,u[h++]=t>>8&255,u[h++]=255&t;return 2===c&&(t=n[e.charCodeAt(r)]<<2|n[e.charCodeAt(r+1)]>>4,u[h++]=255&t),1===c&&(t=n[e.charCodeAt(r)]<<10|n[e.charCodeAt(r+1)]<<4|n[e.charCodeAt(r+2)]>>2,u[h++]=t>>8&255,u[h++]=255&t),u},t.fromByteArray=function(e){for(var t,n=e.length,i=n%3,o=[],s=16383,a=0,u=n-i;a<u;a+=s)o.push(c(e,a,a+s>u?u:a+s));return 1===i?(t=e[n-1],o.push(r[t>>2]+r[t<<4&63]+"==")):2===i&&(t=(e[n-2]<<8)+e[n-1],o.push(r[t>>10]+r[t>>4&63]+r[t<<2&63]+"=")),o.join("")};for(var r=[],n=[],i="undefined"!=typeof Uint8Array?Uint8Array:Array,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0;s<64;++s)r[s]=o[s],n[o.charCodeAt(s)]=s;function a(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=e.indexOf("=");return-1===r&&(r=t),[r,r===t?0:4-r%4]}function c(e,t,n){for(var i,o,s=[],a=t;a<n;a+=3)i=(e[a]<<16&16711680)+(e[a+1]<<8&65280)+(255&e[a+2]),s.push(r[(o=i)>>18&63]+r[o>>12&63]+r[o>>6&63]+r[63&o]);return s.join("")}n["-".charCodeAt(0)]=62,n["_".charCodeAt(0)]=63},2550:(e,t,r)=>{"use strict";var n=r(1429).Buffer;t.k5=function(e){{const t=n.from(e);t.reverse();const r=t.toString("hex");return 0===r.length?BigInt(0):BigInt(`0x${r}`)}},t.Bq=function(e,t){{const r=e.toString(16),i=n.from(r.padStart(2*t,"0").slice(0,2*t),"hex");return i.reverse(),i}}},5530:function(e,t,r){!function(e,t){"use strict";function n(e,t){if(!e)throw new Error(t||"Assertion failed")}function i(e,t){e.super_=t;var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e}function o(e,t,r){if(o.isBN(e))return e;this.negative=0,this.words=null,this.length=0,this.red=null,null!==e&&("le"!==t&&"be"!==t||(r=t,t=10),this._init(e||0,t||10,r||"be"))}var s;"object"==typeof e?e.exports=o:t.BN=o,o.BN=o,o.wordSize=26;try{s="undefined"!=typeof window&&void 0!==window.Buffer?window.Buffer:r(1040).Buffer}catch(e){}function a(e,t){var r=e.charCodeAt(t);return r>=48&&r<=57?r-48:r>=65&&r<=70?r-55:r>=97&&r<=102?r-87:void n(!1,"Invalid character in "+e)}function c(e,t,r){var n=a(e,r);return r-1>=t&&(n|=a(e,r-1)<<4),n}function u(e,t,r,i){for(var o=0,s=0,a=Math.min(e.length,r),c=t;c<a;c++){var u=e.charCodeAt(c)-48;o*=i,s=u>=49?u-49+10:u>=17?u-17+10:u,n(u>=0&&s<i,"Invalid character"),o+=s}return o}function h(e,t){e.words=t.words,e.length=t.length,e.negative=t.negative,e.red=t.red}if(o.isBN=function(e){return e instanceof o||null!==e&&"object"==typeof e&&e.constructor.wordSize===o.wordSize&&Array.isArray(e.words)},o.max=function(e,t){return e.cmp(t)>0?e:t},o.min=function(e,t){return e.cmp(t)<0?e:t},o.prototype._init=function(e,t,r){if("number"==typeof e)return this._initNumber(e,t,r);if("object"==typeof e)return this._initArray(e,t,r);"hex"===t&&(t=16),n(t===(0|t)&&t>=2&&t<=36);var i=0;"-"===(e=e.toString().replace(/\s+/g,""))[0]&&(i++,this.negative=1),i<e.length&&(16===t?this._parseHex(e,i,r):(this._parseBase(e,t,i),"le"===r&&this._initArray(this.toArray(),t,r)))},o.prototype._initNumber=function(e,t,r){e<0&&(this.negative=1,e=-e),e<67108864?(this.words=[67108863&e],this.length=1):e<4503599627370496?(this.words=[67108863&e,e/67108864&67108863],this.length=2):(n(e<9007199254740992),this.words=[67108863&e,e/67108864&67108863,1],this.length=3),"le"===r&&this._initArray(this.toArray(),t,r)},o.prototype._initArray=function(e,t,r){if(n("number"==typeof e.length),e.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(e.length/3),this.words=new Array(this.length);for(var i=0;i<this.length;i++)this.words[i]=0;var o,s,a=0;if("be"===r)for(i=e.length-1,o=0;i>=0;i-=3)s=e[i]|e[i-1]<<8|e[i-2]<<16,this.words[o]|=s<<a&67108863,this.words[o+1]=s>>>26-a&67108863,(a+=24)>=26&&(a-=26,o++);else if("le"===r)for(i=0,o=0;i<e.length;i+=3)s=e[i]|e[i+1]<<8|e[i+2]<<16,this.words[o]|=s<<a&67108863,this.words[o+1]=s>>>26-a&67108863,(a+=24)>=26&&(a-=26,o++);return this._strip()},o.prototype._parseHex=function(e,t,r){this.length=Math.ceil((e.length-t)/6),this.words=new Array(this.length);for(var n=0;n<this.length;n++)this.words[n]=0;var i,o=0,s=0;if("be"===r)for(n=e.length-1;n>=t;n-=2)i=c(e,t,n)<<o,this.words[s]|=67108863&i,o>=18?(o-=18,s+=1,this.words[s]|=i>>>26):o+=8;else for(n=(e.length-t)%2==0?t+1:t;n<e.length;n+=2)i=c(e,t,n)<<o,this.words[s]|=67108863&i,o>=18?(o-=18,s+=1,this.words[s]|=i>>>26):o+=8;this._strip()},o.prototype._parseBase=function(e,t,r){this.words=[0],this.length=1;for(var n=0,i=1;i<=67108863;i*=t)n++;n--,i=i/t|0;for(var o=e.length-r,s=o%n,a=Math.min(o,o-s)+r,c=0,h=r;h<a;h+=n)c=u(e,h,h+n,t),this.imuln(i),this.words[0]+c<67108864?this.words[0]+=c:this._iaddn(c);if(0!==s){var l=1;for(c=u(e,h,e.length,t),h=0;h<s;h++)l*=t;this.imuln(l),this.words[0]+c<67108864?this.words[0]+=c:this._iaddn(c)}this._strip()},o.prototype.copy=function(e){e.words=new Array(this.length);for(var t=0;t<this.length;t++)e.words[t]=this.words[t];e.length=this.length,e.negative=this.negative,e.red=this.red},o.prototype._move=function(e){h(e,this)},o.prototype.clone=function(){var e=new o(null);return this.copy(e),e},o.prototype._expand=function(e){for(;this.length<e;)this.words[this.length++]=0;return this},o.prototype._strip=function(){for(;this.length>1&&0===this.words[this.length-1];)this.length--;return this._normSign()},o.prototype._normSign=function(){return 1===this.length&&0===this.words[0]&&(this.negative=0),this},"undefined"!=typeof Symbol&&"function"==typeof Symbol.for)try{o.prototype[Symbol.for("nodejs.util.inspect.custom")]=l}catch(e){o.prototype.inspect=l}else o.prototype.inspect=l;function l(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"}var d=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],f=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],p=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];function g(e,t,r){r.negative=t.negative^e.negative;var n=e.length+t.length|0;r.length=n,n=n-1|0;var i=0|e.words[0],o=0|t.words[0],s=i*o,a=67108863&s,c=s/67108864|0;r.words[0]=a;for(var u=1;u<n;u++){for(var h=c>>>26,l=67108863&c,d=Math.min(u,t.length-1),f=Math.max(0,u-e.length+1);f<=d;f++){var p=u-f|0;h+=(s=(i=0|e.words[p])*(o=0|t.words[f])+l)/67108864|0,l=67108863&s}r.words[u]=0|l,c=0|h}return 0!==c?r.words[u]=0|c:r.length--,r._strip()}o.prototype.toString=function(e,t){var r;if(t=0|t||1,16===(e=e||10)||"hex"===e){r="";for(var i=0,o=0,s=0;s<this.length;s++){var a=this.words[s],c=(16777215&(a<<i|o)).toString(16);o=a>>>24-i&16777215,(i+=2)>=26&&(i-=26,s--),r=0!==o||s!==this.length-1?d[6-c.length]+c+r:c+r}for(0!==o&&(r=o.toString(16)+r);r.length%t!=0;)r="0"+r;return 0!==this.negative&&(r="-"+r),r}if(e===(0|e)&&e>=2&&e<=36){var u=f[e],h=p[e];r="";var l=this.clone();for(l.negative=0;!l.isZero();){var g=l.modrn(h).toString(e);r=(l=l.idivn(h)).isZero()?g+r:d[u-g.length]+g+r}for(this.isZero()&&(r="0"+r);r.length%t!=0;)r="0"+r;return 0!==this.negative&&(r="-"+r),r}n(!1,"Base should be between 2 and 36")},o.prototype.toNumber=function(){var e=this.words[0];return 2===this.length?e+=67108864*this.words[1]:3===this.length&&1===this.words[2]?e+=4503599627370496+67108864*this.words[1]:this.length>2&&n(!1,"Number can only safely store up to 53 bits"),0!==this.negative?-e:e},o.prototype.toJSON=function(){return this.toString(16,2)},s&&(o.prototype.toBuffer=function(e,t){return this.toArrayLike(s,e,t)}),o.prototype.toArray=function(e,t){return this.toArrayLike(Array,e,t)},o.prototype.toArrayLike=function(e,t,r){this._strip();var i=this.byteLength(),o=r||Math.max(1,i);n(i<=o,"byte array longer than desired length"),n(o>0,"Requested array length <= 0");var s=function(e,t){return e.allocUnsafe?e.allocUnsafe(t):new e(t)}(e,o);return this["_toArrayLike"+("le"===t?"LE":"BE")](s,i),s},o.prototype._toArrayLikeLE=function(e,t){for(var r=0,n=0,i=0,o=0;i<this.length;i++){var s=this.words[i]<<o|n;e[r++]=255&s,r<e.length&&(e[r++]=s>>8&255),r<e.length&&(e[r++]=s>>16&255),6===o?(r<e.length&&(e[r++]=s>>24&255),n=0,o=0):(n=s>>>24,o+=2)}if(r<e.length)for(e[r++]=n;r<e.length;)e[r++]=0},o.prototype._toArrayLikeBE=function(e,t){for(var r=e.length-1,n=0,i=0,o=0;i<this.length;i++){var s=this.words[i]<<o|n;e[r--]=255&s,r>=0&&(e[r--]=s>>8&255),r>=0&&(e[r--]=s>>16&255),6===o?(r>=0&&(e[r--]=s>>24&255),n=0,o=0):(n=s>>>24,o+=2)}if(r>=0)for(e[r--]=n;r>=0;)e[r--]=0},Math.clz32?o.prototype._countBits=function(e){return 32-Math.clz32(e)}:o.prototype._countBits=function(e){var t=e,r=0;return t>=4096&&(r+=13,t>>>=13),t>=64&&(r+=7,t>>>=7),t>=8&&(r+=4,t>>>=4),t>=2&&(r+=2,t>>>=2),r+t},o.prototype._zeroBits=function(e){if(0===e)return 26;var t=e,r=0;return 8191&t||(r+=13,t>>>=13),127&t||(r+=7,t>>>=7),15&t||(r+=4,t>>>=4),3&t||(r+=2,t>>>=2),1&t||r++,r},o.prototype.bitLength=function(){var e=this.words[this.length-1],t=this._countBits(e);return 26*(this.length-1)+t},o.prototype.zeroBits=function(){if(this.isZero())return 0;for(var e=0,t=0;t<this.length;t++){var r=this._zeroBits(this.words[t]);if(e+=r,26!==r)break}return e},o.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},o.prototype.toTwos=function(e){return 0!==this.negative?this.abs().inotn(e).iaddn(1):this.clone()},o.prototype.fromTwos=function(e){return this.testn(e-1)?this.notn(e).iaddn(1).ineg():this.clone()},o.prototype.isNeg=function(){return 0!==this.negative},o.prototype.neg=function(){return this.clone().ineg()},o.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},o.prototype.iuor=function(e){for(;this.length<e.length;)this.words[this.length++]=0;for(var t=0;t<e.length;t++)this.words[t]=this.words[t]|e.words[t];return this._strip()},o.prototype.ior=function(e){return n(!(this.negative|e.negative)),this.iuor(e)},o.prototype.or=function(e){return this.length>e.length?this.clone().ior(e):e.clone().ior(this)},o.prototype.uor=function(e){return this.length>e.length?this.clone().iuor(e):e.clone().iuor(this)},o.prototype.iuand=function(e){var t;t=this.length>e.length?e:this;for(var r=0;r<t.length;r++)this.words[r]=this.words[r]&e.words[r];return this.length=t.length,this._strip()},o.prototype.iand=function(e){return n(!(this.negative|e.negative)),this.iuand(e)},o.prototype.and=function(e){return this.length>e.length?this.clone().iand(e):e.clone().iand(this)},o.prototype.uand=function(e){return this.length>e.length?this.clone().iuand(e):e.clone().iuand(this)},o.prototype.iuxor=function(e){var t,r;this.length>e.length?(t=this,r=e):(t=e,r=this);for(var n=0;n<r.length;n++)this.words[n]=t.words[n]^r.words[n];if(this!==t)for(;n<t.length;n++)this.words[n]=t.words[n];return this.length=t.length,this._strip()},o.prototype.ixor=function(e){return n(!(this.negative|e.negative)),this.iuxor(e)},o.prototype.xor=function(e){return this.length>e.length?this.clone().ixor(e):e.clone().ixor(this)},o.prototype.uxor=function(e){return this.length>e.length?this.clone().iuxor(e):e.clone().iuxor(this)},o.prototype.inotn=function(e){n("number"==typeof e&&e>=0);var t=0|Math.ceil(e/26),r=e%26;this._expand(t),r>0&&t--;for(var i=0;i<t;i++)this.words[i]=67108863&~this.words[i];return r>0&&(this.words[i]=~this.words[i]&67108863>>26-r),this._strip()},o.prototype.notn=function(e){return this.clone().inotn(e)},o.prototype.setn=function(e,t){n("number"==typeof e&&e>=0);var r=e/26|0,i=e%26;return this._expand(r+1),this.words[r]=t?this.words[r]|1<<i:this.words[r]&~(1<<i),this._strip()},o.prototype.iadd=function(e){var t,r,n;if(0!==this.negative&&0===e.negative)return this.negative=0,t=this.isub(e),this.negative^=1,this._normSign();if(0===this.negative&&0!==e.negative)return e.negative=0,t=this.isub(e),e.negative=1,t._normSign();this.length>e.length?(r=this,n=e):(r=e,n=this);for(var i=0,o=0;o<n.length;o++)t=(0|r.words[o])+(0|n.words[o])+i,this.words[o]=67108863&t,i=t>>>26;for(;0!==i&&o<r.length;o++)t=(0|r.words[o])+i,this.words[o]=67108863&t,i=t>>>26;if(this.length=r.length,0!==i)this.words[this.length]=i,this.length++;else if(r!==this)for(;o<r.length;o++)this.words[o]=r.words[o];return this},o.prototype.add=function(e){var t;return 0!==e.negative&&0===this.negative?(e.negative=0,t=this.sub(e),e.negative^=1,t):0===e.negative&&0!==this.negative?(this.negative=0,t=e.sub(this),this.negative=1,t):this.length>e.length?this.clone().iadd(e):e.clone().iadd(this)},o.prototype.isub=function(e){if(0!==e.negative){e.negative=0;var t=this.iadd(e);return e.negative=1,t._normSign()}if(0!==this.negative)return this.negative=0,this.iadd(e),this.negative=1,this._normSign();var r,n,i=this.cmp(e);if(0===i)return this.negative=0,this.length=1,this.words[0]=0,this;i>0?(r=this,n=e):(r=e,n=this);for(var o=0,s=0;s<n.length;s++)o=(t=(0|r.words[s])-(0|n.words[s])+o)>>26,this.words[s]=67108863&t;for(;0!==o&&s<r.length;s++)o=(t=(0|r.words[s])+o)>>26,this.words[s]=67108863&t;if(0===o&&s<r.length&&r!==this)for(;s<r.length;s++)this.words[s]=r.words[s];return this.length=Math.max(this.length,s),r!==this&&(this.negative=1),this._strip()},o.prototype.sub=function(e){return this.clone().isub(e)};var y=function(e,t,r){var n,i,o,s=e.words,a=t.words,c=r.words,u=0,h=0|s[0],l=8191&h,d=h>>>13,f=0|s[1],p=8191&f,g=f>>>13,y=0|s[2],b=8191&y,m=y>>>13,w=0|s[3],v=8191&w,S=w>>>13,_=0|s[4],E=8191&_,I=_>>>13,A=0|s[5],k=8191&A,x=A>>>13,P=0|s[6],O=8191&P,R=P>>>13,T=0|s[7],N=8191&T,M=T>>>13,C=0|s[8],B=8191&C,L=C>>>13,U=0|s[9],D=8191&U,j=U>>>13,z=0|a[0],q=8191&z,$=z>>>13,K=0|a[1],F=8191&K,W=K>>>13,H=0|a[2],V=8191&H,G=H>>>13,Y=0|a[3],J=8191&Y,X=Y>>>13,Z=0|a[4],Q=8191&Z,ee=Z>>>13,te=0|a[5],re=8191&te,ne=te>>>13,ie=0|a[6],oe=8191&ie,se=ie>>>13,ae=0|a[7],ce=8191&ae,ue=ae>>>13,he=0|a[8],le=8191&he,de=he>>>13,fe=0|a[9],pe=8191&fe,ge=fe>>>13;r.negative=e.negative^t.negative,r.length=19;var ye=(u+(n=Math.imul(l,q))|0)+((8191&(i=(i=Math.imul(l,$))+Math.imul(d,q)|0))<<13)|0;u=((o=Math.imul(d,$))+(i>>>13)|0)+(ye>>>26)|0,ye&=67108863,n=Math.imul(p,q),i=(i=Math.imul(p,$))+Math.imul(g,q)|0,o=Math.imul(g,$);var be=(u+(n=n+Math.imul(l,F)|0)|0)+((8191&(i=(i=i+Math.imul(l,W)|0)+Math.imul(d,F)|0))<<13)|0;u=((o=o+Math.imul(d,W)|0)+(i>>>13)|0)+(be>>>26)|0,be&=67108863,n=Math.imul(b,q),i=(i=Math.imul(b,$))+Math.imul(m,q)|0,o=Math.imul(m,$),n=n+Math.imul(p,F)|0,i=(i=i+Math.imul(p,W)|0)+Math.imul(g,F)|0,o=o+Math.imul(g,W)|0;var me=(u+(n=n+Math.imul(l,V)|0)|0)+((8191&(i=(i=i+Math.imul(l,G)|0)+Math.imul(d,V)|0))<<13)|0;u=((o=o+Math.imul(d,G)|0)+(i>>>13)|0)+(me>>>26)|0,me&=67108863,n=Math.imul(v,q),i=(i=Math.imul(v,$))+Math.imul(S,q)|0,o=Math.imul(S,$),n=n+Math.imul(b,F)|0,i=(i=i+Math.imul(b,W)|0)+Math.imul(m,F)|0,o=o+Math.imul(m,W)|0,n=n+Math.imul(p,V)|0,i=(i=i+Math.imul(p,G)|0)+Math.imul(g,V)|0,o=o+Math.imul(g,G)|0;var we=(u+(n=n+Math.imul(l,J)|0)|0)+((8191&(i=(i=i+Math.imul(l,X)|0)+Math.imul(d,J)|0))<<13)|0;u=((o=o+Math.imul(d,X)|0)+(i>>>13)|0)+(we>>>26)|0,we&=67108863,n=Math.imul(E,q),i=(i=Math.imul(E,$))+Math.imul(I,q)|0,o=Math.imul(I,$),n=n+Math.imul(v,F)|0,i=(i=i+Math.imul(v,W)|0)+Math.imul(S,F)|0,o=o+Math.imul(S,W)|0,n=n+Math.imul(b,V)|0,i=(i=i+Math.imul(b,G)|0)+Math.imul(m,V)|0,o=o+Math.imul(m,G)|0,n=n+Math.imul(p,J)|0,i=(i=i+Math.imul(p,X)|0)+Math.imul(g,J)|0,o=o+Math.imul(g,X)|0;var ve=(u+(n=n+Math.imul(l,Q)|0)|0)+((8191&(i=(i=i+Math.imul(l,ee)|0)+Math.imul(d,Q)|0))<<13)|0;u=((o=o+Math.imul(d,ee)|0)+(i>>>13)|0)+(ve>>>26)|0,ve&=67108863,n=Math.imul(k,q),i=(i=Math.imul(k,$))+Math.imul(x,q)|0,o=Math.imul(x,$),n=n+Math.imul(E,F)|0,i=(i=i+Math.imul(E,W)|0)+Math.imul(I,F)|0,o=o+Math.imul(I,W)|0,n=n+Math.imul(v,V)|0,i=(i=i+Math.imul(v,G)|0)+Math.imul(S,V)|0,o=o+Math.imul(S,G)|0,n=n+Math.imul(b,J)|0,i=(i=i+Math.imul(b,X)|0)+Math.imul(m,J)|0,o=o+Math.imul(m,X)|0,n=n+Math.imul(p,Q)|0,i=(i=i+Math.imul(p,ee)|0)+Math.imul(g,Q)|0,o=o+Math.imul(g,ee)|0;var Se=(u+(n=n+Math.imul(l,re)|0)|0)+((8191&(i=(i=i+Math.imul(l,ne)|0)+Math.imul(d,re)|0))<<13)|0;u=((o=o+Math.imul(d,ne)|0)+(i>>>13)|0)+(Se>>>26)|0,Se&=67108863,n=Math.imul(O,q),i=(i=Math.imul(O,$))+Math.imul(R,q)|0,o=Math.imul(R,$),n=n+Math.imul(k,F)|0,i=(i=i+Math.imul(k,W)|0)+Math.imul(x,F)|0,o=o+Math.imul(x,W)|0,n=n+Math.imul(E,V)|0,i=(i=i+Math.imul(E,G)|0)+Math.imul(I,V)|0,o=o+Math.imul(I,G)|0,n=n+Math.imul(v,J)|0,i=(i=i+Math.imul(v,X)|0)+Math.imul(S,J)|0,o=o+Math.imul(S,X)|0,n=n+Math.imul(b,Q)|0,i=(i=i+Math.imul(b,ee)|0)+Math.imul(m,Q)|0,o=o+Math.imul(m,ee)|0,n=n+Math.imul(p,re)|0,i=(i=i+Math.imul(p,ne)|0)+Math.imul(g,re)|0,o=o+Math.imul(g,ne)|0;var _e=(u+(n=n+Math.imul(l,oe)|0)|0)+((8191&(i=(i=i+Math.imul(l,se)|0)+Math.imul(d,oe)|0))<<13)|0;u=((o=o+Math.imul(d,se)|0)+(i>>>13)|0)+(_e>>>26)|0,_e&=67108863,n=Math.imul(N,q),i=(i=Math.imul(N,$))+Math.imul(M,q)|0,o=Math.imul(M,$),n=n+Math.imul(O,F)|0,i=(i=i+Math.imul(O,W)|0)+Math.imul(R,F)|0,o=o+Math.imul(R,W)|0,n=n+Math.imul(k,V)|0,i=(i=i+Math.imul(k,G)|0)+Math.imul(x,V)|0,o=o+Math.imul(x,G)|0,n=n+Math.imul(E,J)|0,i=(i=i+Math.imul(E,X)|0)+Math.imul(I,J)|0,o=o+Math.imul(I,X)|0,n=n+Math.imul(v,Q)|0,i=(i=i+Math.imul(v,ee)|0)+Math.imul(S,Q)|0,o=o+Math.imul(S,ee)|0,n=n+Math.imul(b,re)|0,i=(i=i+Math.imul(b,ne)|0)+Math.imul(m,re)|0,o=o+Math.imul(m,ne)|0,n=n+Math.imul(p,oe)|0,i=(i=i+Math.imul(p,se)|0)+Math.imul(g,oe)|0,o=o+Math.imul(g,se)|0;var Ee=(u+(n=n+Math.imul(l,ce)|0)|0)+((8191&(i=(i=i+Math.imul(l,ue)|0)+Math.imul(d,ce)|0))<<13)|0;u=((o=o+Math.imul(d,ue)|0)+(i>>>13)|0)+(Ee>>>26)|0,Ee&=67108863,n=Math.imul(B,q),i=(i=Math.imul(B,$))+Math.imul(L,q)|0,o=Math.imul(L,$),n=n+Math.imul(N,F)|0,i=(i=i+Math.imul(N,W)|0)+Math.imul(M,F)|0,o=o+Math.imul(M,W)|0,n=n+Math.imul(O,V)|0,i=(i=i+Math.imul(O,G)|0)+Math.imul(R,V)|0,o=o+Math.imul(R,G)|0,n=n+Math.imul(k,J)|0,i=(i=i+Math.imul(k,X)|0)+Math.imul(x,J)|0,o=o+Math.imul(x,X)|0,n=n+Math.imul(E,Q)|0,i=(i=i+Math.imul(E,ee)|0)+Math.imul(I,Q)|0,o=o+Math.imul(I,ee)|0,n=n+Math.imul(v,re)|0,i=(i=i+Math.imul(v,ne)|0)+Math.imul(S,re)|0,o=o+Math.imul(S,ne)|0,n=n+Math.imul(b,oe)|0,i=(i=i+Math.imul(b,se)|0)+Math.imul(m,oe)|0,o=o+Math.imul(m,se)|0,n=n+Math.imul(p,ce)|0,i=(i=i+Math.imul(p,ue)|0)+Math.imul(g,ce)|0,o=o+Math.imul(g,ue)|0;var Ie=(u+(n=n+Math.imul(l,le)|0)|0)+((8191&(i=(i=i+Math.imul(l,de)|0)+Math.imul(d,le)|0))<<13)|0;u=((o=o+Math.imul(d,de)|0)+(i>>>13)|0)+(Ie>>>26)|0,Ie&=67108863,n=Math.imul(D,q),i=(i=Math.imul(D,$))+Math.imul(j,q)|0,o=Math.imul(j,$),n=n+Math.imul(B,F)|0,i=(i=i+Math.imul(B,W)|0)+Math.imul(L,F)|0,o=o+Math.imul(L,W)|0,n=n+Math.imul(N,V)|0,i=(i=i+Math.imul(N,G)|0)+Math.imul(M,V)|0,o=o+Math.imul(M,G)|0,n=n+Math.imul(O,J)|0,i=(i=i+Math.imul(O,X)|0)+Math.imul(R,J)|0,o=o+Math.imul(R,X)|0,n=n+Math.imul(k,Q)|0,i=(i=i+Math.imul(k,ee)|0)+Math.imul(x,Q)|0,o=o+Math.imul(x,ee)|0,n=n+Math.imul(E,re)|0,i=(i=i+Math.imul(E,ne)|0)+Math.imul(I,re)|0,o=o+Math.imul(I,ne)|0,n=n+Math.imul(v,oe)|0,i=(i=i+Math.imul(v,se)|0)+Math.imul(S,oe)|0,o=o+Math.imul(S,se)|0,n=n+Math.imul(b,ce)|0,i=(i=i+Math.imul(b,ue)|0)+Math.imul(m,ce)|0,o=o+Math.imul(m,ue)|0,n=n+Math.imul(p,le)|0,i=(i=i+Math.imul(p,de)|0)+Math.imul(g,le)|0,o=o+Math.imul(g,de)|0;var Ae=(u+(n=n+Math.imul(l,pe)|0)|0)+((8191&(i=(i=i+Math.imul(l,ge)|0)+Math.imul(d,pe)|0))<<13)|0;u=((o=o+Math.imul(d,ge)|0)+(i>>>13)|0)+(Ae>>>26)|0,Ae&=67108863,n=Math.imul(D,F),i=(i=Math.imul(D,W))+Math.imul(j,F)|0,o=Math.imul(j,W),n=n+Math.imul(B,V)|0,i=(i=i+Math.imul(B,G)|0)+Math.imul(L,V)|0,o=o+Math.imul(L,G)|0,n=n+Math.imul(N,J)|0,i=(i=i+Math.imul(N,X)|0)+Math.imul(M,J)|0,o=o+Math.imul(M,X)|0,n=n+Math.imul(O,Q)|0,i=(i=i+Math.imul(O,ee)|0)+Math.imul(R,Q)|0,o=o+Math.imul(R,ee)|0,n=n+Math.imul(k,re)|0,i=(i=i+Math.imul(k,ne)|0)+Math.imul(x,re)|0,o=o+Math.imul(x,ne)|0,n=n+Math.imul(E,oe)|0,i=(i=i+Math.imul(E,se)|0)+Math.imul(I,oe)|0,o=o+Math.imul(I,se)|0,n=n+Math.imul(v,ce)|0,i=(i=i+Math.imul(v,ue)|0)+Math.imul(S,ce)|0,o=o+Math.imul(S,ue)|0,n=n+Math.imul(b,le)|0,i=(i=i+Math.imul(b,de)|0)+Math.imul(m,le)|0,o=o+Math.imul(m,de)|0;var ke=(u+(n=n+Math.imul(p,pe)|0)|0)+((8191&(i=(i=i+Math.imul(p,ge)|0)+Math.imul(g,pe)|0))<<13)|0;u=((o=o+Math.imul(g,ge)|0)+(i>>>13)|0)+(ke>>>26)|0,ke&=67108863,n=Math.imul(D,V),i=(i=Math.imul(D,G))+Math.imul(j,V)|0,o=Math.imul(j,G),n=n+Math.imul(B,J)|0,i=(i=i+Math.imul(B,X)|0)+Math.imul(L,J)|0,o=o+Math.imul(L,X)|0,n=n+Math.imul(N,Q)|0,i=(i=i+Math.imul(N,ee)|0)+Math.imul(M,Q)|0,o=o+Math.imul(M,ee)|0,n=n+Math.imul(O,re)|0,i=(i=i+Math.imul(O,ne)|0)+Math.imul(R,re)|0,o=o+Math.imul(R,ne)|0,n=n+Math.imul(k,oe)|0,i=(i=i+Math.imul(k,se)|0)+Math.imul(x,oe)|0,o=o+Math.imul(x,se)|0,n=n+Math.imul(E,ce)|0,i=(i=i+Math.imul(E,ue)|0)+Math.imul(I,ce)|0,o=o+Math.imul(I,ue)|0,n=n+Math.imul(v,le)|0,i=(i=i+Math.imul(v,de)|0)+Math.imul(S,le)|0,o=o+Math.imul(S,de)|0;var xe=(u+(n=n+Math.imul(b,pe)|0)|0)+((8191&(i=(i=i+Math.imul(b,ge)|0)+Math.imul(m,pe)|0))<<13)|0;u=((o=o+Math.imul(m,ge)|0)+(i>>>13)|0)+(xe>>>26)|0,xe&=67108863,n=Math.imul(D,J),i=(i=Math.imul(D,X))+Math.imul(j,J)|0,o=Math.imul(j,X),n=n+Math.imul(B,Q)|0,i=(i=i+Math.imul(B,ee)|0)+Math.imul(L,Q)|0,o=o+Math.imul(L,ee)|0,n=n+Math.imul(N,re)|0,i=(i=i+Math.imul(N,ne)|0)+Math.imul(M,re)|0,o=o+Math.imul(M,ne)|0,n=n+Math.imul(O,oe)|0,i=(i=i+Math.imul(O,se)|0)+Math.imul(R,oe)|0,o=o+Math.imul(R,se)|0,n=n+Math.imul(k,ce)|0,i=(i=i+Math.imul(k,ue)|0)+Math.imul(x,ce)|0,o=o+Math.imul(x,ue)|0,n=n+Math.imul(E,le)|0,i=(i=i+Math.imul(E,de)|0)+Math.imul(I,le)|0,o=o+Math.imul(I,de)|0;var Pe=(u+(n=n+Math.imul(v,pe)|0)|0)+((8191&(i=(i=i+Math.imul(v,ge)|0)+Math.imul(S,pe)|0))<<13)|0;u=((o=o+Math.imul(S,ge)|0)+(i>>>13)|0)+(Pe>>>26)|0,Pe&=67108863,n=Math.imul(D,Q),i=(i=Math.imul(D,ee))+Math.imul(j,Q)|0,o=Math.imul(j,ee),n=n+Math.imul(B,re)|0,i=(i=i+Math.imul(B,ne)|0)+Math.imul(L,re)|0,o=o+Math.imul(L,ne)|0,n=n+Math.imul(N,oe)|0,i=(i=i+Math.imul(N,se)|0)+Math.imul(M,oe)|0,o=o+Math.imul(M,se)|0,n=n+Math.imul(O,ce)|0,i=(i=i+Math.imul(O,ue)|0)+Math.imul(R,ce)|0,o=o+Math.imul(R,ue)|0,n=n+Math.imul(k,le)|0,i=(i=i+Math.imul(k,de)|0)+Math.imul(x,le)|0,o=o+Math.imul(x,de)|0;var Oe=(u+(n=n+Math.imul(E,pe)|0)|0)+((8191&(i=(i=i+Math.imul(E,ge)|0)+Math.imul(I,pe)|0))<<13)|0;u=((o=o+Math.imul(I,ge)|0)+(i>>>13)|0)+(Oe>>>26)|0,Oe&=67108863,n=Math.imul(D,re),i=(i=Math.imul(D,ne))+Math.imul(j,re)|0,o=Math.imul(j,ne),n=n+Math.imul(B,oe)|0,i=(i=i+Math.imul(B,se)|0)+Math.imul(L,oe)|0,o=o+Math.imul(L,se)|0,n=n+Math.imul(N,ce)|0,i=(i=i+Math.imul(N,ue)|0)+Math.imul(M,ce)|0,o=o+Math.imul(M,ue)|0,n=n+Math.imul(O,le)|0,i=(i=i+Math.imul(O,de)|0)+Math.imul(R,le)|0,o=o+Math.imul(R,de)|0;var Re=(u+(n=n+Math.imul(k,pe)|0)|0)+((8191&(i=(i=i+Math.imul(k,ge)|0)+Math.imul(x,pe)|0))<<13)|0;u=((o=o+Math.imul(x,ge)|0)+(i>>>13)|0)+(Re>>>26)|0,Re&=67108863,n=Math.imul(D,oe),i=(i=Math.imul(D,se))+Math.imul(j,oe)|0,o=Math.imul(j,se),n=n+Math.imul(B,ce)|0,i=(i=i+Math.imul(B,ue)|0)+Math.imul(L,ce)|0,o=o+Math.imul(L,ue)|0,n=n+Math.imul(N,le)|0,i=(i=i+Math.imul(N,de)|0)+Math.imul(M,le)|0,o=o+Math.imul(M,de)|0;var Te=(u+(n=n+Math.imul(O,pe)|0)|0)+((8191&(i=(i=i+Math.imul(O,ge)|0)+Math.imul(R,pe)|0))<<13)|0;u=((o=o+Math.imul(R,ge)|0)+(i>>>13)|0)+(Te>>>26)|0,Te&=67108863,n=Math.imul(D,ce),i=(i=Math.imul(D,ue))+Math.imul(j,ce)|0,o=Math.imul(j,ue),n=n+Math.imul(B,le)|0,i=(i=i+Math.imul(B,de)|0)+Math.imul(L,le)|0,o=o+Math.imul(L,de)|0;var Ne=(u+(n=n+Math.imul(N,pe)|0)|0)+((8191&(i=(i=i+Math.imul(N,ge)|0)+Math.imul(M,pe)|0))<<13)|0;u=((o=o+Math.imul(M,ge)|0)+(i>>>13)|0)+(Ne>>>26)|0,Ne&=67108863,n=Math.imul(D,le),i=(i=Math.imul(D,de))+Math.imul(j,le)|0,o=Math.imul(j,de);var Me=(u+(n=n+Math.imul(B,pe)|0)|0)+((8191&(i=(i=i+Math.imul(B,ge)|0)+Math.imul(L,pe)|0))<<13)|0;u=((o=o+Math.imul(L,ge)|0)+(i>>>13)|0)+(Me>>>26)|0,Me&=67108863;var Ce=(u+(n=Math.imul(D,pe))|0)+((8191&(i=(i=Math.imul(D,ge))+Math.imul(j,pe)|0))<<13)|0;return u=((o=Math.imul(j,ge))+(i>>>13)|0)+(Ce>>>26)|0,Ce&=67108863,c[0]=ye,c[1]=be,c[2]=me,c[3]=we,c[4]=ve,c[5]=Se,c[6]=_e,c[7]=Ee,c[8]=Ie,c[9]=Ae,c[10]=ke,c[11]=xe,c[12]=Pe,c[13]=Oe,c[14]=Re,c[15]=Te,c[16]=Ne,c[17]=Me,c[18]=Ce,0!==u&&(c[19]=u,r.length++),r};function b(e,t,r){r.negative=t.negative^e.negative,r.length=e.length+t.length;for(var n=0,i=0,o=0;o<r.length-1;o++){var s=i;i=0;for(var a=67108863&n,c=Math.min(o,t.length-1),u=Math.max(0,o-e.length+1);u<=c;u++){var h=o-u,l=(0|e.words[h])*(0|t.words[u]),d=67108863&l;a=67108863&(d=d+a|0),i+=(s=(s=s+(l/67108864|0)|0)+(d>>>26)|0)>>>26,s&=67108863}r.words[o]=a,n=s,s=i}return 0!==n?r.words[o]=n:r.length--,r._strip()}function m(e,t,r){return b(e,t,r)}function w(e,t){this.x=e,this.y=t}Math.imul||(y=g),o.prototype.mulTo=function(e,t){var r=this.length+e.length;return 10===this.length&&10===e.length?y(this,e,t):r<63?g(this,e,t):r<1024?b(this,e,t):m(this,e,t)},w.prototype.makeRBT=function(e){for(var t=new Array(e),r=o.prototype._countBits(e)-1,n=0;n<e;n++)t[n]=this.revBin(n,r,e);return t},w.prototype.revBin=function(e,t,r){if(0===e||e===r-1)return e;for(var n=0,i=0;i<t;i++)n|=(1&e)<<t-i-1,e>>=1;return n},w.prototype.permute=function(e,t,r,n,i,o){for(var s=0;s<o;s++)n[s]=t[e[s]],i[s]=r[e[s]]},w.prototype.transform=function(e,t,r,n,i,o){this.permute(o,e,t,r,n,i);for(var s=1;s<i;s<<=1)for(var a=s<<1,c=Math.cos(2*Math.PI/a),u=Math.sin(2*Math.PI/a),h=0;h<i;h+=a)for(var l=c,d=u,f=0;f<s;f++){var p=r[h+f],g=n[h+f],y=r[h+f+s],b=n[h+f+s],m=l*y-d*b;b=l*b+d*y,y=m,r[h+f]=p+y,n[h+f]=g+b,r[h+f+s]=p-y,n[h+f+s]=g-b,f!==a&&(m=c*l-u*d,d=c*d+u*l,l=m)}},w.prototype.guessLen13b=function(e,t){var r=1|Math.max(t,e),n=1&r,i=0;for(r=r/2|0;r;r>>>=1)i++;return 1<<i+1+n},w.prototype.conjugate=function(e,t,r){if(!(r<=1))for(var n=0;n<r/2;n++){var i=e[n];e[n]=e[r-n-1],e[r-n-1]=i,i=t[n],t[n]=-t[r-n-1],t[r-n-1]=-i}},w.prototype.normalize13b=function(e,t){for(var r=0,n=0;n<t/2;n++){var i=8192*Math.round(e[2*n+1]/t)+Math.round(e[2*n]/t)+r;e[n]=67108863&i,r=i<67108864?0:i/67108864|0}return e},w.prototype.convert13b=function(e,t,r,i){for(var o=0,s=0;s<t;s++)o+=0|e[s],r[2*s]=8191&o,o>>>=13,r[2*s+1]=8191&o,o>>>=13;for(s=2*t;s<i;++s)r[s]=0;n(0===o),n(!(-8192&o))},w.prototype.stub=function(e){for(var t=new Array(e),r=0;r<e;r++)t[r]=0;return t},w.prototype.mulp=function(e,t,r){var n=2*this.guessLen13b(e.length,t.length),i=this.makeRBT(n),o=this.stub(n),s=new Array(n),a=new Array(n),c=new Array(n),u=new Array(n),h=new Array(n),l=new Array(n),d=r.words;d.length=n,this.convert13b(e.words,e.length,s,n),this.convert13b(t.words,t.length,u,n),this.transform(s,o,a,c,n,i),this.transform(u,o,h,l,n,i);for(var f=0;f<n;f++){var p=a[f]*h[f]-c[f]*l[f];c[f]=a[f]*l[f]+c[f]*h[f],a[f]=p}return this.conjugate(a,c,n),this.transform(a,c,d,o,n,i),this.conjugate(d,o,n),this.normalize13b(d,n),r.negative=e.negative^t.negative,r.length=e.length+t.length,r._strip()},o.prototype.mul=function(e){var t=new o(null);return t.words=new Array(this.length+e.length),this.mulTo(e,t)},o.prototype.mulf=function(e){var t=new o(null);return t.words=new Array(this.length+e.length),m(this,e,t)},o.prototype.imul=function(e){return this.clone().mulTo(e,this)},o.prototype.imuln=function(e){var t=e<0;t&&(e=-e),n("number"==typeof e),n(e<67108864);for(var r=0,i=0;i<this.length;i++){var o=(0|this.words[i])*e,s=(67108863&o)+(67108863&r);r>>=26,r+=o/67108864|0,r+=s>>>26,this.words[i]=67108863&s}return 0!==r&&(this.words[i]=r,this.length++),t?this.ineg():this},o.prototype.muln=function(e){return this.clone().imuln(e)},o.prototype.sqr=function(){return this.mul(this)},o.prototype.isqr=function(){return this.imul(this.clone())},o.prototype.pow=function(e){var t=function(e){for(var t=new Array(e.bitLength()),r=0;r<t.length;r++){var n=r/26|0,i=r%26;t[r]=e.words[n]>>>i&1}return t}(e);if(0===t.length)return new o(1);for(var r=this,n=0;n<t.length&&0===t[n];n++,r=r.sqr());if(++n<t.length)for(var i=r.sqr();n<t.length;n++,i=i.sqr())0!==t[n]&&(r=r.mul(i));return r},o.prototype.iushln=function(e){n("number"==typeof e&&e>=0);var t,r=e%26,i=(e-r)/26,o=67108863>>>26-r<<26-r;if(0!==r){var s=0;for(t=0;t<this.length;t++){var a=this.words[t]&o,c=(0|this.words[t])-a<<r;this.words[t]=c|s,s=a>>>26-r}s&&(this.words[t]=s,this.length++)}if(0!==i){for(t=this.length-1;t>=0;t--)this.words[t+i]=this.words[t];for(t=0;t<i;t++)this.words[t]=0;this.length+=i}return this._strip()},o.prototype.ishln=function(e){return n(0===this.negative),this.iushln(e)},o.prototype.iushrn=function(e,t,r){var i;n("number"==typeof e&&e>=0),i=t?(t-t%26)/26:0;var o=e%26,s=Math.min((e-o)/26,this.length),a=67108863^67108863>>>o<<o,c=r;if(i-=s,i=Math.max(0,i),c){for(var u=0;u<s;u++)c.words[u]=this.words[u];c.length=s}if(0===s);else if(this.length>s)for(this.length-=s,u=0;u<this.length;u++)this.words[u]=this.words[u+s];else this.words[0]=0,this.length=1;var h=0;for(u=this.length-1;u>=0&&(0!==h||u>=i);u--){var l=0|this.words[u];this.words[u]=h<<26-o|l>>>o,h=l&a}return c&&0!==h&&(c.words[c.length++]=h),0===this.length&&(this.words[0]=0,this.length=1),this._strip()},o.prototype.ishrn=function(e,t,r){return n(0===this.negative),this.iushrn(e,t,r)},o.prototype.shln=function(e){return this.clone().ishln(e)},o.prototype.ushln=function(e){return this.clone().iushln(e)},o.prototype.shrn=function(e){return this.clone().ishrn(e)},o.prototype.ushrn=function(e){return this.clone().iushrn(e)},o.prototype.testn=function(e){n("number"==typeof e&&e>=0);var t=e%26,r=(e-t)/26,i=1<<t;return!(this.length<=r||!(this.words[r]&i))},o.prototype.imaskn=function(e){n("number"==typeof e&&e>=0);var t=e%26,r=(e-t)/26;if(n(0===this.negative,"imaskn works only with positive numbers"),this.length<=r)return this;if(0!==t&&r++,this.length=Math.min(r,this.length),0!==t){var i=67108863^67108863>>>t<<t;this.words[this.length-1]&=i}return this._strip()},o.prototype.maskn=function(e){return this.clone().imaskn(e)},o.prototype.iaddn=function(e){return n("number"==typeof e),n(e<67108864),e<0?this.isubn(-e):0!==this.negative?1===this.length&&(0|this.words[0])<=e?(this.words[0]=e-(0|this.words[0]),this.negative=0,this):(this.negative=0,this.isubn(e),this.negative=1,this):this._iaddn(e)},o.prototype._iaddn=function(e){this.words[0]+=e;for(var t=0;t<this.length&&this.words[t]>=67108864;t++)this.words[t]-=67108864,t===this.length-1?this.words[t+1]=1:this.words[t+1]++;return this.length=Math.max(this.length,t+1),this},o.prototype.isubn=function(e){if(n("number"==typeof e),n(e<67108864),e<0)return this.iaddn(-e);if(0!==this.negative)return this.negative=0,this.iaddn(e),this.negative=1,this;if(this.words[0]-=e,1===this.length&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var t=0;t<this.length&&this.words[t]<0;t++)this.words[t]+=67108864,this.words[t+1]-=1;return this._strip()},o.prototype.addn=function(e){return this.clone().iaddn(e)},o.prototype.subn=function(e){return this.clone().isubn(e)},o.prototype.iabs=function(){return this.negative=0,this},o.prototype.abs=function(){return this.clone().iabs()},o.prototype._ishlnsubmul=function(e,t,r){var i,o,s=e.length+r;this._expand(s);var a=0;for(i=0;i<e.length;i++){o=(0|this.words[i+r])+a;var c=(0|e.words[i])*t;a=((o-=67108863&c)>>26)-(c/67108864|0),this.words[i+r]=67108863&o}for(;i<this.length-r;i++)a=(o=(0|this.words[i+r])+a)>>26,this.words[i+r]=67108863&o;if(0===a)return this._strip();for(n(-1===a),a=0,i=0;i<this.length;i++)a=(o=-(0|this.words[i])+a)>>26,this.words[i]=67108863&o;return this.negative=1,this._strip()},o.prototype._wordDiv=function(e,t){var r=(this.length,e.length),n=this.clone(),i=e,s=0|i.words[i.length-1];0!=(r=26-this._countBits(s))&&(i=i.ushln(r),n.iushln(r),s=0|i.words[i.length-1]);var a,c=n.length-i.length;if("mod"!==t){(a=new o(null)).length=c+1,a.words=new Array(a.length);for(var u=0;u<a.length;u++)a.words[u]=0}var h=n.clone()._ishlnsubmul(i,1,c);0===h.negative&&(n=h,a&&(a.words[c]=1));for(var l=c-1;l>=0;l--){var d=67108864*(0|n.words[i.length+l])+(0|n.words[i.length+l-1]);for(d=Math.min(d/s|0,67108863),n._ishlnsubmul(i,d,l);0!==n.negative;)d--,n.negative=0,n._ishlnsubmul(i,1,l),n.isZero()||(n.negative^=1);a&&(a.words[l]=d)}return a&&a._strip(),n._strip(),"div"!==t&&0!==r&&n.iushrn(r),{div:a||null,mod:n}},o.prototype.divmod=function(e,t,r){return n(!e.isZero()),this.isZero()?{div:new o(0),mod:new o(0)}:0!==this.negative&&0===e.negative?(a=this.neg().divmod(e,t),"mod"!==t&&(i=a.div.neg()),"div"!==t&&(s=a.mod.neg(),r&&0!==s.negative&&s.iadd(e)),{div:i,mod:s}):0===this.negative&&0!==e.negative?(a=this.divmod(e.neg(),t),"mod"!==t&&(i=a.div.neg()),{div:i,mod:a.mod}):this.negative&e.negative?(a=this.neg().divmod(e.neg(),t),"div"!==t&&(s=a.mod.neg(),r&&0!==s.negative&&s.isub(e)),{div:a.div,mod:s}):e.length>this.length||this.cmp(e)<0?{div:new o(0),mod:this}:1===e.length?"div"===t?{div:this.divn(e.words[0]),mod:null}:"mod"===t?{div:null,mod:new o(this.modrn(e.words[0]))}:{div:this.divn(e.words[0]),mod:new o(this.modrn(e.words[0]))}:this._wordDiv(e,t);var i,s,a},o.prototype.div=function(e){return this.divmod(e,"div",!1).div},o.prototype.mod=function(e){return this.divmod(e,"mod",!1).mod},o.prototype.umod=function(e){return this.divmod(e,"mod",!0).mod},o.prototype.divRound=function(e){var t=this.divmod(e);if(t.mod.isZero())return t.div;var r=0!==t.div.negative?t.mod.isub(e):t.mod,n=e.ushrn(1),i=e.andln(1),o=r.cmp(n);return o<0||1===i&&0===o?t.div:0!==t.div.negative?t.div.isubn(1):t.div.iaddn(1)},o.prototype.modrn=function(e){var t=e<0;t&&(e=-e),n(e<=67108863);for(var r=(1<<26)%e,i=0,o=this.length-1;o>=0;o--)i=(r*i+(0|this.words[o]))%e;return t?-i:i},o.prototype.modn=function(e){return this.modrn(e)},o.prototype.idivn=function(e){var t=e<0;t&&(e=-e),n(e<=67108863);for(var r=0,i=this.length-1;i>=0;i--){var o=(0|this.words[i])+67108864*r;this.words[i]=o/e|0,r=o%e}return this._strip(),t?this.ineg():this},o.prototype.divn=function(e){return this.clone().idivn(e)},o.prototype.egcd=function(e){n(0===e.negative),n(!e.isZero());var t=this,r=e.clone();t=0!==t.negative?t.umod(e):t.clone();for(var i=new o(1),s=new o(0),a=new o(0),c=new o(1),u=0;t.isEven()&&r.isEven();)t.iushrn(1),r.iushrn(1),++u;for(var h=r.clone(),l=t.clone();!t.isZero();){for(var d=0,f=1;!(t.words[0]&f)&&d<26;++d,f<<=1);if(d>0)for(t.iushrn(d);d-- >0;)(i.isOdd()||s.isOdd())&&(i.iadd(h),s.isub(l)),i.iushrn(1),s.iushrn(1);for(var p=0,g=1;!(r.words[0]&g)&&p<26;++p,g<<=1);if(p>0)for(r.iushrn(p);p-- >0;)(a.isOdd()||c.isOdd())&&(a.iadd(h),c.isub(l)),a.iushrn(1),c.iushrn(1);t.cmp(r)>=0?(t.isub(r),i.isub(a),s.isub(c)):(r.isub(t),a.isub(i),c.isub(s))}return{a,b:c,gcd:r.iushln(u)}},o.prototype._invmp=function(e){n(0===e.negative),n(!e.isZero());var t=this,r=e.clone();t=0!==t.negative?t.umod(e):t.clone();for(var i,s=new o(1),a=new o(0),c=r.clone();t.cmpn(1)>0&&r.cmpn(1)>0;){for(var u=0,h=1;!(t.words[0]&h)&&u<26;++u,h<<=1);if(u>0)for(t.iushrn(u);u-- >0;)s.isOdd()&&s.iadd(c),s.iushrn(1);for(var l=0,d=1;!(r.words[0]&d)&&l<26;++l,d<<=1);if(l>0)for(r.iushrn(l);l-- >0;)a.isOdd()&&a.iadd(c),a.iushrn(1);t.cmp(r)>=0?(t.isub(r),s.isub(a)):(r.isub(t),a.isub(s))}return(i=0===t.cmpn(1)?s:a).cmpn(0)<0&&i.iadd(e),i},o.prototype.gcd=function(e){if(this.isZero())return e.abs();if(e.isZero())return this.abs();var t=this.clone(),r=e.clone();t.negative=0,r.negative=0;for(var n=0;t.isEven()&&r.isEven();n++)t.iushrn(1),r.iushrn(1);for(;;){for(;t.isEven();)t.iushrn(1);for(;r.isEven();)r.iushrn(1);var i=t.cmp(r);if(i<0){var o=t;t=r,r=o}else if(0===i||0===r.cmpn(1))break;t.isub(r)}return r.iushln(n)},o.prototype.invm=function(e){return this.egcd(e).a.umod(e)},o.prototype.isEven=function(){return!(1&this.words[0])},o.prototype.isOdd=function(){return!(1&~this.words[0])},o.prototype.andln=function(e){return this.words[0]&e},o.prototype.bincn=function(e){n("number"==typeof e);var t=e%26,r=(e-t)/26,i=1<<t;if(this.length<=r)return this._expand(r+1),this.words[r]|=i,this;for(var o=i,s=r;0!==o&&s<this.length;s++){var a=0|this.words[s];o=(a+=o)>>>26,a&=67108863,this.words[s]=a}return 0!==o&&(this.words[s]=o,this.length++),this},o.prototype.isZero=function(){return 1===this.length&&0===this.words[0]},o.prototype.cmpn=function(e){var t,r=e<0;if(0!==this.negative&&!r)return-1;if(0===this.negative&&r)return 1;if(this._strip(),this.length>1)t=1;else{r&&(e=-e),n(e<=67108863,"Number is too big");var i=0|this.words[0];t=i===e?0:i<e?-1:1}return 0!==this.negative?0|-t:t},o.prototype.cmp=function(e){if(0!==this.negative&&0===e.negative)return-1;if(0===this.negative&&0!==e.negative)return 1;var t=this.ucmp(e);return 0!==this.negative?0|-t:t},o.prototype.ucmp=function(e){if(this.length>e.length)return 1;if(this.length<e.length)return-1;for(var t=0,r=this.length-1;r>=0;r--){var n=0|this.words[r],i=0|e.words[r];if(n!==i){n<i?t=-1:n>i&&(t=1);break}}return t},o.prototype.gtn=function(e){return 1===this.cmpn(e)},o.prototype.gt=function(e){return 1===this.cmp(e)},o.prototype.gten=function(e){return this.cmpn(e)>=0},o.prototype.gte=function(e){return this.cmp(e)>=0},o.prototype.ltn=function(e){return-1===this.cmpn(e)},o.prototype.lt=function(e){return-1===this.cmp(e)},o.prototype.lten=function(e){return this.cmpn(e)<=0},o.prototype.lte=function(e){return this.cmp(e)<=0},o.prototype.eqn=function(e){return 0===this.cmpn(e)},o.prototype.eq=function(e){return 0===this.cmp(e)},o.red=function(e){return new k(e)},o.prototype.toRed=function(e){return n(!this.red,"Already a number in reduction context"),n(0===this.negative,"red works only with positives"),e.convertTo(this)._forceRed(e)},o.prototype.fromRed=function(){return n(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},o.prototype._forceRed=function(e){return this.red=e,this},o.prototype.forceRed=function(e){return n(!this.red,"Already a number in reduction context"),this._forceRed(e)},o.prototype.redAdd=function(e){return n(this.red,"redAdd works only with red numbers"),this.red.add(this,e)},o.prototype.redIAdd=function(e){return n(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,e)},o.prototype.redSub=function(e){return n(this.red,"redSub works only with red numbers"),this.red.sub(this,e)},o.prototype.redISub=function(e){return n(this.red,"redISub works only with red numbers"),this.red.isub(this,e)},o.prototype.redShl=function(e){return n(this.red,"redShl works only with red numbers"),this.red.shl(this,e)},o.prototype.redMul=function(e){return n(this.red,"redMul works only with red numbers"),this.red._verify2(this,e),this.red.mul(this,e)},o.prototype.redIMul=function(e){return n(this.red,"redMul works only with red numbers"),this.red._verify2(this,e),this.red.imul(this,e)},o.prototype.redSqr=function(){return n(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},o.prototype.redISqr=function(){return n(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},o.prototype.redSqrt=function(){return n(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},o.prototype.redInvm=function(){return n(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},o.prototype.redNeg=function(){return n(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},o.prototype.redPow=function(e){return n(this.red&&!e.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,e)};var v={k256:null,p224:null,p192:null,p25519:null};function S(e,t){this.name=e,this.p=new o(t,16),this.n=this.p.bitLength(),this.k=new o(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}function _(){S.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}function E(){S.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}function I(){S.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}function A(){S.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}function k(e){if("string"==typeof e){var t=o._prime(e);this.m=t.p,this.prime=t}else n(e.gtn(1),"modulus must be greater than 1"),this.m=e,this.prime=null}function x(e){k.call(this,e),this.shift=this.m.bitLength(),this.shift%26!=0&&(this.shift+=26-this.shift%26),this.r=new o(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}S.prototype._tmp=function(){var e=new o(null);return e.words=new Array(Math.ceil(this.n/13)),e},S.prototype.ireduce=function(e){var t,r=e;do{this.split(r,this.tmp),t=(r=(r=this.imulK(r)).iadd(this.tmp)).bitLength()}while(t>this.n);var n=t<this.n?-1:r.ucmp(this.p);return 0===n?(r.words[0]=0,r.length=1):n>0?r.isub(this.p):void 0!==r.strip?r.strip():r._strip(),r},S.prototype.split=function(e,t){e.iushrn(this.n,0,t)},S.prototype.imulK=function(e){return e.imul(this.k)},i(_,S),_.prototype.split=function(e,t){for(var r=4194303,n=Math.min(e.length,9),i=0;i<n;i++)t.words[i]=e.words[i];if(t.length=n,e.length<=9)return e.words[0]=0,void(e.length=1);var o=e.words[9];for(t.words[t.length++]=o&r,i=10;i<e.length;i++){var s=0|e.words[i];e.words[i-10]=(s&r)<<4|o>>>22,o=s}o>>>=22,e.words[i-10]=o,0===o&&e.length>10?e.length-=10:e.length-=9},_.prototype.imulK=function(e){e.words[e.length]=0,e.words[e.length+1]=0,e.length+=2;for(var t=0,r=0;r<e.length;r++){var n=0|e.words[r];t+=977*n,e.words[r]=67108863&t,t=64*n+(t/67108864|0)}return 0===e.words[e.length-1]&&(e.length--,0===e.words[e.length-1]&&e.length--),e},i(E,S),i(I,S),i(A,S),A.prototype.imulK=function(e){for(var t=0,r=0;r<e.length;r++){var n=19*(0|e.words[r])+t,i=67108863&n;n>>>=26,e.words[r]=i,t=n}return 0!==t&&(e.words[e.length++]=t),e},o._prime=function(e){if(v[e])return v[e];var t;if("k256"===e)t=new _;else if("p224"===e)t=new E;else if("p192"===e)t=new I;else{if("p25519"!==e)throw new Error("Unknown prime "+e);t=new A}return v[e]=t,t},k.prototype._verify1=function(e){n(0===e.negative,"red works only with positives"),n(e.red,"red works only with red numbers")},k.prototype._verify2=function(e,t){n(!(e.negative|t.negative),"red works only with positives"),n(e.red&&e.red===t.red,"red works only with red numbers")},k.prototype.imod=function(e){return this.prime?this.prime.ireduce(e)._forceRed(this):(h(e,e.umod(this.m)._forceRed(this)),e)},k.prototype.neg=function(e){return e.isZero()?e.clone():this.m.sub(e)._forceRed(this)},k.prototype.add=function(e,t){this._verify2(e,t);var r=e.add(t);return r.cmp(this.m)>=0&&r.isub(this.m),r._forceRed(this)},k.prototype.iadd=function(e,t){this._verify2(e,t);var r=e.iadd(t);return r.cmp(this.m)>=0&&r.isub(this.m),r},k.prototype.sub=function(e,t){this._verify2(e,t);var r=e.sub(t);return r.cmpn(0)<0&&r.iadd(this.m),r._forceRed(this)},k.prototype.isub=function(e,t){this._verify2(e,t);var r=e.isub(t);return r.cmpn(0)<0&&r.iadd(this.m),r},k.prototype.shl=function(e,t){return this._verify1(e),this.imod(e.ushln(t))},k.prototype.imul=function(e,t){return this._verify2(e,t),this.imod(e.imul(t))},k.prototype.mul=function(e,t){return this._verify2(e,t),this.imod(e.mul(t))},k.prototype.isqr=function(e){return this.imul(e,e.clone())},k.prototype.sqr=function(e){return this.mul(e,e)},k.prototype.sqrt=function(e){if(e.isZero())return e.clone();var t=this.m.andln(3);if(n(t%2==1),3===t){var r=this.m.add(new o(1)).iushrn(2);return this.pow(e,r)}for(var i=this.m.subn(1),s=0;!i.isZero()&&0===i.andln(1);)s++,i.iushrn(1);n(!i.isZero());var a=new o(1).toRed(this),c=a.redNeg(),u=this.m.subn(1).iushrn(1),h=this.m.bitLength();for(h=new o(2*h*h).toRed(this);0!==this.pow(h,u).cmp(c);)h.redIAdd(c);for(var l=this.pow(h,i),d=this.pow(e,i.addn(1).iushrn(1)),f=this.pow(e,i),p=s;0!==f.cmp(a);){for(var g=f,y=0;0!==g.cmp(a);y++)g=g.redSqr();n(y<p);var b=this.pow(l,new o(1).iushln(p-y-1));d=d.redMul(b),l=b.redSqr(),f=f.redMul(l),p=y}return d},k.prototype.invm=function(e){var t=e._invmp(this.m);return 0!==t.negative?(t.negative=0,this.imod(t).redNeg()):this.imod(t)},k.prototype.pow=function(e,t){if(t.isZero())return new o(1).toRed(this);if(0===t.cmpn(1))return e.clone();var r=new Array(16);r[0]=new o(1).toRed(this),r[1]=e;for(var n=2;n<r.length;n++)r[n]=this.mul(r[n-1],e);var i=r[0],s=0,a=0,c=t.bitLength()%26;for(0===c&&(c=26),n=t.length-1;n>=0;n--){for(var u=t.words[n],h=c-1;h>=0;h--){var l=u>>h&1;i!==r[0]&&(i=this.sqr(i)),0!==l||0!==s?(s<<=1,s|=l,(4==++a||0===n&&0===h)&&(i=this.mul(i,r[s]),a=0,s=0)):a=0}c=26}return i},k.prototype.convertTo=function(e){var t=e.umod(this.m);return t===e?t.clone():t},k.prototype.convertFrom=function(e){var t=e.clone();return t.red=null,t},o.mont=function(e){return new x(e)},i(x,k),x.prototype.convertTo=function(e){return this.imod(e.ushln(this.shift))},x.prototype.convertFrom=function(e){var t=this.imod(e.mul(this.rinv));return t.red=null,t},x.prototype.imul=function(e,t){if(e.isZero()||t.isZero())return e.words[0]=0,e.length=1,e;var r=e.imul(t),n=r.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),i=r.isub(n).iushrn(this.shift),o=i;return i.cmp(this.m)>=0?o=i.isub(this.m):i.cmpn(0)<0&&(o=i.iadd(this.m)),o._forceRed(this)},x.prototype.mul=function(e,t){if(e.isZero()||t.isZero())return new o(0)._forceRed(this);var r=e.mul(t),n=r.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),i=r.isub(n).iushrn(this.shift),s=i;return i.cmp(this.m)>=0?s=i.isub(this.m):i.cmpn(0)<0&&(s=i.iadd(this.m)),s._forceRed(this)},x.prototype.invm=function(e){return this.imod(e._invmp(this.m).mul(this.r2))._forceRed(this)}}(e=r.nmd(e),this)},9461:function(e,t,r){"use strict";var n=r(1429).Buffer,i=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__decorate||function(e,t,r,n){var i,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,r,s):i(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s},a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.hasOwnProperty.call(e,r)&&i(t,e,r);return o(t,e),t},c=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.deserializeUnchecked=t.deserialize=t.serialize=t.BinaryReader=t.BinaryWriter=t.BorshError=t.baseDecode=t.baseEncode=void 0;const u=c(r(5530)),h=c(r(9331)),l=a(r(5215)),d=new("function"!=typeof TextDecoder?l.TextDecoder:TextDecoder)("utf-8",{fatal:!0});t.baseEncode=function(e){return"string"==typeof e&&(e=n.from(e,"utf8")),h.default.encode(n.from(e))},t.baseDecode=function(e){return n.from(h.default.decode(e))};const f=1024;class p extends Error{constructor(e){super(e),this.fieldPath=[],this.originalMessage=e}addToFieldPath(e){this.fieldPath.splice(0,0,e),this.message=this.originalMessage+": "+this.fieldPath.join(".")}}t.BorshError=p;class g{constructor(){this.buf=n.alloc(f),this.length=0}maybeResize(){this.buf.length<16+this.length&&(this.buf=n.concat([this.buf,n.alloc(f)]))}writeU8(e){this.maybeResize(),this.buf.writeUInt8(e,this.length),this.length+=1}writeU16(e){this.maybeResize(),this.buf.writeUInt16LE(e,this.length),this.length+=2}writeU32(e){this.maybeResize(),this.buf.writeUInt32LE(e,this.length),this.length+=4}writeU64(e){this.maybeResize(),this.writeBuffer(n.from(new u.default(e).toArray("le",8)))}writeU128(e){this.maybeResize(),this.writeBuffer(n.from(new u.default(e).toArray("le",16)))}writeU256(e){this.maybeResize(),this.writeBuffer(n.from(new u.default(e).toArray("le",32)))}writeU512(e){this.maybeResize(),this.writeBuffer(n.from(new u.default(e).toArray("le",64)))}writeBuffer(e){this.buf=n.concat([n.from(this.buf.subarray(0,this.length)),e,n.alloc(f)]),this.length+=e.length}writeString(e){this.maybeResize();const t=n.from(e,"utf8");this.writeU32(t.length),this.writeBuffer(t)}writeFixedArray(e){this.writeBuffer(n.from(e))}writeArray(e,t){this.maybeResize(),this.writeU32(e.length);for(const r of e)this.maybeResize(),t(r)}toArray(){return this.buf.subarray(0,this.length)}}function y(e,t,r){const n=r.value;r.value=function(...e){try{return n.apply(this,e)}catch(e){if(e instanceof RangeError){const t=e.code;if(["ERR_BUFFER_OUT_OF_BOUNDS","ERR_OUT_OF_RANGE"].indexOf(t)>=0)throw new p("Reached the end of buffer when deserializing")}throw e}}}t.BinaryWriter=g;class b{constructor(e){this.buf=e,this.offset=0}readU8(){const e=this.buf.readUInt8(this.offset);return this.offset+=1,e}readU16(){const e=this.buf.readUInt16LE(this.offset);return this.offset+=2,e}readU32(){const e=this.buf.readUInt32LE(this.offset);return this.offset+=4,e}readU64(){const e=this.readBuffer(8);return new u.default(e,"le")}readU128(){const e=this.readBuffer(16);return new u.default(e,"le")}readU256(){const e=this.readBuffer(32);return new u.default(e,"le")}readU512(){const e=this.readBuffer(64);return new u.default(e,"le")}readBuffer(e){if(this.offset+e>this.buf.length)throw new p(`Expected buffer length ${e} isn't within bounds`);const t=this.buf.slice(this.offset,this.offset+e);return this.offset+=e,t}readString(){const e=this.readU32(),t=this.readBuffer(e);try{return d.decode(t)}catch(e){throw new p(`Error decoding UTF-8 string: ${e}`)}}readFixedArray(e){return new Uint8Array(this.readBuffer(e))}readArray(e){const t=this.readU32(),r=Array();for(let n=0;n<t;++n)r.push(e());return r}}function m(e){return e.charAt(0).toUpperCase()+e.slice(1)}function w(e,t,r,n,i){try{if("string"==typeof n)i[`write${m(n)}`](r);else if(n instanceof Array)if("number"==typeof n[0]){if(r.length!==n[0])throw new p(`Expecting byte array of length ${n[0]}, but got ${r.length} bytes`);i.writeFixedArray(r)}else if(2===n.length&&"number"==typeof n[1]){if(r.length!==n[1])throw new p(`Expecting byte array of length ${n[1]}, but got ${r.length} bytes`);for(let t=0;t<n[1];t++)w(e,null,r[t],n[0],i)}else i.writeArray(r,(r=>{w(e,t,r,n[0],i)}));else if(void 0!==n.kind)switch(n.kind){case"option":null==r?i.writeU8(0):(i.writeU8(1),w(e,t,r,n.type,i));break;case"map":i.writeU32(r.size),r.forEach(((r,o)=>{w(e,t,o,n.key,i),w(e,t,r,n.value,i)}));break;default:throw new p(`FieldType ${n} unrecognized`)}else v(e,r,i)}catch(e){throw e instanceof p&&e.addToFieldPath(t),e}}function v(e,t,r){if("function"==typeof t.borshSerialize)return void t.borshSerialize(r);const n=e.get(t.constructor);if(!n)throw new p(`Class ${t.constructor.name} is missing in schema`);if("struct"===n.kind)n.fields.map((([n,i])=>{w(e,n,t[n],i,r)}));else{if("enum"!==n.kind)throw new p(`Unexpected schema kind: ${n.kind} for ${t.constructor.name}`);{const i=t[n.field];for(let o=0;o<n.values.length;++o){const[s,a]=n.values[o];if(s===i){r.writeU8(o),w(e,s,t[s],a,r);break}}}}}function S(e,t,r,n){try{if("string"==typeof r)return n[`read${m(r)}`]();if(r instanceof Array){if("number"==typeof r[0])return n.readFixedArray(r[0]);if("number"==typeof r[1]){const t=[];for(let i=0;i<r[1];i++)t.push(S(e,null,r[0],n));return t}return n.readArray((()=>S(e,t,r[0],n)))}if("option"===r.kind)return n.readU8()?S(e,t,r.type,n):void 0;if("map"===r.kind){let i=new Map;const o=n.readU32();for(let s=0;s<o;s++){const o=S(e,t,r.key,n),s=S(e,t,r.value,n);i.set(o,s)}return i}return _(e,r,n)}catch(e){throw e instanceof p&&e.addToFieldPath(t),e}}function _(e,t,r){if("function"==typeof t.borshDeserialize)return t.borshDeserialize(r);const n=e.get(t);if(!n)throw new p(`Class ${t.name} is missing in schema`);if("struct"===n.kind){const n={};for(const[i,o]of e.get(t).fields)n[i]=S(e,i,o,r);return new t(n)}if("enum"===n.kind){const i=r.readU8();if(i>=n.values.length)throw new p(`Enum index: ${i} is out of range`);const[o,s]=n.values[i],a=S(e,o,s,r);return new t({[o]:a})}throw new p(`Unexpected schema kind: ${n.kind} for ${t.constructor.name}`)}s([y],b.prototype,"readU8",null),s([y],b.prototype,"readU16",null),s([y],b.prototype,"readU32",null),s([y],b.prototype,"readU64",null),s([y],b.prototype,"readU128",null),s([y],b.prototype,"readU256",null),s([y],b.prototype,"readU512",null),s([y],b.prototype,"readString",null),s([y],b.prototype,"readFixedArray",null),s([y],b.prototype,"readArray",null),t.BinaryReader=b,t.serialize=function(e,t,r=g){const n=new r;return v(e,t,n),n.toArray()},t.deserialize=function(e,t,r,n=b){const i=new n(r),o=_(e,t,i);if(i.offset<r.length)throw new p(`Unexpected ${r.length-i.offset} bytes after deserialized data`);return o},t.deserializeUnchecked=function(e,t,r,n=b){return _(e,t,new n(r))}},9331:(e,t,r)=>{var n=r(7810);e.exports=n("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz")},1219:(e,t,r)=>{var n;function i(e){this.rand=e}if(e.exports=function(e){return n||(n=new i(null)),n.generate(e)},e.exports.Rand=i,i.prototype.generate=function(e){return this._rand(e)},i.prototype._rand=function(e){if(this.rand.getBytes)return this.rand.getBytes(e);for(var t=new Uint8Array(e),r=0;r<t.length;r++)t[r]=this.rand.getByte();return t},"object"==typeof self)self.crypto&&self.crypto.getRandomValues?i.prototype._rand=function(e){var t=new Uint8Array(e);return self.crypto.getRandomValues(t),t}:self.msCrypto&&self.msCrypto.getRandomValues?i.prototype._rand=function(e){var t=new Uint8Array(e);return self.msCrypto.getRandomValues(t),t}:"object"==typeof window&&(i.prototype._rand=function(){throw new Error("Not implemented yet")});else try{var o=r(4654);if("function"!=typeof o.randomBytes)throw new Error("Not supported");i.prototype._rand=function(e){return o.randomBytes(e)}}catch(e){}},8649:(e,t,r)=>{const n=r(3640);e.exports=n("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz")},3640:e=>{"use strict";e.exports=function(e){if(e.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),r=0;r<t.length;r++)t[r]=255;for(var n=0;n<e.length;n++){var i=e.charAt(n),o=i.charCodeAt(0);if(255!==t[o])throw new TypeError(i+" is ambiguous");t[o]=n}var s=e.length,a=e.charAt(0),c=Math.log(s)/Math.log(256),u=Math.log(256)/Math.log(s);function h(e){if("string"!=typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;for(var r=0,n=0,i=0;e[r]===a;)n++,r++;for(var o=(e.length-r)*c+1>>>0,u=new Uint8Array(o);e[r];){var h=t[e.charCodeAt(r)];if(255===h)return;for(var l=0,d=o-1;(0!==h||l<i)&&-1!==d;d--,l++)h+=s*u[d]>>>0,u[d]=h%256>>>0,h=h/256>>>0;if(0!==h)throw new Error("Non-zero carry");i=l,r++}for(var f=o-i;f!==o&&0===u[f];)f++;for(var p=new Uint8Array(n+(o-f)),g=n;f!==o;)p[g++]=u[f++];return p}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var r=0,n=0,i=0,o=t.length;i!==o&&0===t[i];)i++,r++;for(var c=(o-i)*u+1>>>0,h=new Uint8Array(c);i!==o;){for(var l=t[i],d=0,f=c-1;(0!==l||d<n)&&-1!==f;f--,d++)l+=256*h[f]>>>0,h[f]=l%s>>>0,l=l/s>>>0;if(0!==l)throw new Error("Non-zero carry");n=d,i++}for(var p=c-n;p!==c&&0===h[p];)p++;for(var g=a.repeat(r);p<c;++p)g+=e.charAt(h[p]);return g},decodeUnsafe:h,decode:function(e){var t=h(e);if(t)return t;throw new Error("Non-base"+s+" character")}}}},1429:(e,t,r)=>{"use strict";const n=r(4028),i=r(5801),o="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;t.Buffer=c,t.SlowBuffer=function(e){return+e!=e&&(e=0),c.alloc(+e)},t.INSPECT_MAX_BYTES=50;const s=2147483647;function a(e){if(e>s)throw new RangeError('The value "'+e+'" is invalid for option "size"');const t=new Uint8Array(e);return Object.setPrototypeOf(t,c.prototype),t}function c(e,t,r){if("number"==typeof e){if("string"==typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return l(e)}return u(e,t,r)}function u(e,t,r){if("string"==typeof e)return function(e,t){if("string"==typeof t&&""!==t||(t="utf8"),!c.isEncoding(t))throw new TypeError("Unknown encoding: "+t);const r=0|g(e,t);let n=a(r);const i=n.write(e,t);return i!==r&&(n=n.slice(0,i)),n}(e,t);if(ArrayBuffer.isView(e))return function(e){if(Y(e,Uint8Array)){const t=new Uint8Array(e);return f(t.buffer,t.byteOffset,t.byteLength)}return d(e)}(e);if(null==e)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(Y(e,ArrayBuffer)||e&&Y(e.buffer,ArrayBuffer))return f(e,t,r);if("undefined"!=typeof SharedArrayBuffer&&(Y(e,SharedArrayBuffer)||e&&Y(e.buffer,SharedArrayBuffer)))return f(e,t,r);if("number"==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');const n=e.valueOf&&e.valueOf();if(null!=n&&n!==e)return c.from(n,t,r);const i=function(e){if(c.isBuffer(e)){const t=0|p(e.length),r=a(t);return 0===r.length||e.copy(r,0,0,t),r}return void 0!==e.length?"number"!=typeof e.length||J(e.length)?a(0):d(e):"Buffer"===e.type&&Array.isArray(e.data)?d(e.data):void 0}(e);if(i)return i;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return c.from(e[Symbol.toPrimitive]("string"),t,r);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function h(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function l(e){return h(e),a(e<0?0:0|p(e))}function d(e){const t=e.length<0?0:0|p(e.length),r=a(t);for(let n=0;n<t;n+=1)r[n]=255&e[n];return r}function f(e,t,r){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(r||0))throw new RangeError('"length" is outside of buffer bounds');let n;return n=void 0===t&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,t):new Uint8Array(e,t,r),Object.setPrototypeOf(n,c.prototype),n}function p(e){if(e>=s)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s.toString(16)+" bytes");return 0|e}function g(e,t){if(c.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||Y(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);const r=e.length,n=arguments.length>2&&!0===arguments[2];if(!n&&0===r)return 0;let i=!1;for(;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return H(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return V(e).length;default:if(i)return n?-1:H(e).length;t=(""+t).toLowerCase(),i=!0}}function y(e,t,r){let n=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return R(this,t,r);case"utf8":case"utf-8":return k(this,t,r);case"ascii":return P(this,t,r);case"latin1":case"binary":return O(this,t,r);case"base64":return A(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return T(this,t,r);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),n=!0}}function b(e,t,r){const n=e[t];e[t]=e[r],e[r]=n}function m(e,t,r,n,i){if(0===e.length)return-1;if("string"==typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),J(r=+r)&&(r=i?0:e.length-1),r<0&&(r=e.length+r),r>=e.length){if(i)return-1;r=e.length-1}else if(r<0){if(!i)return-1;r=0}if("string"==typeof t&&(t=c.from(t,n)),c.isBuffer(t))return 0===t.length?-1:w(e,t,r,n,i);if("number"==typeof t)return t&=255,"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,r):Uint8Array.prototype.lastIndexOf.call(e,t,r):w(e,[t],r,n,i);throw new TypeError("val must be string, number or Buffer")}function w(e,t,r,n,i){let o,s=1,a=e.length,c=t.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return-1;s=2,a/=2,c/=2,r/=2}function u(e,t){return 1===s?e[t]:e.readUInt16BE(t*s)}if(i){let n=-1;for(o=r;o<a;o++)if(u(e,o)===u(t,-1===n?0:o-n)){if(-1===n&&(n=o),o-n+1===c)return n*s}else-1!==n&&(o-=o-n),n=-1}else for(r+c>a&&(r=a-c),o=r;o>=0;o--){let r=!0;for(let n=0;n<c;n++)if(u(e,o+n)!==u(t,n)){r=!1;break}if(r)return o}return-1}function v(e,t,r,n){r=Number(r)||0;const i=e.length-r;n?(n=Number(n))>i&&(n=i):n=i;const o=t.length;let s;for(n>o/2&&(n=o/2),s=0;s<n;++s){const n=parseInt(t.substr(2*s,2),16);if(J(n))return s;e[r+s]=n}return s}function S(e,t,r,n){return G(H(t,e.length-r),e,r,n)}function _(e,t,r,n){return G(function(e){const t=[];for(let r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}(t),e,r,n)}function E(e,t,r,n){return G(V(t),e,r,n)}function I(e,t,r,n){return G(function(e,t){let r,n,i;const o=[];for(let s=0;s<e.length&&!((t-=2)<0);++s)r=e.charCodeAt(s),n=r>>8,i=r%256,o.push(i),o.push(n);return o}(t,e.length-r),e,r,n)}function A(e,t,r){return 0===t&&r===e.length?n.fromByteArray(e):n.fromByteArray(e.slice(t,r))}function k(e,t,r){r=Math.min(e.length,r);const n=[];let i=t;for(;i<r;){const t=e[i];let o=null,s=t>239?4:t>223?3:t>191?2:1;if(i+s<=r){let r,n,a,c;switch(s){case 1:t<128&&(o=t);break;case 2:r=e[i+1],128==(192&r)&&(c=(31&t)<<6|63&r,c>127&&(o=c));break;case 3:r=e[i+1],n=e[i+2],128==(192&r)&&128==(192&n)&&(c=(15&t)<<12|(63&r)<<6|63&n,c>2047&&(c<55296||c>57343)&&(o=c));break;case 4:r=e[i+1],n=e[i+2],a=e[i+3],128==(192&r)&&128==(192&n)&&128==(192&a)&&(c=(15&t)<<18|(63&r)<<12|(63&n)<<6|63&a,c>65535&&c<1114112&&(o=c))}}null===o?(o=65533,s=1):o>65535&&(o-=65536,n.push(o>>>10&1023|55296),o=56320|1023&o),n.push(o),i+=s}return function(e){const t=e.length;if(t<=x)return String.fromCharCode.apply(String,e);let r="",n=0;for(;n<t;)r+=String.fromCharCode.apply(String,e.slice(n,n+=x));return r}(n)}t.kMaxLength=s,c.TYPED_ARRAY_SUPPORT=function(){try{const e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(e){return!1}}(),c.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(c.prototype,"parent",{enumerable:!0,get:function(){if(c.isBuffer(this))return this.buffer}}),Object.defineProperty(c.prototype,"offset",{enumerable:!0,get:function(){if(c.isBuffer(this))return this.byteOffset}}),c.poolSize=8192,c.from=function(e,t,r){return u(e,t,r)},Object.setPrototypeOf(c.prototype,Uint8Array.prototype),Object.setPrototypeOf(c,Uint8Array),c.alloc=function(e,t,r){return function(e,t,r){return h(e),e<=0?a(e):void 0!==t?"string"==typeof r?a(e).fill(t,r):a(e).fill(t):a(e)}(e,t,r)},c.allocUnsafe=function(e){return l(e)},c.allocUnsafeSlow=function(e){return l(e)},c.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==c.prototype},c.compare=function(e,t){if(Y(e,Uint8Array)&&(e=c.from(e,e.offset,e.byteLength)),Y(t,Uint8Array)&&(t=c.from(t,t.offset,t.byteLength)),!c.isBuffer(e)||!c.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;let r=e.length,n=t.length;for(let i=0,o=Math.min(r,n);i<o;++i)if(e[i]!==t[i]){r=e[i],n=t[i];break}return r<n?-1:n<r?1:0},c.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},c.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return c.alloc(0);let r;if(void 0===t)for(t=0,r=0;r<e.length;++r)t+=e[r].length;const n=c.allocUnsafe(t);let i=0;for(r=0;r<e.length;++r){let t=e[r];if(Y(t,Uint8Array))i+t.length>n.length?(c.isBuffer(t)||(t=c.from(t)),t.copy(n,i)):Uint8Array.prototype.set.call(n,t,i);else{if(!c.isBuffer(t))throw new TypeError('"list" argument must be an Array of Buffers');t.copy(n,i)}i+=t.length}return n},c.byteLength=g,c.prototype._isBuffer=!0,c.prototype.swap16=function(){const e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let t=0;t<e;t+=2)b(this,t,t+1);return this},c.prototype.swap32=function(){const e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let t=0;t<e;t+=4)b(this,t,t+3),b(this,t+1,t+2);return this},c.prototype.swap64=function(){const e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let t=0;t<e;t+=8)b(this,t,t+7),b(this,t+1,t+6),b(this,t+2,t+5),b(this,t+3,t+4);return this},c.prototype.toString=function(){const e=this.length;return 0===e?"":0===arguments.length?k(this,0,e):y.apply(this,arguments)},c.prototype.toLocaleString=c.prototype.toString,c.prototype.equals=function(e){if(!c.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===c.compare(this,e)},c.prototype.inspect=function(){let e="";const r=t.INSPECT_MAX_BYTES;return e=this.toString("hex",0,r).replace(/(.{2})/g,"$1 ").trim(),this.length>r&&(e+=" ... "),"<Buffer "+e+">"},o&&(c.prototype[o]=c.prototype.inspect),c.prototype.compare=function(e,t,r,n,i){if(Y(e,Uint8Array)&&(e=c.from(e,e.offset,e.byteLength)),!c.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===r&&(r=e?e.length:0),void 0===n&&(n=0),void 0===i&&(i=this.length),t<0||r>e.length||n<0||i>this.length)throw new RangeError("out of range index");if(n>=i&&t>=r)return 0;if(n>=i)return-1;if(t>=r)return 1;if(this===e)return 0;let o=(i>>>=0)-(n>>>=0),s=(r>>>=0)-(t>>>=0);const a=Math.min(o,s),u=this.slice(n,i),h=e.slice(t,r);for(let e=0;e<a;++e)if(u[e]!==h[e]){o=u[e],s=h[e];break}return o<s?-1:s<o?1:0},c.prototype.includes=function(e,t,r){return-1!==this.indexOf(e,t,r)},c.prototype.indexOf=function(e,t,r){return m(this,e,t,r,!0)},c.prototype.lastIndexOf=function(e,t,r){return m(this,e,t,r,!1)},c.prototype.write=function(e,t,r,n){if(void 0===t)n="utf8",r=this.length,t=0;else if(void 0===r&&"string"==typeof t)n=t,r=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(r)?(r>>>=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}const i=this.length-t;if((void 0===r||r>i)&&(r=i),e.length>0&&(r<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");let o=!1;for(;;)switch(n){case"hex":return v(this,e,t,r);case"utf8":case"utf-8":return S(this,e,t,r);case"ascii":case"latin1":case"binary":return _(this,e,t,r);case"base64":return E(this,e,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return I(this,e,t,r);default:if(o)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),o=!0}},c.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};const x=4096;function P(e,t,r){let n="";r=Math.min(e.length,r);for(let i=t;i<r;++i)n+=String.fromCharCode(127&e[i]);return n}function O(e,t,r){let n="";r=Math.min(e.length,r);for(let i=t;i<r;++i)n+=String.fromCharCode(e[i]);return n}function R(e,t,r){const n=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>n)&&(r=n);let i="";for(let n=t;n<r;++n)i+=X[e[n]];return i}function T(e,t,r){const n=e.slice(t,r);let i="";for(let e=0;e<n.length-1;e+=2)i+=String.fromCharCode(n[e]+256*n[e+1]);return i}function N(e,t,r){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>r)throw new RangeError("Trying to access beyond buffer length")}function M(e,t,r,n,i,o){if(!c.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<o)throw new RangeError('"value" argument is out of bounds');if(r+n>e.length)throw new RangeError("Index out of range")}function C(e,t,r,n,i){$(t,n,i,e,r,7);let o=Number(t&BigInt(4294967295));e[r++]=o,o>>=8,e[r++]=o,o>>=8,e[r++]=o,o>>=8,e[r++]=o;let s=Number(t>>BigInt(32)&BigInt(4294967295));return e[r++]=s,s>>=8,e[r++]=s,s>>=8,e[r++]=s,s>>=8,e[r++]=s,r}function B(e,t,r,n,i){$(t,n,i,e,r,7);let o=Number(t&BigInt(4294967295));e[r+7]=o,o>>=8,e[r+6]=o,o>>=8,e[r+5]=o,o>>=8,e[r+4]=o;let s=Number(t>>BigInt(32)&BigInt(4294967295));return e[r+3]=s,s>>=8,e[r+2]=s,s>>=8,e[r+1]=s,s>>=8,e[r]=s,r+8}function L(e,t,r,n,i,o){if(r+n>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function U(e,t,r,n,o){return t=+t,r>>>=0,o||L(e,0,r,4),i.write(e,t,r,n,23,4),r+4}function D(e,t,r,n,o){return t=+t,r>>>=0,o||L(e,0,r,8),i.write(e,t,r,n,52,8),r+8}c.prototype.slice=function(e,t){const r=this.length;(e=~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),(t=void 0===t?r:~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e);const n=this.subarray(e,t);return Object.setPrototypeOf(n,c.prototype),n},c.prototype.readUintLE=c.prototype.readUIntLE=function(e,t,r){e>>>=0,t>>>=0,r||N(e,t,this.length);let n=this[e],i=1,o=0;for(;++o<t&&(i*=256);)n+=this[e+o]*i;return n},c.prototype.readUintBE=c.prototype.readUIntBE=function(e,t,r){e>>>=0,t>>>=0,r||N(e,t,this.length);let n=this[e+--t],i=1;for(;t>0&&(i*=256);)n+=this[e+--t]*i;return n},c.prototype.readUint8=c.prototype.readUInt8=function(e,t){return e>>>=0,t||N(e,1,this.length),this[e]},c.prototype.readUint16LE=c.prototype.readUInt16LE=function(e,t){return e>>>=0,t||N(e,2,this.length),this[e]|this[e+1]<<8},c.prototype.readUint16BE=c.prototype.readUInt16BE=function(e,t){return e>>>=0,t||N(e,2,this.length),this[e]<<8|this[e+1]},c.prototype.readUint32LE=c.prototype.readUInt32LE=function(e,t){return e>>>=0,t||N(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},c.prototype.readUint32BE=c.prototype.readUInt32BE=function(e,t){return e>>>=0,t||N(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},c.prototype.readBigUInt64LE=Z((function(e){K(e>>>=0,"offset");const t=this[e],r=this[e+7];void 0!==t&&void 0!==r||F(e,this.length-8);const n=t+256*this[++e]+65536*this[++e]+this[++e]*2**24,i=this[++e]+256*this[++e]+65536*this[++e]+r*2**24;return BigInt(n)+(BigInt(i)<<BigInt(32))})),c.prototype.readBigUInt64BE=Z((function(e){K(e>>>=0,"offset");const t=this[e],r=this[e+7];void 0!==t&&void 0!==r||F(e,this.length-8);const n=t*2**24+65536*this[++e]+256*this[++e]+this[++e],i=this[++e]*2**24+65536*this[++e]+256*this[++e]+r;return(BigInt(n)<<BigInt(32))+BigInt(i)})),c.prototype.readIntLE=function(e,t,r){e>>>=0,t>>>=0,r||N(e,t,this.length);let n=this[e],i=1,o=0;for(;++o<t&&(i*=256);)n+=this[e+o]*i;return i*=128,n>=i&&(n-=Math.pow(2,8*t)),n},c.prototype.readIntBE=function(e,t,r){e>>>=0,t>>>=0,r||N(e,t,this.length);let n=t,i=1,o=this[e+--n];for(;n>0&&(i*=256);)o+=this[e+--n]*i;return i*=128,o>=i&&(o-=Math.pow(2,8*t)),o},c.prototype.readInt8=function(e,t){return e>>>=0,t||N(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},c.prototype.readInt16LE=function(e,t){e>>>=0,t||N(e,2,this.length);const r=this[e]|this[e+1]<<8;return 32768&r?4294901760|r:r},c.prototype.readInt16BE=function(e,t){e>>>=0,t||N(e,2,this.length);const r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r},c.prototype.readInt32LE=function(e,t){return e>>>=0,t||N(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},c.prototype.readInt32BE=function(e,t){return e>>>=0,t||N(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},c.prototype.readBigInt64LE=Z((function(e){K(e>>>=0,"offset");const t=this[e],r=this[e+7];void 0!==t&&void 0!==r||F(e,this.length-8);const n=this[e+4]+256*this[e+5]+65536*this[e+6]+(r<<24);return(BigInt(n)<<BigInt(32))+BigInt(t+256*this[++e]+65536*this[++e]+this[++e]*2**24)})),c.prototype.readBigInt64BE=Z((function(e){K(e>>>=0,"offset");const t=this[e],r=this[e+7];void 0!==t&&void 0!==r||F(e,this.length-8);const n=(t<<24)+65536*this[++e]+256*this[++e]+this[++e];return(BigInt(n)<<BigInt(32))+BigInt(this[++e]*2**24+65536*this[++e]+256*this[++e]+r)})),c.prototype.readFloatLE=function(e,t){return e>>>=0,t||N(e,4,this.length),i.read(this,e,!0,23,4)},c.prototype.readFloatBE=function(e,t){return e>>>=0,t||N(e,4,this.length),i.read(this,e,!1,23,4)},c.prototype.readDoubleLE=function(e,t){return e>>>=0,t||N(e,8,this.length),i.read(this,e,!0,52,8)},c.prototype.readDoubleBE=function(e,t){return e>>>=0,t||N(e,8,this.length),i.read(this,e,!1,52,8)},c.prototype.writeUintLE=c.prototype.writeUIntLE=function(e,t,r,n){e=+e,t>>>=0,r>>>=0,n||M(this,e,t,r,Math.pow(2,8*r)-1,0);let i=1,o=0;for(this[t]=255&e;++o<r&&(i*=256);)this[t+o]=e/i&255;return t+r},c.prototype.writeUintBE=c.prototype.writeUIntBE=function(e,t,r,n){e=+e,t>>>=0,r>>>=0,n||M(this,e,t,r,Math.pow(2,8*r)-1,0);let i=r-1,o=1;for(this[t+i]=255&e;--i>=0&&(o*=256);)this[t+i]=e/o&255;return t+r},c.prototype.writeUint8=c.prototype.writeUInt8=function(e,t,r){return e=+e,t>>>=0,r||M(this,e,t,1,255,0),this[t]=255&e,t+1},c.prototype.writeUint16LE=c.prototype.writeUInt16LE=function(e,t,r){return e=+e,t>>>=0,r||M(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},c.prototype.writeUint16BE=c.prototype.writeUInt16BE=function(e,t,r){return e=+e,t>>>=0,r||M(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},c.prototype.writeUint32LE=c.prototype.writeUInt32LE=function(e,t,r){return e=+e,t>>>=0,r||M(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},c.prototype.writeUint32BE=c.prototype.writeUInt32BE=function(e,t,r){return e=+e,t>>>=0,r||M(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},c.prototype.writeBigUInt64LE=Z((function(e,t=0){return C(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))})),c.prototype.writeBigUInt64BE=Z((function(e,t=0){return B(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))})),c.prototype.writeIntLE=function(e,t,r,n){if(e=+e,t>>>=0,!n){const n=Math.pow(2,8*r-1);M(this,e,t,r,n-1,-n)}let i=0,o=1,s=0;for(this[t]=255&e;++i<r&&(o*=256);)e<0&&0===s&&0!==this[t+i-1]&&(s=1),this[t+i]=(e/o|0)-s&255;return t+r},c.prototype.writeIntBE=function(e,t,r,n){if(e=+e,t>>>=0,!n){const n=Math.pow(2,8*r-1);M(this,e,t,r,n-1,-n)}let i=r-1,o=1,s=0;for(this[t+i]=255&e;--i>=0&&(o*=256);)e<0&&0===s&&0!==this[t+i+1]&&(s=1),this[t+i]=(e/o|0)-s&255;return t+r},c.prototype.writeInt8=function(e,t,r){return e=+e,t>>>=0,r||M(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},c.prototype.writeInt16LE=function(e,t,r){return e=+e,t>>>=0,r||M(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},c.prototype.writeInt16BE=function(e,t,r){return e=+e,t>>>=0,r||M(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},c.prototype.writeInt32LE=function(e,t,r){return e=+e,t>>>=0,r||M(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},c.prototype.writeInt32BE=function(e,t,r){return e=+e,t>>>=0,r||M(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},c.prototype.writeBigInt64LE=Z((function(e,t=0){return C(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),c.prototype.writeBigInt64BE=Z((function(e,t=0){return B(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),c.prototype.writeFloatLE=function(e,t,r){return U(this,e,t,!0,r)},c.prototype.writeFloatBE=function(e,t,r){return U(this,e,t,!1,r)},c.prototype.writeDoubleLE=function(e,t,r){return D(this,e,t,!0,r)},c.prototype.writeDoubleBE=function(e,t,r){return D(this,e,t,!1,r)},c.prototype.copy=function(e,t,r,n){if(!c.isBuffer(e))throw new TypeError("argument should be a Buffer");if(r||(r=0),n||0===n||(n=this.length),t>=e.length&&(t=e.length),t||(t=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-r&&(n=e.length-t+r);const i=n-r;return this===e&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(t,r,n):Uint8Array.prototype.set.call(e,this.subarray(r,n),t),i},c.prototype.fill=function(e,t,r,n){if("string"==typeof e){if("string"==typeof t?(n=t,t=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!c.isEncoding(n))throw new TypeError("Unknown encoding: "+n);if(1===e.length){const t=e.charCodeAt(0);("utf8"===n&&t<128||"latin1"===n)&&(e=t)}}else"number"==typeof e?e&=255:"boolean"==typeof e&&(e=Number(e));if(t<0||this.length<t||this.length<r)throw new RangeError("Out of range index");if(r<=t)return this;let i;if(t>>>=0,r=void 0===r?this.length:r>>>0,e||(e=0),"number"==typeof e)for(i=t;i<r;++i)this[i]=e;else{const o=c.isBuffer(e)?e:c.from(e,n),s=o.length;if(0===s)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(i=0;i<r-t;++i)this[i+t]=o[i%s]}return this};const j={};function z(e,t,r){j[e]=class extends r{constructor(){super(),Object.defineProperty(this,"message",{value:t.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${e}]`,this.stack,delete this.name}get code(){return e}set code(e){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:e,writable:!0})}toString(){return`${this.name} [${e}]: ${this.message}`}}}function q(e){let t="",r=e.length;const n="-"===e[0]?1:0;for(;r>=n+4;r-=3)t=`_${e.slice(r-3,r)}${t}`;return`${e.slice(0,r)}${t}`}function $(e,t,r,n,i,o){if(e>r||e<t){const n="bigint"==typeof t?"n":"";let i;throw i=o>3?0===t||t===BigInt(0)?`>= 0${n} and < 2${n} ** ${8*(o+1)}${n}`:`>= -(2${n} ** ${8*(o+1)-1}${n}) and < 2 ** ${8*(o+1)-1}${n}`:`>= ${t}${n} and <= ${r}${n}`,new j.ERR_OUT_OF_RANGE("value",i,e)}!function(e,t,r){K(t,"offset"),void 0!==e[t]&&void 0!==e[t+r]||F(t,e.length-(r+1))}(n,i,o)}function K(e,t){if("number"!=typeof e)throw new j.ERR_INVALID_ARG_TYPE(t,"number",e)}function F(e,t,r){if(Math.floor(e)!==e)throw K(e,r),new j.ERR_OUT_OF_RANGE(r||"offset","an integer",e);if(t<0)throw new j.ERR_BUFFER_OUT_OF_BOUNDS;throw new j.ERR_OUT_OF_RANGE(r||"offset",`>= ${r?1:0} and <= ${t}`,e)}z("ERR_BUFFER_OUT_OF_BOUNDS",(function(e){return e?`${e} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"}),RangeError),z("ERR_INVALID_ARG_TYPE",(function(e,t){return`The "${e}" argument must be of type number. Received type ${typeof t}`}),TypeError),z("ERR_OUT_OF_RANGE",(function(e,t,r){let n=`The value of "${e}" is out of range.`,i=r;return Number.isInteger(r)&&Math.abs(r)>2**32?i=q(String(r)):"bigint"==typeof r&&(i=String(r),(r>BigInt(2)**BigInt(32)||r<-(BigInt(2)**BigInt(32)))&&(i=q(i)),i+="n"),n+=` It must be ${t}. Received ${i}`,n}),RangeError);const W=/[^+/0-9A-Za-z-_]/g;function H(e,t){let r;t=t||1/0;const n=e.length;let i=null;const o=[];for(let s=0;s<n;++s){if(r=e.charCodeAt(s),r>55295&&r<57344){if(!i){if(r>56319){(t-=3)>-1&&o.push(239,191,189);continue}if(s+1===n){(t-=3)>-1&&o.push(239,191,189);continue}i=r;continue}if(r<56320){(t-=3)>-1&&o.push(239,191,189),i=r;continue}r=65536+(i-55296<<10|r-56320)}else i&&(t-=3)>-1&&o.push(239,191,189);if(i=null,r<128){if((t-=1)<0)break;o.push(r)}else if(r<2048){if((t-=2)<0)break;o.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;o.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return o}function V(e){return n.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(W,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function G(e,t,r,n){let i;for(i=0;i<n&&!(i+r>=t.length||i>=e.length);++i)t[i+r]=e[i];return i}function Y(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function J(e){return e!=e}const X=function(){const e="0123456789abcdef",t=new Array(256);for(let r=0;r<16;++r){const n=16*r;for(let i=0;i<16;++i)t[n+i]=e[r]+e[i]}return t}();function Z(e){return"undefined"==typeof BigInt?Q:e}function Q(){throw new Error("BigInt not supported")}},1581:(e,t,r)=>{"use strict";var n=r(4295),i=r(1701),o=i(n("String.prototype.indexOf"));e.exports=function(e,t){var r=n(e,!!t);return"function"==typeof r&&o(e,".prototype.")>-1?i(r):r}},1701:(e,t,r)=>{"use strict";var n=r(469),i=r(4295),o=r(8187),s=r(6757),a=i("%Function.prototype.apply%"),c=i("%Function.prototype.call%"),u=i("%Reflect.apply%",!0)||n.call(c,a),h=r(9997),l=i("%Math.max%");e.exports=function(e){if("function"!=typeof e)throw new s("a function is required");var t=u(n,c,arguments);return o(t,1+l(0,e.length-(arguments.length-1)),!0)};var d=function(){return u(n,a,arguments)};h?h(e.exports,"apply",{value:d}):e.exports.apply=d},5510:e=>{"use strict";var t=function(e){return function(e){return!!e&&"object"==typeof e}(e)&&!function(e){var t=Object.prototype.toString.call(e);return"[object RegExp]"===t||"[object Date]"===t||function(e){return e.$$typeof===r}(e)}(e)},r="function"==typeof Symbol&&Symbol.for?Symbol.for("react.element"):60103;function n(e,t){return!1!==t.clone&&t.isMergeableObject(e)?a((r=e,Array.isArray(r)?[]:{}),e,t):e;var r}function i(e,t,r){return e.concat(t).map((function(e){return n(e,r)}))}function o(e){return Object.keys(e).concat(function(e){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(e).filter((function(t){return Object.propertyIsEnumerable.call(e,t)})):[]}(e))}function s(e,t){try{return t in e}catch(e){return!1}}function a(e,r,c){(c=c||{}).arrayMerge=c.arrayMerge||i,c.isMergeableObject=c.isMergeableObject||t,c.cloneUnlessOtherwiseSpecified=n;var u=Array.isArray(r);return u===Array.isArray(e)?u?c.arrayMerge(e,r,c):function(e,t,r){var i={};return r.isMergeableObject(e)&&o(e).forEach((function(t){i[t]=n(e[t],r)})),o(t).forEach((function(o){(function(e,t){return s(e,t)&&!(Object.hasOwnProperty.call(e,t)&&Object.propertyIsEnumerable.call(e,t))})(e,o)||(s(e,o)&&r.isMergeableObject(t[o])?i[o]=function(e,t){if(!t.customMerge)return a;var r=t.customMerge(e);return"function"==typeof r?r:a}(o,r)(e[o],t[o],r):i[o]=n(t[o],r))})),i}(e,r,c):n(r,c)}a.all=function(e,t){if(!Array.isArray(e))throw new Error("first argument should be an array");return e.reduce((function(e,r){return a(e,r,t)}),{})};var c=a;e.exports=c},75:(e,t,r)=>{"use strict";var n=r(9997),i=r(1742),o=r(6757),s=r(1233);e.exports=function(e,t,r){if(!e||"object"!=typeof e&&"function"!=typeof e)throw new o("`obj` must be an object or a function`");if("string"!=typeof t&&"symbol"!=typeof t)throw new o("`property` must be a string or a symbol`");if(arguments.length>3&&"boolean"!=typeof arguments[3]&&null!==arguments[3])throw new o("`nonEnumerable`, if provided, must be a boolean or null");if(arguments.length>4&&"boolean"!=typeof arguments[4]&&null!==arguments[4])throw new o("`nonWritable`, if provided, must be a boolean or null");if(arguments.length>5&&"boolean"!=typeof arguments[5]&&null!==arguments[5])throw new o("`nonConfigurable`, if provided, must be a boolean or null");if(arguments.length>6&&"boolean"!=typeof arguments[6])throw new o("`loose`, if provided, must be a boolean");var a=arguments.length>3?arguments[3]:null,c=arguments.length>4?arguments[4]:null,u=arguments.length>5?arguments[5]:null,h=arguments.length>6&&arguments[6],l=!!s&&s(e,t);if(n)n(e,t,{configurable:null===u&&l?l.configurable:!u,enumerable:null===a&&l?l.enumerable:!a,value:r,writable:null===c&&l?l.writable:!c});else{if(!h&&(a||c||u))throw new i("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.");e[t]=r}}},5679:(e,t,r)=>{"use strict";var n=t;n.version=r(7142).rE,n.utils=r(1137),n.rand=r(1219),n.curve=r(6940),n.curves=r(1750),n.ec=r(8945),n.eddsa=r(4896)},9171:(e,t,r)=>{"use strict";var n=r(5530),i=r(1137),o=i.getNAF,s=i.getJSF,a=i.assert;function c(e,t){this.type=e,this.p=new n(t.p,16),this.red=t.prime?n.red(t.prime):n.mont(this.p),this.zero=new n(0).toRed(this.red),this.one=new n(1).toRed(this.red),this.two=new n(2).toRed(this.red),this.n=t.n&&new n(t.n,16),this.g=t.g&&this.pointFromJSON(t.g,t.gRed),this._wnafT1=new Array(4),this._wnafT2=new Array(4),this._wnafT3=new Array(4),this._wnafT4=new Array(4),this._bitLength=this.n?this.n.bitLength():0;var r=this.n&&this.p.div(this.n);!r||r.cmpn(100)>0?this.redN=null:(this._maxwellTrick=!0,this.redN=this.n.toRed(this.red))}function u(e,t){this.curve=e,this.type=t,this.precomputed=null}e.exports=c,c.prototype.point=function(){throw new Error("Not implemented")},c.prototype.validate=function(){throw new Error("Not implemented")},c.prototype._fixedNafMul=function(e,t){a(e.precomputed);var r=e._getDoubles(),n=o(t,1,this._bitLength),i=(1<<r.step+1)-(r.step%2==0?2:1);i/=3;var s,c,u=[];for(s=0;s<n.length;s+=r.step){c=0;for(var h=s+r.step-1;h>=s;h--)c=(c<<1)+n[h];u.push(c)}for(var l=this.jpoint(null,null,null),d=this.jpoint(null,null,null),f=i;f>0;f--){for(s=0;s<u.length;s++)(c=u[s])===f?d=d.mixedAdd(r.points[s]):c===-f&&(d=d.mixedAdd(r.points[s].neg()));l=l.add(d)}return l.toP()},c.prototype._wnafMul=function(e,t){var r=4,n=e._getNAFPoints(r);r=n.wnd;for(var i=n.points,s=o(t,r,this._bitLength),c=this.jpoint(null,null,null),u=s.length-1;u>=0;u--){for(var h=0;u>=0&&0===s[u];u--)h++;if(u>=0&&h++,c=c.dblp(h),u<0)break;var l=s[u];a(0!==l),c="affine"===e.type?l>0?c.mixedAdd(i[l-1>>1]):c.mixedAdd(i[-l-1>>1].neg()):l>0?c.add(i[l-1>>1]):c.add(i[-l-1>>1].neg())}return"affine"===e.type?c.toP():c},c.prototype._wnafMulAdd=function(e,t,r,n,i){var a,c,u,h=this._wnafT1,l=this._wnafT2,d=this._wnafT3,f=0;for(a=0;a<n;a++){var p=(u=t[a])._getNAFPoints(e);h[a]=p.wnd,l[a]=p.points}for(a=n-1;a>=1;a-=2){var g=a-1,y=a;if(1===h[g]&&1===h[y]){var b=[t[g],null,null,t[y]];0===t[g].y.cmp(t[y].y)?(b[1]=t[g].add(t[y]),b[2]=t[g].toJ().mixedAdd(t[y].neg())):0===t[g].y.cmp(t[y].y.redNeg())?(b[1]=t[g].toJ().mixedAdd(t[y]),b[2]=t[g].add(t[y].neg())):(b[1]=t[g].toJ().mixedAdd(t[y]),b[2]=t[g].toJ().mixedAdd(t[y].neg()));var m=[-3,-1,-5,-7,0,7,5,1,3],w=s(r[g],r[y]);for(f=Math.max(w[0].length,f),d[g]=new Array(f),d[y]=new Array(f),c=0;c<f;c++){var v=0|w[0][c],S=0|w[1][c];d[g][c]=m[3*(v+1)+(S+1)],d[y][c]=0,l[g]=b}}else d[g]=o(r[g],h[g],this._bitLength),d[y]=o(r[y],h[y],this._bitLength),f=Math.max(d[g].length,f),f=Math.max(d[y].length,f)}var _=this.jpoint(null,null,null),E=this._wnafT4;for(a=f;a>=0;a--){for(var I=0;a>=0;){var A=!0;for(c=0;c<n;c++)E[c]=0|d[c][a],0!==E[c]&&(A=!1);if(!A)break;I++,a--}if(a>=0&&I++,_=_.dblp(I),a<0)break;for(c=0;c<n;c++){var k=E[c];0!==k&&(k>0?u=l[c][k-1>>1]:k<0&&(u=l[c][-k-1>>1].neg()),_="affine"===u.type?_.mixedAdd(u):_.add(u))}}for(a=0;a<n;a++)l[a]=null;return i?_:_.toP()},c.BasePoint=u,u.prototype.eq=function(){throw new Error("Not implemented")},u.prototype.validate=function(){return this.curve.validate(this)},c.prototype.decodePoint=function(e,t){e=i.toArray(e,t);var r=this.p.byteLength();if((4===e[0]||6===e[0]||7===e[0])&&e.length-1==2*r)return 6===e[0]?a(e[e.length-1]%2==0):7===e[0]&&a(e[e.length-1]%2==1),this.point(e.slice(1,1+r),e.slice(1+r,1+2*r));if((2===e[0]||3===e[0])&&e.length-1===r)return this.pointFromX(e.slice(1,1+r),3===e[0]);throw new Error("Unknown point format")},u.prototype.encodeCompressed=function(e){return this.encode(e,!0)},u.prototype._encode=function(e){var t=this.curve.p.byteLength(),r=this.getX().toArray("be",t);return e?[this.getY().isEven()?2:3].concat(r):[4].concat(r,this.getY().toArray("be",t))},u.prototype.encode=function(e,t){return i.encode(this._encode(t),e)},u.prototype.precompute=function(e){if(this.precomputed)return this;var t={doubles:null,naf:null,beta:null};return t.naf=this._getNAFPoints(8),t.doubles=this._getDoubles(4,e),t.beta=this._getBeta(),this.precomputed=t,this},u.prototype._hasDoubles=function(e){if(!this.precomputed)return!1;var t=this.precomputed.doubles;return!!t&&t.points.length>=Math.ceil((e.bitLength()+1)/t.step)},u.prototype._getDoubles=function(e,t){if(this.precomputed&&this.precomputed.doubles)return this.precomputed.doubles;for(var r=[this],n=this,i=0;i<t;i+=e){for(var o=0;o<e;o++)n=n.dbl();r.push(n)}return{step:e,points:r}},u.prototype._getNAFPoints=function(e){if(this.precomputed&&this.precomputed.naf)return this.precomputed.naf;for(var t=[this],r=(1<<e)-1,n=1===r?null:this.dbl(),i=1;i<r;i++)t[i]=t[i-1].add(n);return{wnd:e,points:t}},u.prototype._getBeta=function(){return null},u.prototype.dblp=function(e){for(var t=this,r=0;r<e;r++)t=t.dbl();return t}},5544:(e,t,r)=>{"use strict";var n=r(1137),i=r(5530),o=r(9988),s=r(9171),a=n.assert;function c(e){this.twisted=1!=(0|e.a),this.mOneA=this.twisted&&-1==(0|e.a),this.extended=this.mOneA,s.call(this,"edwards",e),this.a=new i(e.a,16).umod(this.red.m),this.a=this.a.toRed(this.red),this.c=new i(e.c,16).toRed(this.red),this.c2=this.c.redSqr(),this.d=new i(e.d,16).toRed(this.red),this.dd=this.d.redAdd(this.d),a(!this.twisted||0===this.c.fromRed().cmpn(1)),this.oneC=1==(0|e.c)}function u(e,t,r,n,o){s.BasePoint.call(this,e,"projective"),null===t&&null===r&&null===n?(this.x=this.curve.zero,this.y=this.curve.one,this.z=this.curve.one,this.t=this.curve.zero,this.zOne=!0):(this.x=new i(t,16),this.y=new i(r,16),this.z=n?new i(n,16):this.curve.one,this.t=o&&new i(o,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.t&&!this.t.red&&(this.t=this.t.toRed(this.curve.red)),this.zOne=this.z===this.curve.one,this.curve.extended&&!this.t&&(this.t=this.x.redMul(this.y),this.zOne||(this.t=this.t.redMul(this.z.redInvm()))))}o(c,s),e.exports=c,c.prototype._mulA=function(e){return this.mOneA?e.redNeg():this.a.redMul(e)},c.prototype._mulC=function(e){return this.oneC?e:this.c.redMul(e)},c.prototype.jpoint=function(e,t,r,n){return this.point(e,t,r,n)},c.prototype.pointFromX=function(e,t){(e=new i(e,16)).red||(e=e.toRed(this.red));var r=e.redSqr(),n=this.c2.redSub(this.a.redMul(r)),o=this.one.redSub(this.c2.redMul(this.d).redMul(r)),s=n.redMul(o.redInvm()),a=s.redSqrt();if(0!==a.redSqr().redSub(s).cmp(this.zero))throw new Error("invalid point");var c=a.fromRed().isOdd();return(t&&!c||!t&&c)&&(a=a.redNeg()),this.point(e,a)},c.prototype.pointFromY=function(e,t){(e=new i(e,16)).red||(e=e.toRed(this.red));var r=e.redSqr(),n=r.redSub(this.c2),o=r.redMul(this.d).redMul(this.c2).redSub(this.a),s=n.redMul(o.redInvm());if(0===s.cmp(this.zero)){if(t)throw new Error("invalid point");return this.point(this.zero,e)}var a=s.redSqrt();if(0!==a.redSqr().redSub(s).cmp(this.zero))throw new Error("invalid point");return a.fromRed().isOdd()!==t&&(a=a.redNeg()),this.point(a,e)},c.prototype.validate=function(e){if(e.isInfinity())return!0;e.normalize();var t=e.x.redSqr(),r=e.y.redSqr(),n=t.redMul(this.a).redAdd(r),i=this.c2.redMul(this.one.redAdd(this.d.redMul(t).redMul(r)));return 0===n.cmp(i)},o(u,s.BasePoint),c.prototype.pointFromJSON=function(e){return u.fromJSON(this,e)},c.prototype.point=function(e,t,r,n){return new u(this,e,t,r,n)},u.fromJSON=function(e,t){return new u(e,t[0],t[1],t[2])},u.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"},u.prototype.isInfinity=function(){return 0===this.x.cmpn(0)&&(0===this.y.cmp(this.z)||this.zOne&&0===this.y.cmp(this.curve.c))},u.prototype._extDbl=function(){var e=this.x.redSqr(),t=this.y.redSqr(),r=this.z.redSqr();r=r.redIAdd(r);var n=this.curve._mulA(e),i=this.x.redAdd(this.y).redSqr().redISub(e).redISub(t),o=n.redAdd(t),s=o.redSub(r),a=n.redSub(t),c=i.redMul(s),u=o.redMul(a),h=i.redMul(a),l=s.redMul(o);return this.curve.point(c,u,l,h)},u.prototype._projDbl=function(){var e,t,r,n,i,o,s=this.x.redAdd(this.y).redSqr(),a=this.x.redSqr(),c=this.y.redSqr();if(this.curve.twisted){var u=(n=this.curve._mulA(a)).redAdd(c);this.zOne?(e=s.redSub(a).redSub(c).redMul(u.redSub(this.curve.two)),t=u.redMul(n.redSub(c)),r=u.redSqr().redSub(u).redSub(u)):(i=this.z.redSqr(),o=u.redSub(i).redISub(i),e=s.redSub(a).redISub(c).redMul(o),t=u.redMul(n.redSub(c)),r=u.redMul(o))}else n=a.redAdd(c),i=this.curve._mulC(this.z).redSqr(),o=n.redSub(i).redSub(i),e=this.curve._mulC(s.redISub(n)).redMul(o),t=this.curve._mulC(n).redMul(a.redISub(c)),r=n.redMul(o);return this.curve.point(e,t,r)},u.prototype.dbl=function(){return this.isInfinity()?this:this.curve.extended?this._extDbl():this._projDbl()},u.prototype._extAdd=function(e){var t=this.y.redSub(this.x).redMul(e.y.redSub(e.x)),r=this.y.redAdd(this.x).redMul(e.y.redAdd(e.x)),n=this.t.redMul(this.curve.dd).redMul(e.t),i=this.z.redMul(e.z.redAdd(e.z)),o=r.redSub(t),s=i.redSub(n),a=i.redAdd(n),c=r.redAdd(t),u=o.redMul(s),h=a.redMul(c),l=o.redMul(c),d=s.redMul(a);return this.curve.point(u,h,d,l)},u.prototype._projAdd=function(e){var t,r,n=this.z.redMul(e.z),i=n.redSqr(),o=this.x.redMul(e.x),s=this.y.redMul(e.y),a=this.curve.d.redMul(o).redMul(s),c=i.redSub(a),u=i.redAdd(a),h=this.x.redAdd(this.y).redMul(e.x.redAdd(e.y)).redISub(o).redISub(s),l=n.redMul(c).redMul(h);return this.curve.twisted?(t=n.redMul(u).redMul(s.redSub(this.curve._mulA(o))),r=c.redMul(u)):(t=n.redMul(u).redMul(s.redSub(o)),r=this.curve._mulC(c).redMul(u)),this.curve.point(l,t,r)},u.prototype.add=function(e){return this.isInfinity()?e:e.isInfinity()?this:this.curve.extended?this._extAdd(e):this._projAdd(e)},u.prototype.mul=function(e){return this._hasDoubles(e)?this.curve._fixedNafMul(this,e):this.curve._wnafMul(this,e)},u.prototype.mulAdd=function(e,t,r){return this.curve._wnafMulAdd(1,[this,t],[e,r],2,!1)},u.prototype.jmulAdd=function(e,t,r){return this.curve._wnafMulAdd(1,[this,t],[e,r],2,!0)},u.prototype.normalize=function(){if(this.zOne)return this;var e=this.z.redInvm();return this.x=this.x.redMul(e),this.y=this.y.redMul(e),this.t&&(this.t=this.t.redMul(e)),this.z=this.curve.one,this.zOne=!0,this},u.prototype.neg=function(){return this.curve.point(this.x.redNeg(),this.y,this.z,this.t&&this.t.redNeg())},u.prototype.getX=function(){return this.normalize(),this.x.fromRed()},u.prototype.getY=function(){return this.normalize(),this.y.fromRed()},u.prototype.eq=function(e){return this===e||0===this.getX().cmp(e.getX())&&0===this.getY().cmp(e.getY())},u.prototype.eqXToP=function(e){var t=e.toRed(this.curve.red).redMul(this.z);if(0===this.x.cmp(t))return!0;for(var r=e.clone(),n=this.curve.redN.redMul(this.z);;){if(r.iadd(this.curve.n),r.cmp(this.curve.p)>=0)return!1;if(t.redIAdd(n),0===this.x.cmp(t))return!0}},u.prototype.toP=u.prototype.normalize,u.prototype.mixedAdd=u.prototype.add},6940:(e,t,r)=>{"use strict";var n=t;n.base=r(9171),n.short=r(8370),n.mont=r(6888),n.edwards=r(5544)},6888:(e,t,r)=>{"use strict";var n=r(5530),i=r(9988),o=r(9171),s=r(1137);function a(e){o.call(this,"mont",e),this.a=new n(e.a,16).toRed(this.red),this.b=new n(e.b,16).toRed(this.red),this.i4=new n(4).toRed(this.red).redInvm(),this.two=new n(2).toRed(this.red),this.a24=this.i4.redMul(this.a.redAdd(this.two))}function c(e,t,r){o.BasePoint.call(this,e,"projective"),null===t&&null===r?(this.x=this.curve.one,this.z=this.curve.zero):(this.x=new n(t,16),this.z=new n(r,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)))}i(a,o),e.exports=a,a.prototype.validate=function(e){var t=e.normalize().x,r=t.redSqr(),n=r.redMul(t).redAdd(r.redMul(this.a)).redAdd(t);return 0===n.redSqrt().redSqr().cmp(n)},i(c,o.BasePoint),a.prototype.decodePoint=function(e,t){return this.point(s.toArray(e,t),1)},a.prototype.point=function(e,t){return new c(this,e,t)},a.prototype.pointFromJSON=function(e){return c.fromJSON(this,e)},c.prototype.precompute=function(){},c.prototype._encode=function(){return this.getX().toArray("be",this.curve.p.byteLength())},c.fromJSON=function(e,t){return new c(e,t[0],t[1]||e.one)},c.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"},c.prototype.isInfinity=function(){return 0===this.z.cmpn(0)},c.prototype.dbl=function(){var e=this.x.redAdd(this.z).redSqr(),t=this.x.redSub(this.z).redSqr(),r=e.redSub(t),n=e.redMul(t),i=r.redMul(t.redAdd(this.curve.a24.redMul(r)));return this.curve.point(n,i)},c.prototype.add=function(){throw new Error("Not supported on Montgomery curve")},c.prototype.diffAdd=function(e,t){var r=this.x.redAdd(this.z),n=this.x.redSub(this.z),i=e.x.redAdd(e.z),o=e.x.redSub(e.z).redMul(r),s=i.redMul(n),a=t.z.redMul(o.redAdd(s).redSqr()),c=t.x.redMul(o.redISub(s).redSqr());return this.curve.point(a,c)},c.prototype.mul=function(e){for(var t=e.clone(),r=this,n=this.curve.point(null,null),i=[];0!==t.cmpn(0);t.iushrn(1))i.push(t.andln(1));for(var o=i.length-1;o>=0;o--)0===i[o]?(r=r.diffAdd(n,this),n=n.dbl()):(n=r.diffAdd(n,this),r=r.dbl());return n},c.prototype.mulAdd=function(){throw new Error("Not supported on Montgomery curve")},c.prototype.jumlAdd=function(){throw new Error("Not supported on Montgomery curve")},c.prototype.eq=function(e){return 0===this.getX().cmp(e.getX())},c.prototype.normalize=function(){return this.x=this.x.redMul(this.z.redInvm()),this.z=this.curve.one,this},c.prototype.getX=function(){return this.normalize(),this.x.fromRed()}},8370:(e,t,r)=>{"use strict";var n=r(1137),i=r(5530),o=r(9988),s=r(9171),a=n.assert;function c(e){s.call(this,"short",e),this.a=new i(e.a,16).toRed(this.red),this.b=new i(e.b,16).toRed(this.red),this.tinv=this.two.redInvm(),this.zeroA=0===this.a.fromRed().cmpn(0),this.threeA=0===this.a.fromRed().sub(this.p).cmpn(-3),this.endo=this._getEndomorphism(e),this._endoWnafT1=new Array(4),this._endoWnafT2=new Array(4)}function u(e,t,r,n){s.BasePoint.call(this,e,"affine"),null===t&&null===r?(this.x=null,this.y=null,this.inf=!0):(this.x=new i(t,16),this.y=new i(r,16),n&&(this.x.forceRed(this.curve.red),this.y.forceRed(this.curve.red)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.inf=!1)}function h(e,t,r,n){s.BasePoint.call(this,e,"jacobian"),null===t&&null===r&&null===n?(this.x=this.curve.one,this.y=this.curve.one,this.z=new i(0)):(this.x=new i(t,16),this.y=new i(r,16),this.z=new i(n,16)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.zOne=this.z===this.curve.one}o(c,s),e.exports=c,c.prototype._getEndomorphism=function(e){if(this.zeroA&&this.g&&this.n&&1===this.p.modn(3)){var t,r;if(e.beta)t=new i(e.beta,16).toRed(this.red);else{var n=this._getEndoRoots(this.p);t=(t=n[0].cmp(n[1])<0?n[0]:n[1]).toRed(this.red)}if(e.lambda)r=new i(e.lambda,16);else{var o=this._getEndoRoots(this.n);0===this.g.mul(o[0]).x.cmp(this.g.x.redMul(t))?r=o[0]:(r=o[1],a(0===this.g.mul(r).x.cmp(this.g.x.redMul(t))))}return{beta:t,lambda:r,basis:e.basis?e.basis.map((function(e){return{a:new i(e.a,16),b:new i(e.b,16)}})):this._getEndoBasis(r)}}},c.prototype._getEndoRoots=function(e){var t=e===this.p?this.red:i.mont(e),r=new i(2).toRed(t).redInvm(),n=r.redNeg(),o=new i(3).toRed(t).redNeg().redSqrt().redMul(r);return[n.redAdd(o).fromRed(),n.redSub(o).fromRed()]},c.prototype._getEndoBasis=function(e){for(var t,r,n,o,s,a,c,u,h,l=this.n.ushrn(Math.floor(this.n.bitLength()/2)),d=e,f=this.n.clone(),p=new i(1),g=new i(0),y=new i(0),b=new i(1),m=0;0!==d.cmpn(0);){var w=f.div(d);u=f.sub(w.mul(d)),h=y.sub(w.mul(p));var v=b.sub(w.mul(g));if(!n&&u.cmp(l)<0)t=c.neg(),r=p,n=u.neg(),o=h;else if(n&&2==++m)break;c=u,f=d,d=u,y=p,p=h,b=g,g=v}s=u.neg(),a=h;var S=n.sqr().add(o.sqr());return s.sqr().add(a.sqr()).cmp(S)>=0&&(s=t,a=r),n.negative&&(n=n.neg(),o=o.neg()),s.negative&&(s=s.neg(),a=a.neg()),[{a:n,b:o},{a:s,b:a}]},c.prototype._endoSplit=function(e){var t=this.endo.basis,r=t[0],n=t[1],i=n.b.mul(e).divRound(this.n),o=r.b.neg().mul(e).divRound(this.n),s=i.mul(r.a),a=o.mul(n.a),c=i.mul(r.b),u=o.mul(n.b);return{k1:e.sub(s).sub(a),k2:c.add(u).neg()}},c.prototype.pointFromX=function(e,t){(e=new i(e,16)).red||(e=e.toRed(this.red));var r=e.redSqr().redMul(e).redIAdd(e.redMul(this.a)).redIAdd(this.b),n=r.redSqrt();if(0!==n.redSqr().redSub(r).cmp(this.zero))throw new Error("invalid point");var o=n.fromRed().isOdd();return(t&&!o||!t&&o)&&(n=n.redNeg()),this.point(e,n)},c.prototype.validate=function(e){if(e.inf)return!0;var t=e.x,r=e.y,n=this.a.redMul(t),i=t.redSqr().redMul(t).redIAdd(n).redIAdd(this.b);return 0===r.redSqr().redISub(i).cmpn(0)},c.prototype._endoWnafMulAdd=function(e,t,r){for(var n=this._endoWnafT1,i=this._endoWnafT2,o=0;o<e.length;o++){var s=this._endoSplit(t[o]),a=e[o],c=a._getBeta();s.k1.negative&&(s.k1.ineg(),a=a.neg(!0)),s.k2.negative&&(s.k2.ineg(),c=c.neg(!0)),n[2*o]=a,n[2*o+1]=c,i[2*o]=s.k1,i[2*o+1]=s.k2}for(var u=this._wnafMulAdd(1,n,i,2*o,r),h=0;h<2*o;h++)n[h]=null,i[h]=null;return u},o(u,s.BasePoint),c.prototype.point=function(e,t,r){return new u(this,e,t,r)},c.prototype.pointFromJSON=function(e,t){return u.fromJSON(this,e,t)},u.prototype._getBeta=function(){if(this.curve.endo){var e=this.precomputed;if(e&&e.beta)return e.beta;var t=this.curve.point(this.x.redMul(this.curve.endo.beta),this.y);if(e){var r=this.curve,n=function(e){return r.point(e.x.redMul(r.endo.beta),e.y)};e.beta=t,t.precomputed={beta:null,naf:e.naf&&{wnd:e.naf.wnd,points:e.naf.points.map(n)},doubles:e.doubles&&{step:e.doubles.step,points:e.doubles.points.map(n)}}}return t}},u.prototype.toJSON=function(){return this.precomputed?[this.x,this.y,this.precomputed&&{doubles:this.precomputed.doubles&&{step:this.precomputed.doubles.step,points:this.precomputed.doubles.points.slice(1)},naf:this.precomputed.naf&&{wnd:this.precomputed.naf.wnd,points:this.precomputed.naf.points.slice(1)}}]:[this.x,this.y]},u.fromJSON=function(e,t,r){"string"==typeof t&&(t=JSON.parse(t));var n=e.point(t[0],t[1],r);if(!t[2])return n;function i(t){return e.point(t[0],t[1],r)}var o=t[2];return n.precomputed={beta:null,doubles:o.doubles&&{step:o.doubles.step,points:[n].concat(o.doubles.points.map(i))},naf:o.naf&&{wnd:o.naf.wnd,points:[n].concat(o.naf.points.map(i))}},n},u.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+">"},u.prototype.isInfinity=function(){return this.inf},u.prototype.add=function(e){if(this.inf)return e;if(e.inf)return this;if(this.eq(e))return this.dbl();if(this.neg().eq(e))return this.curve.point(null,null);if(0===this.x.cmp(e.x))return this.curve.point(null,null);var t=this.y.redSub(e.y);0!==t.cmpn(0)&&(t=t.redMul(this.x.redSub(e.x).redInvm()));var r=t.redSqr().redISub(this.x).redISub(e.x),n=t.redMul(this.x.redSub(r)).redISub(this.y);return this.curve.point(r,n)},u.prototype.dbl=function(){if(this.inf)return this;var e=this.y.redAdd(this.y);if(0===e.cmpn(0))return this.curve.point(null,null);var t=this.curve.a,r=this.x.redSqr(),n=e.redInvm(),i=r.redAdd(r).redIAdd(r).redIAdd(t).redMul(n),o=i.redSqr().redISub(this.x.redAdd(this.x)),s=i.redMul(this.x.redSub(o)).redISub(this.y);return this.curve.point(o,s)},u.prototype.getX=function(){return this.x.fromRed()},u.prototype.getY=function(){return this.y.fromRed()},u.prototype.mul=function(e){return e=new i(e,16),this.isInfinity()?this:this._hasDoubles(e)?this.curve._fixedNafMul(this,e):this.curve.endo?this.curve._endoWnafMulAdd([this],[e]):this.curve._wnafMul(this,e)},u.prototype.mulAdd=function(e,t,r){var n=[this,t],i=[e,r];return this.curve.endo?this.curve._endoWnafMulAdd(n,i):this.curve._wnafMulAdd(1,n,i,2)},u.prototype.jmulAdd=function(e,t,r){var n=[this,t],i=[e,r];return this.curve.endo?this.curve._endoWnafMulAdd(n,i,!0):this.curve._wnafMulAdd(1,n,i,2,!0)},u.prototype.eq=function(e){return this===e||this.inf===e.inf&&(this.inf||0===this.x.cmp(e.x)&&0===this.y.cmp(e.y))},u.prototype.neg=function(e){if(this.inf)return this;var t=this.curve.point(this.x,this.y.redNeg());if(e&&this.precomputed){var r=this.precomputed,n=function(e){return e.neg()};t.precomputed={naf:r.naf&&{wnd:r.naf.wnd,points:r.naf.points.map(n)},doubles:r.doubles&&{step:r.doubles.step,points:r.doubles.points.map(n)}}}return t},u.prototype.toJ=function(){return this.inf?this.curve.jpoint(null,null,null):this.curve.jpoint(this.x,this.y,this.curve.one)},o(h,s.BasePoint),c.prototype.jpoint=function(e,t,r){return new h(this,e,t,r)},h.prototype.toP=function(){if(this.isInfinity())return this.curve.point(null,null);var e=this.z.redInvm(),t=e.redSqr(),r=this.x.redMul(t),n=this.y.redMul(t).redMul(e);return this.curve.point(r,n)},h.prototype.neg=function(){return this.curve.jpoint(this.x,this.y.redNeg(),this.z)},h.prototype.add=function(e){if(this.isInfinity())return e;if(e.isInfinity())return this;var t=e.z.redSqr(),r=this.z.redSqr(),n=this.x.redMul(t),i=e.x.redMul(r),o=this.y.redMul(t.redMul(e.z)),s=e.y.redMul(r.redMul(this.z)),a=n.redSub(i),c=o.redSub(s);if(0===a.cmpn(0))return 0!==c.cmpn(0)?this.curve.jpoint(null,null,null):this.dbl();var u=a.redSqr(),h=u.redMul(a),l=n.redMul(u),d=c.redSqr().redIAdd(h).redISub(l).redISub(l),f=c.redMul(l.redISub(d)).redISub(o.redMul(h)),p=this.z.redMul(e.z).redMul(a);return this.curve.jpoint(d,f,p)},h.prototype.mixedAdd=function(e){if(this.isInfinity())return e.toJ();if(e.isInfinity())return this;var t=this.z.redSqr(),r=this.x,n=e.x.redMul(t),i=this.y,o=e.y.redMul(t).redMul(this.z),s=r.redSub(n),a=i.redSub(o);if(0===s.cmpn(0))return 0!==a.cmpn(0)?this.curve.jpoint(null,null,null):this.dbl();var c=s.redSqr(),u=c.redMul(s),h=r.redMul(c),l=a.redSqr().redIAdd(u).redISub(h).redISub(h),d=a.redMul(h.redISub(l)).redISub(i.redMul(u)),f=this.z.redMul(s);return this.curve.jpoint(l,d,f)},h.prototype.dblp=function(e){if(0===e)return this;if(this.isInfinity())return this;if(!e)return this.dbl();var t;if(this.curve.zeroA||this.curve.threeA){var r=this;for(t=0;t<e;t++)r=r.dbl();return r}var n=this.curve.a,i=this.curve.tinv,o=this.x,s=this.y,a=this.z,c=a.redSqr().redSqr(),u=s.redAdd(s);for(t=0;t<e;t++){var h=o.redSqr(),l=u.redSqr(),d=l.redSqr(),f=h.redAdd(h).redIAdd(h).redIAdd(n.redMul(c)),p=o.redMul(l),g=f.redSqr().redISub(p.redAdd(p)),y=p.redISub(g),b=f.redMul(y);b=b.redIAdd(b).redISub(d);var m=u.redMul(a);t+1<e&&(c=c.redMul(d)),o=g,a=m,u=b}return this.curve.jpoint(o,u.redMul(i),a)},h.prototype.dbl=function(){return this.isInfinity()?this:this.curve.zeroA?this._zeroDbl():this.curve.threeA?this._threeDbl():this._dbl()},h.prototype._zeroDbl=function(){var e,t,r;if(this.zOne){var n=this.x.redSqr(),i=this.y.redSqr(),o=i.redSqr(),s=this.x.redAdd(i).redSqr().redISub(n).redISub(o);s=s.redIAdd(s);var a=n.redAdd(n).redIAdd(n),c=a.redSqr().redISub(s).redISub(s),u=o.redIAdd(o);u=(u=u.redIAdd(u)).redIAdd(u),e=c,t=a.redMul(s.redISub(c)).redISub(u),r=this.y.redAdd(this.y)}else{var h=this.x.redSqr(),l=this.y.redSqr(),d=l.redSqr(),f=this.x.redAdd(l).redSqr().redISub(h).redISub(d);f=f.redIAdd(f);var p=h.redAdd(h).redIAdd(h),g=p.redSqr(),y=d.redIAdd(d);y=(y=y.redIAdd(y)).redIAdd(y),e=g.redISub(f).redISub(f),t=p.redMul(f.redISub(e)).redISub(y),r=(r=this.y.redMul(this.z)).redIAdd(r)}return this.curve.jpoint(e,t,r)},h.prototype._threeDbl=function(){var e,t,r;if(this.zOne){var n=this.x.redSqr(),i=this.y.redSqr(),o=i.redSqr(),s=this.x.redAdd(i).redSqr().redISub(n).redISub(o);s=s.redIAdd(s);var a=n.redAdd(n).redIAdd(n).redIAdd(this.curve.a),c=a.redSqr().redISub(s).redISub(s);e=c;var u=o.redIAdd(o);u=(u=u.redIAdd(u)).redIAdd(u),t=a.redMul(s.redISub(c)).redISub(u),r=this.y.redAdd(this.y)}else{var h=this.z.redSqr(),l=this.y.redSqr(),d=this.x.redMul(l),f=this.x.redSub(h).redMul(this.x.redAdd(h));f=f.redAdd(f).redIAdd(f);var p=d.redIAdd(d),g=(p=p.redIAdd(p)).redAdd(p);e=f.redSqr().redISub(g),r=this.y.redAdd(this.z).redSqr().redISub(l).redISub(h);var y=l.redSqr();y=(y=(y=y.redIAdd(y)).redIAdd(y)).redIAdd(y),t=f.redMul(p.redISub(e)).redISub(y)}return this.curve.jpoint(e,t,r)},h.prototype._dbl=function(){var e=this.curve.a,t=this.x,r=this.y,n=this.z,i=n.redSqr().redSqr(),o=t.redSqr(),s=r.redSqr(),a=o.redAdd(o).redIAdd(o).redIAdd(e.redMul(i)),c=t.redAdd(t),u=(c=c.redIAdd(c)).redMul(s),h=a.redSqr().redISub(u.redAdd(u)),l=u.redISub(h),d=s.redSqr();d=(d=(d=d.redIAdd(d)).redIAdd(d)).redIAdd(d);var f=a.redMul(l).redISub(d),p=r.redAdd(r).redMul(n);return this.curve.jpoint(h,f,p)},h.prototype.trpl=function(){if(!this.curve.zeroA)return this.dbl().add(this);var e=this.x.redSqr(),t=this.y.redSqr(),r=this.z.redSqr(),n=t.redSqr(),i=e.redAdd(e).redIAdd(e),o=i.redSqr(),s=this.x.redAdd(t).redSqr().redISub(e).redISub(n),a=(s=(s=(s=s.redIAdd(s)).redAdd(s).redIAdd(s)).redISub(o)).redSqr(),c=n.redIAdd(n);c=(c=(c=c.redIAdd(c)).redIAdd(c)).redIAdd(c);var u=i.redIAdd(s).redSqr().redISub(o).redISub(a).redISub(c),h=t.redMul(u);h=(h=h.redIAdd(h)).redIAdd(h);var l=this.x.redMul(a).redISub(h);l=(l=l.redIAdd(l)).redIAdd(l);var d=this.y.redMul(u.redMul(c.redISub(u)).redISub(s.redMul(a)));d=(d=(d=d.redIAdd(d)).redIAdd(d)).redIAdd(d);var f=this.z.redAdd(s).redSqr().redISub(r).redISub(a);return this.curve.jpoint(l,d,f)},h.prototype.mul=function(e,t){return e=new i(e,t),this.curve._wnafMul(this,e)},h.prototype.eq=function(e){if("affine"===e.type)return this.eq(e.toJ());if(this===e)return!0;var t=this.z.redSqr(),r=e.z.redSqr();if(0!==this.x.redMul(r).redISub(e.x.redMul(t)).cmpn(0))return!1;var n=t.redMul(this.z),i=r.redMul(e.z);return 0===this.y.redMul(i).redISub(e.y.redMul(n)).cmpn(0)},h.prototype.eqXToP=function(e){var t=this.z.redSqr(),r=e.toRed(this.curve.red).redMul(t);if(0===this.x.cmp(r))return!0;for(var n=e.clone(),i=this.curve.redN.redMul(t);;){if(n.iadd(this.curve.n),n.cmp(this.curve.p)>=0)return!1;if(r.redIAdd(i),0===this.x.cmp(r))return!0}},h.prototype.inspect=function(){return this.isInfinity()?"<EC JPoint Infinity>":"<EC JPoint x: "+this.x.toString(16,2)+" y: "+this.y.toString(16,2)+" z: "+this.z.toString(16,2)+">"},h.prototype.isInfinity=function(){return 0===this.z.cmpn(0)}},1750:(e,t,r)=>{"use strict";var n,i=t,o=r(7734),s=r(6940),a=r(1137).assert;function c(e){"short"===e.type?this.curve=new s.short(e):"edwards"===e.type?this.curve=new s.edwards(e):this.curve=new s.mont(e),this.g=this.curve.g,this.n=this.curve.n,this.hash=e.hash,a(this.g.validate(),"Invalid curve"),a(this.g.mul(this.n).isInfinity(),"Invalid curve, G*N != O")}function u(e,t){Object.defineProperty(i,e,{configurable:!0,enumerable:!0,get:function(){var r=new c(t);return Object.defineProperty(i,e,{configurable:!0,enumerable:!0,value:r}),r}})}i.PresetCurve=c,u("p192",{type:"short",prime:"p192",p:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff",a:"ffffffff ffffffff ffffffff fffffffe ffffffff fffffffc",b:"64210519 e59c80e7 0fa7e9ab 72243049 feb8deec c146b9b1",n:"ffffffff ffffffff ffffffff 99def836 146bc9b1 b4d22831",hash:o.sha256,gRed:!1,g:["188da80e b03090f6 7cbf20eb 43a18800 f4ff0afd 82ff1012","07192b95 ffc8da78 631011ed 6b24cdd5 73f977a1 1e794811"]}),u("p224",{type:"short",prime:"p224",p:"ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001",a:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff fffffffe",b:"b4050a85 0c04b3ab f5413256 5044b0b7 d7bfd8ba 270b3943 2355ffb4",n:"ffffffff ffffffff ffffffff ffff16a2 e0b8f03e 13dd2945 5c5c2a3d",hash:o.sha256,gRed:!1,g:["b70e0cbd 6bb4bf7f 321390b9 4a03c1d3 56c21122 343280d6 115c1d21","bd376388 b5f723fb 4c22dfe6 cd4375a0 5a074764 44d58199 85007e34"]}),u("p256",{type:"short",prime:null,p:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff ffffffff",a:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff fffffffc",b:"5ac635d8 aa3a93e7 b3ebbd55 769886bc 651d06b0 cc53b0f6 3bce3c3e 27d2604b",n:"ffffffff 00000000 ffffffff ffffffff bce6faad a7179e84 f3b9cac2 fc632551",hash:o.sha256,gRed:!1,g:["6b17d1f2 e12c4247 f8bce6e5 63a440f2 77037d81 2deb33a0 f4a13945 d898c296","4fe342e2 fe1a7f9b 8ee7eb4a 7c0f9e16 2bce3357 6b315ece cbb64068 37bf51f5"]}),u("p384",{type:"short",prime:null,p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 ffffffff",a:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 fffffffc",b:"b3312fa7 e23ee7e4 988e056b e3f82d19 181d9c6e fe814112 0314088f 5013875a c656398d 8a2ed19d 2a85c8ed d3ec2aef",n:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff c7634d81 f4372ddf 581a0db2 48b0a77a ecec196a ccc52973",hash:o.sha384,gRed:!1,g:["aa87ca22 be8b0537 8eb1c71e f320ad74 6e1d3b62 8ba79b98 59f741e0 82542a38 5502f25d bf55296c 3a545e38 72760ab7","3617de4a 96262c6f 5d9e98bf 9292dc29 f8f41dbd 289a147c e9da3113 b5f0b8c0 0a60b1ce 1d7e819d 7a431d7c 90ea0e5f"]}),u("p521",{type:"short",prime:null,p:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff",a:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffc",b:"00000051 953eb961 8e1c9a1f 929a21a0 b68540ee a2da725b 99b315f3 b8b48991 8ef109e1 56193951 ec7e937b 1652c0bd 3bb1bf07 3573df88 3d2c34f1 ef451fd4 6b503f00",n:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffa 51868783 bf2f966b 7fcc0148 f709a5d0 3bb5c9b8 899c47ae bb6fb71e 91386409",hash:o.sha512,gRed:!1,g:["000000c6 858e06b7 0404e9cd 9e3ecb66 2395b442 9c648139 053fb521 f828af60 6b4d3dba a14b5e77 efe75928 fe1dc127 a2ffa8de 3348b3c1 856a429b f97e7e31 c2e5bd66","00000118 39296a78 9a3bc004 5c8a5fb4 2c7d1bd9 98f54449 579b4468 17afbd17 273e662c 97ee7299 5ef42640 c550b901 3fad0761 353c7086 a272c240 88be9476 9fd16650"]}),u("curve25519",{type:"mont",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"76d06",b:"1",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:o.sha256,gRed:!1,g:["9"]}),u("ed25519",{type:"edwards",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"-1",c:"1",d:"52036cee2b6ffe73 8cc740797779e898 00700a4d4141d8ab 75eb4dca135978a3",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:o.sha256,gRed:!1,g:["216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a","6666666666666666666666666666666666666666666666666666666666666658"]});try{n=r(577)}catch(e){n=void 0}u("secp256k1",{type:"short",prime:"k256",p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f",a:"0",b:"7",n:"ffffffff ffffffff ffffffff fffffffe baaedce6 af48a03b bfd25e8c d0364141",h:"1",hash:o.sha256,beta:"7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee",lambda:"5363ad4cc05c30e0a5261c028812645a122e22ea20816678df02967c1b23bd72",basis:[{a:"3086d221a7d46bcde86c90e49284eb15",b:"-e4437ed6010e88286f547fa90abfe4c3"},{a:"114ca50f7a8e2f3f657c1108d9d44cfd8",b:"3086d221a7d46bcde86c90e49284eb15"}],gRed:!1,g:["79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798","483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8",n]})},8945:(e,t,r)=>{"use strict";var n=r(5530),i=r(1001),o=r(1137),s=r(1750),a=r(1219),c=o.assert,u=r(290),h=r(1847);function l(e){if(!(this instanceof l))return new l(e);"string"==typeof e&&(c(Object.prototype.hasOwnProperty.call(s,e),"Unknown curve "+e),e=s[e]),e instanceof s.PresetCurve&&(e={curve:e}),this.curve=e.curve.curve,this.n=this.curve.n,this.nh=this.n.ushrn(1),this.g=this.curve.g,this.g=e.curve.g,this.g.precompute(e.curve.n.bitLength()+1),this.hash=e.hash||e.curve.hash}e.exports=l,l.prototype.keyPair=function(e){return new u(this,e)},l.prototype.keyFromPrivate=function(e,t){return u.fromPrivate(this,e,t)},l.prototype.keyFromPublic=function(e,t){return u.fromPublic(this,e,t)},l.prototype.genKeyPair=function(e){e||(e={});for(var t=new i({hash:this.hash,pers:e.pers,persEnc:e.persEnc||"utf8",entropy:e.entropy||a(this.hash.hmacStrength),entropyEnc:e.entropy&&e.entropyEnc||"utf8",nonce:this.n.toArray()}),r=this.n.byteLength(),o=this.n.sub(new n(2));;){var s=new n(t.generate(r));if(!(s.cmp(o)>0))return s.iaddn(1),this.keyFromPrivate(s)}},l.prototype._truncateToN=function(e,t,r){var i;if(n.isBN(e)||"number"==typeof e)i=(e=new n(e,16)).byteLength();else if("object"==typeof e)i=e.length,e=new n(e,16);else{var o=e.toString();i=o.length+1>>>1,e=new n(o,16)}"number"!=typeof r&&(r=8*i);var s=r-this.n.bitLength();return s>0&&(e=e.ushrn(s)),!t&&e.cmp(this.n)>=0?e.sub(this.n):e},l.prototype.sign=function(e,t,r,o){if("object"==typeof r&&(o=r,r=null),o||(o={}),"string"!=typeof e&&"number"!=typeof e&&!n.isBN(e)){c("object"==typeof e&&e&&"number"==typeof e.length,"Expected message to be an array-like, a hex string, or a BN instance"),c(e.length>>>0===e.length);for(var s=0;s<e.length;s++)c((255&e[s])===e[s])}t=this.keyFromPrivate(t,r),e=this._truncateToN(e,!1,o.msgBitLength),c(!e.isNeg(),"Can not sign a negative message");var a=this.n.byteLength(),u=t.getPrivate().toArray("be",a),l=e.toArray("be",a);c(new n(l).eq(e),"Can not sign message");for(var d=new i({hash:this.hash,entropy:u,nonce:l,pers:o.pers,persEnc:o.persEnc||"utf8"}),f=this.n.sub(new n(1)),p=0;;p++){var g=o.k?o.k(p):new n(d.generate(this.n.byteLength()));if(!((g=this._truncateToN(g,!0)).cmpn(1)<=0||g.cmp(f)>=0)){var y=this.g.mul(g);if(!y.isInfinity()){var b=y.getX(),m=b.umod(this.n);if(0!==m.cmpn(0)){var w=g.invm(this.n).mul(m.mul(t.getPrivate()).iadd(e));if(0!==(w=w.umod(this.n)).cmpn(0)){var v=(y.getY().isOdd()?1:0)|(0!==b.cmp(m)?2:0);return o.canonical&&w.cmp(this.nh)>0&&(w=this.n.sub(w),v^=1),new h({r:m,s:w,recoveryParam:v})}}}}}},l.prototype.verify=function(e,t,r,n,i){i||(i={}),e=this._truncateToN(e,!1,i.msgBitLength),r=this.keyFromPublic(r,n);var o=(t=new h(t,"hex")).r,s=t.s;if(o.cmpn(1)<0||o.cmp(this.n)>=0)return!1;if(s.cmpn(1)<0||s.cmp(this.n)>=0)return!1;var a,c=s.invm(this.n),u=c.mul(e).umod(this.n),l=c.mul(o).umod(this.n);return this.curve._maxwellTrick?!(a=this.g.jmulAdd(u,r.getPublic(),l)).isInfinity()&&a.eqXToP(o):!(a=this.g.mulAdd(u,r.getPublic(),l)).isInfinity()&&0===a.getX().umod(this.n).cmp(o)},l.prototype.recoverPubKey=function(e,t,r,i){c((3&r)===r,"The recovery param is more than two bits"),t=new h(t,i);var o=this.n,s=new n(e),a=t.r,u=t.s,l=1&r,d=r>>1;if(a.cmp(this.curve.p.umod(this.curve.n))>=0&&d)throw new Error("Unable to find sencond key candinate");a=d?this.curve.pointFromX(a.add(this.curve.n),l):this.curve.pointFromX(a,l);var f=t.r.invm(o),p=o.sub(s).mul(f).umod(o),g=u.mul(f).umod(o);return this.g.mulAdd(p,a,g)},l.prototype.getKeyRecoveryParam=function(e,t,r,n){if(null!==(t=new h(t,n)).recoveryParam)return t.recoveryParam;for(var i=0;i<4;i++){var o;try{o=this.recoverPubKey(e,t,i)}catch(e){continue}if(o.eq(r))return i}throw new Error("Unable to find valid recovery factor")}},290:(e,t,r)=>{"use strict";var n=r(5530),i=r(1137).assert;function o(e,t){this.ec=e,this.priv=null,this.pub=null,t.priv&&this._importPrivate(t.priv,t.privEnc),t.pub&&this._importPublic(t.pub,t.pubEnc)}e.exports=o,o.fromPublic=function(e,t,r){return t instanceof o?t:new o(e,{pub:t,pubEnc:r})},o.fromPrivate=function(e,t,r){return t instanceof o?t:new o(e,{priv:t,privEnc:r})},o.prototype.validate=function(){var e=this.getPublic();return e.isInfinity()?{result:!1,reason:"Invalid public key"}:e.validate()?e.mul(this.ec.curve.n).isInfinity()?{result:!0,reason:null}:{result:!1,reason:"Public key * N != O"}:{result:!1,reason:"Public key is not a point"}},o.prototype.getPublic=function(e,t){return"string"==typeof e&&(t=e,e=null),this.pub||(this.pub=this.ec.g.mul(this.priv)),t?this.pub.encode(t,e):this.pub},o.prototype.getPrivate=function(e){return"hex"===e?this.priv.toString(16,2):this.priv},o.prototype._importPrivate=function(e,t){this.priv=new n(e,t||16),this.priv=this.priv.umod(this.ec.curve.n)},o.prototype._importPublic=function(e,t){if(e.x||e.y)return"mont"===this.ec.curve.type?i(e.x,"Need x coordinate"):"short"!==this.ec.curve.type&&"edwards"!==this.ec.curve.type||i(e.x&&e.y,"Need both x and y coordinate"),void(this.pub=this.ec.curve.point(e.x,e.y));this.pub=this.ec.curve.decodePoint(e,t)},o.prototype.derive=function(e){return e.validate()||i(e.validate(),"public point not validated"),e.mul(this.priv).getX()},o.prototype.sign=function(e,t,r){return this.ec.sign(e,this,t,r)},o.prototype.verify=function(e,t,r){return this.ec.verify(e,t,this,void 0,r)},o.prototype.inspect=function(){return"<Key priv: "+(this.priv&&this.priv.toString(16,2))+" pub: "+(this.pub&&this.pub.inspect())+" >"}},1847:(e,t,r)=>{"use strict";var n=r(5530),i=r(1137),o=i.assert;function s(e,t){if(e instanceof s)return e;this._importDER(e,t)||(o(e.r&&e.s,"Signature without r or s"),this.r=new n(e.r,16),this.s=new n(e.s,16),void 0===e.recoveryParam?this.recoveryParam=null:this.recoveryParam=e.recoveryParam)}function a(){this.place=0}function c(e,t){var r=e[t.place++];if(!(128&r))return r;var n=15&r;if(0===n||n>4)return!1;if(0===e[t.place])return!1;for(var i=0,o=0,s=t.place;o<n;o++,s++)i<<=8,i|=e[s],i>>>=0;return!(i<=127)&&(t.place=s,i)}function u(e){for(var t=0,r=e.length-1;!e[t]&&!(128&e[t+1])&&t<r;)t++;return 0===t?e:e.slice(t)}function h(e,t){if(t<128)e.push(t);else{var r=1+(Math.log(t)/Math.LN2>>>3);for(e.push(128|r);--r;)e.push(t>>>(r<<3)&255);e.push(t)}}e.exports=s,s.prototype._importDER=function(e,t){e=i.toArray(e,t);var r=new a;if(48!==e[r.place++])return!1;var o=c(e,r);if(!1===o)return!1;if(o+r.place!==e.length)return!1;if(2!==e[r.place++])return!1;var s=c(e,r);if(!1===s)return!1;if(128&e[r.place])return!1;var u=e.slice(r.place,s+r.place);if(r.place+=s,2!==e[r.place++])return!1;var h=c(e,r);if(!1===h)return!1;if(e.length!==h+r.place)return!1;if(128&e[r.place])return!1;var l=e.slice(r.place,h+r.place);if(0===u[0]){if(!(128&u[1]))return!1;u=u.slice(1)}if(0===l[0]){if(!(128&l[1]))return!1;l=l.slice(1)}return this.r=new n(u),this.s=new n(l),this.recoveryParam=null,!0},s.prototype.toDER=function(e){var t=this.r.toArray(),r=this.s.toArray();for(128&t[0]&&(t=[0].concat(t)),128&r[0]&&(r=[0].concat(r)),t=u(t),r=u(r);!(r[0]||128&r[1]);)r=r.slice(1);var n=[2];h(n,t.length),(n=n.concat(t)).push(2),h(n,r.length);var o=n.concat(r),s=[48];return h(s,o.length),s=s.concat(o),i.encode(s,e)}},4896:(e,t,r)=>{"use strict";var n=r(7734),i=r(1750),o=r(1137),s=o.assert,a=o.parseBytes,c=r(1363),u=r(8798);function h(e){if(s("ed25519"===e,"only tested with ed25519 so far"),!(this instanceof h))return new h(e);e=i[e].curve,this.curve=e,this.g=e.g,this.g.precompute(e.n.bitLength()+1),this.pointClass=e.point().constructor,this.encodingLength=Math.ceil(e.n.bitLength()/8),this.hash=n.sha512}e.exports=h,h.prototype.sign=function(e,t){e=a(e);var r=this.keyFromSecret(t),n=this.hashInt(r.messagePrefix(),e),i=this.g.mul(n),o=this.encodePoint(i),s=this.hashInt(o,r.pubBytes(),e).mul(r.priv()),c=n.add(s).umod(this.curve.n);return this.makeSignature({R:i,S:c,Rencoded:o})},h.prototype.verify=function(e,t,r){if(e=a(e),(t=this.makeSignature(t)).S().gte(t.eddsa.curve.n)||t.S().isNeg())return!1;var n=this.keyFromPublic(r),i=this.hashInt(t.Rencoded(),n.pubBytes(),e),o=this.g.mul(t.S());return t.R().add(n.pub().mul(i)).eq(o)},h.prototype.hashInt=function(){for(var e=this.hash(),t=0;t<arguments.length;t++)e.update(arguments[t]);return o.intFromLE(e.digest()).umod(this.curve.n)},h.prototype.keyFromPublic=function(e){return c.fromPublic(this,e)},h.prototype.keyFromSecret=function(e){return c.fromSecret(this,e)},h.prototype.makeSignature=function(e){return e instanceof u?e:new u(this,e)},h.prototype.encodePoint=function(e){var t=e.getY().toArray("le",this.encodingLength);return t[this.encodingLength-1]|=e.getX().isOdd()?128:0,t},h.prototype.decodePoint=function(e){var t=(e=o.parseBytes(e)).length-1,r=e.slice(0,t).concat(-129&e[t]),n=!!(128&e[t]),i=o.intFromLE(r);return this.curve.pointFromY(i,n)},h.prototype.encodeInt=function(e){return e.toArray("le",this.encodingLength)},h.prototype.decodeInt=function(e){return o.intFromLE(e)},h.prototype.isPoint=function(e){return e instanceof this.pointClass}},1363:(e,t,r)=>{"use strict";var n=r(1137),i=n.assert,o=n.parseBytes,s=n.cachedProperty;function a(e,t){this.eddsa=e,this._secret=o(t.secret),e.isPoint(t.pub)?this._pub=t.pub:this._pubBytes=o(t.pub)}a.fromPublic=function(e,t){return t instanceof a?t:new a(e,{pub:t})},a.fromSecret=function(e,t){return t instanceof a?t:new a(e,{secret:t})},a.prototype.secret=function(){return this._secret},s(a,"pubBytes",(function(){return this.eddsa.encodePoint(this.pub())})),s(a,"pub",(function(){return this._pubBytes?this.eddsa.decodePoint(this._pubBytes):this.eddsa.g.mul(this.priv())})),s(a,"privBytes",(function(){var e=this.eddsa,t=this.hash(),r=e.encodingLength-1,n=t.slice(0,e.encodingLength);return n[0]&=248,n[r]&=127,n[r]|=64,n})),s(a,"priv",(function(){return this.eddsa.decodeInt(this.privBytes())})),s(a,"hash",(function(){return this.eddsa.hash().update(this.secret()).digest()})),s(a,"messagePrefix",(function(){return this.hash().slice(this.eddsa.encodingLength)})),a.prototype.sign=function(e){return i(this._secret,"KeyPair can only verify"),this.eddsa.sign(e,this)},a.prototype.verify=function(e,t){return this.eddsa.verify(e,t,this)},a.prototype.getSecret=function(e){return i(this._secret,"KeyPair is public only"),n.encode(this.secret(),e)},a.prototype.getPublic=function(e){return n.encode(this.pubBytes(),e)},e.exports=a},8798:(e,t,r)=>{"use strict";var n=r(5530),i=r(1137),o=i.assert,s=i.cachedProperty,a=i.parseBytes;function c(e,t){this.eddsa=e,"object"!=typeof t&&(t=a(t)),Array.isArray(t)&&(o(t.length===2*e.encodingLength,"Signature has invalid size"),t={R:t.slice(0,e.encodingLength),S:t.slice(e.encodingLength)}),o(t.R&&t.S,"Signature without R or S"),e.isPoint(t.R)&&(this._R=t.R),t.S instanceof n&&(this._S=t.S),this._Rencoded=Array.isArray(t.R)?t.R:t.Rencoded,this._Sencoded=Array.isArray(t.S)?t.S:t.Sencoded}s(c,"S",(function(){return this.eddsa.decodeInt(this.Sencoded())})),s(c,"R",(function(){return this.eddsa.decodePoint(this.Rencoded())})),s(c,"Rencoded",(function(){return this.eddsa.encodePoint(this.R())})),s(c,"Sencoded",(function(){return this.eddsa.encodeInt(this.S())})),c.prototype.toBytes=function(){return this.Rencoded().concat(this.Sencoded())},c.prototype.toHex=function(){return i.encode(this.toBytes(),"hex").toUpperCase()},e.exports=c},577:e=>{e.exports={doubles:{step:4,points:[["e60fce93b59e9ec53011aabc21c23e97b2a31369b87a5ae9c44ee89e2a6dec0a","f7e3507399e595929db99f34f57937101296891e44d23f0be1f32cce69616821"],["8282263212c609d9ea2a6e3e172de238d8c39cabd5ac1ca10646e23fd5f51508","11f8a8098557dfe45e8256e830b60ace62d613ac2f7b17bed31b6eaff6e26caf"],["175e159f728b865a72f99cc6c6fc846de0b93833fd2222ed73fce5b551e5b739","d3506e0d9e3c79eba4ef97a51ff71f5eacb5955add24345c6efa6ffee9fed695"],["363d90d447b00c9c99ceac05b6262ee053441c7e55552ffe526bad8f83ff4640","4e273adfc732221953b445397f3363145b9a89008199ecb62003c7f3bee9de9"],["8b4b5f165df3c2be8c6244b5b745638843e4a781a15bcd1b69f79a55dffdf80c","4aad0a6f68d308b4b3fbd7813ab0da04f9e336546162ee56b3eff0c65fd4fd36"],["723cbaa6e5db996d6bf771c00bd548c7b700dbffa6c0e77bcb6115925232fcda","96e867b5595cc498a921137488824d6e2660a0653779494801dc069d9eb39f5f"],["eebfa4d493bebf98ba5feec812c2d3b50947961237a919839a533eca0e7dd7fa","5d9a8ca3970ef0f269ee7edaf178089d9ae4cdc3a711f712ddfd4fdae1de8999"],["100f44da696e71672791d0a09b7bde459f1215a29b3c03bfefd7835b39a48db0","cdd9e13192a00b772ec8f3300c090666b7ff4a18ff5195ac0fbd5cd62bc65a09"],["e1031be262c7ed1b1dc9227a4a04c017a77f8d4464f3b3852c8acde6e534fd2d","9d7061928940405e6bb6a4176597535af292dd419e1ced79a44f18f29456a00d"],["feea6cae46d55b530ac2839f143bd7ec5cf8b266a41d6af52d5e688d9094696d","e57c6b6c97dce1bab06e4e12bf3ecd5c981c8957cc41442d3155debf18090088"],["da67a91d91049cdcb367be4be6ffca3cfeed657d808583de33fa978bc1ec6cb1","9bacaa35481642bc41f463f7ec9780e5dec7adc508f740a17e9ea8e27a68be1d"],["53904faa0b334cdda6e000935ef22151ec08d0f7bb11069f57545ccc1a37b7c0","5bc087d0bc80106d88c9eccac20d3c1c13999981e14434699dcb096b022771c8"],["8e7bcd0bd35983a7719cca7764ca906779b53a043a9b8bcaeff959f43ad86047","10b7770b2a3da4b3940310420ca9514579e88e2e47fd68b3ea10047e8460372a"],["385eed34c1cdff21e6d0818689b81bde71a7f4f18397e6690a841e1599c43862","283bebc3e8ea23f56701de19e9ebf4576b304eec2086dc8cc0458fe5542e5453"],["6f9d9b803ecf191637c73a4413dfa180fddf84a5947fbc9c606ed86c3fac3a7","7c80c68e603059ba69b8e2a30e45c4d47ea4dd2f5c281002d86890603a842160"],["3322d401243c4e2582a2147c104d6ecbf774d163db0f5e5313b7e0e742d0e6bd","56e70797e9664ef5bfb019bc4ddaf9b72805f63ea2873af624f3a2e96c28b2a0"],["85672c7d2de0b7da2bd1770d89665868741b3f9af7643397721d74d28134ab83","7c481b9b5b43b2eb6374049bfa62c2e5e77f17fcc5298f44c8e3094f790313a6"],["948bf809b1988a46b06c9f1919413b10f9226c60f668832ffd959af60c82a0a","53a562856dcb6646dc6b74c5d1c3418c6d4dff08c97cd2bed4cb7f88d8c8e589"],["6260ce7f461801c34f067ce0f02873a8f1b0e44dfc69752accecd819f38fd8e8","bc2da82b6fa5b571a7f09049776a1ef7ecd292238051c198c1a84e95b2b4ae17"],["e5037de0afc1d8d43d8348414bbf4103043ec8f575bfdc432953cc8d2037fa2d","4571534baa94d3b5f9f98d09fb990bddbd5f5b03ec481f10e0e5dc841d755bda"],["e06372b0f4a207adf5ea905e8f1771b4e7e8dbd1c6a6c5b725866a0ae4fce725","7a908974bce18cfe12a27bb2ad5a488cd7484a7787104870b27034f94eee31dd"],["213c7a715cd5d45358d0bbf9dc0ce02204b10bdde2a3f58540ad6908d0559754","4b6dad0b5ae462507013ad06245ba190bb4850f5f36a7eeddff2c27534b458f2"],["4e7c272a7af4b34e8dbb9352a5419a87e2838c70adc62cddf0cc3a3b08fbd53c","17749c766c9d0b18e16fd09f6def681b530b9614bff7dd33e0b3941817dcaae6"],["fea74e3dbe778b1b10f238ad61686aa5c76e3db2be43057632427e2840fb27b6","6e0568db9b0b13297cf674deccb6af93126b596b973f7b77701d3db7f23cb96f"],["76e64113f677cf0e10a2570d599968d31544e179b760432952c02a4417bdde39","c90ddf8dee4e95cf577066d70681f0d35e2a33d2b56d2032b4b1752d1901ac01"],["c738c56b03b2abe1e8281baa743f8f9a8f7cc643df26cbee3ab150242bcbb891","893fb578951ad2537f718f2eacbfbbbb82314eef7880cfe917e735d9699a84c3"],["d895626548b65b81e264c7637c972877d1d72e5f3a925014372e9f6588f6c14b","febfaa38f2bc7eae728ec60818c340eb03428d632bb067e179363ed75d7d991f"],["b8da94032a957518eb0f6433571e8761ceffc73693e84edd49150a564f676e03","2804dfa44805a1e4d7c99cc9762808b092cc584d95ff3b511488e4e74efdf6e7"],["e80fea14441fb33a7d8adab9475d7fab2019effb5156a792f1a11778e3c0df5d","eed1de7f638e00771e89768ca3ca94472d155e80af322ea9fcb4291b6ac9ec78"],["a301697bdfcd704313ba48e51d567543f2a182031efd6915ddc07bbcc4e16070","7370f91cfb67e4f5081809fa25d40f9b1735dbf7c0a11a130c0d1a041e177ea1"],["90ad85b389d6b936463f9d0512678de208cc330b11307fffab7ac63e3fb04ed4","e507a3620a38261affdcbd9427222b839aefabe1582894d991d4d48cb6ef150"],["8f68b9d2f63b5f339239c1ad981f162ee88c5678723ea3351b7b444c9ec4c0da","662a9f2dba063986de1d90c2b6be215dbbea2cfe95510bfdf23cbf79501fff82"],["e4f3fb0176af85d65ff99ff9198c36091f48e86503681e3e6686fd5053231e11","1e63633ad0ef4f1c1661a6d0ea02b7286cc7e74ec951d1c9822c38576feb73bc"],["8c00fa9b18ebf331eb961537a45a4266c7034f2f0d4e1d0716fb6eae20eae29e","efa47267fea521a1a9dc343a3736c974c2fadafa81e36c54e7d2a4c66702414b"],["e7a26ce69dd4829f3e10cec0a9e98ed3143d084f308b92c0997fddfc60cb3e41","2a758e300fa7984b471b006a1aafbb18d0a6b2c0420e83e20e8a9421cf2cfd51"],["b6459e0ee3662ec8d23540c223bcbdc571cbcb967d79424f3cf29eb3de6b80ef","67c876d06f3e06de1dadf16e5661db3c4b3ae6d48e35b2ff30bf0b61a71ba45"],["d68a80c8280bb840793234aa118f06231d6f1fc67e73c5a5deda0f5b496943e8","db8ba9fff4b586d00c4b1f9177b0e28b5b0e7b8f7845295a294c84266b133120"],["324aed7df65c804252dc0270907a30b09612aeb973449cea4095980fc28d3d5d","648a365774b61f2ff130c0c35aec1f4f19213b0c7e332843967224af96ab7c84"],["4df9c14919cde61f6d51dfdbe5fee5dceec4143ba8d1ca888e8bd373fd054c96","35ec51092d8728050974c23a1d85d4b5d506cdc288490192ebac06cad10d5d"],["9c3919a84a474870faed8a9c1cc66021523489054d7f0308cbfc99c8ac1f98cd","ddb84f0f4a4ddd57584f044bf260e641905326f76c64c8e6be7e5e03d4fc599d"],["6057170b1dd12fdf8de05f281d8e06bb91e1493a8b91d4cc5a21382120a959e5","9a1af0b26a6a4807add9a2daf71df262465152bc3ee24c65e899be932385a2a8"],["a576df8e23a08411421439a4518da31880cef0fba7d4df12b1a6973eecb94266","40a6bf20e76640b2c92b97afe58cd82c432e10a7f514d9f3ee8be11ae1b28ec8"],["7778a78c28dec3e30a05fe9629de8c38bb30d1f5cf9a3a208f763889be58ad71","34626d9ab5a5b22ff7098e12f2ff580087b38411ff24ac563b513fc1fd9f43ac"],["928955ee637a84463729fd30e7afd2ed5f96274e5ad7e5cb09eda9c06d903ac","c25621003d3f42a827b78a13093a95eeac3d26efa8a8d83fc5180e935bcd091f"],["85d0fef3ec6db109399064f3a0e3b2855645b4a907ad354527aae75163d82751","1f03648413a38c0be29d496e582cf5663e8751e96877331582c237a24eb1f962"],["ff2b0dce97eece97c1c9b6041798b85dfdfb6d8882da20308f5404824526087e","493d13fef524ba188af4c4dc54d07936c7b7ed6fb90e2ceb2c951e01f0c29907"],["827fbbe4b1e880ea9ed2b2e6301b212b57f1ee148cd6dd28780e5e2cf856e241","c60f9c923c727b0b71bef2c67d1d12687ff7a63186903166d605b68baec293ec"],["eaa649f21f51bdbae7be4ae34ce6e5217a58fdce7f47f9aa7f3b58fa2120e2b3","be3279ed5bbbb03ac69a80f89879aa5a01a6b965f13f7e59d47a5305ba5ad93d"],["e4a42d43c5cf169d9391df6decf42ee541b6d8f0c9a137401e23632dda34d24f","4d9f92e716d1c73526fc99ccfb8ad34ce886eedfa8d8e4f13a7f7131deba9414"],["1ec80fef360cbdd954160fadab352b6b92b53576a88fea4947173b9d4300bf19","aeefe93756b5340d2f3a4958a7abbf5e0146e77f6295a07b671cdc1cc107cefd"],["146a778c04670c2f91b00af4680dfa8bce3490717d58ba889ddb5928366642be","b318e0ec3354028add669827f9d4b2870aaa971d2f7e5ed1d0b297483d83efd0"],["fa50c0f61d22e5f07e3acebb1aa07b128d0012209a28b9776d76a8793180eef9","6b84c6922397eba9b72cd2872281a68a5e683293a57a213b38cd8d7d3f4f2811"],["da1d61d0ca721a11b1a5bf6b7d88e8421a288ab5d5bba5220e53d32b5f067ec2","8157f55a7c99306c79c0766161c91e2966a73899d279b48a655fba0f1ad836f1"],["a8e282ff0c9706907215ff98e8fd416615311de0446f1e062a73b0610d064e13","7f97355b8db81c09abfb7f3c5b2515888b679a3e50dd6bd6cef7c73111f4cc0c"],["174a53b9c9a285872d39e56e6913cab15d59b1fa512508c022f382de8319497c","ccc9dc37abfc9c1657b4155f2c47f9e6646b3a1d8cb9854383da13ac079afa73"],["959396981943785c3d3e57edf5018cdbe039e730e4918b3d884fdff09475b7ba","2e7e552888c331dd8ba0386a4b9cd6849c653f64c8709385e9b8abf87524f2fd"],["d2a63a50ae401e56d645a1153b109a8fcca0a43d561fba2dbb51340c9d82b151","e82d86fb6443fcb7565aee58b2948220a70f750af484ca52d4142174dcf89405"],["64587e2335471eb890ee7896d7cfdc866bacbdbd3839317b3436f9b45617e073","d99fcdd5bf6902e2ae96dd6447c299a185b90a39133aeab358299e5e9faf6589"],["8481bde0e4e4d885b3a546d3e549de042f0aa6cea250e7fd358d6c86dd45e458","38ee7b8cba5404dd84a25bf39cecb2ca900a79c42b262e556d64b1b59779057e"],["13464a57a78102aa62b6979ae817f4637ffcfed3c4b1ce30bcd6303f6caf666b","69be159004614580ef7e433453ccb0ca48f300a81d0942e13f495a907f6ecc27"],["bc4a9df5b713fe2e9aef430bcc1dc97a0cd9ccede2f28588cada3a0d2d83f366","d3a81ca6e785c06383937adf4b798caa6e8a9fbfa547b16d758d666581f33c1"],["8c28a97bf8298bc0d23d8c749452a32e694b65e30a9472a3954ab30fe5324caa","40a30463a3305193378fedf31f7cc0eb7ae784f0451cb9459e71dc73cbef9482"],["8ea9666139527a8c1dd94ce4f071fd23c8b350c5a4bb33748c4ba111faccae0","620efabbc8ee2782e24e7c0cfb95c5d735b783be9cf0f8e955af34a30e62b945"],["dd3625faef5ba06074669716bbd3788d89bdde815959968092f76cc4eb9a9787","7a188fa3520e30d461da2501045731ca941461982883395937f68d00c644a573"],["f710d79d9eb962297e4f6232b40e8f7feb2bc63814614d692c12de752408221e","ea98e67232d3b3295d3b535532115ccac8612c721851617526ae47a9c77bfc82"]]},naf:{wnd:7,points:[["f9308a019258c31049344f85f89d5229b531c845836f99b08601f113bce036f9","388f7b0f632de8140fe337e62a37f3566500a99934c2231b6cb9fd7584b8e672"],["2f8bde4d1a07209355b4a7250a5c5128e88b84bddc619ab7cba8d569b240efe4","d8ac222636e5e3d6d4dba9dda6c9c426f788271bab0d6840dca87d3aa6ac62d6"],["5cbdf0646e5db4eaa398f365f2ea7a0e3d419b7e0330e39ce92bddedcac4f9bc","6aebca40ba255960a3178d6d861a54dba813d0b813fde7b5a5082628087264da"],["acd484e2f0c7f65309ad178a9f559abde09796974c57e714c35f110dfc27ccbe","cc338921b0a7d9fd64380971763b61e9add888a4375f8e0f05cc262ac64f9c37"],["774ae7f858a9411e5ef4246b70c65aac5649980be5c17891bbec17895da008cb","d984a032eb6b5e190243dd56d7b7b365372db1e2dff9d6a8301d74c9c953c61b"],["f28773c2d975288bc7d1d205c3748651b075fbc6610e58cddeeddf8f19405aa8","ab0902e8d880a89758212eb65cdaf473a1a06da521fa91f29b5cb52db03ed81"],["d7924d4f7d43ea965a465ae3095ff41131e5946f3c85f79e44adbcf8e27e080e","581e2872a86c72a683842ec228cc6defea40af2bd896d3a5c504dc9ff6a26b58"],["defdea4cdb677750a420fee807eacf21eb9898ae79b9768766e4faa04a2d4a34","4211ab0694635168e997b0ead2a93daeced1f4a04a95c0f6cfb199f69e56eb77"],["2b4ea0a797a443d293ef5cff444f4979f06acfebd7e86d277475656138385b6c","85e89bc037945d93b343083b5a1c86131a01f60c50269763b570c854e5c09b7a"],["352bbf4a4cdd12564f93fa332ce333301d9ad40271f8107181340aef25be59d5","321eb4075348f534d59c18259dda3e1f4a1b3b2e71b1039c67bd3d8bcf81998c"],["2fa2104d6b38d11b0230010559879124e42ab8dfeff5ff29dc9cdadd4ecacc3f","2de1068295dd865b64569335bd5dd80181d70ecfc882648423ba76b532b7d67"],["9248279b09b4d68dab21a9b066edda83263c3d84e09572e269ca0cd7f5453714","73016f7bf234aade5d1aa71bdea2b1ff3fc0de2a887912ffe54a32ce97cb3402"],["daed4f2be3a8bf278e70132fb0beb7522f570e144bf615c07e996d443dee8729","a69dce4a7d6c98e8d4a1aca87ef8d7003f83c230f3afa726ab40e52290be1c55"],["c44d12c7065d812e8acf28d7cbb19f9011ecd9e9fdf281b0e6a3b5e87d22e7db","2119a460ce326cdc76c45926c982fdac0e106e861edf61c5a039063f0e0e6482"],["6a245bf6dc698504c89a20cfded60853152b695336c28063b61c65cbd269e6b4","e022cf42c2bd4a708b3f5126f16a24ad8b33ba48d0423b6efd5e6348100d8a82"],["1697ffa6fd9de627c077e3d2fe541084ce13300b0bec1146f95ae57f0d0bd6a5","b9c398f186806f5d27561506e4557433a2cf15009e498ae7adee9d63d01b2396"],["605bdb019981718b986d0f07e834cb0d9deb8360ffb7f61df982345ef27a7479","2972d2de4f8d20681a78d93ec96fe23c26bfae84fb14db43b01e1e9056b8c49"],["62d14dab4150bf497402fdc45a215e10dcb01c354959b10cfe31c7e9d87ff33d","80fc06bd8cc5b01098088a1950eed0db01aa132967ab472235f5642483b25eaf"],["80c60ad0040f27dade5b4b06c408e56b2c50e9f56b9b8b425e555c2f86308b6f","1c38303f1cc5c30f26e66bad7fe72f70a65eed4cbe7024eb1aa01f56430bd57a"],["7a9375ad6167ad54aa74c6348cc54d344cc5dc9487d847049d5eabb0fa03c8fb","d0e3fa9eca8726909559e0d79269046bdc59ea10c70ce2b02d499ec224dc7f7"],["d528ecd9b696b54c907a9ed045447a79bb408ec39b68df504bb51f459bc3ffc9","eecf41253136e5f99966f21881fd656ebc4345405c520dbc063465b521409933"],["49370a4b5f43412ea25f514e8ecdad05266115e4a7ecb1387231808f8b45963","758f3f41afd6ed428b3081b0512fd62a54c3f3afbb5b6764b653052a12949c9a"],["77f230936ee88cbbd73df930d64702ef881d811e0e1498e2f1c13eb1fc345d74","958ef42a7886b6400a08266e9ba1b37896c95330d97077cbbe8eb3c7671c60d6"],["f2dac991cc4ce4b9ea44887e5c7c0bce58c80074ab9d4dbaeb28531b7739f530","e0dedc9b3b2f8dad4da1f32dec2531df9eb5fbeb0598e4fd1a117dba703a3c37"],["463b3d9f662621fb1b4be8fbbe2520125a216cdfc9dae3debcba4850c690d45b","5ed430d78c296c3543114306dd8622d7c622e27c970a1de31cb377b01af7307e"],["f16f804244e46e2a09232d4aff3b59976b98fac14328a2d1a32496b49998f247","cedabd9b82203f7e13d206fcdf4e33d92a6c53c26e5cce26d6579962c4e31df6"],["caf754272dc84563b0352b7a14311af55d245315ace27c65369e15f7151d41d1","cb474660ef35f5f2a41b643fa5e460575f4fa9b7962232a5c32f908318a04476"],["2600ca4b282cb986f85d0f1709979d8b44a09c07cb86d7c124497bc86f082120","4119b88753c15bd6a693b03fcddbb45d5ac6be74ab5f0ef44b0be9475a7e4b40"],["7635ca72d7e8432c338ec53cd12220bc01c48685e24f7dc8c602a7746998e435","91b649609489d613d1d5e590f78e6d74ecfc061d57048bad9e76f302c5b9c61"],["754e3239f325570cdbbf4a87deee8a66b7f2b33479d468fbc1a50743bf56cc18","673fb86e5bda30fb3cd0ed304ea49a023ee33d0197a695d0c5d98093c536683"],["e3e6bd1071a1e96aff57859c82d570f0330800661d1c952f9fe2694691d9b9e8","59c9e0bba394e76f40c0aa58379a3cb6a5a2283993e90c4167002af4920e37f5"],["186b483d056a033826ae73d88f732985c4ccb1f32ba35f4b4cc47fdcf04aa6eb","3b952d32c67cf77e2e17446e204180ab21fb8090895138b4a4a797f86e80888b"],["df9d70a6b9876ce544c98561f4be4f725442e6d2b737d9c91a8321724ce0963f","55eb2dafd84d6ccd5f862b785dc39d4ab157222720ef9da217b8c45cf2ba2417"],["5edd5cc23c51e87a497ca815d5dce0f8ab52554f849ed8995de64c5f34ce7143","efae9c8dbc14130661e8cec030c89ad0c13c66c0d17a2905cdc706ab7399a868"],["290798c2b6476830da12fe02287e9e777aa3fba1c355b17a722d362f84614fba","e38da76dcd440621988d00bcf79af25d5b29c094db2a23146d003afd41943e7a"],["af3c423a95d9f5b3054754efa150ac39cd29552fe360257362dfdecef4053b45","f98a3fd831eb2b749a93b0e6f35cfb40c8cd5aa667a15581bc2feded498fd9c6"],["766dbb24d134e745cccaa28c99bf274906bb66b26dcf98df8d2fed50d884249a","744b1152eacbe5e38dcc887980da38b897584a65fa06cedd2c924f97cbac5996"],["59dbf46f8c94759ba21277c33784f41645f7b44f6c596a58ce92e666191abe3e","c534ad44175fbc300f4ea6ce648309a042ce739a7919798cd85e216c4a307f6e"],["f13ada95103c4537305e691e74e9a4a8dd647e711a95e73cb62dc6018cfd87b8","e13817b44ee14de663bf4bc808341f326949e21a6a75c2570778419bdaf5733d"],["7754b4fa0e8aced06d4167a2c59cca4cda1869c06ebadfb6488550015a88522c","30e93e864e669d82224b967c3020b8fa8d1e4e350b6cbcc537a48b57841163a2"],["948dcadf5990e048aa3874d46abef9d701858f95de8041d2a6828c99e2262519","e491a42537f6e597d5d28a3224b1bc25df9154efbd2ef1d2cbba2cae5347d57e"],["7962414450c76c1689c7b48f8202ec37fb224cf5ac0bfa1570328a8a3d7c77ab","100b610ec4ffb4760d5c1fc133ef6f6b12507a051f04ac5760afa5b29db83437"],["3514087834964b54b15b160644d915485a16977225b8847bb0dd085137ec47ca","ef0afbb2056205448e1652c48e8127fc6039e77c15c2378b7e7d15a0de293311"],["d3cc30ad6b483e4bc79ce2c9dd8bc54993e947eb8df787b442943d3f7b527eaf","8b378a22d827278d89c5e9be8f9508ae3c2ad46290358630afb34db04eede0a4"],["1624d84780732860ce1c78fcbfefe08b2b29823db913f6493975ba0ff4847610","68651cf9b6da903e0914448c6cd9d4ca896878f5282be4c8cc06e2a404078575"],["733ce80da955a8a26902c95633e62a985192474b5af207da6df7b4fd5fc61cd4","f5435a2bd2badf7d485a4d8b8db9fcce3e1ef8e0201e4578c54673bc1dc5ea1d"],["15d9441254945064cf1a1c33bbd3b49f8966c5092171e699ef258dfab81c045c","d56eb30b69463e7234f5137b73b84177434800bacebfc685fc37bbe9efe4070d"],["a1d0fcf2ec9de675b612136e5ce70d271c21417c9d2b8aaaac138599d0717940","edd77f50bcb5a3cab2e90737309667f2641462a54070f3d519212d39c197a629"],["e22fbe15c0af8ccc5780c0735f84dbe9a790badee8245c06c7ca37331cb36980","a855babad5cd60c88b430a69f53a1a7a38289154964799be43d06d77d31da06"],["311091dd9860e8e20ee13473c1155f5f69635e394704eaa74009452246cfa9b3","66db656f87d1f04fffd1f04788c06830871ec5a64feee685bd80f0b1286d8374"],["34c1fd04d301be89b31c0442d3e6ac24883928b45a9340781867d4232ec2dbdf","9414685e97b1b5954bd46f730174136d57f1ceeb487443dc5321857ba73abee"],["f219ea5d6b54701c1c14de5b557eb42a8d13f3abbcd08affcc2a5e6b049b8d63","4cb95957e83d40b0f73af4544cccf6b1f4b08d3c07b27fb8d8c2962a400766d1"],["d7b8740f74a8fbaab1f683db8f45de26543a5490bca627087236912469a0b448","fa77968128d9c92ee1010f337ad4717eff15db5ed3c049b3411e0315eaa4593b"],["32d31c222f8f6f0ef86f7c98d3a3335ead5bcd32abdd94289fe4d3091aa824bf","5f3032f5892156e39ccd3d7915b9e1da2e6dac9e6f26e961118d14b8462e1661"],["7461f371914ab32671045a155d9831ea8793d77cd59592c4340f86cbc18347b5","8ec0ba238b96bec0cbdddcae0aa442542eee1ff50c986ea6b39847b3cc092ff6"],["ee079adb1df1860074356a25aa38206a6d716b2c3e67453d287698bad7b2b2d6","8dc2412aafe3be5c4c5f37e0ecc5f9f6a446989af04c4e25ebaac479ec1c8c1e"],["16ec93e447ec83f0467b18302ee620f7e65de331874c9dc72bfd8616ba9da6b5","5e4631150e62fb40d0e8c2a7ca5804a39d58186a50e497139626778e25b0674d"],["eaa5f980c245f6f038978290afa70b6bd8855897f98b6aa485b96065d537bd99","f65f5d3e292c2e0819a528391c994624d784869d7e6ea67fb18041024edc07dc"],["78c9407544ac132692ee1910a02439958ae04877151342ea96c4b6b35a49f51","f3e0319169eb9b85d5404795539a5e68fa1fbd583c064d2462b675f194a3ddb4"],["494f4be219a1a77016dcd838431aea0001cdc8ae7a6fc688726578d9702857a5","42242a969283a5f339ba7f075e36ba2af925ce30d767ed6e55f4b031880d562c"],["a598a8030da6d86c6bc7f2f5144ea549d28211ea58faa70ebf4c1e665c1fe9b5","204b5d6f84822c307e4b4a7140737aec23fc63b65b35f86a10026dbd2d864e6b"],["c41916365abb2b5d09192f5f2dbeafec208f020f12570a184dbadc3e58595997","4f14351d0087efa49d245b328984989d5caf9450f34bfc0ed16e96b58fa9913"],["841d6063a586fa475a724604da03bc5b92a2e0d2e0a36acfe4c73a5514742881","73867f59c0659e81904f9a1c7543698e62562d6744c169ce7a36de01a8d6154"],["5e95bb399a6971d376026947f89bde2f282b33810928be4ded112ac4d70e20d5","39f23f366809085beebfc71181313775a99c9aed7d8ba38b161384c746012865"],["36e4641a53948fd476c39f8a99fd974e5ec07564b5315d8bf99471bca0ef2f66","d2424b1b1abe4eb8164227b085c9aa9456ea13493fd563e06fd51cf5694c78fc"],["336581ea7bfbbb290c191a2f507a41cf5643842170e914faeab27c2c579f726","ead12168595fe1be99252129b6e56b3391f7ab1410cd1e0ef3dcdcabd2fda224"],["8ab89816dadfd6b6a1f2634fcf00ec8403781025ed6890c4849742706bd43ede","6fdcef09f2f6d0a044e654aef624136f503d459c3e89845858a47a9129cdd24e"],["1e33f1a746c9c5778133344d9299fcaa20b0938e8acff2544bb40284b8c5fb94","60660257dd11b3aa9c8ed618d24edff2306d320f1d03010e33a7d2057f3b3b6"],["85b7c1dcb3cec1b7ee7f30ded79dd20a0ed1f4cc18cbcfcfa410361fd8f08f31","3d98a9cdd026dd43f39048f25a8847f4fcafad1895d7a633c6fed3c35e999511"],["29df9fbd8d9e46509275f4b125d6d45d7fbe9a3b878a7af872a2800661ac5f51","b4c4fe99c775a606e2d8862179139ffda61dc861c019e55cd2876eb2a27d84b"],["a0b1cae06b0a847a3fea6e671aaf8adfdfe58ca2f768105c8082b2e449fce252","ae434102edde0958ec4b19d917a6a28e6b72da1834aff0e650f049503a296cf2"],["4e8ceafb9b3e9a136dc7ff67e840295b499dfb3b2133e4ba113f2e4c0e121e5","cf2174118c8b6d7a4b48f6d534ce5c79422c086a63460502b827ce62a326683c"],["d24a44e047e19b6f5afb81c7ca2f69080a5076689a010919f42725c2b789a33b","6fb8d5591b466f8fc63db50f1c0f1c69013f996887b8244d2cdec417afea8fa3"],["ea01606a7a6c9cdd249fdfcfacb99584001edd28abbab77b5104e98e8e3b35d4","322af4908c7312b0cfbfe369f7a7b3cdb7d4494bc2823700cfd652188a3ea98d"],["af8addbf2b661c8a6c6328655eb96651252007d8c5ea31be4ad196de8ce2131f","6749e67c029b85f52a034eafd096836b2520818680e26ac8f3dfbcdb71749700"],["e3ae1974566ca06cc516d47e0fb165a674a3dabcfca15e722f0e3450f45889","2aeabe7e4531510116217f07bf4d07300de97e4874f81f533420a72eeb0bd6a4"],["591ee355313d99721cf6993ffed1e3e301993ff3ed258802075ea8ced397e246","b0ea558a113c30bea60fc4775460c7901ff0b053d25ca2bdeee98f1a4be5d196"],["11396d55fda54c49f19aa97318d8da61fa8584e47b084945077cf03255b52984","998c74a8cd45ac01289d5833a7beb4744ff536b01b257be4c5767bea93ea57a4"],["3c5d2a1ba39c5a1790000738c9e0c40b8dcdfd5468754b6405540157e017aa7a","b2284279995a34e2f9d4de7396fc18b80f9b8b9fdd270f6661f79ca4c81bd257"],["cc8704b8a60a0defa3a99a7299f2e9c3fbc395afb04ac078425ef8a1793cc030","bdd46039feed17881d1e0862db347f8cf395b74fc4bcdc4e940b74e3ac1f1b13"],["c533e4f7ea8555aacd9777ac5cad29b97dd4defccc53ee7ea204119b2889b197","6f0a256bc5efdf429a2fb6242f1a43a2d9b925bb4a4b3a26bb8e0f45eb596096"],["c14f8f2ccb27d6f109f6d08d03cc96a69ba8c34eec07bbcf566d48e33da6593","c359d6923bb398f7fd4473e16fe1c28475b740dd098075e6c0e8649113dc3a38"],["a6cbc3046bc6a450bac24789fa17115a4c9739ed75f8f21ce441f72e0b90e6ef","21ae7f4680e889bb130619e2c0f95a360ceb573c70603139862afd617fa9b9f"],["347d6d9a02c48927ebfb86c1359b1caf130a3c0267d11ce6344b39f99d43cc38","60ea7f61a353524d1c987f6ecec92f086d565ab687870cb12689ff1e31c74448"],["da6545d2181db8d983f7dcb375ef5866d47c67b1bf31c8cf855ef7437b72656a","49b96715ab6878a79e78f07ce5680c5d6673051b4935bd897fea824b77dc208a"],["c40747cc9d012cb1a13b8148309c6de7ec25d6945d657146b9d5994b8feb1111","5ca560753be2a12fc6de6caf2cb489565db936156b9514e1bb5e83037e0fa2d4"],["4e42c8ec82c99798ccf3a610be870e78338c7f713348bd34c8203ef4037f3502","7571d74ee5e0fb92a7a8b33a07783341a5492144cc54bcc40a94473693606437"],["3775ab7089bc6af823aba2e1af70b236d251cadb0c86743287522a1b3b0dedea","be52d107bcfa09d8bcb9736a828cfa7fac8db17bf7a76a2c42ad961409018cf7"],["cee31cbf7e34ec379d94fb814d3d775ad954595d1314ba8846959e3e82f74e26","8fd64a14c06b589c26b947ae2bcf6bfa0149ef0be14ed4d80f448a01c43b1c6d"],["b4f9eaea09b6917619f6ea6a4eb5464efddb58fd45b1ebefcdc1a01d08b47986","39e5c9925b5a54b07433a4f18c61726f8bb131c012ca542eb24a8ac07200682a"],["d4263dfc3d2df923a0179a48966d30ce84e2515afc3dccc1b77907792ebcc60e","62dfaf07a0f78feb30e30d6295853ce189e127760ad6cf7fae164e122a208d54"],["48457524820fa65a4f8d35eb6930857c0032acc0a4a2de422233eeda897612c4","25a748ab367979d98733c38a1fa1c2e7dc6cc07db2d60a9ae7a76aaa49bd0f77"],["dfeeef1881101f2cb11644f3a2afdfc2045e19919152923f367a1767c11cceda","ecfb7056cf1de042f9420bab396793c0c390bde74b4bbdff16a83ae09a9a7517"],["6d7ef6b17543f8373c573f44e1f389835d89bcbc6062ced36c82df83b8fae859","cd450ec335438986dfefa10c57fea9bcc521a0959b2d80bbf74b190dca712d10"],["e75605d59102a5a2684500d3b991f2e3f3c88b93225547035af25af66e04541f","f5c54754a8f71ee540b9b48728473e314f729ac5308b06938360990e2bfad125"],["eb98660f4c4dfaa06a2be453d5020bc99a0c2e60abe388457dd43fefb1ed620c","6cb9a8876d9cb8520609af3add26cd20a0a7cd8a9411131ce85f44100099223e"],["13e87b027d8514d35939f2e6892b19922154596941888336dc3563e3b8dba942","fef5a3c68059a6dec5d624114bf1e91aac2b9da568d6abeb2570d55646b8adf1"],["ee163026e9fd6fe017c38f06a5be6fc125424b371ce2708e7bf4491691e5764a","1acb250f255dd61c43d94ccc670d0f58f49ae3fa15b96623e5430da0ad6c62b2"],["b268f5ef9ad51e4d78de3a750c2dc89b1e626d43505867999932e5db33af3d80","5f310d4b3c99b9ebb19f77d41c1dee018cf0d34fd4191614003e945a1216e423"],["ff07f3118a9df035e9fad85eb6c7bfe42b02f01ca99ceea3bf7ffdba93c4750d","438136d603e858a3a5c440c38eccbaddc1d2942114e2eddd4740d098ced1f0d8"],["8d8b9855c7c052a34146fd20ffb658bea4b9f69e0d825ebec16e8c3ce2b526a1","cdb559eedc2d79f926baf44fb84ea4d44bcf50fee51d7ceb30e2e7f463036758"],["52db0b5384dfbf05bfa9d472d7ae26dfe4b851ceca91b1eba54263180da32b63","c3b997d050ee5d423ebaf66a6db9f57b3180c902875679de924b69d84a7b375"],["e62f9490d3d51da6395efd24e80919cc7d0f29c3f3fa48c6fff543becbd43352","6d89ad7ba4876b0b22c2ca280c682862f342c8591f1daf5170e07bfd9ccafa7d"],["7f30ea2476b399b4957509c88f77d0191afa2ff5cb7b14fd6d8e7d65aaab1193","ca5ef7d4b231c94c3b15389a5f6311e9daff7bb67b103e9880ef4bff637acaec"],["5098ff1e1d9f14fb46a210fada6c903fef0fb7b4a1dd1d9ac60a0361800b7a00","9731141d81fc8f8084d37c6e7542006b3ee1b40d60dfe5362a5b132fd17ddc0"],["32b78c7de9ee512a72895be6b9cbefa6e2f3c4ccce445c96b9f2c81e2778ad58","ee1849f513df71e32efc3896ee28260c73bb80547ae2275ba497237794c8753c"],["e2cb74fddc8e9fbcd076eef2a7c72b0ce37d50f08269dfc074b581550547a4f7","d3aa2ed71c9dd2247a62df062736eb0baddea9e36122d2be8641abcb005cc4a4"],["8438447566d4d7bedadc299496ab357426009a35f235cb141be0d99cd10ae3a8","c4e1020916980a4da5d01ac5e6ad330734ef0d7906631c4f2390426b2edd791f"],["4162d488b89402039b584c6fc6c308870587d9c46f660b878ab65c82c711d67e","67163e903236289f776f22c25fb8a3afc1732f2b84b4e95dbda47ae5a0852649"],["3fad3fa84caf0f34f0f89bfd2dcf54fc175d767aec3e50684f3ba4a4bf5f683d","cd1bc7cb6cc407bb2f0ca647c718a730cf71872e7d0d2a53fa20efcdfe61826"],["674f2600a3007a00568c1a7ce05d0816c1fb84bf1370798f1c69532faeb1a86b","299d21f9413f33b3edf43b257004580b70db57da0b182259e09eecc69e0d38a5"],["d32f4da54ade74abb81b815ad1fb3b263d82d6c692714bcff87d29bd5ee9f08f","f9429e738b8e53b968e99016c059707782e14f4535359d582fc416910b3eea87"],["30e4e670435385556e593657135845d36fbb6931f72b08cb1ed954f1e3ce3ff6","462f9bce619898638499350113bbc9b10a878d35da70740dc695a559eb88db7b"],["be2062003c51cc3004682904330e4dee7f3dcd10b01e580bf1971b04d4cad297","62188bc49d61e5428573d48a74e1c655b1c61090905682a0d5558ed72dccb9bc"],["93144423ace3451ed29e0fb9ac2af211cb6e84a601df5993c419859fff5df04a","7c10dfb164c3425f5c71a3f9d7992038f1065224f72bb9d1d902a6d13037b47c"],["b015f8044f5fcbdcf21ca26d6c34fb8197829205c7b7d2a7cb66418c157b112c","ab8c1e086d04e813744a655b2df8d5f83b3cdc6faa3088c1d3aea1454e3a1d5f"],["d5e9e1da649d97d89e4868117a465a3a4f8a18de57a140d36b3f2af341a21b52","4cb04437f391ed73111a13cc1d4dd0db1693465c2240480d8955e8592f27447a"],["d3ae41047dd7ca065dbf8ed77b992439983005cd72e16d6f996a5316d36966bb","bd1aeb21ad22ebb22a10f0303417c6d964f8cdd7df0aca614b10dc14d125ac46"],["463e2763d885f958fc66cdd22800f0a487197d0a82e377b49f80af87c897b065","bfefacdb0e5d0fd7df3a311a94de062b26b80c61fbc97508b79992671ef7ca7f"],["7985fdfd127c0567c6f53ec1bb63ec3158e597c40bfe747c83cddfc910641917","603c12daf3d9862ef2b25fe1de289aed24ed291e0ec6708703a5bd567f32ed03"],["74a1ad6b5f76e39db2dd249410eac7f99e74c59cb83d2d0ed5ff1543da7703e9","cc6157ef18c9c63cd6193d83631bbea0093e0968942e8c33d5737fd790e0db08"],["30682a50703375f602d416664ba19b7fc9bab42c72747463a71d0896b22f6da3","553e04f6b018b4fa6c8f39e7f311d3176290d0e0f19ca73f17714d9977a22ff8"],["9e2158f0d7c0d5f26c3791efefa79597654e7a2b2464f52b1ee6c1347769ef57","712fcdd1b9053f09003a3481fa7762e9ffd7c8ef35a38509e2fbf2629008373"],["176e26989a43c9cfeba4029c202538c28172e566e3c4fce7322857f3be327d66","ed8cc9d04b29eb877d270b4878dc43c19aefd31f4eee09ee7b47834c1fa4b1c3"],["75d46efea3771e6e68abb89a13ad747ecf1892393dfc4f1b7004788c50374da8","9852390a99507679fd0b86fd2b39a868d7efc22151346e1a3ca4726586a6bed8"],["809a20c67d64900ffb698c4c825f6d5f2310fb0451c869345b7319f645605721","9e994980d9917e22b76b061927fa04143d096ccc54963e6a5ebfa5f3f8e286c1"],["1b38903a43f7f114ed4500b4eac7083fdefece1cf29c63528d563446f972c180","4036edc931a60ae889353f77fd53de4a2708b26b6f5da72ad3394119daf408f9"]]}}},1137:(e,t,r)=>{"use strict";var n=t,i=r(5530),o=r(4263),s=r(1901);n.assert=o,n.toArray=s.toArray,n.zero2=s.zero2,n.toHex=s.toHex,n.encode=s.encode,n.getNAF=function(e,t,r){var n,i=new Array(Math.max(e.bitLength(),r)+1);for(n=0;n<i.length;n+=1)i[n]=0;var o=1<<t+1,s=e.clone();for(n=0;n<i.length;n++){var a,c=s.andln(o-1);s.isOdd()?(a=c>(o>>1)-1?(o>>1)-c:c,s.isubn(a)):a=0,i[n]=a,s.iushrn(1)}return i},n.getJSF=function(e,t){var r=[[],[]];e=e.clone(),t=t.clone();for(var n,i=0,o=0;e.cmpn(-i)>0||t.cmpn(-o)>0;){var s,a,c=e.andln(3)+i&3,u=t.andln(3)+o&3;3===c&&(c=-1),3===u&&(u=-1),s=1&c?3!=(n=e.andln(7)+i&7)&&5!==n||2!==u?c:-c:0,r[0].push(s),a=1&u?3!=(n=t.andln(7)+o&7)&&5!==n||2!==c?u:-u:0,r[1].push(a),2*i===s+1&&(i=1-i),2*o===a+1&&(o=1-o),e.iushrn(1),t.iushrn(1)}return r},n.cachedProperty=function(e,t,r){var n="_"+t;e.prototype[t]=function(){return void 0!==this[n]?this[n]:this[n]=r.call(this)}},n.parseBytes=function(e){return"string"==typeof e?n.toArray(e,"hex"):e},n.intFromLE=function(e){return new i(e,"hex","le")}},9997:(e,t,r)=>{"use strict";var n=r(4295)("%Object.defineProperty%",!0)||!1;if(n)try{n({},"a",{value:1})}catch(e){n=!1}e.exports=n},155:e=>{"use strict";e.exports=EvalError},593:e=>{"use strict";e.exports=Error},7180:e=>{"use strict";e.exports=RangeError},9304:e=>{"use strict";e.exports=ReferenceError},1742:e=>{"use strict";e.exports=SyntaxError},6757:e=>{"use strict";e.exports=TypeError},4923:e=>{"use strict";e.exports=URIError},2646:e=>{"use strict";var t=Object.prototype.hasOwnProperty,r="~";function n(){}function i(e,t,r){this.fn=e,this.context=t,this.once=r||!1}function o(e,t,n,o,s){if("function"!=typeof n)throw new TypeError("The listener must be a function");var a=new i(n,o||e,s),c=r?r+t:t;return e._events[c]?e._events[c].fn?e._events[c]=[e._events[c],a]:e._events[c].push(a):(e._events[c]=a,e._eventsCount++),e}function s(e,t){0==--e._eventsCount?e._events=new n:delete e._events[t]}function a(){this._events=new n,this._eventsCount=0}Object.create&&(n.prototype=Object.create(null),(new n).__proto__||(r=!1)),a.prototype.eventNames=function(){var e,n,i=[];if(0===this._eventsCount)return i;for(n in e=this._events)t.call(e,n)&&i.push(r?n.slice(1):n);return Object.getOwnPropertySymbols?i.concat(Object.getOwnPropertySymbols(e)):i},a.prototype.listeners=function(e){var t=r?r+e:e,n=this._events[t];if(!n)return[];if(n.fn)return[n.fn];for(var i=0,o=n.length,s=new Array(o);i<o;i++)s[i]=n[i].fn;return s},a.prototype.listenerCount=function(e){var t=r?r+e:e,n=this._events[t];return n?n.fn?1:n.length:0},a.prototype.emit=function(e,t,n,i,o,s){var a=r?r+e:e;if(!this._events[a])return!1;var c,u,h=this._events[a],l=arguments.length;if(h.fn){switch(h.once&&this.removeListener(e,h.fn,void 0,!0),l){case 1:return h.fn.call(h.context),!0;case 2:return h.fn.call(h.context,t),!0;case 3:return h.fn.call(h.context,t,n),!0;case 4:return h.fn.call(h.context,t,n,i),!0;case 5:return h.fn.call(h.context,t,n,i,o),!0;case 6:return h.fn.call(h.context,t,n,i,o,s),!0}for(u=1,c=new Array(l-1);u<l;u++)c[u-1]=arguments[u];h.fn.apply(h.context,c)}else{var d,f=h.length;for(u=0;u<f;u++)switch(h[u].once&&this.removeListener(e,h[u].fn,void 0,!0),l){case 1:h[u].fn.call(h[u].context);break;case 2:h[u].fn.call(h[u].context,t);break;case 3:h[u].fn.call(h[u].context,t,n);break;case 4:h[u].fn.call(h[u].context,t,n,i);break;default:if(!c)for(d=1,c=new Array(l-1);d<l;d++)c[d-1]=arguments[d];h[u].fn.apply(h[u].context,c)}}return!0},a.prototype.on=function(e,t,r){return o(this,e,t,r,!1)},a.prototype.once=function(e,t,r){return o(this,e,t,r,!0)},a.prototype.removeListener=function(e,t,n,i){var o=r?r+e:e;if(!this._events[o])return this;if(!t)return s(this,o),this;var a=this._events[o];if(a.fn)a.fn!==t||i&&!a.once||n&&a.context!==n||s(this,o);else{for(var c=0,u=[],h=a.length;c<h;c++)(a[c].fn!==t||i&&!a[c].once||n&&a[c].context!==n)&&u.push(a[c]);u.length?this._events[o]=1===u.length?u[0]:u:s(this,o)}return this},a.prototype.removeAllListeners=function(e){var t;return e?(t=r?r+e:e,this._events[t]&&s(this,t)):(this._events=new n,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=r,a.EventEmitter=a,e.exports=a},8621:e=>{"use strict";var t,r="object"==typeof Reflect?Reflect:null,n=r&&"function"==typeof r.apply?r.apply:function(e,t,r){return Function.prototype.apply.call(e,t,r)};t=r&&"function"==typeof r.ownKeys?r.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var i=Number.isNaN||function(e){return e!=e};function o(){o.init.call(this)}e.exports=o,e.exports.once=function(e,t){return new Promise((function(r,n){function i(r){e.removeListener(t,o),n(r)}function o(){"function"==typeof e.removeListener&&e.removeListener("error",i),r([].slice.call(arguments))}g(e,t,o,{once:!0}),"error"!==t&&function(e,t){"function"==typeof e.on&&g(e,"error",t,{once:!0})}(e,i)}))},o.EventEmitter=o,o.prototype._events=void 0,o.prototype._eventsCount=0,o.prototype._maxListeners=void 0;var s=10;function a(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function c(e){return void 0===e._maxListeners?o.defaultMaxListeners:e._maxListeners}function u(e,t,r,n){var i,o,s,u;if(a(r),void 0===(o=e._events)?(o=e._events=Object.create(null),e._eventsCount=0):(void 0!==o.newListener&&(e.emit("newListener",t,r.listener?r.listener:r),o=e._events),s=o[t]),void 0===s)s=o[t]=r,++e._eventsCount;else if("function"==typeof s?s=o[t]=n?[r,s]:[s,r]:n?s.unshift(r):s.push(r),(i=c(e))>0&&s.length>i&&!s.warned){s.warned=!0;var h=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");h.name="MaxListenersExceededWarning",h.emitter=e,h.type=t,h.count=s.length,u=h,console&&console.warn&&console.warn(u)}return e}function h(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function l(e,t,r){var n={fired:!1,wrapFn:void 0,target:e,type:t,listener:r},i=h.bind(n);return i.listener=r,n.wrapFn=i,i}function d(e,t,r){var n=e._events;if(void 0===n)return[];var i=n[t];return void 0===i?[]:"function"==typeof i?r?[i.listener||i]:[i]:r?function(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}(i):p(i,i.length)}function f(e){var t=this._events;if(void 0!==t){var r=t[e];if("function"==typeof r)return 1;if(void 0!==r)return r.length}return 0}function p(e,t){for(var r=new Array(t),n=0;n<t;++n)r[n]=e[n];return r}function g(e,t,r,n){if("function"==typeof e.on)n.once?e.once(t,r):e.on(t,r);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function i(o){n.once&&e.removeEventListener(t,i),r(o)}))}}Object.defineProperty(o,"defaultMaxListeners",{enumerable:!0,get:function(){return s},set:function(e){if("number"!=typeof e||e<0||i(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");s=e}}),o.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},o.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||i(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},o.prototype.getMaxListeners=function(){return c(this)},o.prototype.emit=function(e){for(var t=[],r=1;r<arguments.length;r++)t.push(arguments[r]);var i="error"===e,o=this._events;if(void 0!==o)i=i&&void 0===o.error;else if(!i)return!1;if(i){var s;if(t.length>0&&(s=t[0]),s instanceof Error)throw s;var a=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw a.context=s,a}var c=o[e];if(void 0===c)return!1;if("function"==typeof c)n(c,this,t);else{var u=c.length,h=p(c,u);for(r=0;r<u;++r)n(h[r],this,t)}return!0},o.prototype.addListener=function(e,t){return u(this,e,t,!1)},o.prototype.on=o.prototype.addListener,o.prototype.prependListener=function(e,t){return u(this,e,t,!0)},o.prototype.once=function(e,t){return a(t),this.on(e,l(this,e,t)),this},o.prototype.prependOnceListener=function(e,t){return a(t),this.prependListener(e,l(this,e,t)),this},o.prototype.removeListener=function(e,t){var r,n,i,o,s;if(a(t),void 0===(n=this._events))return this;if(void 0===(r=n[e]))return this;if(r===t||r.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,r.listener||t));else if("function"!=typeof r){for(i=-1,o=r.length-1;o>=0;o--)if(r[o]===t||r[o].listener===t){s=r[o].listener,i=o;break}if(i<0)return this;0===i?r.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(r,i),1===r.length&&(n[e]=r[0]),void 0!==n.removeListener&&this.emit("removeListener",e,s||t)}return this},o.prototype.off=o.prototype.removeListener,o.prototype.removeAllListeners=function(e){var t,r,n;if(void 0===(r=this._events))return this;if(void 0===r.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==r[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete r[e]),this;if(0===arguments.length){var i,o=Object.keys(r);for(n=0;n<o.length;++n)"removeListener"!==(i=o[n])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=r[e]))this.removeListener(e,t);else if(void 0!==t)for(n=t.length-1;n>=0;n--)this.removeListener(e,t[n]);return this},o.prototype.listeners=function(e){return d(this,e,!0)},o.prototype.rawListeners=function(e){return d(this,e,!1)},o.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):f.call(e,t)},o.prototype.listenerCount=f,o.prototype.eventNames=function(){return this._eventsCount>0?t(this._events):[]}},9691:e=>{"use strict";var t=Object.prototype.toString,r=Math.max,n=function(e,t){for(var r=[],n=0;n<e.length;n+=1)r[n]=e[n];for(var i=0;i<t.length;i+=1)r[i+e.length]=t[i];return r};e.exports=function(e){var i=this;if("function"!=typeof i||"[object Function]"!==t.apply(i))throw new TypeError("Function.prototype.bind called on incompatible "+i);for(var o,s=function(e){for(var t=[],r=1,n=0;r<e.length;r+=1,n+=1)t[n]=e[r];return t}(arguments),a=r(0,i.length-s.length),c=[],u=0;u<a;u++)c[u]="$"+u;if(o=Function("binder","return function ("+function(e){for(var t="",r=0;r<e.length;r+=1)t+=e[r],r+1<e.length&&(t+=",");return t}(c)+"){ return binder.apply(this,arguments); }")((function(){if(this instanceof o){var t=i.apply(this,n(s,arguments));return Object(t)===t?t:this}return i.apply(e,n(s,arguments))})),i.prototype){var h=function(){};h.prototype=i.prototype,o.prototype=new h,h.prototype=null}return o}},469:(e,t,r)=>{"use strict";var n=r(9691);e.exports=Function.prototype.bind||n},4295:(e,t,r)=>{"use strict";var n,i=r(593),o=r(155),s=r(7180),a=r(9304),c=r(1742),u=r(6757),h=r(4923),l=Function,d=function(e){try{return l('"use strict"; return ('+e+").constructor;")()}catch(e){}},f=Object.getOwnPropertyDescriptor;if(f)try{f({},"")}catch(e){f=null}var p=function(){throw new u},g=f?function(){try{return p}catch(e){try{return f(arguments,"callee").get}catch(e){return p}}}():p,y=r(8573)(),b=r(6818)(),m=Object.getPrototypeOf||(b?function(e){return e.__proto__}:null),w={},v="undefined"!=typeof Uint8Array&&m?m(Uint8Array):n,S={__proto__:null,"%AggregateError%":"undefined"==typeof AggregateError?n:AggregateError,"%Array%":Array,"%ArrayBuffer%":"undefined"==typeof ArrayBuffer?n:ArrayBuffer,"%ArrayIteratorPrototype%":y&&m?m([][Symbol.iterator]()):n,"%AsyncFromSyncIteratorPrototype%":n,"%AsyncFunction%":w,"%AsyncGenerator%":w,"%AsyncGeneratorFunction%":w,"%AsyncIteratorPrototype%":w,"%Atomics%":"undefined"==typeof Atomics?n:Atomics,"%BigInt%":"undefined"==typeof BigInt?n:BigInt,"%BigInt64Array%":"undefined"==typeof BigInt64Array?n:BigInt64Array,"%BigUint64Array%":"undefined"==typeof BigUint64Array?n:BigUint64Array,"%Boolean%":Boolean,"%DataView%":"undefined"==typeof DataView?n:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":i,"%eval%":eval,"%EvalError%":o,"%Float32Array%":"undefined"==typeof Float32Array?n:Float32Array,"%Float64Array%":"undefined"==typeof Float64Array?n:Float64Array,"%FinalizationRegistry%":"undefined"==typeof FinalizationRegistry?n:FinalizationRegistry,"%Function%":l,"%GeneratorFunction%":w,"%Int8Array%":"undefined"==typeof Int8Array?n:Int8Array,"%Int16Array%":"undefined"==typeof Int16Array?n:Int16Array,"%Int32Array%":"undefined"==typeof Int32Array?n:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":y&&m?m(m([][Symbol.iterator]())):n,"%JSON%":"object"==typeof JSON?JSON:n,"%Map%":"undefined"==typeof Map?n:Map,"%MapIteratorPrototype%":"undefined"!=typeof Map&&y&&m?m((new Map)[Symbol.iterator]()):n,"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":"undefined"==typeof Promise?n:Promise,"%Proxy%":"undefined"==typeof Proxy?n:Proxy,"%RangeError%":s,"%ReferenceError%":a,"%Reflect%":"undefined"==typeof Reflect?n:Reflect,"%RegExp%":RegExp,"%Set%":"undefined"==typeof Set?n:Set,"%SetIteratorPrototype%":"undefined"!=typeof Set&&y&&m?m((new Set)[Symbol.iterator]()):n,"%SharedArrayBuffer%":"undefined"==typeof SharedArrayBuffer?n:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":y&&m?m(""[Symbol.iterator]()):n,"%Symbol%":y?Symbol:n,"%SyntaxError%":c,"%ThrowTypeError%":g,"%TypedArray%":v,"%TypeError%":u,"%Uint8Array%":"undefined"==typeof Uint8Array?n:Uint8Array,"%Uint8ClampedArray%":"undefined"==typeof Uint8ClampedArray?n:Uint8ClampedArray,"%Uint16Array%":"undefined"==typeof Uint16Array?n:Uint16Array,"%Uint32Array%":"undefined"==typeof Uint32Array?n:Uint32Array,"%URIError%":h,"%WeakMap%":"undefined"==typeof WeakMap?n:WeakMap,"%WeakRef%":"undefined"==typeof WeakRef?n:WeakRef,"%WeakSet%":"undefined"==typeof WeakSet?n:WeakSet};if(m)try{null.error}catch(e){var _=m(m(e));S["%Error.prototype%"]=_}var E=function e(t){var r;if("%AsyncFunction%"===t)r=d("async function () {}");else if("%GeneratorFunction%"===t)r=d("function* () {}");else if("%AsyncGeneratorFunction%"===t)r=d("async function* () {}");else if("%AsyncGenerator%"===t){var n=e("%AsyncGeneratorFunction%");n&&(r=n.prototype)}else if("%AsyncIteratorPrototype%"===t){var i=e("%AsyncGenerator%");i&&m&&(r=m(i.prototype))}return S[t]=r,r},I={__proto__:null,"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},A=r(469),k=r(9731),x=A.call(Function.call,Array.prototype.concat),P=A.call(Function.apply,Array.prototype.splice),O=A.call(Function.call,String.prototype.replace),R=A.call(Function.call,String.prototype.slice),T=A.call(Function.call,RegExp.prototype.exec),N=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,M=/\\(\\)?/g,C=function(e,t){var r,n=e;if(k(I,n)&&(n="%"+(r=I[n])[0]+"%"),k(S,n)){var i=S[n];if(i===w&&(i=E(n)),void 0===i&&!t)throw new u("intrinsic "+e+" exists, but is not available. Please file an issue!");return{alias:r,name:n,value:i}}throw new c("intrinsic "+e+" does not exist!")};e.exports=function(e,t){if("string"!=typeof e||0===e.length)throw new u("intrinsic name must be a non-empty string");if(arguments.length>1&&"boolean"!=typeof t)throw new u('"allowMissing" argument must be a boolean');if(null===T(/^%?[^%]*%?$/,e))throw new c("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var r=function(e){var t=R(e,0,1),r=R(e,-1);if("%"===t&&"%"!==r)throw new c("invalid intrinsic syntax, expected closing `%`");if("%"===r&&"%"!==t)throw new c("invalid intrinsic syntax, expected opening `%`");var n=[];return O(e,N,(function(e,t,r,i){n[n.length]=r?O(i,M,"$1"):t||e})),n}(e),n=r.length>0?r[0]:"",i=C("%"+n+"%",t),o=i.name,s=i.value,a=!1,h=i.alias;h&&(n=h[0],P(r,x([0,1],h)));for(var l=1,d=!0;l<r.length;l+=1){var p=r[l],g=R(p,0,1),y=R(p,-1);if(('"'===g||"'"===g||"`"===g||'"'===y||"'"===y||"`"===y)&&g!==y)throw new c("property names with quotes must have matching quotes");if("constructor"!==p&&d||(a=!0),k(S,o="%"+(n+="."+p)+"%"))s=S[o];else if(null!=s){if(!(p in s)){if(!t)throw new u("base intrinsic for "+e+" exists, but the property is not available.");return}if(f&&l+1>=r.length){var b=f(s,p);s=(d=!!b)&&"get"in b&&!("originalValue"in b.get)?b.get:s[p]}else d=k(s,p),s=s[p];d&&!a&&(S[o]=s)}}return s}},1233:(e,t,r)=>{"use strict";var n=r(4295)("%Object.getOwnPropertyDescriptor%",!0);if(n)try{n([],"length")}catch(e){n=null}e.exports=n},9118:(e,t,r)=>{"use strict";var n=r(9997),i=function(){return!!n};i.hasArrayLengthDefineBug=function(){if(!n)return null;try{return 1!==n([],"length",{value:1}).length}catch(e){return!0}},e.exports=i},6818:e=>{"use strict";var t={__proto__:null,foo:{}},r=Object;e.exports=function(){return{__proto__:t}.foo===t.foo&&!(t instanceof r)}},8573:(e,t,r)=>{"use strict";var n="undefined"!=typeof Symbol&&Symbol,i=r(9535);e.exports=function(){return"function"==typeof n&&"function"==typeof Symbol&&"symbol"==typeof n("foo")&&"symbol"==typeof Symbol("bar")&&i()}},9535:e=>{"use strict";e.exports=function(){if("function"!=typeof Symbol||"function"!=typeof Object.getOwnPropertySymbols)return!1;if("symbol"==typeof Symbol.iterator)return!0;var e={},t=Symbol("test"),r=Object(t);if("string"==typeof t)return!1;if("[object Symbol]"!==Object.prototype.toString.call(t))return!1;if("[object Symbol]"!==Object.prototype.toString.call(r))return!1;for(t in e[t]=42,e)return!1;if("function"==typeof Object.keys&&0!==Object.keys(e).length)return!1;if("function"==typeof Object.getOwnPropertyNames&&0!==Object.getOwnPropertyNames(e).length)return!1;var n=Object.getOwnPropertySymbols(e);if(1!==n.length||n[0]!==t)return!1;if(!Object.prototype.propertyIsEnumerable.call(e,t))return!1;if("function"==typeof Object.getOwnPropertyDescriptor){var i=Object.getOwnPropertyDescriptor(e,t);if(42!==i.value||!0!==i.enumerable)return!1}return!0}},7734:(e,t,r)=>{var n=t;n.utils=r(4624),n.common=r(6148),n.sha=r(3875),n.ripemd=r(7962),n.hmac=r(9934),n.sha1=n.sha.sha1,n.sha256=n.sha.sha256,n.sha224=n.sha.sha224,n.sha384=n.sha.sha384,n.sha512=n.sha.sha512,n.ripemd160=n.ripemd.ripemd160},6148:(e,t,r)=>{"use strict";var n=r(4624),i=r(4263);function o(){this.pending=null,this.pendingTotal=0,this.blockSize=this.constructor.blockSize,this.outSize=this.constructor.outSize,this.hmacStrength=this.constructor.hmacStrength,this.padLength=this.constructor.padLength/8,this.endian="big",this._delta8=this.blockSize/8,this._delta32=this.blockSize/32}t.BlockHash=o,o.prototype.update=function(e,t){if(e=n.toArray(e,t),this.pending?this.pending=this.pending.concat(e):this.pending=e,this.pendingTotal+=e.length,this.pending.length>=this._delta8){var r=(e=this.pending).length%this._delta8;this.pending=e.slice(e.length-r,e.length),0===this.pending.length&&(this.pending=null),e=n.join32(e,0,e.length-r,this.endian);for(var i=0;i<e.length;i+=this._delta32)this._update(e,i,i+this._delta32)}return this},o.prototype.digest=function(e){return this.update(this._pad()),i(null===this.pending),this._digest(e)},o.prototype._pad=function(){var e=this.pendingTotal,t=this._delta8,r=t-(e+this.padLength)%t,n=new Array(r+this.padLength);n[0]=128;for(var i=1;i<r;i++)n[i]=0;if(e<<=3,"big"===this.endian){for(var o=8;o<this.padLength;o++)n[i++]=0;n[i++]=0,n[i++]=0,n[i++]=0,n[i++]=0,n[i++]=e>>>24&255,n[i++]=e>>>16&255,n[i++]=e>>>8&255,n[i++]=255&e}else for(n[i++]=255&e,n[i++]=e>>>8&255,n[i++]=e>>>16&255,n[i++]=e>>>24&255,n[i++]=0,n[i++]=0,n[i++]=0,n[i++]=0,o=8;o<this.padLength;o++)n[i++]=0;return n}},9934:(e,t,r)=>{"use strict";var n=r(4624),i=r(4263);function o(e,t,r){if(!(this instanceof o))return new o(e,t,r);this.Hash=e,this.blockSize=e.blockSize/8,this.outSize=e.outSize/8,this.inner=null,this.outer=null,this._init(n.toArray(t,r))}e.exports=o,o.prototype._init=function(e){e.length>this.blockSize&&(e=(new this.Hash).update(e).digest()),i(e.length<=this.blockSize);for(var t=e.length;t<this.blockSize;t++)e.push(0);for(t=0;t<e.length;t++)e[t]^=54;for(this.inner=(new this.Hash).update(e),t=0;t<e.length;t++)e[t]^=106;this.outer=(new this.Hash).update(e)},o.prototype.update=function(e,t){return this.inner.update(e,t),this},o.prototype.digest=function(e){return this.outer.update(this.inner.digest()),this.outer.digest(e)}},7962:(e,t,r)=>{"use strict";var n=r(4624),i=r(6148),o=n.rotl32,s=n.sum32,a=n.sum32_3,c=n.sum32_4,u=i.BlockHash;function h(){if(!(this instanceof h))return new h;u.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.endian="little"}function l(e,t,r,n){return e<=15?t^r^n:e<=31?t&r|~t&n:e<=47?(t|~r)^n:e<=63?t&n|r&~n:t^(r|~n)}function d(e){return e<=15?0:e<=31?1518500249:e<=47?1859775393:e<=63?2400959708:2840853838}function f(e){return e<=15?1352829926:e<=31?1548603684:e<=47?1836072691:e<=63?2053994217:0}n.inherits(h,u),t.ripemd160=h,h.blockSize=512,h.outSize=160,h.hmacStrength=192,h.padLength=64,h.prototype._update=function(e,t){for(var r=this.h[0],n=this.h[1],i=this.h[2],u=this.h[3],h=this.h[4],m=r,w=n,v=i,S=u,_=h,E=0;E<80;E++){var I=s(o(c(r,l(E,n,i,u),e[p[E]+t],d(E)),y[E]),h);r=h,h=u,u=o(i,10),i=n,n=I,I=s(o(c(m,l(79-E,w,v,S),e[g[E]+t],f(E)),b[E]),_),m=_,_=S,S=o(v,10),v=w,w=I}I=a(this.h[1],i,S),this.h[1]=a(this.h[2],u,_),this.h[2]=a(this.h[3],h,m),this.h[3]=a(this.h[4],r,w),this.h[4]=a(this.h[0],n,v),this.h[0]=I},h.prototype._digest=function(e){return"hex"===e?n.toHex32(this.h,"little"):n.split32(this.h,"little")};var p=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],g=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],y=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],b=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]},3875:(e,t,r)=>{"use strict";t.sha1=r(9119),t.sha224=r(9588),t.sha256=r(2545),t.sha384=r(9093),t.sha512=r(9044)},9119:(e,t,r)=>{"use strict";var n=r(4624),i=r(6148),o=r(4215),s=n.rotl32,a=n.sum32,c=n.sum32_5,u=o.ft_1,h=i.BlockHash,l=[1518500249,1859775393,2400959708,3395469782];function d(){if(!(this instanceof d))return new d;h.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.W=new Array(80)}n.inherits(d,h),e.exports=d,d.blockSize=512,d.outSize=160,d.hmacStrength=80,d.padLength=64,d.prototype._update=function(e,t){for(var r=this.W,n=0;n<16;n++)r[n]=e[t+n];for(;n<r.length;n++)r[n]=s(r[n-3]^r[n-8]^r[n-14]^r[n-16],1);var i=this.h[0],o=this.h[1],h=this.h[2],d=this.h[3],f=this.h[4];for(n=0;n<r.length;n++){var p=~~(n/20),g=c(s(i,5),u(p,o,h,d),f,r[n],l[p]);f=d,d=h,h=s(o,30),o=i,i=g}this.h[0]=a(this.h[0],i),this.h[1]=a(this.h[1],o),this.h[2]=a(this.h[2],h),this.h[3]=a(this.h[3],d),this.h[4]=a(this.h[4],f)},d.prototype._digest=function(e){return"hex"===e?n.toHex32(this.h,"big"):n.split32(this.h,"big")}},9588:(e,t,r)=>{"use strict";var n=r(4624),i=r(2545);function o(){if(!(this instanceof o))return new o;i.call(this),this.h=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]}n.inherits(o,i),e.exports=o,o.blockSize=512,o.outSize=224,o.hmacStrength=192,o.padLength=64,o.prototype._digest=function(e){return"hex"===e?n.toHex32(this.h.slice(0,7),"big"):n.split32(this.h.slice(0,7),"big")}},2545:(e,t,r)=>{"use strict";var n=r(4624),i=r(6148),o=r(4215),s=r(4263),a=n.sum32,c=n.sum32_4,u=n.sum32_5,h=o.ch32,l=o.maj32,d=o.s0_256,f=o.s1_256,p=o.g0_256,g=o.g1_256,y=i.BlockHash,b=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function m(){if(!(this instanceof m))return new m;y.call(this),this.h=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],this.k=b,this.W=new Array(64)}n.inherits(m,y),e.exports=m,m.blockSize=512,m.outSize=256,m.hmacStrength=192,m.padLength=64,m.prototype._update=function(e,t){for(var r=this.W,n=0;n<16;n++)r[n]=e[t+n];for(;n<r.length;n++)r[n]=c(g(r[n-2]),r[n-7],p(r[n-15]),r[n-16]);var i=this.h[0],o=this.h[1],y=this.h[2],b=this.h[3],m=this.h[4],w=this.h[5],v=this.h[6],S=this.h[7];for(s(this.k.length===r.length),n=0;n<r.length;n++){var _=u(S,f(m),h(m,w,v),this.k[n],r[n]),E=a(d(i),l(i,o,y));S=v,v=w,w=m,m=a(b,_),b=y,y=o,o=i,i=a(_,E)}this.h[0]=a(this.h[0],i),this.h[1]=a(this.h[1],o),this.h[2]=a(this.h[2],y),this.h[3]=a(this.h[3],b),this.h[4]=a(this.h[4],m),this.h[5]=a(this.h[5],w),this.h[6]=a(this.h[6],v),this.h[7]=a(this.h[7],S)},m.prototype._digest=function(e){return"hex"===e?n.toHex32(this.h,"big"):n.split32(this.h,"big")}},9093:(e,t,r)=>{"use strict";var n=r(4624),i=r(9044);function o(){if(!(this instanceof o))return new o;i.call(this),this.h=[3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]}n.inherits(o,i),e.exports=o,o.blockSize=1024,o.outSize=384,o.hmacStrength=192,o.padLength=128,o.prototype._digest=function(e){return"hex"===e?n.toHex32(this.h.slice(0,12),"big"):n.split32(this.h.slice(0,12),"big")}},9044:(e,t,r)=>{"use strict";var n=r(4624),i=r(6148),o=r(4263),s=n.rotr64_hi,a=n.rotr64_lo,c=n.shr64_hi,u=n.shr64_lo,h=n.sum64,l=n.sum64_hi,d=n.sum64_lo,f=n.sum64_4_hi,p=n.sum64_4_lo,g=n.sum64_5_hi,y=n.sum64_5_lo,b=i.BlockHash,m=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function w(){if(!(this instanceof w))return new w;b.call(this),this.h=[1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209],this.k=m,this.W=new Array(160)}function v(e,t,r,n,i){var o=e&r^~e&i;return o<0&&(o+=4294967296),o}function S(e,t,r,n,i,o){var s=t&n^~t&o;return s<0&&(s+=4294967296),s}function _(e,t,r,n,i){var o=e&r^e&i^r&i;return o<0&&(o+=4294967296),o}function E(e,t,r,n,i,o){var s=t&n^t&o^n&o;return s<0&&(s+=4294967296),s}function I(e,t){var r=s(e,t,28)^s(t,e,2)^s(t,e,7);return r<0&&(r+=4294967296),r}function A(e,t){var r=a(e,t,28)^a(t,e,2)^a(t,e,7);return r<0&&(r+=4294967296),r}function k(e,t){var r=a(e,t,14)^a(e,t,18)^a(t,e,9);return r<0&&(r+=4294967296),r}function x(e,t){var r=s(e,t,1)^s(e,t,8)^c(e,t,7);return r<0&&(r+=4294967296),r}function P(e,t){var r=a(e,t,1)^a(e,t,8)^u(e,t,7);return r<0&&(r+=4294967296),r}function O(e,t){var r=a(e,t,19)^a(t,e,29)^u(e,t,6);return r<0&&(r+=4294967296),r}n.inherits(w,b),e.exports=w,w.blockSize=1024,w.outSize=512,w.hmacStrength=192,w.padLength=128,w.prototype._prepareBlock=function(e,t){for(var r=this.W,n=0;n<32;n++)r[n]=e[t+n];for(;n<r.length;n+=2){var i=(y=r[n-4],b=r[n-3],m=void 0,(m=s(y,b,19)^s(b,y,29)^c(y,b,6))<0&&(m+=4294967296),m),o=O(r[n-4],r[n-3]),a=r[n-14],u=r[n-13],h=x(r[n-30],r[n-29]),l=P(r[n-30],r[n-29]),d=r[n-32],g=r[n-31];r[n]=f(i,o,a,u,h,l,d,g),r[n+1]=p(i,o,a,u,h,l,d,g)}var y,b,m},w.prototype._update=function(e,t){this._prepareBlock(e,t);var r,n,i,a=this.W,c=this.h[0],u=this.h[1],f=this.h[2],p=this.h[3],b=this.h[4],m=this.h[5],w=this.h[6],x=this.h[7],P=this.h[8],O=this.h[9],R=this.h[10],T=this.h[11],N=this.h[12],M=this.h[13],C=this.h[14],B=this.h[15];o(this.k.length===a.length);for(var L=0;L<a.length;L+=2){var U=C,D=B,j=(i=void 0,(i=s(r=P,n=O,14)^s(r,n,18)^s(n,r,9))<0&&(i+=4294967296),i),z=k(P,O),q=v(P,0,R,0,N),$=S(0,O,0,T,0,M),K=this.k[L],F=this.k[L+1],W=a[L],H=a[L+1],V=g(U,D,j,z,q,$,K,F,W,H),G=y(U,D,j,z,q,$,K,F,W,H);U=I(c,u),D=A(c,u),j=_(c,0,f,0,b),z=E(0,u,0,p,0,m);var Y=l(U,D,j,z),J=d(U,D,j,z);C=N,B=M,N=R,M=T,R=P,T=O,P=l(w,x,V,G),O=d(x,x,V,G),w=b,x=m,b=f,m=p,f=c,p=u,c=l(V,G,Y,J),u=d(V,G,Y,J)}h(this.h,0,c,u),h(this.h,2,f,p),h(this.h,4,b,m),h(this.h,6,w,x),h(this.h,8,P,O),h(this.h,10,R,T),h(this.h,12,N,M),h(this.h,14,C,B)},w.prototype._digest=function(e){return"hex"===e?n.toHex32(this.h,"big"):n.split32(this.h,"big")}},4215:(e,t,r)=>{"use strict";var n=r(4624).rotr32;function i(e,t,r){return e&t^~e&r}function o(e,t,r){return e&t^e&r^t&r}function s(e,t,r){return e^t^r}t.ft_1=function(e,t,r,n){return 0===e?i(t,r,n):1===e||3===e?s(t,r,n):2===e?o(t,r,n):void 0},t.ch32=i,t.maj32=o,t.p32=s,t.s0_256=function(e){return n(e,2)^n(e,13)^n(e,22)},t.s1_256=function(e){return n(e,6)^n(e,11)^n(e,25)},t.g0_256=function(e){return n(e,7)^n(e,18)^e>>>3},t.g1_256=function(e){return n(e,17)^n(e,19)^e>>>10}},4624:(e,t,r)=>{"use strict";var n=r(4263),i=r(9988);function o(e,t){return 55296==(64512&e.charCodeAt(t))&&!(t<0||t+1>=e.length)&&56320==(64512&e.charCodeAt(t+1))}function s(e){return(e>>>24|e>>>8&65280|e<<8&16711680|(255&e)<<24)>>>0}function a(e){return 1===e.length?"0"+e:e}function c(e){return 7===e.length?"0"+e:6===e.length?"00"+e:5===e.length?"000"+e:4===e.length?"0000"+e:3===e.length?"00000"+e:2===e.length?"000000"+e:1===e.length?"0000000"+e:e}t.inherits=i,t.toArray=function(e,t){if(Array.isArray(e))return e.slice();if(!e)return[];var r=[];if("string"==typeof e)if(t){if("hex"===t)for((e=e.replace(/[^a-z0-9]+/gi,"")).length%2!=0&&(e="0"+e),i=0;i<e.length;i+=2)r.push(parseInt(e[i]+e[i+1],16))}else for(var n=0,i=0;i<e.length;i++){var s=e.charCodeAt(i);s<128?r[n++]=s:s<2048?(r[n++]=s>>6|192,r[n++]=63&s|128):o(e,i)?(s=65536+((1023&s)<<10)+(1023&e.charCodeAt(++i)),r[n++]=s>>18|240,r[n++]=s>>12&63|128,r[n++]=s>>6&63|128,r[n++]=63&s|128):(r[n++]=s>>12|224,r[n++]=s>>6&63|128,r[n++]=63&s|128)}else for(i=0;i<e.length;i++)r[i]=0|e[i];return r},t.toHex=function(e){for(var t="",r=0;r<e.length;r++)t+=a(e[r].toString(16));return t},t.htonl=s,t.toHex32=function(e,t){for(var r="",n=0;n<e.length;n++){var i=e[n];"little"===t&&(i=s(i)),r+=c(i.toString(16))}return r},t.zero2=a,t.zero8=c,t.join32=function(e,t,r,i){var o=r-t;n(o%4==0);for(var s=new Array(o/4),a=0,c=t;a<s.length;a++,c+=4){var u;u="big"===i?e[c]<<24|e[c+1]<<16|e[c+2]<<8|e[c+3]:e[c+3]<<24|e[c+2]<<16|e[c+1]<<8|e[c],s[a]=u>>>0}return s},t.split32=function(e,t){for(var r=new Array(4*e.length),n=0,i=0;n<e.length;n++,i+=4){var o=e[n];"big"===t?(r[i]=o>>>24,r[i+1]=o>>>16&255,r[i+2]=o>>>8&255,r[i+3]=255&o):(r[i+3]=o>>>24,r[i+2]=o>>>16&255,r[i+1]=o>>>8&255,r[i]=255&o)}return r},t.rotr32=function(e,t){return e>>>t|e<<32-t},t.rotl32=function(e,t){return e<<t|e>>>32-t},t.sum32=function(e,t){return e+t>>>0},t.sum32_3=function(e,t,r){return e+t+r>>>0},t.sum32_4=function(e,t,r,n){return e+t+r+n>>>0},t.sum32_5=function(e,t,r,n,i){return e+t+r+n+i>>>0},t.sum64=function(e,t,r,n){var i=e[t],o=n+e[t+1]>>>0,s=(o<n?1:0)+r+i;e[t]=s>>>0,e[t+1]=o},t.sum64_hi=function(e,t,r,n){return(t+n>>>0<t?1:0)+e+r>>>0},t.sum64_lo=function(e,t,r,n){return t+n>>>0},t.sum64_4_hi=function(e,t,r,n,i,o,s,a){var c=0,u=t;return c+=(u=u+n>>>0)<t?1:0,c+=(u=u+o>>>0)<o?1:0,e+r+i+s+(c+=(u=u+a>>>0)<a?1:0)>>>0},t.sum64_4_lo=function(e,t,r,n,i,o,s,a){return t+n+o+a>>>0},t.sum64_5_hi=function(e,t,r,n,i,o,s,a,c,u){var h=0,l=t;return h+=(l=l+n>>>0)<t?1:0,h+=(l=l+o>>>0)<o?1:0,h+=(l=l+a>>>0)<a?1:0,e+r+i+s+c+(h+=(l=l+u>>>0)<u?1:0)>>>0},t.sum64_5_lo=function(e,t,r,n,i,o,s,a,c,u){return t+n+o+a+u>>>0},t.rotr64_hi=function(e,t,r){return(t<<32-r|e>>>r)>>>0},t.rotr64_lo=function(e,t,r){return(e<<32-r|t>>>r)>>>0},t.shr64_hi=function(e,t,r){return e>>>r},t.shr64_lo=function(e,t,r){return(e<<32-r|t>>>r)>>>0}},9731:(e,t,r)=>{"use strict";var n=Function.prototype.call,i=Object.prototype.hasOwnProperty,o=r(469);e.exports=o.call(n,i)},1001:(e,t,r)=>{"use strict";var n=r(7734),i=r(1901),o=r(4263);function s(e){if(!(this instanceof s))return new s(e);this.hash=e.hash,this.predResist=!!e.predResist,this.outLen=this.hash.outSize,this.minEntropy=e.minEntropy||this.hash.hmacStrength,this._reseed=null,this.reseedInterval=null,this.K=null,this.V=null;var t=i.toArray(e.entropy,e.entropyEnc||"hex"),r=i.toArray(e.nonce,e.nonceEnc||"hex"),n=i.toArray(e.pers,e.persEnc||"hex");o(t.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._init(t,r,n)}e.exports=s,s.prototype._init=function(e,t,r){var n=e.concat(t).concat(r);this.K=new Array(this.outLen/8),this.V=new Array(this.outLen/8);for(var i=0;i<this.V.length;i++)this.K[i]=0,this.V[i]=1;this._update(n),this._reseed=1,this.reseedInterval=281474976710656},s.prototype._hmac=function(){return new n.hmac(this.hash,this.K)},s.prototype._update=function(e){var t=this._hmac().update(this.V).update([0]);e&&(t=t.update(e)),this.K=t.digest(),this.V=this._hmac().update(this.V).digest(),e&&(this.K=this._hmac().update(this.V).update([1]).update(e).digest(),this.V=this._hmac().update(this.V).digest())},s.prototype.reseed=function(e,t,r,n){"string"!=typeof t&&(n=r,r=t,t=null),e=i.toArray(e,t),r=i.toArray(r,n),o(e.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._update(e.concat(r||[])),this._reseed=1},s.prototype.generate=function(e,t,r,n){if(this._reseed>this.reseedInterval)throw new Error("Reseed is required");"string"!=typeof t&&(n=r,r=t,t=null),r&&(r=i.toArray(r,n||"hex"),this._update(r));for(var o=[];o.length<e;)this.V=this._hmac().update(this.V).digest(),o=o.concat(this.V);var s=o.slice(0,e);return this._update(r),this._reseed++,i.encode(s,t)}},5801:(e,t)=>{t.read=function(e,t,r,n,i){var o,s,a=8*i-n-1,c=(1<<a)-1,u=c>>1,h=-7,l=r?i-1:0,d=r?-1:1,f=e[t+l];for(l+=d,o=f&(1<<-h)-1,f>>=-h,h+=a;h>0;o=256*o+e[t+l],l+=d,h-=8);for(s=o&(1<<-h)-1,o>>=-h,h+=n;h>0;s=256*s+e[t+l],l+=d,h-=8);if(0===o)o=1-u;else{if(o===c)return s?NaN:1/0*(f?-1:1);s+=Math.pow(2,n),o-=u}return(f?-1:1)*s*Math.pow(2,o-n)},t.write=function(e,t,r,n,i,o){var s,a,c,u=8*o-i-1,h=(1<<u)-1,l=h>>1,d=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,f=n?0:o-1,p=n?1:-1,g=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,s=h):(s=Math.floor(Math.log(t)/Math.LN2),t*(c=Math.pow(2,-s))<1&&(s--,c*=2),(t+=s+l>=1?d/c:d*Math.pow(2,1-l))*c>=2&&(s++,c/=2),s+l>=h?(a=0,s=h):s+l>=1?(a=(t*c-1)*Math.pow(2,i),s+=l):(a=t*Math.pow(2,l-1)*Math.pow(2,i),s=0));i>=8;e[r+f]=255&a,f+=p,a/=256,i-=8);for(s=s<<i|a,u+=i;u>0;e[r+f]=255&s,f+=p,s/=256,u-=8);e[r+f-p]|=128*g}},9988:e=>{"function"==typeof Object.create?e.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:e.exports=function(e,t){if(t){e.super_=t;var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e}}},5864:(e,t,r)=>{"use strict";const n=r(151).v4,i=r(9391),o=function(e,t){if(!(this instanceof o))return new o(e,t);t||(t={}),this.options={reviver:void 0!==t.reviver?t.reviver:null,replacer:void 0!==t.replacer?t.replacer:null,generator:void 0!==t.generator?t.generator:function(){return n()},version:void 0!==t.version?t.version:2,notificationIdNull:"boolean"==typeof t.notificationIdNull&&t.notificationIdNull},this.callServer=e};e.exports=o,o.prototype.request=function(e,t,r,n){const o=this;let s=null;const a=Array.isArray(e)&&"function"==typeof t;if(1===this.options.version&&a)throw new TypeError("JSON-RPC 1.0 does not support batching");if(a||!a&&e&&"object"==typeof e&&"function"==typeof t)n=t,s=e;else{"function"==typeof r&&(n=r,r=void 0);const o="function"==typeof n;try{s=i(e,t,r,{generator:this.options.generator,version:this.options.version,notificationIdNull:this.options.notificationIdNull})}catch(e){if(o)return n(e);throw e}if(!o)return s}let c;try{c=JSON.stringify(s,this.options.replacer)}catch(e){return n(e)}return this.callServer(c,(function(e,t){o._parseResponse(e,t,n)})),s},o.prototype._parseResponse=function(e,t,r){if(e)return void r(e);if(!t)return r();let n;try{n=JSON.parse(t,this.options.reviver)}catch(e){return r(e)}if(3===r.length){if(Array.isArray(n)){const e=function(e){return void 0!==e.error},t=function(t){return!e(t)};return r(null,n.filter(e),n.filter(t))}return r(null,n.error,n.result)}r(null,n)}},9391:(e,t,r)=>{"use strict";const n=r(151).v4;e.exports=function(e,t,r,i){if("string"!=typeof e)throw new TypeError(e+" must be a string");const o="number"==typeof(i=i||{}).version?i.version:2;if(1!==o&&2!==o)throw new TypeError(o+" must be 1 or 2");const s={method:e};if(2===o&&(s.jsonrpc="2.0"),t){if("object"!=typeof t&&!Array.isArray(t))throw new TypeError(t+" must be an object, array or omitted");s.params=t}if(void 0===r){const e="function"==typeof i.generator?i.generator:function(){return n()};s.id=e(s,i)}else 2===o&&null===r?i.notificationIdNull&&(s.id=null):s.id=r;return s}},151:(e,t,r)=>{"use strict";var n;r.d(t,{v4:()=>h});var i=new Uint8Array(16);function o(){if(!n&&!(n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return n(i)}const s=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;for(var a=[],c=0;c<256;++c)a.push((c+256).toString(16).substr(1));const u=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=(a[e[t+0]]+a[e[t+1]]+a[e[t+2]]+a[e[t+3]]+"-"+a[e[t+4]]+a[e[t+5]]+"-"+a[e[t+6]]+a[e[t+7]]+"-"+a[e[t+8]]+a[e[t+9]]+"-"+a[e[t+10]]+a[e[t+11]]+a[e[t+12]]+a[e[t+13]]+a[e[t+14]]+a[e[t+15]]).toLowerCase();if(!function(e){return"string"==typeof e&&s.test(e)}(r))throw TypeError("Stringified UUID is invalid");return r},h=function(e,t,r){var n=(e=e||{}).random||(e.rng||o)();if(n[6]=15&n[6]|64,n[8]=63&n[8]|128,t){r=r||0;for(var i=0;i<16;++i)t[r+i]=n[i];return t}return u(n)}},5938:(e,t,r)=>{var n,i=r(3184);!function(){"use strict";var o="input is invalid type",s="object"==typeof window,a=s?window:{};a.JS_SHA3_NO_WINDOW&&(s=!1);var c=!s&&"object"==typeof self;!a.JS_SHA3_NO_NODE_JS&&"object"==typeof i&&i.versions&&i.versions.node?a=r.g:c&&(a=self);var u=!a.JS_SHA3_NO_COMMON_JS&&e.exports,h=r.amdO,l=!a.JS_SHA3_NO_ARRAY_BUFFER&&"undefined"!=typeof ArrayBuffer,d="0123456789abcdef".split(""),f=[4,1024,262144,67108864],p=[0,8,16,24],g=[1,0,32898,0,32906,2147483648,2147516416,2147483648,32907,0,2147483649,0,2147516545,2147483648,32777,2147483648,138,0,136,0,2147516425,0,2147483658,0,2147516555,0,139,2147483648,32905,2147483648,32771,2147483648,32770,2147483648,128,2147483648,32778,0,2147483658,2147483648,2147516545,2147483648,32896,2147483648,2147483649,0,2147516424,2147483648],y=[224,256,384,512],b=[128,256],m=["hex","buffer","arrayBuffer","array","digest"],w={128:168,256:136};!a.JS_SHA3_NO_NODE_JS&&Array.isArray||(Array.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)}),!l||!a.JS_SHA3_NO_ARRAY_BUFFER_IS_VIEW&&ArrayBuffer.isView||(ArrayBuffer.isView=function(e){return"object"==typeof e&&e.buffer&&e.buffer.constructor===ArrayBuffer});for(var v=function(e,t,r){return function(n){return new B(e,t,e).update(n)[r]()}},S=function(e,t,r){return function(n,i){return new B(e,t,i).update(n)[r]()}},_=function(e,t,r){return function(t,n,i,o){return x["cshake"+e].update(t,n,i,o)[r]()}},E=function(e,t,r){return function(t,n,i,o){return x["kmac"+e].update(t,n,i,o)[r]()}},I=function(e,t,r,n){for(var i=0;i<m.length;++i){var o=m[i];e[o]=t(r,n,o)}return e},A=function(e,t){var r=v(e,t,"hex");return r.create=function(){return new B(e,t,e)},r.update=function(e){return r.create().update(e)},I(r,v,e,t)},k=[{name:"keccak",padding:[1,256,65536,16777216],bits:y,createMethod:A},{name:"sha3",padding:[6,1536,393216,100663296],bits:y,createMethod:A},{name:"shake",padding:[31,7936,2031616,520093696],bits:b,createMethod:function(e,t){var r=S(e,t,"hex");return r.create=function(r){return new B(e,t,r)},r.update=function(e,t){return r.create(t).update(e)},I(r,S,e,t)}},{name:"cshake",padding:f,bits:b,createMethod:function(e,t){var r=w[e],n=_(e,0,"hex");return n.create=function(n,i,o){return i||o?new B(e,t,n).bytepad([i,o],r):x["shake"+e].create(n)},n.update=function(e,t,r,i){return n.create(t,r,i).update(e)},I(n,_,e,t)}},{name:"kmac",padding:f,bits:b,createMethod:function(e,t){var r=w[e],n=E(e,0,"hex");return n.create=function(n,i,o){return new L(e,t,i).bytepad(["KMAC",o],r).bytepad([n],r)},n.update=function(e,t,r,i){return n.create(e,r,i).update(t)},I(n,E,e,t)}}],x={},P=[],O=0;O<k.length;++O)for(var R=k[O],T=R.bits,N=0;N<T.length;++N){var M=R.name+"_"+T[N];if(P.push(M),x[M]=R.createMethod(T[N],R.padding),"sha3"!==R.name){var C=R.name+T[N];P.push(C),x[C]=x[M]}}function B(e,t,r){this.blocks=[],this.s=[],this.padding=t,this.outputBits=r,this.reset=!0,this.finalized=!1,this.block=0,this.start=0,this.blockCount=1600-(e<<1)>>5,this.byteCount=this.blockCount<<2,this.outputBlocks=r>>5,this.extraBytes=(31&r)>>3;for(var n=0;n<50;++n)this.s[n]=0}function L(e,t,r){B.call(this,e,t,r)}B.prototype.update=function(e){if(this.finalized)throw new Error("finalize already called");var t,r=typeof e;if("string"!==r){if("object"!==r)throw new Error(o);if(null===e)throw new Error(o);if(l&&e.constructor===ArrayBuffer)e=new Uint8Array(e);else if(!(Array.isArray(e)||l&&ArrayBuffer.isView(e)))throw new Error(o);t=!0}for(var n,i,s=this.blocks,a=this.byteCount,c=e.length,u=this.blockCount,h=0,d=this.s;h<c;){if(this.reset)for(this.reset=!1,s[0]=this.block,n=1;n<u+1;++n)s[n]=0;if(t)for(n=this.start;h<c&&n<a;++h)s[n>>2]|=e[h]<<p[3&n++];else for(n=this.start;h<c&&n<a;++h)(i=e.charCodeAt(h))<128?s[n>>2]|=i<<p[3&n++]:i<2048?(s[n>>2]|=(192|i>>6)<<p[3&n++],s[n>>2]|=(128|63&i)<<p[3&n++]):i<55296||i>=57344?(s[n>>2]|=(224|i>>12)<<p[3&n++],s[n>>2]|=(128|i>>6&63)<<p[3&n++],s[n>>2]|=(128|63&i)<<p[3&n++]):(i=65536+((1023&i)<<10|1023&e.charCodeAt(++h)),s[n>>2]|=(240|i>>18)<<p[3&n++],s[n>>2]|=(128|i>>12&63)<<p[3&n++],s[n>>2]|=(128|i>>6&63)<<p[3&n++],s[n>>2]|=(128|63&i)<<p[3&n++]);if(this.lastByteIndex=n,n>=a){for(this.start=n-a,this.block=s[u],n=0;n<u;++n)d[n]^=s[n];U(d),this.reset=!0}else this.start=n}return this},B.prototype.encode=function(e,t){var r=255&e,n=1,i=[r];for(r=255&(e>>=8);r>0;)i.unshift(r),r=255&(e>>=8),++n;return t?i.push(n):i.unshift(n),this.update(i),i.length},B.prototype.encodeString=function(e){var t,r=typeof e;if("string"!==r){if("object"!==r)throw new Error(o);if(null===e)throw new Error(o);if(l&&e.constructor===ArrayBuffer)e=new Uint8Array(e);else if(!(Array.isArray(e)||l&&ArrayBuffer.isView(e)))throw new Error(o);t=!0}var n=0,i=e.length;if(t)n=i;else for(var s=0;s<e.length;++s){var a=e.charCodeAt(s);a<128?n+=1:a<2048?n+=2:a<55296||a>=57344?n+=3:(a=65536+((1023&a)<<10|1023&e.charCodeAt(++s)),n+=4)}return n+=this.encode(8*n),this.update(e),n},B.prototype.bytepad=function(e,t){for(var r=this.encode(t),n=0;n<e.length;++n)r+=this.encodeString(e[n]);var i=t-r%t,o=[];return o.length=i,this.update(o),this},B.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var e=this.blocks,t=this.lastByteIndex,r=this.blockCount,n=this.s;if(e[t>>2]|=this.padding[3&t],this.lastByteIndex===this.byteCount)for(e[0]=e[r],t=1;t<r+1;++t)e[t]=0;for(e[r-1]|=2147483648,t=0;t<r;++t)n[t]^=e[t];U(n)}},B.prototype.toString=B.prototype.hex=function(){this.finalize();for(var e,t=this.blockCount,r=this.s,n=this.outputBlocks,i=this.extraBytes,o=0,s=0,a="";s<n;){for(o=0;o<t&&s<n;++o,++s)e=r[o],a+=d[e>>4&15]+d[15&e]+d[e>>12&15]+d[e>>8&15]+d[e>>20&15]+d[e>>16&15]+d[e>>28&15]+d[e>>24&15];s%t==0&&(U(r),o=0)}return i&&(e=r[o],a+=d[e>>4&15]+d[15&e],i>1&&(a+=d[e>>12&15]+d[e>>8&15]),i>2&&(a+=d[e>>20&15]+d[e>>16&15])),a},B.prototype.arrayBuffer=function(){this.finalize();var e,t=this.blockCount,r=this.s,n=this.outputBlocks,i=this.extraBytes,o=0,s=0,a=this.outputBits>>3;e=i?new ArrayBuffer(n+1<<2):new ArrayBuffer(a);for(var c=new Uint32Array(e);s<n;){for(o=0;o<t&&s<n;++o,++s)c[s]=r[o];s%t==0&&U(r)}return i&&(c[o]=r[o],e=e.slice(0,a)),e},B.prototype.buffer=B.prototype.arrayBuffer,B.prototype.digest=B.prototype.array=function(){this.finalize();for(var e,t,r=this.blockCount,n=this.s,i=this.outputBlocks,o=this.extraBytes,s=0,a=0,c=[];a<i;){for(s=0;s<r&&a<i;++s,++a)e=a<<2,t=n[s],c[e]=255&t,c[e+1]=t>>8&255,c[e+2]=t>>16&255,c[e+3]=t>>24&255;a%r==0&&U(n)}return o&&(e=a<<2,t=n[s],c[e]=255&t,o>1&&(c[e+1]=t>>8&255),o>2&&(c[e+2]=t>>16&255)),c},L.prototype=new B,L.prototype.finalize=function(){return this.encode(this.outputBits,!0),B.prototype.finalize.call(this)};var U=function(e){var t,r,n,i,o,s,a,c,u,h,l,d,f,p,y,b,m,w,v,S,_,E,I,A,k,x,P,O,R,T,N,M,C,B,L,U,D,j,z,q,$,K,F,W,H,V,G,Y,J,X,Z,Q,ee,te,re,ne,ie,oe,se,ae,ce,ue,he;for(n=0;n<48;n+=2)i=e[0]^e[10]^e[20]^e[30]^e[40],o=e[1]^e[11]^e[21]^e[31]^e[41],s=e[2]^e[12]^e[22]^e[32]^e[42],a=e[3]^e[13]^e[23]^e[33]^e[43],c=e[4]^e[14]^e[24]^e[34]^e[44],u=e[5]^e[15]^e[25]^e[35]^e[45],h=e[6]^e[16]^e[26]^e[36]^e[46],l=e[7]^e[17]^e[27]^e[37]^e[47],t=(d=e[8]^e[18]^e[28]^e[38]^e[48])^(s<<1|a>>>31),r=(f=e[9]^e[19]^e[29]^e[39]^e[49])^(a<<1|s>>>31),e[0]^=t,e[1]^=r,e[10]^=t,e[11]^=r,e[20]^=t,e[21]^=r,e[30]^=t,e[31]^=r,e[40]^=t,e[41]^=r,t=i^(c<<1|u>>>31),r=o^(u<<1|c>>>31),e[2]^=t,e[3]^=r,e[12]^=t,e[13]^=r,e[22]^=t,e[23]^=r,e[32]^=t,e[33]^=r,e[42]^=t,e[43]^=r,t=s^(h<<1|l>>>31),r=a^(l<<1|h>>>31),e[4]^=t,e[5]^=r,e[14]^=t,e[15]^=r,e[24]^=t,e[25]^=r,e[34]^=t,e[35]^=r,e[44]^=t,e[45]^=r,t=c^(d<<1|f>>>31),r=u^(f<<1|d>>>31),e[6]^=t,e[7]^=r,e[16]^=t,e[17]^=r,e[26]^=t,e[27]^=r,e[36]^=t,e[37]^=r,e[46]^=t,e[47]^=r,t=h^(i<<1|o>>>31),r=l^(o<<1|i>>>31),e[8]^=t,e[9]^=r,e[18]^=t,e[19]^=r,e[28]^=t,e[29]^=r,e[38]^=t,e[39]^=r,e[48]^=t,e[49]^=r,p=e[0],y=e[1],V=e[11]<<4|e[10]>>>28,G=e[10]<<4|e[11]>>>28,O=e[20]<<3|e[21]>>>29,R=e[21]<<3|e[20]>>>29,ae=e[31]<<9|e[30]>>>23,ce=e[30]<<9|e[31]>>>23,K=e[40]<<18|e[41]>>>14,F=e[41]<<18|e[40]>>>14,B=e[2]<<1|e[3]>>>31,L=e[3]<<1|e[2]>>>31,b=e[13]<<12|e[12]>>>20,m=e[12]<<12|e[13]>>>20,Y=e[22]<<10|e[23]>>>22,J=e[23]<<10|e[22]>>>22,T=e[33]<<13|e[32]>>>19,N=e[32]<<13|e[33]>>>19,ue=e[42]<<2|e[43]>>>30,he=e[43]<<2|e[42]>>>30,te=e[5]<<30|e[4]>>>2,re=e[4]<<30|e[5]>>>2,U=e[14]<<6|e[15]>>>26,D=e[15]<<6|e[14]>>>26,w=e[25]<<11|e[24]>>>21,v=e[24]<<11|e[25]>>>21,X=e[34]<<15|e[35]>>>17,Z=e[35]<<15|e[34]>>>17,M=e[45]<<29|e[44]>>>3,C=e[44]<<29|e[45]>>>3,A=e[6]<<28|e[7]>>>4,k=e[7]<<28|e[6]>>>4,ne=e[17]<<23|e[16]>>>9,ie=e[16]<<23|e[17]>>>9,j=e[26]<<25|e[27]>>>7,z=e[27]<<25|e[26]>>>7,S=e[36]<<21|e[37]>>>11,_=e[37]<<21|e[36]>>>11,Q=e[47]<<24|e[46]>>>8,ee=e[46]<<24|e[47]>>>8,W=e[8]<<27|e[9]>>>5,H=e[9]<<27|e[8]>>>5,x=e[18]<<20|e[19]>>>12,P=e[19]<<20|e[18]>>>12,oe=e[29]<<7|e[28]>>>25,se=e[28]<<7|e[29]>>>25,q=e[38]<<8|e[39]>>>24,$=e[39]<<8|e[38]>>>24,E=e[48]<<14|e[49]>>>18,I=e[49]<<14|e[48]>>>18,e[0]=p^~b&w,e[1]=y^~m&v,e[10]=A^~x&O,e[11]=k^~P&R,e[20]=B^~U&j,e[21]=L^~D&z,e[30]=W^~V&Y,e[31]=H^~G&J,e[40]=te^~ne&oe,e[41]=re^~ie&se,e[2]=b^~w&S,e[3]=m^~v&_,e[12]=x^~O&T,e[13]=P^~R&N,e[22]=U^~j&q,e[23]=D^~z&$,e[32]=V^~Y&X,e[33]=G^~J&Z,e[42]=ne^~oe&ae,e[43]=ie^~se&ce,e[4]=w^~S&E,e[5]=v^~_&I,e[14]=O^~T&M,e[15]=R^~N&C,e[24]=j^~q&K,e[25]=z^~$&F,e[34]=Y^~X&Q,e[35]=J^~Z&ee,e[44]=oe^~ae&ue,e[45]=se^~ce&he,e[6]=S^~E&p,e[7]=_^~I&y,e[16]=T^~M&A,e[17]=N^~C&k,e[26]=q^~K&B,e[27]=$^~F&L,e[36]=X^~Q&W,e[37]=Z^~ee&H,e[46]=ae^~ue&te,e[47]=ce^~he&re,e[8]=E^~p&b,e[9]=I^~y&m,e[18]=M^~A&x,e[19]=C^~k&P,e[28]=K^~B&U,e[29]=F^~L&D,e[38]=Q^~W&V,e[39]=ee^~H&G,e[48]=ue^~te&ne,e[49]=he^~re&ie,e[0]^=g[n],e[1]^=g[n+1]};if(u)e.exports=x;else{for(O=0;O<P.length;++O)a[P[O]]=x[P[O]];h&&(void 0===(n=function(){return x}.call(t,r,t,e))||(e.exports=n))}}()},3551:(e,t,r)=>{"use strict";var n=("undefined"!=typeof JSON?JSON:r(4709)).stringify,i=r(184),o=r(3735),s=r(1701),a=r(1581),c=a("Array.prototype.join"),u=a("Array.prototype.push"),h=function(e,t){for(var r="",n=0;n<e;n+=1)r+=t;return r},l=function(e,t,r){return r};e.exports=function(e){var t=arguments.length>1?arguments[1]:void 0,r=t&&t.space||"";"number"==typeof r&&(r=h(r," "));var a=!!t&&"boolean"==typeof t.cycles&&t.cycles,d=t&&t.replacer?s(t.replacer):l,f="function"==typeof t?t:t&&t.cmp,p=f&&function(e){var t=f.length>2&&function(t){return e[t]};return function(r,n){return f({key:r,value:e[r]},{key:n,value:e[n]},t?{__proto__:null,get:t}:void 0)}},g=[];return function e(t,s,l,f){var y=r?"\n"+h(f,r):"",b=r?": ":":";if(l&&l.toJSON&&"function"==typeof l.toJSON&&(l=l.toJSON()),void 0!==(l=d(t,s,l))){if("object"!=typeof l||null===l)return n(l);if(i(l)){for(var m=[],w=0;w<l.length;w++){var v=e(l,w,l[w],f+1)||n(null);u(m,y+r+v)}return"["+c(m,",")+y+"]"}if(-1!==g.indexOf(l)){if(a)return n("__cycle__");throw new TypeError("Converting circular structure to JSON")}u(g,l);var S=o(l).sort(p&&p(l));for(m=[],w=0;w<S.length;w++){var _=e(l,s=S[w],l[s],f+1);if(_){var E=n(s)+b+_;u(m,y+r+E)}}return g.splice(g.indexOf(l),1),"{"+c(m,",")+y+"}"}}({"":e},"",e,0)}},184:e=>{var t={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==t.call(e)}},4709:(e,t,r)=>{"use strict";t.parse=r(5842),t.stringify=r(2428)},5842:e=>{"use strict";var t,r,n,i={'"':'"',"\\":"\\","/":"/",b:"\b",f:"\f",n:"\n",r:"\r",t:"\t"};function o(e){throw{name:"SyntaxError",message:e,at:t,text:n}}function s(e){return e&&e!==r&&o("Expected '"+e+"' instead of '"+r+"'"),r=n.charAt(t),t+=1,r}function a(){var e,t="";for("-"===r&&(t="-",s("-"));r>="0"&&r<="9";)t+=r,s();if("."===r)for(t+=".";s()&&r>="0"&&r<="9";)t+=r;if("e"===r||"E"===r)for(t+=r,s(),"-"!==r&&"+"!==r||(t+=r,s());r>="0"&&r<="9";)t+=r,s();return e=Number(t),isFinite(e)||o("Bad number"),e}function c(){var e,t,n,a="";if('"'===r)for(;s();){if('"'===r)return s(),a;if("\\"===r)if(s(),"u"===r){for(n=0,t=0;t<4&&(e=parseInt(s(),16),isFinite(e));t+=1)n=16*n+e;a+=String.fromCharCode(n)}else{if("string"!=typeof i[r])break;a+=i[r]}else a+=r}o("Bad string")}function u(){for(;r&&r<=" ";)s()}function h(){switch(u(),r){case"{":return function(){var e,t={};if("{"===r){if(s("{"),u(),"}"===r)return s("}"),t;for(;r;){if(e=c(),u(),s(":"),Object.prototype.hasOwnProperty.call(t,e)&&o('Duplicate key "'+e+'"'),t[e]=h(),u(),"}"===r)return s("}"),t;s(","),u()}}o("Bad object")}();case"[":return function(){var e=[];if("["===r){if(s("["),u(),"]"===r)return s("]"),e;for(;r;){if(e.push(h()),u(),"]"===r)return s("]"),e;s(","),u()}}o("Bad array")}();case'"':return c();case"-":return a();default:return r>="0"&&r<="9"?a():function(){switch(r){case"t":return s("t"),s("r"),s("u"),s("e"),!0;case"f":return s("f"),s("a"),s("l"),s("s"),s("e"),!1;case"n":return s("n"),s("u"),s("l"),s("l"),null;default:o("Unexpected '"+r+"'")}}()}}e.exports=function(e,i){var s;return n=e,t=0,r=" ",s=h(),u(),r&&o("Syntax error"),"function"==typeof i?function e(t,r){var n,o,s=t[r];if(s&&"object"==typeof s)for(n in h)Object.prototype.hasOwnProperty.call(s,n)&&(void 0===(o=e(s,n))?delete s[n]:s[n]=o);return i.call(t,r,s)}({"":s},""):s}},2428:e=>{"use strict";var t,r,n,i=/[\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,o={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};function s(e){return i.lastIndex=0,i.test(e)?'"'+e.replace(i,(function(e){var t=o[e];return"string"==typeof t?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)}))+'"':'"'+e+'"'}function a(e,i){var o,c,u,h,l,d=t,f=i[e];switch(f&&"object"==typeof f&&"function"==typeof f.toJSON&&(f=f.toJSON(e)),"function"==typeof n&&(f=n.call(i,e,f)),typeof f){case"string":return s(f);case"number":return isFinite(f)?String(f):"null";case"boolean":case"null":return String(f);case"object":if(!f)return"null";if(t+=r,l=[],"[object Array]"===Object.prototype.toString.apply(f)){for(h=f.length,o=0;o<h;o+=1)l[o]=a(o,f)||"null";return u=0===l.length?"[]":t?"[\n"+t+l.join(",\n"+t)+"\n"+d+"]":"["+l.join(",")+"]",t=d,u}if(n&&"object"==typeof n)for(h=n.length,o=0;o<h;o+=1)"string"==typeof(c=n[o])&&(u=a(c,f))&&l.push(s(c)+(t?": ":":")+u);else for(c in f)Object.prototype.hasOwnProperty.call(f,c)&&(u=a(c,f))&&l.push(s(c)+(t?": ":":")+u);return u=0===l.length?"{}":t?"{\n"+t+l.join(",\n"+t)+"\n"+d+"}":"{"+l.join(",")+"}",t=d,u}}e.exports=function(e,i,o){var s;if(t="",r="","number"==typeof o)for(s=0;s<o;s+=1)r+=" ";else"string"==typeof o&&(r=o);if(n=i,i&&"function"!=typeof i&&("object"!=typeof i||"number"!=typeof i.length))throw new Error("JSON.stringify");return a("",{"":e})}},6780:(e,t,r)=>{e=r.nmd(e);var n="__lodash_hash_undefined__",i=1,o=2,s=9007199254740991,a="[object Arguments]",c="[object Array]",u="[object AsyncFunction]",h="[object Boolean]",l="[object Date]",d="[object Error]",f="[object Function]",p="[object GeneratorFunction]",g="[object Map]",y="[object Number]",b="[object Null]",m="[object Object]",w="[object Promise]",v="[object Proxy]",S="[object RegExp]",_="[object Set]",E="[object String]",I="[object Undefined]",A="[object WeakMap]",k="[object ArrayBuffer]",x="[object DataView]",P=/^\[object .+?Constructor\]$/,O=/^(?:0|[1-9]\d*)$/,R={};R["[object Float32Array]"]=R["[object Float64Array]"]=R["[object Int8Array]"]=R["[object Int16Array]"]=R["[object Int32Array]"]=R["[object Uint8Array]"]=R["[object Uint8ClampedArray]"]=R["[object Uint16Array]"]=R["[object Uint32Array]"]=!0,R[a]=R[c]=R[k]=R[h]=R[x]=R[l]=R[d]=R[f]=R[g]=R[y]=R[m]=R[S]=R[_]=R[E]=R[A]=!1;var T="object"==typeof r.g&&r.g&&r.g.Object===Object&&r.g,N="object"==typeof self&&self&&self.Object===Object&&self,M=T||N||Function("return this")(),C=t&&!t.nodeType&&t,B=C&&e&&!e.nodeType&&e,L=B&&B.exports===C,U=L&&T.process,D=function(){try{return U&&U.binding&&U.binding("util")}catch(e){}}(),j=D&&D.isTypedArray;function z(e,t){for(var r=-1,n=null==e?0:e.length;++r<n;)if(t(e[r],r,e))return!0;return!1}function q(e){var t=-1,r=Array(e.size);return e.forEach((function(e,n){r[++t]=[n,e]})),r}function $(e){var t=-1,r=Array(e.size);return e.forEach((function(e){r[++t]=e})),r}var K,F,W,H=Array.prototype,V=Function.prototype,G=Object.prototype,Y=M["__core-js_shared__"],J=V.toString,X=G.hasOwnProperty,Z=(K=/[^.]+$/.exec(Y&&Y.keys&&Y.keys.IE_PROTO||""))?"Symbol(src)_1."+K:"",Q=G.toString,ee=RegExp("^"+J.call(X).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),te=L?M.Buffer:void 0,re=M.Symbol,ne=M.Uint8Array,ie=G.propertyIsEnumerable,oe=H.splice,se=re?re.toStringTag:void 0,ae=Object.getOwnPropertySymbols,ce=te?te.isBuffer:void 0,ue=(F=Object.keys,W=Object,function(e){return F(W(e))}),he=Be(M,"DataView"),le=Be(M,"Map"),de=Be(M,"Promise"),fe=Be(M,"Set"),pe=Be(M,"WeakMap"),ge=Be(Object,"create"),ye=je(he),be=je(le),me=je(de),we=je(fe),ve=je(pe),Se=re?re.prototype:void 0,_e=Se?Se.valueOf:void 0;function Ee(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function Ie(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function Ae(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function ke(e){var t=-1,r=null==e?0:e.length;for(this.__data__=new Ae;++t<r;)this.add(e[t])}function xe(e){var t=this.__data__=new Ie(e);this.size=t.size}function Pe(e,t){for(var r=e.length;r--;)if(ze(e[r][0],t))return r;return-1}function Oe(e){return null==e?void 0===e?I:b:se&&se in Object(e)?function(e){var t=X.call(e,se),r=e[se];try{e[se]=void 0;var n=!0}catch(e){}var i=Q.call(e);return n&&(t?e[se]=r:delete e[se]),i}(e):function(e){return Q.call(e)}(e)}function Re(e){return Ve(e)&&Oe(e)==a}function Te(e,t,r,n,s){return e===t||(null==e||null==t||!Ve(e)&&!Ve(t)?e!=e&&t!=t:function(e,t,r,n,s,u){var f=$e(e),p=$e(t),b=f?c:Ue(e),w=p?c:Ue(t),v=(b=b==a?m:b)==m,I=(w=w==a?m:w)==m,A=b==w;if(A&&Ke(e)){if(!Ke(t))return!1;f=!0,v=!1}if(A&&!v)return u||(u=new xe),f||Ge(e)?Ne(e,t,r,n,s,u):function(e,t,r,n,s,a,c){switch(r){case x:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case k:return!(e.byteLength!=t.byteLength||!a(new ne(e),new ne(t)));case h:case l:case y:return ze(+e,+t);case d:return e.name==t.name&&e.message==t.message;case S:case E:return e==t+"";case g:var u=q;case _:var f=n&i;if(u||(u=$),e.size!=t.size&&!f)return!1;var p=c.get(e);if(p)return p==t;n|=o,c.set(e,t);var b=Ne(u(e),u(t),n,s,a,c);return c.delete(e),b;case"[object Symbol]":if(_e)return _e.call(e)==_e.call(t)}return!1}(e,t,b,r,n,s,u);if(!(r&i)){var P=v&&X.call(e,"__wrapped__"),O=I&&X.call(t,"__wrapped__");if(P||O){var R=P?e.value():e,T=O?t.value():t;return u||(u=new xe),s(R,T,r,n,u)}}return!!A&&(u||(u=new xe),function(e,t,r,n,o,s){var a=r&i,c=Me(e),u=c.length;if(u!=Me(t).length&&!a)return!1;for(var h=u;h--;){var l=c[h];if(!(a?l in t:X.call(t,l)))return!1}var d=s.get(e);if(d&&s.get(t))return d==t;var f=!0;s.set(e,t),s.set(t,e);for(var p=a;++h<u;){var g=e[l=c[h]],y=t[l];if(n)var b=a?n(y,g,l,t,e,s):n(g,y,l,e,t,s);if(!(void 0===b?g===y||o(g,y,r,n,s):b)){f=!1;break}p||(p="constructor"==l)}if(f&&!p){var m=e.constructor,w=t.constructor;m==w||!("constructor"in e)||!("constructor"in t)||"function"==typeof m&&m instanceof m&&"function"==typeof w&&w instanceof w||(f=!1)}return s.delete(e),s.delete(t),f}(e,t,r,n,s,u))}(e,t,r,n,Te,s))}function Ne(e,t,r,n,s,a){var c=r&i,u=e.length,h=t.length;if(u!=h&&!(c&&h>u))return!1;var l=a.get(e);if(l&&a.get(t))return l==t;var d=-1,f=!0,p=r&o?new ke:void 0;for(a.set(e,t),a.set(t,e);++d<u;){var g=e[d],y=t[d];if(n)var b=c?n(y,g,d,t,e,a):n(g,y,d,e,t,a);if(void 0!==b){if(b)continue;f=!1;break}if(p){if(!z(t,(function(e,t){if(i=t,!p.has(i)&&(g===e||s(g,e,r,n,a)))return p.push(t);var i}))){f=!1;break}}else if(g!==y&&!s(g,y,r,n,a)){f=!1;break}}return a.delete(e),a.delete(t),f}function Me(e){return function(e,t,r){var n=t(e);return $e(e)?n:function(e,t){for(var r=-1,n=t.length,i=e.length;++r<n;)e[i+r]=t[r];return e}(n,r(e))}(e,Ye,Le)}function Ce(e,t){var r,n,i=e.__data__;return("string"==(n=typeof(r=t))||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==r:null===r)?i["string"==typeof t?"string":"hash"]:i.map}function Be(e,t){var r=function(e,t){return null==e?void 0:e[t]}(e,t);return function(e){return!(!He(e)||function(e){return!!Z&&Z in e}(e))&&(Fe(e)?ee:P).test(je(e))}(r)?r:void 0}Ee.prototype.clear=function(){this.__data__=ge?ge(null):{},this.size=0},Ee.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},Ee.prototype.get=function(e){var t=this.__data__;if(ge){var r=t[e];return r===n?void 0:r}return X.call(t,e)?t[e]:void 0},Ee.prototype.has=function(e){var t=this.__data__;return ge?void 0!==t[e]:X.call(t,e)},Ee.prototype.set=function(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=ge&&void 0===t?n:t,this},Ie.prototype.clear=function(){this.__data__=[],this.size=0},Ie.prototype.delete=function(e){var t=this.__data__,r=Pe(t,e);return!(r<0||(r==t.length-1?t.pop():oe.call(t,r,1),--this.size,0))},Ie.prototype.get=function(e){var t=this.__data__,r=Pe(t,e);return r<0?void 0:t[r][1]},Ie.prototype.has=function(e){return Pe(this.__data__,e)>-1},Ie.prototype.set=function(e,t){var r=this.__data__,n=Pe(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this},Ae.prototype.clear=function(){this.size=0,this.__data__={hash:new Ee,map:new(le||Ie),string:new Ee}},Ae.prototype.delete=function(e){var t=Ce(this,e).delete(e);return this.size-=t?1:0,t},Ae.prototype.get=function(e){return Ce(this,e).get(e)},Ae.prototype.has=function(e){return Ce(this,e).has(e)},Ae.prototype.set=function(e,t){var r=Ce(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this},ke.prototype.add=ke.prototype.push=function(e){return this.__data__.set(e,n),this},ke.prototype.has=function(e){return this.__data__.has(e)},xe.prototype.clear=function(){this.__data__=new Ie,this.size=0},xe.prototype.delete=function(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r},xe.prototype.get=function(e){return this.__data__.get(e)},xe.prototype.has=function(e){return this.__data__.has(e)},xe.prototype.set=function(e,t){var r=this.__data__;if(r instanceof Ie){var n=r.__data__;if(!le||n.length<199)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new Ae(n)}return r.set(e,t),this.size=r.size,this};var Le=ae?function(e){return null==e?[]:(e=Object(e),function(t){for(var r=-1,n=null==t?0:t.length,i=0,o=[];++r<n;){var s=t[r];a=s,ie.call(e,a)&&(o[i++]=s)}var a;return o}(ae(e)))}:function(){return[]},Ue=Oe;function De(e,t){return!!(t=null==t?s:t)&&("number"==typeof e||O.test(e))&&e>-1&&e%1==0&&e<t}function je(e){if(null!=e){try{return J.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function ze(e,t){return e===t||e!=e&&t!=t}(he&&Ue(new he(new ArrayBuffer(1)))!=x||le&&Ue(new le)!=g||de&&Ue(de.resolve())!=w||fe&&Ue(new fe)!=_||pe&&Ue(new pe)!=A)&&(Ue=function(e){var t=Oe(e),r=t==m?e.constructor:void 0,n=r?je(r):"";if(n)switch(n){case ye:return x;case be:return g;case me:return w;case we:return _;case ve:return A}return t});var qe=Re(function(){return arguments}())?Re:function(e){return Ve(e)&&X.call(e,"callee")&&!ie.call(e,"callee")},$e=Array.isArray,Ke=ce||function(){return!1};function Fe(e){if(!He(e))return!1;var t=Oe(e);return t==f||t==p||t==u||t==v}function We(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=s}function He(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function Ve(e){return null!=e&&"object"==typeof e}var Ge=j?function(e){return function(t){return e(t)}}(j):function(e){return Ve(e)&&We(e.length)&&!!R[Oe(e)]};function Ye(e){return null!=(t=e)&&We(t.length)&&!Fe(t)?function(e,t){var r=$e(e),n=!r&&qe(e),i=!r&&!n&&Ke(e),o=!r&&!n&&!i&&Ge(e),s=r||n||i||o,a=s?function(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}(e.length,String):[],c=a.length;for(var u in e)!t&&!X.call(e,u)||s&&("length"==u||i&&("offset"==u||"parent"==u)||o&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||De(u,c))||a.push(u);return a}(e):function(e){if(r=(t=e)&&t.constructor,t!==("function"==typeof r&&r.prototype||G))return ue(e);var t,r,n=[];for(var i in Object(e))X.call(e,i)&&"constructor"!=i&&n.push(i);return n}(e);var t}e.exports=function(e,t){return Te(e,t)}},4367:function(e,t,r){var n,i;!function(){"use strict";n=function(){var e=function(){},t="undefined",r=typeof window!==t&&typeof window.navigator!==t&&/Trident\/|MSIE /.test(window.navigator.userAgent),n=["trace","debug","info","warn","error"],i={},o=null;function s(e,t){var r=e[t];if("function"==typeof r.bind)return r.bind(e);try{return Function.prototype.bind.call(r,e)}catch(t){return function(){return Function.prototype.apply.apply(r,[e,arguments])}}}function a(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function c(){for(var r=this.getLevel(),i=0;i<n.length;i++){var o=n[i];this[o]=i<r?e:this.methodFactory(o,r,this.name)}if(this.log=this.debug,typeof console===t&&r<this.levels.SILENT)return"No console available for logging"}function u(e){return function(){typeof console!==t&&(c.call(this),this[e].apply(this,arguments))}}function h(n,i,o){return function(n){return"debug"===n&&(n="log"),typeof console!==t&&("trace"===n&&r?a:void 0!==console[n]?s(console,n):void 0!==console.log?s(console,"log"):e)}(n)||u.apply(this,arguments)}function l(e,r){var s,a,u,l=this,d="loglevel";function f(){var e;if(typeof window!==t&&d){try{e=window.localStorage[d]}catch(e){}if(typeof e===t)try{var r=window.document.cookie,n=encodeURIComponent(d),i=r.indexOf(n+"=");-1!==i&&(e=/^([^;]+)/.exec(r.slice(i+n.length+1))[1])}catch(e){}return void 0===l.levels[e]&&(e=void 0),e}}function p(e){var t=e;if("string"==typeof t&&void 0!==l.levels[t.toUpperCase()]&&(t=l.levels[t.toUpperCase()]),"number"==typeof t&&t>=0&&t<=l.levels.SILENT)return t;throw new TypeError("log.setLevel() called with invalid level: "+e)}"string"==typeof e?d+=":"+e:"symbol"==typeof e&&(d=void 0),l.name=e,l.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},l.methodFactory=r||h,l.getLevel=function(){return null!=u?u:null!=a?a:s},l.setLevel=function(e,r){return u=p(e),!1!==r&&function(e){var r=(n[e]||"silent").toUpperCase();if(typeof window!==t&&d){try{return void(window.localStorage[d]=r)}catch(e){}try{window.document.cookie=encodeURIComponent(d)+"="+r+";"}catch(e){}}}(u),c.call(l)},l.setDefaultLevel=function(e){a=p(e),f()||l.setLevel(e,!1)},l.resetLevel=function(){u=null,function(){if(typeof window!==t&&d){try{window.localStorage.removeItem(d)}catch(e){}try{window.document.cookie=encodeURIComponent(d)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch(e){}}}(),c.call(l)},l.enableAll=function(e){l.setLevel(l.levels.TRACE,e)},l.disableAll=function(e){l.setLevel(l.levels.SILENT,e)},l.rebuild=function(){if(o!==l&&(s=p(o.getLevel())),c.call(l),o===l)for(var e in i)i[e].rebuild()},s=p(o?o.getLevel():"WARN");var g=f();null!=g&&(u=p(g)),c.call(l)}(o=new l).getLogger=function(e){if("symbol"!=typeof e&&"string"!=typeof e||""===e)throw new TypeError("You must supply a name when creating a logger.");var t=i[e];return t||(t=i[e]=new l(e,o.methodFactory)),t};var d=typeof window!==t?window.log:void 0;return o.noConflict=function(){return typeof window!==t&&window.log===o&&(window.log=d),o},o.getLoggers=function(){return i},o.default=o,o},void 0===(i=n.call(t,r,t,e))||(e.exports=i)}()},4263:e=>{function t(e,t){if(!e)throw new Error(t||"Assertion failed")}e.exports=t,t.equal=function(e,t,r){if(e!=t)throw new Error(r||"Assertion failed: "+e+" != "+t)}},1901:(e,t)=>{"use strict";var r=t;function n(e){return 1===e.length?"0"+e:e}function i(e){for(var t="",r=0;r<e.length;r++)t+=n(e[r].toString(16));return t}r.toArray=function(e,t){if(Array.isArray(e))return e.slice();if(!e)return[];var r=[];if("string"!=typeof e){for(var n=0;n<e.length;n++)r[n]=0|e[n];return r}if("hex"===t)for((e=e.replace(/[^a-z0-9]+/gi,"")).length%2!=0&&(e="0"+e),n=0;n<e.length;n+=2)r.push(parseInt(e[n]+e[n+1],16));else for(n=0;n<e.length;n++){var i=e.charCodeAt(n),o=i>>8,s=255&i;o?r.push(o,s):r.push(s)}return r},r.zero2=n,r.toHex=i,r.encode=function(e,t){return"hex"===t?i(e):e}},1385:(e,t,r)=>{"use strict";var n;if(!Object.keys){var i=Object.prototype.hasOwnProperty,o=Object.prototype.toString,s=r(6199),a=Object.prototype.propertyIsEnumerable,c=!a.call({toString:null},"toString"),u=a.call((function(){}),"prototype"),h=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],l=function(e){var t=e.constructor;return t&&t.prototype===e},d={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$onmozfullscreenchange:!0,$onmozfullscreenerror:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},f=function(){if("undefined"==typeof window)return!1;for(var e in window)try{if(!d["$"+e]&&i.call(window,e)&&null!==window[e]&&"object"==typeof window[e])try{l(window[e])}catch(e){return!0}}catch(e){return!0}return!1}();n=function(e){var t=null!==e&&"object"==typeof e,r="[object Function]"===o.call(e),n=s(e),a=t&&"[object String]"===o.call(e),d=[];if(!t&&!r&&!n)throw new TypeError("Object.keys called on a non-object");var p=u&&r;if(a&&e.length>0&&!i.call(e,0))for(var g=0;g<e.length;++g)d.push(String(g));if(n&&e.length>0)for(var y=0;y<e.length;++y)d.push(String(y));else for(var b in e)p&&"prototype"===b||!i.call(e,b)||d.push(String(b));if(c)for(var m=function(e){if("undefined"==typeof window||!f)return l(e);try{return l(e)}catch(e){return!1}}(e),w=0;w<h.length;++w)m&&"constructor"===h[w]||!i.call(e,h[w])||d.push(h[w]);return d}}e.exports=n},3735:(e,t,r)=>{"use strict";var n=Array.prototype.slice,i=r(6199),o=Object.keys,s=o?function(e){return o(e)}:r(1385),a=Object.keys;s.shim=function(){if(Object.keys){var e=function(){var e=Object.keys(arguments);return e&&e.length===arguments.length}(1,2);e||(Object.keys=function(e){return i(e)?a(n.call(e)):a(e)})}else Object.keys=s;return Object.keys||s},e.exports=s},6199:e=>{"use strict";var t=Object.prototype.toString;e.exports=function(e){var r=t.call(e),n="[object Arguments]"===r;return n||(n="[object Array]"!==r&&null!==e&&"object"==typeof e&&"number"==typeof e.length&&e.length>=0&&"[object Function]"===t.call(e.callee)),n}},3184:e=>{var t,r,n=e.exports={};function i(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function s(e){if(t===setTimeout)return setTimeout(e,0);if((t===i||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(r){try{return t.call(null,e,0)}catch(r){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:i}catch(e){t=i}try{r="function"==typeof clearTimeout?clearTimeout:o}catch(e){r=o}}();var a,c=[],u=!1,h=-1;function l(){u&&a&&(u=!1,a.length?c=a.concat(c):h=-1,c.length&&d())}function d(){if(!u){var e=s(l);u=!0;for(var t=c.length;t;){for(a=c,c=[];++h<t;)a&&a[h].run();h=-1,t=c.length}a=null,u=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===o||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{return r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function f(e,t){this.fun=e,this.array=t}function p(){}n.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];c.push(new f(e,t)),1!==c.length||u||s(d)},f.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.browser=!0,n.env={},n.argv=[],n.version="",n.versions={},n.on=p,n.addListener=p,n.once=p,n.off=p,n.removeListener=p,n.removeAllListeners=p,n.emit=p,n.prependListener=p,n.prependOnceListener=p,n.listeners=function(e){return[]},n.binding=function(e){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(e){throw new Error("process.chdir is not supported")},n.umask=function(){return 0}},6135:e=>{"use strict";function t(e){try{return JSON.stringify(e)}catch(e){return'"[Circular]"'}}e.exports=function(e,r,n){var i=n&&n.stringify||t;if("object"==typeof e&&null!==e){var o=r.length+1;if(1===o)return e;var s=new Array(o);s[0]=i(e);for(var a=1;a<o;a++)s[a]=i(r[a]);return s.join(" ")}if("string"!=typeof e)return e;var c=r.length;if(0===c)return e;for(var u="",h=0,l=-1,d=e&&e.length||0,f=0;f<d;){if(37===e.charCodeAt(f)&&f+1<d){switch(l=l>-1?l:0,e.charCodeAt(f+1)){case 100:case 102:if(h>=c)break;if(null==r[h])break;l<f&&(u+=e.slice(l,f)),u+=Number(r[h]),l=f+2,f++;break;case 105:if(h>=c)break;if(null==r[h])break;l<f&&(u+=e.slice(l,f)),u+=Math.floor(Number(r[h])),l=f+2,f++;break;case 79:case 111:case 106:if(h>=c)break;if(void 0===r[h])break;l<f&&(u+=e.slice(l,f));var p=typeof r[h];if("string"===p){u+="'"+r[h]+"'",l=f+2,f++;break}if("function"===p){u+=r[h].name||"<anonymous>",l=f+2,f++;break}u+=i(r[h]),l=f+2,f++;break;case 115:if(h>=c)break;l<f&&(u+=e.slice(l,f)),u+=String(r[h]),l=f+2,f++;break;case 37:l<f&&(u+=e.slice(l,f)),u+="%",l=f+2,f++,h--}++h}++f}return-1===l?e:(l<d&&(u+=e.slice(l)),u)}},5719:(e,t,r)=>{var n=r(1429),i=n.Buffer;function o(e,t){for(var r in e)t[r]=e[r]}function s(e,t,r){return i(e,t,r)}i.from&&i.alloc&&i.allocUnsafe&&i.allocUnsafeSlow?e.exports=n:(o(n,t),t.Buffer=s),s.prototype=Object.create(i.prototype),o(i,s),s.from=function(e,t,r){if("number"==typeof e)throw new TypeError("Argument must not be a number");return i(e,t,r)},s.alloc=function(e,t,r){if("number"!=typeof e)throw new TypeError("Argument must be a number");var n=i(e);return void 0!==t?"string"==typeof r?n.fill(t,r):n.fill(t):n.fill(0),n},s.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return i(e)},s.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return n.SlowBuffer(e)}},8187:(e,t,r)=>{"use strict";var n=r(4295),i=r(75),o=r(9118)(),s=r(1233),a=r(6757),c=n("%Math.floor%");e.exports=function(e,t){if("function"!=typeof e)throw new a("`fn` is not a function");if("number"!=typeof t||t<0||t>4294967295||c(t)!==t)throw new a("`length` must be a positive 32-bit integer");var r=arguments.length>2&&!!arguments[2],n=!0,u=!0;if("length"in e&&s){var h=s(e,"length");h&&!h.configurable&&(n=!1),h&&!h.writable&&(u=!1)}return(n||u||!r)&&(o?i(e,"length",t,!0,!0):i(e,"length",t)),e}},5215:(e,t)=>{"use strict";function r(e,t,r){return t<=e&&e<=r}function n(e){if(void 0===e)return{};if(e===Object(e))return e;throw TypeError("Could not convert argument to dictionary")}function i(e){this.tokens=[].slice.call(e)}i.prototype={endOfStream:function(){return!this.tokens.length},read:function(){return this.tokens.length?this.tokens.shift():-1},prepend:function(e){if(Array.isArray(e))for(var t=e;t.length;)this.tokens.unshift(t.pop());else this.tokens.unshift(e)},push:function(e){if(Array.isArray(e))for(var t=e;t.length;)this.tokens.push(t.shift());else this.tokens.push(e)}};var o=-1;function s(e,t){if(e)throw TypeError("Decoder error");return t||65533}var a="utf-8";function c(e,t){if(!(this instanceof c))return new c(e,t);if((e=void 0!==e?String(e).toLowerCase():a)!==a)throw new Error("Encoding not supported. Only utf-8 is supported");t=n(t),this._streaming=!1,this._BOMseen=!1,this._decoder=null,this._fatal=Boolean(t.fatal),this._ignoreBOM=Boolean(t.ignoreBOM),Object.defineProperty(this,"encoding",{value:"utf-8"}),Object.defineProperty(this,"fatal",{value:this._fatal}),Object.defineProperty(this,"ignoreBOM",{value:this._ignoreBOM})}function u(e,t){if(!(this instanceof u))return new u(e,t);if((e=void 0!==e?String(e).toLowerCase():a)!==a)throw new Error("Encoding not supported. Only utf-8 is supported");t=n(t),this._streaming=!1,this._encoder=null,this._options={fatal:Boolean(t.fatal)},Object.defineProperty(this,"encoding",{value:"utf-8"})}function h(e){var t=e.fatal,n=0,i=0,a=0,c=128,u=191;this.handler=function(e,h){if(-1===h&&0!==a)return a=0,s(t);if(-1===h)return o;if(0===a){if(r(h,0,127))return h;if(r(h,194,223))a=1,n=h-192;else if(r(h,224,239))224===h&&(c=160),237===h&&(u=159),a=2,n=h-224;else{if(!r(h,240,244))return s(t);240===h&&(c=144),244===h&&(u=143),a=3,n=h-240}return n<<=6*a,null}if(!r(h,c,u))return n=a=i=0,c=128,u=191,e.prepend(h),s(t);if(c=128,u=191,n+=h-128<<6*(a-(i+=1)),i!==a)return null;var l=n;return n=a=i=0,l}}function l(e){e.fatal,this.handler=function(e,t){if(-1===t)return o;if(r(t,0,127))return t;var n,i;r(t,128,2047)?(n=1,i=192):r(t,2048,65535)?(n=2,i=224):r(t,65536,1114111)&&(n=3,i=240);for(var s=[(t>>6*n)+i];n>0;){var a=t>>6*(n-1);s.push(128|63&a),n-=1}return s}}c.prototype={decode:function(e,t){var r;r="object"==typeof e&&e instanceof ArrayBuffer?new Uint8Array(e):"object"==typeof e&&"buffer"in e&&e.buffer instanceof ArrayBuffer?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(0),t=n(t),this._streaming||(this._decoder=new h({fatal:this._fatal}),this._BOMseen=!1),this._streaming=Boolean(t.stream);for(var s,a=new i(r),c=[];!a.endOfStream()&&(s=this._decoder.handler(a,a.read()))!==o;)null!==s&&(Array.isArray(s)?c.push.apply(c,s):c.push(s));if(!this._streaming){do{if((s=this._decoder.handler(a,a.read()))===o)break;null!==s&&(Array.isArray(s)?c.push.apply(c,s):c.push(s))}while(!a.endOfStream());this._decoder=null}return c.length&&(-1===["utf-8"].indexOf(this.encoding)||this._ignoreBOM||this._BOMseen||(65279===c[0]?(this._BOMseen=!0,c.shift()):this._BOMseen=!0)),function(e){for(var t="",r=0;r<e.length;++r){var n=e[r];n<=65535?t+=String.fromCharCode(n):(n-=65536,t+=String.fromCharCode(55296+(n>>10),56320+(1023&n)))}return t}(c)}},u.prototype={encode:function(e,t){e=e?String(e):"",t=n(t),this._streaming||(this._encoder=new l(this._options)),this._streaming=Boolean(t.stream);for(var r,s=[],a=new i(function(e){for(var t=String(e),r=t.length,n=0,i=[];n<r;){var o=t.charCodeAt(n);if(o<55296||o>57343)i.push(o);else if(56320<=o&&o<=57343)i.push(65533);else if(55296<=o&&o<=56319)if(n===r-1)i.push(65533);else{var s=e.charCodeAt(n+1);if(56320<=s&&s<=57343){var a=1023&o,c=1023&s;i.push(65536+(a<<10)+c),n+=1}else i.push(65533)}n+=1}return i}(e));!a.endOfStream()&&(r=this._encoder.handler(a,a.read()))!==o;)Array.isArray(r)?s.push.apply(s,r):s.push(r);if(!this._streaming){for(;(r=this._encoder.handler(a,a.read()))!==o;)Array.isArray(r)?s.push.apply(s,r):s.push(r);this._encoder=null}return new Uint8Array(s)}},t.TextEncoder=u,t.TextDecoder=c},753:e=>{"use strict";e.exports=function(){throw new Error("ws does not work in the browser. Browser clients must use the native WebSocket object")}},1040:()=>{},4654:()=>{},1318:(e,t,r)=>{"use strict";const n=r(6135);e.exports=s;const i=function(){function e(e){return void 0!==e&&e}try{return"undefined"!=typeof globalThis||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch(t){return e(self)||e(window)||e(this)||{}}}().console||{},o={mapHttpRequest:d,mapHttpResponse:d,wrapRequestSerializer:f,wrapResponseSerializer:f,wrapErrorSerializer:f,req:d,res:d,err:function(e){const t={type:e.constructor.name,msg:e.message,stack:e.stack};for(const r in e)void 0===t[r]&&(t[r]=e[r]);return t}};function s(e){(e=e||{}).browser=e.browser||{};const t=e.browser.transmit;if(t&&"function"!=typeof t.send)throw Error("pino: transmit option must have a send function");const r=e.browser.write||i;e.browser.write&&(e.browser.asObject=!0);const n=e.serializers||{},o=function(e,t){return Array.isArray(e)?e.filter((function(e){return"!stdSerializers.err"!==e})):!0===e&&Object.keys(t)}(e.browser.serialize,n);let d=e.browser.serialize;Array.isArray(e.browser.serialize)&&e.browser.serialize.indexOf("!stdSerializers.err")>-1&&(d=!1),"function"==typeof r&&(r.error=r.fatal=r.warn=r.info=r.debug=r.trace=r),!1===e.enabled&&(e.level="silent");const f=e.level||"info",g=Object.create(r);g.log||(g.log=p),Object.defineProperty(g,"levelVal",{get:function(){return"silent"===this.level?1/0:this.levels.values[this.level]}}),Object.defineProperty(g,"level",{get:function(){return this._level},set:function(e){if("silent"!==e&&!this.levels.values[e])throw Error("unknown level "+e);this._level=e,a(y,g,"error","log"),a(y,g,"fatal","error"),a(y,g,"warn","error"),a(y,g,"info","log"),a(y,g,"debug","log"),a(y,g,"trace","log")}});const y={transmit:t,serialize:o,asObject:e.browser.asObject,levels:["error","fatal","warn","info","debug","trace"],timestamp:l(e)};return g.levels=s.levels,g.level=f,g.setMaxListeners=g.getMaxListeners=g.emit=g.addListener=g.on=g.prependListener=g.once=g.prependOnceListener=g.removeListener=g.removeAllListeners=g.listeners=g.listenerCount=g.eventNames=g.write=g.flush=p,g.serializers=n,g._serialize=o,g._stdErrSerialize=d,g.child=function(r,i){if(!r)throw new Error("missing bindings for child Pino");i=i||{},o&&r.serializers&&(i.serializers=r.serializers);const s=i.serializers;if(o&&s){var a=Object.assign({},n,s),l=!0===e.browser.serialize?Object.keys(a):o;delete r.serializers,c([r],l,a,this._stdErrSerialize)}function d(e){this._childLevel=1+(0|e._childLevel),this.error=u(e,r,"error"),this.fatal=u(e,r,"fatal"),this.warn=u(e,r,"warn"),this.info=u(e,r,"info"),this.debug=u(e,r,"debug"),this.trace=u(e,r,"trace"),a&&(this.serializers=a,this._serialize=l),t&&(this._logEvent=h([].concat(e._logEvent.bindings,r)))}return d.prototype=this,new d(this)},t&&(g._logEvent=h()),g}function a(e,t,r,o){const a=Object.getPrototypeOf(t);t[r]=t.levelVal>t.levels.values[r]?p:a[r]?a[r]:i[r]||i[o]||p,function(e,t,r){var o;(e.transmit||t[r]!==p)&&(t[r]=(o=t[r],function(){const a=e.timestamp(),u=new Array(arguments.length),l=Object.getPrototypeOf&&Object.getPrototypeOf(this)===i?i:this;for(var d=0;d<u.length;d++)u[d]=arguments[d];if(e.serialize&&!e.asObject&&c(u,this._serialize,this.serializers,this._stdErrSerialize),e.asObject?o.call(l,function(e,t,r,i){e._serialize&&c(r,e._serialize,e.serializers,e._stdErrSerialize);const o=r.slice();let a=o[0];const u={};i&&(u.time=i),u.level=s.levels.values[t];let h=1+(0|e._childLevel);if(h<1&&(h=1),null!==a&&"object"==typeof a){for(;h--&&"object"==typeof o[0];)Object.assign(u,o.shift());a=o.length?n(o.shift(),o):void 0}else"string"==typeof a&&(a=n(o.shift(),o));return void 0!==a&&(u.msg=a),u}(this,r,u,a)):o.apply(l,u),e.transmit){const n=e.transmit.level||t.level,i=s.levels.values[n],o=s.levels.values[r];if(o<i)return;!function(e,t,r){const n=t.send,i=t.ts,o=t.methodLevel,s=t.methodValue,a=t.val,u=e._logEvent.bindings;c(r,e._serialize||Object.keys(e.serializers),e.serializers,void 0===e._stdErrSerialize||e._stdErrSerialize),e._logEvent.ts=i,e._logEvent.messages=r.filter((function(e){return-1===u.indexOf(e)})),e._logEvent.level.label=o,e._logEvent.level.value=s,n(o,e._logEvent,a),e._logEvent=h(u)}(this,{ts:a,methodLevel:r,methodValue:o,transmitLevel:n,transmitValue:s.levels.values[e.transmit.level||t.level],send:e.transmit.send,val:t.levelVal},u)}}))}(e,t,r)}function c(e,t,r,n){for(const i in e)if(n&&e[i]instanceof Error)e[i]=s.stdSerializers.err(e[i]);else if("object"==typeof e[i]&&!Array.isArray(e[i]))for(const n in e[i])t&&t.indexOf(n)>-1&&n in r&&(e[i][n]=r[n](e[i][n]))}function u(e,t,r){return function(){const n=new Array(1+arguments.length);n[0]=t;for(var i=1;i<n.length;i++)n[i]=arguments[i-1];return e[r].apply(this,n)}}function h(e){return{ts:0,messages:[],bindings:e||[],level:{label:"",value:0}}}function l(e){return"function"==typeof e.timestamp?e.timestamp:!1===e.timestamp?g:y}function d(){return{}}function f(e){return e}function p(){}function g(){return!1}function y(){return Date.now()}s.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},s.stdSerializers=o,s.stdTimeFunctions=Object.assign({},{nullTime:g,epochTime:y,unixTime:function(){return Math.round(Date.now()/1e3)},isoTime:function(){return new Date(Date.now()).toISOString()}})},7142:e=>{"use strict";e.exports={rE:"6.6.1"}}},t={};function r(n){var i=t[n];if(void 0!==i)return i.exports;var o=t[n]={id:n,loaded:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.loaded=!0,o.exports}r.amdO={},r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.nmd=e=>(e.paths=[],e.children||(e.children=[]),e);var n={};return(()=>{"use strict";r.r(n),r.d(n,{getDefaultExternalAdapters:()=>Qb,getInjectedAdapters:()=>Zb});var e={};r.r(e),r.d(e,{identity:()=>Bs});var t={};r.r(t),r.d(t,{base2:()=>Ls});var i={};r.r(i),r.d(i,{base8:()=>Us});var o={};r.r(o),r.d(o,{base10:()=>Ds});var s={};r.r(s),r.d(s,{base16:()=>js,base16upper:()=>zs});var a={};r.r(a),r.d(a,{base32:()=>qs,base32hex:()=>Ws,base32hexpad:()=>Vs,base32hexpadupper:()=>Gs,base32hexupper:()=>Hs,base32pad:()=>Ks,base32padupper:()=>Fs,base32upper:()=>$s,base32z:()=>Ys});var c={};r.r(c),r.d(c,{base36:()=>Js,base36upper:()=>Xs});var u={};r.r(u),r.d(u,{base58btc:()=>Zs,base58flickr:()=>Qs});var h={};r.r(h),r.d(h,{base64:()=>ea,base64pad:()=>ta,base64url:()=>ra,base64urlpad:()=>na});var l={};r.r(l),r.d(l,{base256emoji:()=>aa});var d={};r.r(d),r.d(d,{sha256:()=>Oa,sha512:()=>Ra});var f={};r.r(f),r.d(f,{identity:()=>Na});var p={};r.r(p),r.d(p,{code:()=>Ca,decode:()=>La,encode:()=>Ba,name:()=>Ma});var g={};function y(e){return y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},y(e)}function b(e,t,r){return(t=function(e){var t=function(e){if("object"!=y(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=y(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==y(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function m(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function w(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?m(Object(r),!0).forEach((function(t){b(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):m(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}r.r(g),r.d(g,{code:()=>za,decode:()=>$a,encode:()=>qa,name:()=>ja});const v={EIP155:"eip155",SOLANA:"solana",CASPER:"casper",XRPL:"xrpl",OTHER:"other"};var S,_=(S=function(e,t){return S=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},S(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}S(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),E=function(e){function t(t,r){var n,i,o,s=this.constructor,a=e.call(this,t,r)||this;return Object.defineProperty(a,"name",{value:s.name,enumerable:!1,configurable:!0}),n=a,i=s.prototype,(o=Object.setPrototypeOf)?o(n,i):n.__proto__=i,function(e,t){void 0===t&&(t=e.constructor);var r=Error.captureStackTrace;r&&r(e,t)}(a),a}return _(t,e),t}(Error);function I(e){const t=e.findIndex((e=>e instanceof Error)),r=e.findIndex((e=>"string"==typeof e)),n=e.findIndex((e=>e&&"object"==typeof e&&"status"in e&&"type"in e));let i;if(-1!==n){const t=e[n];i=new Error(`${t.status} ${t.type.toString()} ${t.statusText}`)}else i=-1!==t?e.splice(t,1)[0]:-1!==r?new Error(e.splice(r,1)[0]):new Error("Unknown error");return[i,e]}class A extends E{constructor(e,t,r){super(t),b(this,"code",void 0),b(this,"message",void 0),b(this,"cause",void 0),this.code=e,this.message=t||"",this.cause=r,Object.defineProperty(this,"name",{value:"Web3AuthError"})}toJSON(){return{name:this.name,code:this.code,message:this.message,cause:I([this.cause])}}toString(){return JSON.stringify(this.toJSON())}}class k extends A{constructor(e,t,r){super(e,t,r),Object.defineProperty(this,"name",{value:"WalletInitializationError"})}static fromCode(e,t="",r){return new k(e,`${k.messages[e]}, ${t}`,r)}static notFound(e="",t){return k.fromCode(5001,e,t)}static notInstalled(e="",t){return k.fromCode(5002,e,t)}static notReady(e="",t){return k.fromCode(5003,e,t)}static windowBlocked(e="",t){return k.fromCode(5004,e,t)}static windowClosed(e="",t){return k.fromCode(5005,e,t)}static incompatibleChainNameSpace(e="",t){return k.fromCode(5006,e,t)}static duplicateAdapterError(e="",t){return k.fromCode(5007,e,t)}static invalidProviderConfigError(e="",t){return k.fromCode(5008,e,t)}static providerNotReadyError(e="",t){return k.fromCode(5009,e,t)}static rpcConnectionError(e="",t){return k.fromCode(5010,e,t)}static invalidParams(e="",t){return k.fromCode(5011,e,t)}static invalidNetwork(e="",t){return k.fromCode(5013,e,t)}}b(k,"messages",{5e3:"Custom",5001:"Wallet is not found",5002:"Wallet is not installed",5003:"Wallet is not ready yet",5004:"Wallet window is blocked",5005:"Wallet window has been closed by the user",5006:"Incompatible chain namespace provided",5007:"Adapter has already been included",5008:"Invalid provider Config",5009:"Provider is not ready yet",5010:"Failed to connect with rpc url",5011:"Invalid params passed in",5013:"Invalid network provided"});class x extends A{constructor(e,t,r){super(e,t,r),Object.defineProperty(this,"name",{value:"WalletLoginError"})}static fromCode(e,t="",r){return new x(e,`${x.messages[e]}. ${t}`,r)}static connectionError(e="",t){return x.fromCode(5111,e,t)}static disconnectionError(e="",t){return x.fromCode(5112,e,t)}static notConnectedError(e="",t){return x.fromCode(5113,e,t)}static popupClosed(e="",t){return x.fromCode(5114,e,t)}static mfaEnabled(e="",t){return x.fromCode(5115,e,t)}static chainConfigNotAdded(e="",t){return x.fromCode(5116,e,t)}static unsupportedOperation(e="",t){return x.fromCode(5117,e,t)}static coreKitKeyNotFound(e="",t){return x.fromCode(5118,e,t)}static userNotLoggedIn(e="",t){return x.fromCode(5119,e,t)}}b(x,"messages",{5e3:"Custom",5111:"Failed to connect with wallet",5112:"Failed to disconnect from wallet",5113:"Wallet is not connected",5114:"Wallet popup has been closed by the user",5115:"User has already enabled mfa, please use the @web3auth/web3auth-web sdk for login with mfa",5116:"Chain config has not been added. Please add the chain config before calling switchChain",5117:"Unsupported operation",5118:"useCoreKitKey flag is enabled but coreKitKey is not available",5119:"User not logged in."});class P extends A{constructor(e,t,r){super(e,t,r),Object.defineProperty(this,"name",{value:"WalletOperationsError"})}static fromCode(e,t="",r){return new P(e,`${P.messages[e]}, ${t}`,r)}static chainIDNotAllowed(e="",t){return P.fromCode(5201,e,t)}static operationNotAllowed(e="",t){return P.fromCode(5202,e,t)}static chainNamespaceNotAllowed(e="",t){return P.fromCode(5203,e,t)}}b(P,"messages",{5e3:"Custom",5201:"Provided chainId is not allowed",5202:"This operation is not allowed"});class O extends A{constructor(e,t,r){super(e,t,r),Object.defineProperty(this,"name",{value:"WalletProviderError"})}static fromCode(e,t="",r){return new P(e,`${O.messages[e]}, ${t}`,r)}static invalidRequestArgs(e="",t){return P.fromCode(5301,e,t)}static invalidRequestMethod(e="",t){return P.fromCode(5302,e,t)}static invalidRequestParams(e="",t){return P.fromCode(5303,e,t)}}b(O,"messages",{5e3:"Custom",5301:"Expected a single, non-array, object argument.",5302:"'args.method' must be a non-empty string.",5303:"'args.params' must be an object or array if provided."});const R=(e,t,r)=>{if(e===v.OTHER)return null;const n=t?"number"==typeof t?t:parseInt(t,16):(e=>{if(e===v.EIP155)return 1;if(e===v.SOLANA)return 1;if(e===v.XRPL)return 1;throw k.invalidParams(`Chain namespace ${e} is not supported`)})(e);return e===v.EIP155?((e,t="")=>{const r=v.EIP155,n=`https://api.web3auth.io/infura-service/v1/${e}/${t}`;return 1===e?{logo:"https://images.toruswallet.io/eth.svg",chainNamespace:r,chainId:"0x1",rpcTarget:n,displayName:"Ethereum Mainnet",blockExplorerUrl:"https://etherscan.io/",ticker:"ETH",tickerName:"Ethereum",decimals:18}:10===e?{chainNamespace:v.EIP155,decimals:18,blockExplorerUrl:"https://optimistic.etherscan.io",chainId:"0xa",displayName:"Optimism",logo:"optimism.svg",rpcTarget:n,ticker:"ETH",tickerName:"Ethereum"}:8453===e?{chainNamespace:v.EIP155,decimals:18,blockExplorerUrl:"https://basescan.org",chainId:"0x2105",displayName:"Base",logo:"base.svg",rpcTarget:n,ticker:"ETH",tickerName:"Ethereum"}:42161===e?{chainNamespace:v.EIP155,decimals:18,blockExplorerUrl:"https://arbiscan.io",chainId:"0xa4b1",displayName:"Arbitrum One",logo:"arbitrum.svg",rpcTarget:n,ticker:"ETH",tickerName:"Ethereum"}:59144===e?{chainNamespace:v.EIP155,decimals:18,blockExplorerUrl:"https://lineascan.build",chainId:"0xe708",logo:"https://images.toruswallet.io/eth.svg",rpcTarget:n,ticker:"ETH",tickerName:"Ethereum"}:11155111===e?{logo:"https://images.toruswallet.io/eth.svg",chainNamespace:r,chainId:"0xaa36a7",rpcTarget:n,displayName:"Sepolia Testnet",blockExplorerUrl:"https://sepolia.etherscan.io/",ticker:"ETH",tickerName:"Ethereum",decimals:18}:137===e?{logo:"https://images.toruswallet.io/polygon.svg",chainNamespace:r,chainId:"0x89",rpcTarget:n,displayName:"Polygon Mainnet",blockExplorerUrl:"https://polygonscan.com",ticker:"POL",tickerName:"Polygon Ecosystem Token"}:80002===e?{logo:"https://images.toruswallet.io/polygon.svg",chainNamespace:r,chainId:"0x13882",rpcTarget:n,displayName:"Polygon Amoy Testnet",blockExplorerUrl:"https://www.oklink.com/amoy",ticker:"POL",tickerName:"Polygon Ecosystem Token",decimals:18}:56===e?{logo:"https://images.toruswallet.io/bnb.png",chainNamespace:r,chainId:"0x38",rpcTarget:n,displayName:"Binance SmartChain Mainnet",blockExplorerUrl:"https://bscscan.com",ticker:"BNB",tickerName:"Binance SmartChain",decimals:18}:97===e?{logo:"https://images.toruswallet.io/bnb.png",chainNamespace:r,chainId:"0x61",rpcTarget:n,displayName:"Binance SmartChain Testnet",blockExplorerUrl:"https://testnet.bscscan.com",ticker:"BNB",tickerName:"Binance SmartChain",decimals:18}:25===e?{logo:"https://images.toruswallet.io/cro.svg",chainNamespace:r,chainId:"0x19",rpcTarget:"https://rpc.cronos.org",displayName:"Cronos Mainnet",blockExplorerUrl:"https://cronoscan.com/",ticker:"CRO",tickerName:"Cronos"}:338===e?{logo:"https://images.toruswallet.io/cro.svg",chainNamespace:r,chainId:"0x152",rpcTarget:"https://rpc-t3.cronos.org/",displayName:"Cronos Testnet",blockExplorerUrl:"https://cronoscan.com/",ticker:"CRO",tickerName:"Cronos",decimals:18}:8217===e?{logo:"https://images.toruswallet.io/klay.svg",chainNamespace:r,chainId:"0x2019",rpcTarget:"https://public-node-api.klaytnapi.com/v1/cypress",displayName:"Klaytn Mainnet",blockExplorerUrl:"https://scope.klaytn.com",ticker:"KLAY",tickerName:"Klaytn",decimals:18}:1946===e?{chainNamespace:v.EIP155,chainId:"0x79a",rpcTarget:"https://rpc.minato.soneium.org",displayName:"Soneium Minato Testnet",blockExplorerUrl:"https://explorer-testnet.soneium.org",ticker:"ETH",tickerName:"ETH",logo:"https://iili.io/2i5xce2.png"}:1868===e?{chainNamespace:v.EIP155,chainId:"0x74c",rpcTarget:"https://rpc.soneium.org",displayName:"Soneium Mainnet",blockExplorerUrl:"https://soneium.blockscout.com",ticker:"ETH",tickerName:"ETH",logo:"https://iili.io/2i5xce2.png"}:null})(n,r):e===v.SOLANA?(e=>{const t=v.SOLANA;return 101===e||1===e?{logo:"https://images.toruswallet.io/sol.svg",chainNamespace:t,chainId:"0x65",rpcTarget:"https://rpc.ankr.com/solana",displayName:"Solana Mainnet",blockExplorerUrl:"https://explorer.solana.com",ticker:"SOL",tickerName:"Solana",decimals:9}:102===e||2===e?{logo:"https://images.toruswallet.io/sol.svg",chainNamespace:t,chainId:"0x66",rpcTarget:"https://api.testnet.solana.com",displayName:"Solana Testnet",blockExplorerUrl:"https://explorer.solana.com?cluster=testnet",ticker:"SOL",tickerName:"Solana",decimals:9}:103===e||3===e?{logo:"https://images.toruswallet.io/sol.svg",chainNamespace:t,chainId:"0x67",rpcTarget:"https://api.devnet.solana.com",displayName:"Solana Devnet",blockExplorerUrl:"https://explorer.solana.com?cluster=devnet",ticker:"SOL",tickerName:"Solana",decimals:9}:null})(n):e===v.XRPL?(e=>{const t=v.XRPL;return 1===e?{chainNamespace:t,decimals:15,chainId:"0x1",logo:"https://images.toruswallet.io/XRP.svg",rpcTarget:"https://ripple-node.tor.us",wsTarget:"wss://s2.ripple.com",ticker:"XRP",tickerName:"XRPL",displayName:"xrpl mainnet",blockExplorerUrl:"https://livenet.xrpl.org"}:2===e?{chainNamespace:t,decimals:15,chainId:"0x2",logo:"https://images.toruswallet.io/XRP.svg",rpcTarget:"https://testnet-ripple-node.tor.us",wsTarget:"wss://s.altnet.rippletest.net",ticker:"XRP",tickerName:"XRPL",displayName:"xrpl testnet",blockExplorerUrl:"https://testnet.xrpl.org",isTestnet:!0}:3===e?{chainNamespace:t,decimals:15,chainId:"0x3",logo:"https://images.toruswallet.io/XRP.svg",rpcTarget:"https://devnet-ripple-node.tor.us",wsTarget:"wss://s.devnet.rippletest.net/",ticker:"XRP",tickerName:"XRPL",displayName:"xrpl devnet",blockExplorerUrl:"https://devnet.xrpl.org",isTestnet:!0}:null})(n):null};var T=r(5510),N=r.n(T),M=r(4367),C=r.n(M);const B=C().getLogger("http-helpers");B.setLevel(M.levels.INFO);let L="torus-default";const U=(e,t={},r={},n={})=>{const i={mode:"cors",headers:{"Content-Type":"application/json; charset=utf-8"}};n.useAPIKey&&(i.headers=w(w({},i.headers),function(){const e={};return L&&(e["x-api-key"]=L),e}())),r.method="POST";const o=N()(i,r);return n.isUrlEncodedData?(o.body=t,"application/json; charset=utf-8"===o.headers["Content-Type"]&&delete o.headers["Content-Type"]):o.body=JSON.stringify(t),(async(e,t)=>{let r=null;try{const n=new Promise(((t,n)=>{r=setTimeout((()=>{n(new Error(`Timed out in ${e}ms`))}),e)})),i=await Promise.race([t,n]);return null!=r&&clearTimeout(r),i}catch(e){throw null!=r&&clearTimeout(r),e}})(n.timeout||6e4,async function(e,t){let r=null;try{r=new URL(e)}catch(e){}return fetch(e,t)}(e,o).then((e=>{if(n.logTracingHeader&&function(e){const t=e.headers.get("x-web3-correlation-id");t&&B.info(`Request tracing with traceID = ${t}`)}(e),e.ok){const t=e.headers.get("content-type");return null!=t&&t.includes("application/json")?e.json():e.text()}throw function(e){B.info(`Response: ${e.status} ${e.statusText}`),B.info(`Url: ${e.url}`)}(e),e})))},D="https://authjs.web3auth.io",j=async(e,t)=>{const r={payload:e,header:{t:"solana"===t?"sip99":"eip191"},network:"solana"===t?"solana":"ethereum"},n=await U(`${D}/siww/get`,r);if(!n.success)throw new Error("Failed to authenticate user, Please reach out to Web3Auth Support team");return n.challenge},z=async(e,t,r,n,i,o,s,a,c)=>{var u;const h=w({signature:{s:t,t:"solana"===e?"sip99":"eip191"},message:r,issuer:n,audience:a||"undefined"!=typeof window&&(null===(u=window.location)||void 0===u?void 0:u.hostname)||"com://reactnative",timeout:i},c||{}),l=await U(`${D}/siww/verify`,h,{headers:{client_id:o,wallet_provider:n,web3auth_network:s}});if(!l.success)throw C().error("Failed to authenticate user, ,message verification failed",l.error),new Error("Failed to authenticate user, ,message verification failed");return l.token};var q=r(8621),$=r.n(q),K=r(7318);class F{}class W extends F{constructor(e){super()}}const H=K.FIVE_SECONDS,V="heartbeat_pulse";class G extends W{constructor(e){super(e),this.events=new q.EventEmitter,this.interval=H,this.interval=e?.interval||H}static async init(e){const t=new G(e);return await t.init(),t}async init(){await this.initialize()}stop(){clearInterval(this.intervalRef)}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async initialize(){this.intervalRef=setInterval((()=>this.pulse()),(0,K.toMiliseconds)(this.interval))}pulse(){this.events.emit(V)}}const Y=/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,J=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,X=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/;function Z(e,t){if(!("__proto__"===e||"constructor"===e&&t&&"object"==typeof t&&"prototype"in t))return t;!function(e){console.warn(`[destr] Dropping "${e}" key to prevent prototype pollution.`)}(e)}function Q(e,t={}){if("string"!=typeof e)return e;const r=e.trim();if('"'===e[0]&&e.endsWith('"')&&!e.includes("\\"))return r.slice(1,-1);if(r.length<=9){const e=r.toLowerCase();if("true"===e)return!0;if("false"===e)return!1;if("undefined"===e)return;if("null"===e)return null;if("nan"===e)return Number.NaN;if("infinity"===e)return Number.POSITIVE_INFINITY;if("-infinity"===e)return Number.NEGATIVE_INFINITY}if(!X.test(e)){if(t.strict)throw new SyntaxError("[destr] Invalid JSON");return e}try{if(Y.test(e)||J.test(e)){if(t.strict)throw new Error("[destr] Possible prototype pollution");return JSON.parse(e,Z)}return JSON.parse(e)}catch(r){if(t.strict)throw r;return e}}var ee=r(1429).Buffer;function te(e,...t){try{return(r=e(...t))&&"function"==typeof r.then?r:Promise.resolve(r)}catch(e){return Promise.reject(e)}var r}function re(e){if(function(e){const t=typeof e;return null===e||"object"!==t&&"function"!==t}(e))return String(e);if(function(e){const t=Object.getPrototypeOf(e);return!t||t.isPrototypeOf(Object)}(e)||Array.isArray(e))return JSON.stringify(e);if("function"==typeof e.toJSON)return re(e.toJSON());throw new Error("[unstorage] Cannot stringify value!")}function ne(){if(void 0===ee)throw new TypeError("[unstorage] Buffer is not supported!")}const ie="base64:";function oe(e){return e?e.split("?")[0].replace(/[/\\]/g,":").replace(/:+/g,":").replace(/^:|:$/g,""):""}function se(...e){return oe(e.join(":"))}function ae(e){return(e=oe(e))?e+":":""}const ce=()=>{const e=new Map;return{name:"memory",getInstance:()=>e,hasItem:t=>e.has(t),getItem:t=>e.get(t)??null,getItemRaw:t=>e.get(t)??null,setItem(t,r){e.set(t,r)},setItemRaw(t,r){e.set(t,r)},removeItem(t){e.delete(t)},getKeys:()=>[...e.keys()],clear(){e.clear()},dispose(){e.clear()}}};function ue(e,t,r){return e.watch?e.watch(((e,n)=>t(e,r+n))):()=>{}}async function he(e){"function"==typeof e.dispose&&await te(e.dispose)}function le(e){return new Promise(((t,r)=>{e.oncomplete=e.onsuccess=()=>t(e.result),e.onabort=e.onerror=()=>r(e.error)}))}function de(e,t){const r=indexedDB.open(e);r.onupgradeneeded=()=>r.result.createObjectStore(t);const n=le(r);return(e,r)=>n.then((n=>r(n.transaction(t,e).objectStore(t))))}let fe;function pe(){return fe||(fe=de("keyval-store","keyval")),fe}function ge(e,t=pe()){return t("readonly",(t=>le(t.get(e))))}const ye=e=>JSON.stringify(e,((e,t)=>"bigint"==typeof t?t.toString()+"n":t)),be=e=>{const t=e.replace(/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,'$1"$2n"$3');return JSON.parse(t,((e,t)=>"string"==typeof t&&t.match(/^\d+n$/)?BigInt(t.substring(0,t.length-1)):t))};function me(e){if("string"!=typeof e)throw new Error("Cannot safe json parse value of type "+typeof e);try{return be(e)}catch(t){return e}}function we(e){return"string"==typeof e?e:ye(e)||""}var ve=(e={})=>{const t=e.base&&e.base.length>0?`${e.base}:`:"",r=e=>t+e;let n;return e.dbName&&e.storeName&&(n=de(e.dbName,e.storeName)),{name:"idb-keyval",options:e,hasItem:async e=>!(typeof await ge(r(e),n)>"u"),getItem:async e=>await ge(r(e),n)??null,setItem:(e,t)=>function(e,t,r=pe()){return r("readwrite",(r=>(r.put(t,e),le(r.transaction))))}(r(e),t,n),removeItem:e=>function(e,t=pe()){return t("readwrite",(t=>(t.delete(e),le(t.transaction))))}(r(e),n),getKeys:()=>function(e=pe()){return e("readonly",(e=>{if(e.getAllKeys)return le(e.getAllKeys());const t=[];return function(e,t){return e.openCursor().onsuccess=function(){this.result&&(t(this.result),this.result.continue())},le(e.transaction)}(e,(e=>t.push(e.key))).then((()=>t))}))}(n),clear:()=>function(e=pe()){return e("readwrite",(e=>(e.clear(),le(e.transaction))))}(n)}};class Se{constructor(){this.indexedDb=function(e={}){const t={mounts:{"":e.driver||ce()},mountpoints:[""],watching:!1,watchListeners:[],unwatch:{}},r=e=>{for(const r of t.mountpoints)if(e.startsWith(r))return{base:r,relativeKey:e.slice(r.length),driver:t.mounts[r]};return{base:"",relativeKey:e,driver:t.mounts[""]}},n=(e,r)=>t.mountpoints.filter((t=>t.startsWith(e)||r&&e.startsWith(t))).map((r=>({relativeBase:e.length>r.length?e.slice(r.length):void 0,mountpoint:r,driver:t.mounts[r]}))),i=(e,r)=>{if(t.watching){r=oe(r);for(const n of t.watchListeners)n(e,r)}},o=async()=>{if(t.watching){for(const e in t.unwatch)await t.unwatch[e]();t.unwatch={},t.watching=!1}},s=(e,t,n)=>{const i=new Map,o=e=>{let t=i.get(e.base);return t||(t={driver:e.driver,base:e.base,items:[]},i.set(e.base,t)),t};for(const n of e){const e="string"==typeof n,i=oe(e?n:n.key),s=e?void 0:n.value,a=e||!n.options?t:{...t,...n.options},c=r(i);o(c).items.push({key:i,value:s,relativeKey:c.relativeKey,options:a})}return Promise.all([...i.values()].map((e=>n(e)))).then((e=>e.flat()))},a={hasItem(e,t={}){e=oe(e);const{relativeKey:n,driver:i}=r(e);return te(i.hasItem,n,t)},getItem(e,t={}){e=oe(e);const{relativeKey:n,driver:i}=r(e);return te(i.getItem,n,t).then((e=>Q(e)))},getItems:(e,t)=>s(e,t,(e=>e.driver.getItems?te(e.driver.getItems,e.items.map((e=>({key:e.relativeKey,options:e.options}))),t).then((t=>t.map((t=>({key:se(e.base,t.key),value:Q(t.value)}))))):Promise.all(e.items.map((t=>te(e.driver.getItem,t.relativeKey,t.options).then((e=>({key:t.key,value:Q(e)})))))))),getItemRaw(e,t={}){e=oe(e);const{relativeKey:n,driver:i}=r(e);return i.getItemRaw?te(i.getItemRaw,n,t):te(i.getItem,n,t).then((e=>function(e){return"string"!=typeof e?e:e.startsWith(ie)?(ne(),ee.from(e.slice(7),"base64")):e}(e)))},async setItem(e,t,n={}){if(void 0===t)return a.removeItem(e);e=oe(e);const{relativeKey:o,driver:s}=r(e);s.setItem&&(await te(s.setItem,o,re(t),n),s.watch||i("update",e))},async setItems(e,t){await s(e,t,(async e=>{if(e.driver.setItems)return te(e.driver.setItems,e.items.map((e=>({key:e.relativeKey,value:re(e.value),options:e.options}))),t);e.driver.setItem&&await Promise.all(e.items.map((t=>te(e.driver.setItem,t.relativeKey,re(t.value),t.options))))}))},async setItemRaw(e,t,n={}){if(void 0===t)return a.removeItem(e,n);e=oe(e);const{relativeKey:o,driver:s}=r(e);if(s.setItemRaw)await te(s.setItemRaw,o,t,n);else{if(!s.setItem)return;await te(s.setItem,o,function(e){if("string"==typeof e)return e;ne();const t=ee.from(e).toString("base64");return ie+t}(t),n)}s.watch||i("update",e)},async removeItem(e,t={}){"boolean"==typeof t&&(t={removeMeta:t}),e=oe(e);const{relativeKey:n,driver:o}=r(e);o.removeItem&&(await te(o.removeItem,n,t),(t.removeMeta||t.removeMata)&&await te(o.removeItem,n+"$",t),o.watch||i("remove",e))},async getMeta(e,t={}){"boolean"==typeof t&&(t={nativeOnly:t}),e=oe(e);const{relativeKey:n,driver:i}=r(e),o=Object.create(null);if(i.getMeta&&Object.assign(o,await te(i.getMeta,n,t)),!t.nativeOnly){const e=await te(i.getItem,n+"$",t).then((e=>Q(e)));e&&"object"==typeof e&&("string"==typeof e.atime&&(e.atime=new Date(e.atime)),"string"==typeof e.mtime&&(e.mtime=new Date(e.mtime)),Object.assign(o,e))}return o},setMeta(e,t,r={}){return this.setItem(e+"$",t,r)},removeMeta(e,t={}){return this.removeItem(e+"$",t)},async getKeys(e,t={}){e=ae(e);const r=n(e,!0);let i=[];const o=[];for(const e of r){const r=await te(e.driver.getKeys,e.relativeBase,t);for(const t of r){const r=e.mountpoint+oe(t);i.some((e=>r.startsWith(e)))||o.push(r)}i=[e.mountpoint,...i.filter((t=>!t.startsWith(e.mountpoint)))]}return e?o.filter((t=>t.startsWith(e)&&"$"!==t[t.length-1])):o.filter((e=>"$"!==e[e.length-1]))},async clear(e,t={}){e=ae(e),await Promise.all(n(e,!1).map((async e=>{if(e.driver.clear)return te(e.driver.clear,e.relativeBase,t);if(e.driver.removeItem){const r=await e.driver.getKeys(e.relativeBase||"",t);return Promise.all(r.map((r=>e.driver.removeItem(r,t))))}})))},async dispose(){await Promise.all(Object.values(t.mounts).map((e=>he(e))))},watch:async e=>(await(async()=>{if(!t.watching){t.watching=!0;for(const e in t.mounts)t.unwatch[e]=await ue(t.mounts[e],i,e)}})(),t.watchListeners.push(e),async()=>{t.watchListeners=t.watchListeners.filter((t=>t!==e)),0===t.watchListeners.length&&await o()}),async unwatch(){t.watchListeners=[],await o()},mount(e,r){if((e=ae(e))&&t.mounts[e])throw new Error(`already mounted at ${e}`);return e&&(t.mountpoints.push(e),t.mountpoints.sort(((e,t)=>t.length-e.length))),t.mounts[e]=r,t.watching&&Promise.resolve(ue(r,i,e)).then((r=>{t.unwatch[e]=r})).catch(console.error),a},async unmount(e,r=!0){(e=ae(e))&&t.mounts[e]&&(t.watching&&e in t.unwatch&&(t.unwatch[e](),delete t.unwatch[e]),r&&await he(t.mounts[e]),t.mountpoints=t.mountpoints.filter((t=>t!==e)),delete t.mounts[e])},getMount(e=""){e=oe(e)+":";const t=r(e);return{driver:t.driver,base:t.base}},getMounts:(e="",t={})=>(e=oe(e),n(e,t.parents).map((e=>({driver:e.driver,base:e.mountpoint})))),keys:(e,t={})=>a.getKeys(e,t),get:(e,t={})=>a.getItem(e,t),set:(e,t,r={})=>a.setItem(e,t,r),has:(e,t={})=>a.hasItem(e,t),del:(e,t={})=>a.removeItem(e,t),remove:(e,t={})=>a.removeItem(e,t)};return a}({driver:ve({dbName:"WALLET_CONNECT_V2_INDEXED_DB",storeName:"keyvaluestorage"})})}async getKeys(){return this.indexedDb.getKeys()}async getEntries(){return(await this.indexedDb.getItems(await this.indexedDb.getKeys())).map((e=>[e.key,e.value]))}async getItem(e){const t=await this.indexedDb.getItem(e);if(null!==t)return t}async setItem(e,t){await this.indexedDb.setItem(e,we(t))}async removeItem(e){await this.indexedDb.removeItem(e)}}var _e=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof r.g<"u"?r.g:typeof self<"u"?self:{},Ee={exports:{}};function Ie(e){var t;return[e[0],me(null!=(t=e[1])?t:"")]}!function(){let e;function t(){}e=t,e.prototype.getItem=function(e){return this.hasOwnProperty(e)?String(this[e]):null},e.prototype.setItem=function(e,t){this[e]=String(t)},e.prototype.removeItem=function(e){delete this[e]},e.prototype.clear=function(){const e=this;Object.keys(e).forEach((function(t){e[t]=void 0,delete e[t]}))},e.prototype.key=function(e){return e=e||0,Object.keys(this)[e]},e.prototype.__defineGetter__("length",(function(){return Object.keys(this).length})),typeof _e<"u"&&_e.localStorage?Ee.exports=_e.localStorage:typeof window<"u"&&window.localStorage?Ee.exports=window.localStorage:Ee.exports=new t}();class Ae{constructor(){this.localStorage=Ee.exports}async getKeys(){return Object.keys(this.localStorage)}async getEntries(){return Object.entries(this.localStorage).map(Ie)}async getItem(e){const t=this.localStorage.getItem(e);if(null!==t)return me(t)}async setItem(e,t){this.localStorage.setItem(e,we(t))}async removeItem(e){this.localStorage.removeItem(e)}}class ke{constructor(){this.initialized=!1,this.setInitialized=e=>{this.storage=e,this.initialized=!0};const e=new Ae;this.storage=e;try{(async(e,t,r)=>{const n="wc_storage_version",i=await t.getItem(n);if(i&&i>=1)return void r(t);const o=await e.getKeys();if(!o.length)return void r(t);const s=[];for(;o.length;){const r=o.shift();if(!r)continue;const n=r.toLowerCase();if(n.includes("wc@")||n.includes("walletconnect")||n.includes("wc_")||n.includes("wallet_connect")){const n=await e.getItem(r);await t.setItem(r,n),s.push(r)}}await t.setItem(n,1),r(t),(async(e,t)=>{t.length&&t.forEach((async t=>{await e.removeItem(t)}))})(e,s)})(e,new Se,this.setInitialized)}catch{this.initialized=!0}}async getKeys(){return await this.initialize(),this.storage.getKeys()}async getEntries(){return await this.initialize(),this.storage.getEntries()}async getItem(e){return await this.initialize(),this.storage.getItem(e)}async setItem(e,t){return await this.initialize(),this.storage.setItem(e,t)}async removeItem(e){return await this.initialize(),this.storage.removeItem(e)}async initialize(){this.initialized||await new Promise((e=>{const t=setInterval((()=>{this.initialized&&(clearInterval(t),e())}),20)}))}}var xe=r(1318),Pe=r.n(xe);const Oe="custom_context";class Re{constructor(e){this.nodeValue=e,this.sizeInBytes=(new TextEncoder).encode(this.nodeValue).length,this.next=null}get value(){return this.nodeValue}get size(){return this.sizeInBytes}}class Te{constructor(e){this.head=null,this.tail=null,this.lengthInNodes=0,this.maxSizeInBytes=e,this.sizeInBytes=0}append(e){const t=new Re(e);if(t.size>this.maxSizeInBytes)throw new Error(`[LinkedList] Value too big to insert into list: ${e} with size ${t.size}`);for(;this.size+t.size>this.maxSizeInBytes;)this.shift();this.head?(this.tail&&(this.tail.next=t),this.tail=t):(this.head=t,this.tail=t),this.lengthInNodes++,this.sizeInBytes+=t.size}shift(){if(!this.head)return;const e=this.head;this.head=this.head.next,this.head||(this.tail=null),this.lengthInNodes--,this.sizeInBytes-=e.size}toArray(){const e=[];let t=this.head;for(;null!==t;)e.push(t.value),t=t.next;return e}get length(){return this.lengthInNodes}get size(){return this.sizeInBytes}toOrderedArray(){return Array.from(this)}[Symbol.iterator](){let e=this.head;return{next:()=>{if(!e)return{done:!0,value:null};const t=e.value;return e=e.next,{done:!1,value:t}}}}}class Ne{constructor(e,t=1024e3){this.level=e??"error",this.levelValue=xe.levels.values[this.level],this.MAX_LOG_SIZE_IN_BYTES=t,this.logs=new Te(this.MAX_LOG_SIZE_IN_BYTES)}forwardToConsole(e,t){t===xe.levels.values.error?console.error(e):t===xe.levels.values.warn?console.warn(e):t===xe.levels.values.debug?console.debug(e):t===xe.levels.values.trace?console.trace(e):console.log(e)}appendToLogs(e){this.logs.append(we({timestamp:(new Date).toISOString(),log:e}));const t="string"==typeof e?JSON.parse(e).level:e.level;t>=this.levelValue&&this.forwardToConsole(e,t)}getLogs(){return this.logs}clearLogs(){this.logs=new Te(this.MAX_LOG_SIZE_IN_BYTES)}getLogArray(){return Array.from(this.logs)}logsToBlob(e){const t=this.getLogArray();return t.push(we({extraMetadata:e})),new Blob(t,{type:"application/json"})}}class Me{constructor(e,t=1024e3){this.baseChunkLogger=new Ne(e,t)}write(e){this.baseChunkLogger.appendToLogs(e)}getLogs(){return this.baseChunkLogger.getLogs()}clearLogs(){this.baseChunkLogger.clearLogs()}getLogArray(){return this.baseChunkLogger.getLogArray()}logsToBlob(e){return this.baseChunkLogger.logsToBlob(e)}downloadLogsBlobInBrowser(e){const t=URL.createObjectURL(this.logsToBlob(e)),r=document.createElement("a");r.href=t,r.download=`walletconnect-logs-${(new Date).toISOString()}.txt`,document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(t)}}class Ce{constructor(e,t=1024e3){this.baseChunkLogger=new Ne(e,t)}write(e){this.baseChunkLogger.appendToLogs(e)}getLogs(){return this.baseChunkLogger.getLogs()}clearLogs(){this.baseChunkLogger.clearLogs()}getLogArray(){return this.baseChunkLogger.getLogArray()}logsToBlob(e){return this.baseChunkLogger.logsToBlob(e)}}var Be=Object.defineProperty,Le=Object.defineProperties,Ue=Object.getOwnPropertyDescriptors,De=Object.getOwnPropertySymbols,je=Object.prototype.hasOwnProperty,ze=Object.prototype.propertyIsEnumerable,qe=(e,t,r)=>t in e?Be(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,$e=(e,t)=>{for(var r in t||(t={}))je.call(t,r)&&qe(e,r,t[r]);if(De)for(var r of De(t))ze.call(t,r)&&qe(e,r,t[r]);return e},Ke=(e,t)=>Le(e,Ue(t));function Fe(e){return Ke($e({},e),{level:e?.level||"info"})}function We(e,t=Oe){let r="";return r=typeof e.bindings>"u"?function(e,t=Oe){return e[t]||""}(e,t):e.bindings().context||"",r}function He(e,t,r=Oe){const n=function(e,t,r=Oe){const n=We(e,r);return n.trim()?`${n}/${t}`:t}(e,t,r);return function(e,t,r=Oe){return e[r]=t,e}(e.child({context:n}),n,r)}class Ve extends F{constructor(e){super(),this.opts=e,this.protocol="wc",this.version=2}}class Ge extends F{constructor(e,t){super(),this.core=e,this.logger=t,this.records=new Map}}class Ye{constructor(e,t){this.logger=e,this.core=t}}class Je extends F{constructor(e,t){super(),this.relayer=e,this.logger=t}}class Xe extends F{constructor(e){super()}}class Ze{constructor(e,t,r,n){this.core=e,this.logger=t,this.name=r}}class Qe extends F{constructor(e,t){super(),this.relayer=e,this.logger=t}}class et extends F{constructor(e,t){super(),this.core=e,this.logger=t}}class tt{constructor(e,t,r){this.core=e,this.logger=t,this.store=r}}class rt{constructor(e,t){this.projectId=e,this.logger=t}}class nt{constructor(e,t,r){this.core=e,this.logger=t,this.telemetryEnabled=r}}$();class it{constructor(e){this.opts=e,this.protocol="wc",this.version=2}}q.EventEmitter;class ot{constructor(e){this.client=e}}function st(e,...t){if(!function(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&"Uint8Array"===e.constructor.name}(e))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw new Error("Uint8Array expected of length "+t+", got length="+e.length)}function at(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}const ct="object"==typeof globalThis&&"crypto"in globalThis?globalThis.crypto:void 0,ut=e=>new DataView(e.buffer,e.byteOffset,e.byteLength);function ht(e){return"string"==typeof e&&(e=function(e){if("string"!=typeof e)throw new Error("utf8ToBytes expected string, got "+typeof e);return new Uint8Array((new TextEncoder).encode(e))}(e)),st(e),e}class lt{clone(){return this._cloneInto()}}function dt(e=32){if(ct&&"function"==typeof ct.getRandomValues)return ct.getRandomValues(new Uint8Array(e));if(ct&&"function"==typeof ct.randomBytes)return ct.randomBytes(e);throw new Error("crypto.getRandomValues must be defined")}class ft extends lt{constructor(e,t,r,n){super(),this.blockLen=e,this.outputLen=t,this.padOffset=r,this.isLE=n,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=ut(this.buffer)}update(e){at(this);const{view:t,buffer:r,blockLen:n}=this,i=(e=ht(e)).length;for(let o=0;o<i;){const s=Math.min(n-this.pos,i-o);if(s!==n)r.set(e.subarray(o,o+s),this.pos),this.pos+=s,o+=s,this.pos===n&&(this.process(t,0),this.pos=0);else{const t=ut(e);for(;n<=i-o;o+=n)this.process(t,o)}}return this.length+=e.length,this.roundClean(),this}digestInto(e){at(this),function(e,t){st(e);const r=t.outputLen;if(e.length<r)throw new Error("digestInto() expects output buffer of length at least "+r)}(e,this),this.finished=!0;const{buffer:t,view:r,blockLen:n,isLE:i}=this;let{pos:o}=this;t[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>n-o&&(this.process(r,0),o=0);for(let e=o;e<n;e++)t[e]=0;(function(e,t,r,n){if("function"==typeof e.setBigUint64)return e.setBigUint64(t,r,n);const i=BigInt(32),o=BigInt(4294967295),s=Number(r>>i&o),a=Number(r&o),c=n?4:0,u=n?0:4;e.setUint32(t+c,s,n),e.setUint32(t+u,a,n)})(r,n-8,BigInt(8*this.length),i),this.process(r,0);const s=ut(e),a=this.outputLen;if(a%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const c=a/4,u=this.get();if(c>u.length)throw new Error("_sha2: outputLen bigger than state");for(let e=0;e<c;e++)s.setUint32(4*e,u[e],i)}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const r=e.slice(0,t);return this.destroy(),r}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:t,buffer:r,length:n,finished:i,destroyed:o,pos:s}=this;return e.length=n,e.pos=s,e.finished=i,e.destroyed=o,n%t&&e.buffer.set(r),e}}const pt=BigInt(2**32-1),gt=BigInt(32);function yt(e,t=!1){return t?{h:Number(e&pt),l:Number(e>>gt&pt)}:{h:0|Number(e>>gt&pt),l:0|Number(e&pt)}}const bt=function(e,t=!1){let r=new Uint32Array(e.length),n=new Uint32Array(e.length);for(let i=0;i<e.length;i++){const{h:o,l:s}=yt(e[i],t);[r[i],n[i]]=[o,s]}return[r,n]},mt=(e,t,r)=>e>>>r,wt=(e,t,r)=>e<<32-r|t>>>r,vt=(e,t,r)=>e>>>r|t<<32-r,St=(e,t,r)=>e<<32-r|t>>>r,_t=(e,t,r)=>e<<64-r|t>>>r-32,Et=(e,t,r)=>e>>>r-32|t<<64-r,It=function(e,t,r,n){const i=(t>>>0)+(n>>>0);return{h:e+r+(i/2**32|0)|0,l:0|i}},At=(e,t,r)=>(e>>>0)+(t>>>0)+(r>>>0),kt=(e,t,r,n)=>t+r+n+(e/2**32|0)|0,xt=(e,t,r,n)=>(e>>>0)+(t>>>0)+(r>>>0)+(n>>>0),Pt=(e,t,r,n,i)=>t+r+n+i+(e/2**32|0)|0,Ot=(e,t,r,n,i,o)=>t+r+n+i+o+(e/2**32|0)|0,Rt=(e,t,r,n,i)=>(e>>>0)+(t>>>0)+(r>>>0)+(n>>>0)+(i>>>0),[Tt,Nt]=bt(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map((e=>BigInt(e)))),Mt=new Uint32Array(80),Ct=new Uint32Array(80);class Bt extends ft{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:e,Al:t,Bh:r,Bl:n,Ch:i,Cl:o,Dh:s,Dl:a,Eh:c,El:u,Fh:h,Fl:l,Gh:d,Gl:f,Hh:p,Hl:g}=this;return[e,t,r,n,i,o,s,a,c,u,h,l,d,f,p,g]}set(e,t,r,n,i,o,s,a,c,u,h,l,d,f,p,g){this.Ah=0|e,this.Al=0|t,this.Bh=0|r,this.Bl=0|n,this.Ch=0|i,this.Cl=0|o,this.Dh=0|s,this.Dl=0|a,this.Eh=0|c,this.El=0|u,this.Fh=0|h,this.Fl=0|l,this.Gh=0|d,this.Gl=0|f,this.Hh=0|p,this.Hl=0|g}process(e,t){for(let r=0;r<16;r++,t+=4)Mt[r]=e.getUint32(t),Ct[r]=e.getUint32(t+=4);for(let e=16;e<80;e++){const t=0|Mt[e-15],r=0|Ct[e-15],n=vt(t,r,1)^vt(t,r,8)^mt(t,r,7),i=St(t,r,1)^St(t,r,8)^wt(t,r,7),o=0|Mt[e-2],s=0|Ct[e-2],a=vt(o,s,19)^_t(o,s,61)^mt(o,s,6),c=St(o,s,19)^Et(o,s,61)^wt(o,s,6),u=xt(i,c,Ct[e-7],Ct[e-16]),h=Pt(u,n,a,Mt[e-7],Mt[e-16]);Mt[e]=0|h,Ct[e]=0|u}let{Ah:r,Al:n,Bh:i,Bl:o,Ch:s,Cl:a,Dh:c,Dl:u,Eh:h,El:l,Fh:d,Fl:f,Gh:p,Gl:g,Hh:y,Hl:b}=this;for(let e=0;e<80;e++){const t=vt(h,l,14)^vt(h,l,18)^_t(h,l,41),m=St(h,l,14)^St(h,l,18)^Et(h,l,41),w=h&d^~h&p,v=Rt(b,m,l&f^~l&g,Nt[e],Ct[e]),S=Ot(v,y,t,w,Tt[e],Mt[e]),_=0|v,E=vt(r,n,28)^_t(r,n,34)^_t(r,n,39),I=St(r,n,28)^Et(r,n,34)^Et(r,n,39),A=r&i^r&s^i&s,k=n&o^n&a^o&a;y=0|p,b=0|g,p=0|d,g=0|f,d=0|h,f=0|l,({h,l}=It(0|c,0|u,0|S,0|_)),c=0|s,u=0|a,s=0|i,a=0|o,i=0|r,o=0|n;const x=At(_,I,k);r=kt(x,S,E,A),n=0|x}({h:r,l:n}=It(0|this.Ah,0|this.Al,0|r,0|n)),({h:i,l:o}=It(0|this.Bh,0|this.Bl,0|i,0|o)),({h:s,l:a}=It(0|this.Ch,0|this.Cl,0|s,0|a)),({h:c,l:u}=It(0|this.Dh,0|this.Dl,0|c,0|u)),({h,l}=It(0|this.Eh,0|this.El,0|h,0|l)),({h:d,l:f}=It(0|this.Fh,0|this.Fl,0|d,0|f)),({h:p,l:g}=It(0|this.Gh,0|this.Gl,0|p,0|g)),({h:y,l:b}=It(0|this.Hh,0|this.Hl,0|y,0|b)),this.set(r,n,i,o,s,a,c,u,h,l,d,f,p,g,y,b)}roundClean(){Mt.fill(0),Ct.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}const Lt=function(e){const t=t=>e().update(ht(t)).digest(),r=e();return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=()=>e(),t}((()=>new Bt)),Ut=BigInt(0),Dt=BigInt(1),jt=BigInt(2);function zt(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&"Uint8Array"===e.constructor.name}function qt(e){if(!zt(e))throw new Error("Uint8Array expected")}function $t(e,t){if("boolean"!=typeof t)throw new Error(e+" boolean expected, got "+t)}const Kt=Array.from({length:256},((e,t)=>t.toString(16).padStart(2,"0")));function Ft(e){qt(e);let t="";for(let r=0;r<e.length;r++)t+=Kt[e[r]];return t}function Wt(e){if("string"!=typeof e)throw new Error("hex string expected, got "+typeof e);return""===e?Ut:BigInt("0x"+e)}const Ht={_0:48,_9:57,A:65,F:70,a:97,f:102};function Vt(e){return e>=Ht._0&&e<=Ht._9?e-Ht._0:e>=Ht.A&&e<=Ht.F?e-(Ht.A-10):e>=Ht.a&&e<=Ht.f?e-(Ht.a-10):void 0}function Gt(e){if("string"!=typeof e)throw new Error("hex string expected, got "+typeof e);const t=e.length,r=t/2;if(t%2)throw new Error("hex string expected, got unpadded hex of length "+t);const n=new Uint8Array(r);for(let t=0,i=0;t<r;t++,i+=2){const r=Vt(e.charCodeAt(i)),o=Vt(e.charCodeAt(i+1));if(void 0===r||void 0===o){const t=e[i]+e[i+1];throw new Error('hex string expected, got non-hex character "'+t+'" at index '+i)}n[t]=16*r+o}return n}function Yt(e){return qt(e),Wt(Ft(Uint8Array.from(e).reverse()))}function Jt(e,t){return Gt(e.toString(16).padStart(2*t,"0"))}function Xt(e,t){return Jt(e,t).reverse()}function Zt(e,t,r){let n;if("string"==typeof t)try{n=Gt(t)}catch(t){throw new Error(e+" must be hex string or Uint8Array, cause: "+t)}else{if(!zt(t))throw new Error(e+" must be hex string or Uint8Array");n=Uint8Array.from(t)}const i=n.length;if("number"==typeof r&&i!==r)throw new Error(e+" of length "+r+" expected, got "+i);return n}function Qt(...e){let t=0;for(let r=0;r<e.length;r++){const n=e[r];qt(n),t+=n.length}const r=new Uint8Array(t);for(let t=0,n=0;t<e.length;t++){const i=e[t];r.set(i,n),n+=i.length}return r}const er=e=>"bigint"==typeof e&&Ut<=e;function tr(e,t,r,n){if(!function(e,t,r){return er(e)&&er(t)&&er(r)&&t<=e&&e<r}(t,r,n))throw new Error("expected valid "+e+": "+r+" <= n < "+n+", got "+t)}const rr=e=>(jt<<BigInt(e-1))-Dt,nr={bigint:e=>"bigint"==typeof e,function:e=>"function"==typeof e,boolean:e=>"boolean"==typeof e,string:e=>"string"==typeof e,stringOrUint8Array:e=>"string"==typeof e||zt(e),isSafeInteger:e=>Number.isSafeInteger(e),array:e=>Array.isArray(e),field:(e,t)=>t.Fp.isValid(e),hash:e=>"function"==typeof e&&Number.isSafeInteger(e.outputLen)};function ir(e,t,r={}){const n=(t,r,n)=>{const i=nr[r];if("function"!=typeof i)throw new Error("invalid validator function");const o=e[t];if(!(n&&void 0===o||i(o,e)))throw new Error("param "+String(t)+" is invalid. Expected "+r+", got "+o)};for(const[e,r]of Object.entries(t))n(e,r,!1);for(const[e,t]of Object.entries(r))n(e,t,!0);return e}function or(e){const t=new WeakMap;return(r,...n)=>{const i=t.get(r);if(void 0!==i)return i;const o=e(r,...n);return t.set(r,o),o}}const sr=BigInt(0),ar=BigInt(1),cr=BigInt(2),ur=BigInt(3),hr=BigInt(4),lr=BigInt(5),dr=BigInt(8);function fr(e,t){const r=e%t;return r>=sr?r:t+r}function pr(e,t,r){if(t<sr)throw new Error("invalid exponent, negatives unsupported");if(r<=sr)throw new Error("invalid modulus");if(r===ar)return sr;let n=ar;for(;t>sr;)t&ar&&(n=n*e%r),e=e*e%r,t>>=ar;return n}function gr(e,t,r){let n=e;for(;t-- >sr;)n*=n,n%=r;return n}function yr(e,t){if(e===sr)throw new Error("invert: expected non-zero number");if(t<=sr)throw new Error("invert: expected positive modulus, got "+t);let r=fr(e,t),n=t,i=sr,o=ar;for(;r!==sr;){const e=n%r,t=i-o*(n/r);n=r,r=e,i=o,o=t}if(n!==ar)throw new Error("invert: does not exist");return fr(i,t)}const br=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function mr(e,t){const r=void 0!==t?t:e.toString(2).length;return{nBitLength:r,nByteLength:Math.ceil(r/8)}}function wr(e,t,r=!1,n={}){if(e<=sr)throw new Error("invalid field: expected ORDER > 0, got "+e);const{nBitLength:i,nByteLength:o}=mr(e,t);if(o>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let s;const a=Object.freeze({ORDER:e,isLE:r,BITS:i,BYTES:o,MASK:rr(i),ZERO:sr,ONE:ar,create:t=>fr(t,e),isValid:t=>{if("bigint"!=typeof t)throw new Error("invalid field element: expected bigint, got "+typeof t);return sr<=t&&t<e},is0:e=>e===sr,isOdd:e=>(e&ar)===ar,neg:t=>fr(-t,e),eql:(e,t)=>e===t,sqr:t=>fr(t*t,e),add:(t,r)=>fr(t+r,e),sub:(t,r)=>fr(t-r,e),mul:(t,r)=>fr(t*r,e),pow:(e,t)=>function(e,t,r){if(r<sr)throw new Error("invalid exponent, negatives unsupported");if(r===sr)return e.ONE;if(r===ar)return t;let n=e.ONE,i=t;for(;r>sr;)r&ar&&(n=e.mul(n,i)),i=e.sqr(i),r>>=ar;return n}(a,e,t),div:(t,r)=>fr(t*yr(r,e),e),sqrN:e=>e*e,addN:(e,t)=>e+t,subN:(e,t)=>e-t,mulN:(e,t)=>e*t,inv:t=>yr(t,e),sqrt:n.sqrt||(t=>(s||(s=function(e){if(e%hr===ur){const t=(e+ar)/hr;return function(e,r){const n=e.pow(r,t);if(!e.eql(e.sqr(n),r))throw new Error("Cannot find square root");return n}}if(e%dr===lr){const t=(e-lr)/dr;return function(e,r){const n=e.mul(r,cr),i=e.pow(n,t),o=e.mul(r,i),s=e.mul(e.mul(o,cr),i),a=e.mul(o,e.sub(s,e.ONE));if(!e.eql(e.sqr(a),r))throw new Error("Cannot find square root");return a}}return function(e){const t=(e-ar)/cr;let r,n,i;for(r=e-ar,n=0;r%cr===sr;r/=cr,n++);for(i=cr;i<e&&pr(i,t,e)!==e-ar;i++)if(i>1e3)throw new Error("Cannot find square root: likely non-prime P");if(1===n){const t=(e+ar)/hr;return function(e,r){const n=e.pow(r,t);if(!e.eql(e.sqr(n),r))throw new Error("Cannot find square root");return n}}const o=(r+ar)/cr;return function(e,s){if(e.pow(s,t)===e.neg(e.ONE))throw new Error("Cannot find square root");let a=n,c=e.pow(e.mul(e.ONE,i),r),u=e.pow(s,o),h=e.pow(s,r);for(;!e.eql(h,e.ONE);){if(e.eql(h,e.ZERO))return e.ZERO;let t=1;for(let r=e.sqr(h);t<a&&!e.eql(r,e.ONE);t++)r=e.sqr(r);const r=e.pow(c,ar<<BigInt(a-t-1));c=e.sqr(r),u=e.mul(u,r),h=e.mul(h,c),a=t}return u}}(e)}(e)),s(a,t))),invertBatch:e=>function(e,t){const r=new Array(t.length),n=t.reduce(((t,n,i)=>e.is0(n)?t:(r[i]=t,e.mul(t,n))),e.ONE),i=e.inv(n);return t.reduceRight(((t,n,i)=>e.is0(n)?t:(r[i]=e.mul(t,r[i]),e.mul(t,n))),i),r}(a,e),cmov:(e,t,r)=>r?t:e,toBytes:e=>r?Xt(e,o):Jt(e,o),fromBytes:e=>{if(e.length!==o)throw new Error("Field.fromBytes: expected "+o+" bytes, got "+e.length);return r?Yt(e):function(e){return Wt(Ft(e))}(e)}});return Object.freeze(a)}const vr=BigInt(0),Sr=BigInt(1);function _r(e,t){const r=t.negate();return e?r:t}function Er(e,t){if(!Number.isSafeInteger(e)||e<=0||e>t)throw new Error("invalid window size, expected [1.."+t+"], got W="+e)}function Ir(e,t){return Er(e,t),{windows:Math.ceil(t/e)+1,windowSize:2**(e-1)}}const Ar=new WeakMap,kr=new WeakMap;function xr(e){return kr.get(e)||1}const Pr=BigInt(0),Or=BigInt(1),Rr=BigInt(2),Tr=BigInt(8),Nr={zip215:!0};BigInt(0),BigInt(1);const Mr=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),Cr=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752");BigInt(0);const Br=BigInt(1),Lr=BigInt(2);BigInt(3);const Ur=BigInt(5),Dr=BigInt(8);const jr=wr(Mr,void 0,!0),zr=function(e){const t=function(e){const t=function(e){return function(e){ir(e,br.reduce(((e,t)=>(e[t]="function",e)),{ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"}))}(e.Fp),ir(e,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...mr(e.n,e.nBitLength),...e,p:e.Fp.ORDER})}(e);return ir(e,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...t})}(e),{Fp:r,n,prehash:i,hash:o,randomBytes:s,nByteLength:a,h:c}=t,u=Rr<<BigInt(8*a)-Or,h=r.create,l=wr(t.n,t.nBitLength),d=t.uvRatio||((e,t)=>{try{return{isValid:!0,value:r.sqrt(e*r.inv(t))}}catch{return{isValid:!1,value:Pr}}}),f=t.adjustScalarBytes||(e=>e),p=t.domain||((e,t,r)=>{if($t("phflag",r),t.length||r)throw new Error("Contexts/pre-hash are not supported");return e});function g(e,t){tr("coordinate "+e,t,Pr,u)}function y(e){if(!(e instanceof w))throw new Error("ExtendedPoint expected")}const b=or(((e,t)=>{const{ex:n,ey:i,ez:o}=e,s=e.is0();null==t&&(t=s?Tr:r.inv(o));const a=h(n*t),c=h(i*t),u=h(o*t);if(s)return{x:Pr,y:Or};if(u!==Or)throw new Error("invZ was invalid");return{x:a,y:c}})),m=or((e=>{const{a:r,d:n}=t;if(e.is0())throw new Error("bad point: ZERO");const{ex:i,ey:o,ez:s,et:a}=e,c=h(i*i),u=h(o*o),l=h(s*s),d=h(l*l),f=h(c*r);if(h(l*h(f+u))!==h(d+h(n*h(c*u))))throw new Error("bad point: equation left != right (1)");if(h(i*o)!==h(s*a))throw new Error("bad point: equation left != right (2)");return!0}));class w{constructor(e,t,r,n){this.ex=e,this.ey=t,this.ez=r,this.et=n,g("x",e),g("y",t),g("z",r),g("t",n),Object.freeze(this)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(e){if(e instanceof w)throw new Error("extended point not allowed");const{x:t,y:r}=e||{};return g("x",t),g("y",r),new w(t,r,Or,h(t*r))}static normalizeZ(e){const t=r.invertBatch(e.map((e=>e.ez)));return e.map(((e,r)=>e.toAffine(t[r]))).map(w.fromAffine)}static msm(e,t){return function(e,t,r,n){if(function(e,t){if(!Array.isArray(e))throw new Error("array expected");e.forEach(((e,r)=>{if(!(e instanceof t))throw new Error("invalid point at index "+r)}))}(r,e),function(e,t){if(!Array.isArray(e))throw new Error("array of scalars expected");e.forEach(((e,r)=>{if(!t.isValid(e))throw new Error("invalid scalar at index "+r)}))}(n,t),r.length!==n.length)throw new Error("arrays of points and scalars must have equal length");const i=e.ZERO,o=function(e){let t;for(t=0;e>Ut;e>>=Dt,t+=1);return t}(BigInt(r.length)),s=o>12?o-3:o>4?o-2:o?2:1,a=(1<<s)-1,c=new Array(a+1).fill(i);let u=i;for(let e=Math.floor((t.BITS-1)/s)*s;e>=0;e-=s){c.fill(i);for(let t=0;t<n.length;t++){const i=n[t],o=Number(i>>BigInt(e)&BigInt(a));c[o]=c[o].add(r[t])}let t=i;for(let e=c.length-1,r=i;e>0;e--)r=r.add(c[e]),t=t.add(r);if(u=u.add(t),0!==e)for(let e=0;e<s;e++)u=u.double()}return u}(w,l,e,t)}_setWindowSize(e){_.setWindowSize(this,e)}assertValidity(){m(this)}equals(e){y(e);const{ex:t,ey:r,ez:n}=this,{ex:i,ey:o,ez:s}=e,a=h(t*s),c=h(i*n),u=h(r*s),l=h(o*n);return a===c&&u===l}is0(){return this.equals(w.ZERO)}negate(){return new w(h(-this.ex),this.ey,this.ez,h(-this.et))}double(){const{a:e}=t,{ex:r,ey:n,ez:i}=this,o=h(r*r),s=h(n*n),a=h(Rr*h(i*i)),c=h(e*o),u=r+n,l=h(h(u*u)-o-s),d=c+s,f=d-a,p=c-s,g=h(l*f),y=h(d*p),b=h(l*p),m=h(f*d);return new w(g,y,m,b)}add(e){y(e);const{a:r,d:n}=t,{ex:i,ey:o,ez:s,et:a}=this,{ex:c,ey:u,ez:l,et:d}=e;if(r===BigInt(-1)){const e=h((o-i)*(u+c)),t=h((o+i)*(u-c)),r=h(t-e);if(r===Pr)return this.double();const n=h(s*Rr*d),f=h(a*Rr*l),p=f+n,g=t+e,y=f-n,b=h(p*r),m=h(g*y),v=h(p*y),S=h(r*g);return new w(b,m,S,v)}const f=h(i*c),p=h(o*u),g=h(a*n*d),b=h(s*l),m=h((i+o)*(c+u)-f-p),v=b-g,S=b+g,_=h(p-r*f),E=h(m*v),I=h(S*_),A=h(m*_),k=h(v*S);return new w(E,I,k,A)}subtract(e){return this.add(e.negate())}wNAF(e){return _.wNAFCached(this,e,w.normalizeZ)}multiply(e){const t=e;tr("scalar",t,Or,n);const{p:r,f:i}=this.wNAF(t);return w.normalizeZ([r,i])[0]}multiplyUnsafe(e,t=w.ZERO){const r=e;return tr("scalar",r,Pr,n),r===Pr?S:this.is0()||r===Or?this:_.wNAFCachedUnsafe(this,r,w.normalizeZ,t)}isSmallOrder(){return this.multiplyUnsafe(c).is0()}isTorsionFree(){return _.unsafeLadder(this,n).is0()}toAffine(e){return b(this,e)}clearCofactor(){const{h:e}=t;return e===Or?this:this.multiplyUnsafe(e)}static fromHex(e,n=!1){const{d:i,a:o}=t,s=r.BYTES;e=Zt("pointHex",e,s),$t("zip215",n);const a=e.slice(),c=e[s-1];a[s-1]=-129&c;const l=Yt(a),f=n?u:r.ORDER;tr("pointHex.y",l,Pr,f);const p=h(l*l),g=h(p-Or),y=h(i*p-o);let{isValid:b,value:m}=d(g,y);if(!b)throw new Error("Point.fromHex: invalid y coordinate");const v=(m&Or)===Or,S=!!(128&c);if(!n&&m===Pr&&S)throw new Error("Point.fromHex: x=0 and x_0=1");return S!==v&&(m=h(-m)),w.fromAffine({x:m,y:l})}static fromPrivateKey(e){return A(e).point}toRawBytes(){const{x:e,y:t}=this.toAffine(),n=Xt(t,r.BYTES);return n[n.length-1]|=e&Or?128:0,n}toHex(){return Ft(this.toRawBytes())}}w.BASE=new w(t.Gx,t.Gy,Or,h(t.Gx*t.Gy)),w.ZERO=new w(Pr,Or,Or,Pr);const{BASE:v,ZERO:S}=w,_=function(e,t){return{constTimeNegate:_r,hasPrecomputes:e=>1!==xr(e),unsafeLadder(t,r,n=e.ZERO){let i=t;for(;r>vr;)r&Sr&&(n=n.add(i)),i=i.double(),r>>=Sr;return n},precomputeWindow(e,r){const{windows:n,windowSize:i}=Ir(r,t),o=[];let s=e,a=s;for(let e=0;e<n;e++){a=s,o.push(a);for(let e=1;e<i;e++)a=a.add(s),o.push(a);s=a.double()}return o},wNAF(r,n,i){const{windows:o,windowSize:s}=Ir(r,t);let a=e.ZERO,c=e.BASE;const u=BigInt(2**r-1),h=2**r,l=BigInt(r);for(let e=0;e<o;e++){const t=e*s;let r=Number(i&u);i>>=l,r>s&&(r-=h,i+=Sr);const o=t,d=t+Math.abs(r)-1,f=e%2!=0,p=r<0;0===r?c=c.add(_r(f,n[o])):a=a.add(_r(p,n[d]))}return{p:a,f:c}},wNAFUnsafe(r,n,i,o=e.ZERO){const{windows:s,windowSize:a}=Ir(r,t),c=BigInt(2**r-1),u=2**r,h=BigInt(r);for(let e=0;e<s;e++){const t=e*a;if(i===vr)break;let r=Number(i&c);if(i>>=h,r>a&&(r-=u,i+=Sr),0===r)continue;let s=n[t+Math.abs(r)-1];r<0&&(s=s.negate()),o=o.add(s)}return o},getPrecomputes(e,t,r){let n=Ar.get(t);return n||(n=this.precomputeWindow(t,e),1!==e&&Ar.set(t,r(n))),n},wNAFCached(e,t,r){const n=xr(e);return this.wNAF(n,this.getPrecomputes(n,e,r),t)},wNAFCachedUnsafe(e,t,r,n){const i=xr(e);return 1===i?this.unsafeLadder(e,t,n):this.wNAFUnsafe(i,this.getPrecomputes(i,e,r),t,n)},setWindowSize(e,r){Er(r,t),kr.set(e,r),Ar.delete(e)}}}(w,8*a);function E(e){return fr(e,n)}function I(e){return E(Yt(e))}function A(e){const t=r.BYTES;e=Zt("private key",e,t);const n=Zt("hashed private key",o(e),2*t),i=f(n.slice(0,t)),s=n.slice(t,2*t),a=I(i),c=v.multiply(a),u=c.toRawBytes();return{head:i,prefix:s,scalar:a,point:c,pointBytes:u}}function k(e=new Uint8Array,...t){const r=Qt(...t);return I(o(p(r,Zt("context",e),!!i)))}const x=Nr;return v._setWindowSize(8),{CURVE:t,getPublicKey:function(e){return A(e).pointBytes},sign:function(e,t,o={}){e=Zt("message",e),i&&(e=i(e));const{prefix:s,scalar:a,pointBytes:c}=A(t),u=k(o.context,s,e),h=v.multiply(u).toRawBytes(),l=E(u+k(o.context,h,c,e)*a);return tr("signature.s",l,Pr,n),Zt("result",Qt(h,Xt(l,r.BYTES)),2*r.BYTES)},verify:function(e,t,n,o=x){const{context:s,zip215:a}=o,c=r.BYTES;e=Zt("signature",e,2*c),t=Zt("message",t),n=Zt("publicKey",n,c),void 0!==a&&$t("zip215",a),i&&(t=i(t));const u=Yt(e.slice(c,2*c));let h,l,d;try{h=w.fromHex(n,a),l=w.fromHex(e.slice(0,c),a),d=v.multiplyUnsafe(u)}catch{return!1}if(!a&&h.isSmallOrder())return!1;const f=k(s,l.toRawBytes(),h.toRawBytes(),t);return l.add(h.multiplyUnsafe(f)).subtract(d).clearCofactor().equals(w.ZERO)},ExtendedPoint:w,utils:{getExtendedPublicKey:A,randomPrivateKey:()=>s(r.BYTES),precompute:(e=8,t=w.BASE)=>(t._setWindowSize(e),t.multiply(BigInt(3)),t)}}}({a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),Fp:jr,n:BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),h:Dr,Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960"),hash:Lt,randomBytes:dt,adjustScalarBytes:function(e){return e[0]&=248,e[31]&=127,e[31]|=64,e},uvRatio:function(e,t){const r=Mr,n=fr(t*t*t,r),i=function(e){const t=BigInt(10),r=BigInt(20),n=BigInt(40),i=BigInt(80),o=Mr,s=e*e%o*e%o,a=gr(s,Lr,o)*s%o,c=gr(a,Br,o)*e%o,u=gr(c,Ur,o)*c%o,h=gr(u,t,o)*u%o,l=gr(h,r,o)*h%o,d=gr(l,n,o)*l%o,f=gr(d,i,o)*d%o,p=gr(f,i,o)*d%o,g=gr(p,t,o)*u%o;return{pow_p_5_8:gr(g,Lr,o)*e%o,b2:s}}(e*fr(n*n*t,r)).pow_p_5_8;let o=fr(e*n*i,r);const s=fr(t*o*o,r),a=o,c=fr(o*Cr,r),u=s===e,h=s===fr(-e,r),l=s===fr(-e*Cr,r);return u&&(o=a),(h||l)&&(o=c),((e,t)=>(fr(e,t)&ar)===ar)(o,r)&&(o=fr(-o,r)),{isValid:u||h,value:o}}}),qr=".",$r="base64url",Kr="utf8",Fr="utf8",Wr=":",Hr="did",Vr="key",Gr="base58btc",Yr="z",Jr="K36";function Xr(e){return null!=globalThis.Buffer?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e}function Zr(e=0){return null!=globalThis.Buffer&&null!=globalThis.Buffer.allocUnsafe?Xr(globalThis.Buffer.allocUnsafe(e)):new Uint8Array(e)}function Qr(e,t){t||(t=e.reduce(((e,t)=>e+t.length),0));const r=Zr(t);let n=0;for(const t of e)r.set(t,n),n+=t.length;return Xr(r)}var en=function(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<e.length;i++){var o=e.charAt(i),s=o.charCodeAt(0);if(255!==r[s])throw new TypeError(o+" is ambiguous");r[s]=i}var a=e.length,c=e.charAt(0),u=Math.log(a)/Math.log(256),h=Math.log(256)/Math.log(a);function l(e){if("string"!=typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){for(var n=0,i=0;e[t]===c;)n++,t++;for(var o=(e.length-t)*u+1>>>0,s=new Uint8Array(o);e[t];){var h=r[e.charCodeAt(t)];if(255===h)return;for(var l=0,d=o-1;(0!==h||l<i)&&-1!==d;d--,l++)h+=a*s[d]>>>0,s[d]=h%256>>>0,h=h/256>>>0;if(0!==h)throw new Error("Non-zero carry");i=l,t++}if(" "!==e[t]){for(var f=o-i;f!==o&&0===s[f];)f++;for(var p=new Uint8Array(n+(o-f)),g=n;f!==o;)p[g++]=s[f++];return p}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var r=0,n=0,i=0,o=t.length;i!==o&&0===t[i];)i++,r++;for(var s=(o-i)*h+1>>>0,u=new Uint8Array(s);i!==o;){for(var l=t[i],d=0,f=s-1;(0!==l||d<n)&&-1!==f;f--,d++)l+=256*u[f]>>>0,u[f]=l%a>>>0,l=l/a>>>0;if(0!==l)throw new Error("Non-zero carry");n=d,i++}for(var p=s-n;p!==s&&0===u[p];)p++;for(var g=c.repeat(r);p<s;++p)g+=e.charAt(u[p]);return g},decodeUnsafe:l,decode:function(e){var r=l(e);if(r)return r;throw new Error(`Non-${t} character`)}}};const tn=e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")};class rn{constructor(e,t,r){this.name=e,this.prefix=t,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class nn{constructor(e,t,r){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=r}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return sn(this,e)}}class on{constructor(e){this.decoders=e}or(e){return sn(this,e)}decode(e){const t=e[0],r=this.decoders[t];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const sn=(e,t)=>new on({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class an{constructor(e,t,r,n){this.name=e,this.prefix=t,this.baseEncode=r,this.baseDecode=n,this.encoder=new rn(e,t,r),this.decoder=new nn(e,t,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const cn=({name:e,prefix:t,encode:r,decode:n})=>new an(e,t,r,n),un=({prefix:e,name:t,alphabet:r})=>{const{encode:n,decode:i}=en(r,t);return cn({prefix:e,name:t,encode:n,decode:e=>tn(i(e))})},hn=({name:e,prefix:t,bitsPerChar:r,alphabet:n})=>cn({prefix:t,name:e,encode:e=>((e,t,r)=>{const n="="===t[t.length-1],i=(1<<r)-1;let o="",s=0,a=0;for(let n=0;n<e.length;++n)for(a=a<<8|e[n],s+=8;s>r;)s-=r,o+=t[i&a>>s];if(s&&(o+=t[i&a<<r-s]),n)for(;o.length*r&7;)o+="=";return o})(e,n,r),decode:t=>((e,t,r,n)=>{const i={};for(let e=0;e<t.length;++e)i[t[e]]=e;let o=e.length;for(;"="===e[o-1];)--o;const s=new Uint8Array(o*r/8|0);let a=0,c=0,u=0;for(let t=0;t<o;++t){const o=i[e[t]];if(void 0===o)throw new SyntaxError(`Non-${n} character`);c=c<<r|o,a+=r,a>=8&&(a-=8,s[u++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return s})(t,n,r,e)}),ln=cn({prefix:"\0",name:"identity",encode:e=>(e=>(new TextDecoder).decode(e))(e),decode:e=>(e=>(new TextEncoder).encode(e))(e)});var dn=Object.freeze({__proto__:null,identity:ln});const fn=hn({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var pn=Object.freeze({__proto__:null,base2:fn});const gn=hn({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var yn=Object.freeze({__proto__:null,base8:gn});const bn=un({prefix:"9",name:"base10",alphabet:"0123456789"});var mn=Object.freeze({__proto__:null,base10:bn});const wn=hn({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),vn=hn({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var Sn=Object.freeze({__proto__:null,base16:wn,base16upper:vn});const _n=hn({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),En=hn({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),In=hn({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),An=hn({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),kn=hn({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),xn=hn({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Pn=hn({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),On=hn({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Rn=hn({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var Tn=Object.freeze({__proto__:null,base32:_n,base32upper:En,base32pad:In,base32padupper:An,base32hex:kn,base32hexupper:xn,base32hexpad:Pn,base32hexpadupper:On,base32z:Rn});const Nn=un({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Mn=un({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var Cn=Object.freeze({__proto__:null,base36:Nn,base36upper:Mn});const Bn=un({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Ln=un({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var Un=Object.freeze({__proto__:null,base58btc:Bn,base58flickr:Ln});const Dn=hn({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),jn=hn({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),zn=hn({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),qn=hn({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var $n=Object.freeze({__proto__:null,base64:Dn,base64pad:jn,base64url:zn,base64urlpad:qn});const Kn=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),Fn=Kn.reduce(((e,t,r)=>(e[r]=t,e)),[]),Wn=Kn.reduce(((e,t,r)=>(e[t.codePointAt(0)]=r,e)),[]),Hn=cn({prefix:"🚀",name:"base256emoji",encode:function(e){return e.reduce(((e,t)=>e+Fn[t]),"")},decode:function(e){const t=[];for(const r of e){const e=Wn[r.codePointAt(0)];if(void 0===e)throw new Error(`Non-base256emoji character: ${r}`);t.push(e)}return new Uint8Array(t)}});var Vn=Object.freeze({__proto__:null,base256emoji:Hn}),Gn=128,Yn=-128,Jn=Math.pow(2,31),Xn=128,Zn=127,Qn=Math.pow(2,7),ei=Math.pow(2,14),ti=Math.pow(2,21),ri=Math.pow(2,28),ni=Math.pow(2,35),ii=Math.pow(2,42),oi=Math.pow(2,49),si=Math.pow(2,56),ai=Math.pow(2,63),ci={encode:function e(t,r,n){r=r||[];for(var i=n=n||0;t>=Jn;)r[n++]=255&t|Gn,t/=128;for(;t&Yn;)r[n++]=255&t|Gn,t>>>=7;return r[n]=0|t,e.bytes=n-i+1,r},decode:function e(t,r){var n,i=0,o=0,s=r=r||0,a=t.length;do{if(s>=a)throw e.bytes=0,new RangeError("Could not decode varint");n=t[s++],i+=o<28?(n&Zn)<<o:(n&Zn)*Math.pow(2,o),o+=7}while(n>=Xn);return e.bytes=s-r,i},encodingLength:function(e){return e<Qn?1:e<ei?2:e<ti?3:e<ri?4:e<ni?5:e<ii?6:e<oi?7:e<si?8:e<ai?9:10}},ui=ci;const hi=(e,t,r=0)=>(ui.encode(e,t,r),t),li=e=>ui.encodingLength(e),di=(e,t)=>{const r=t.byteLength,n=li(e),i=n+li(r),o=new Uint8Array(i+r);return hi(e,o,0),hi(r,o,n),o.set(t,i),new fi(e,r,t,o)};class fi{constructor(e,t,r,n){this.code=e,this.size=t,this.digest=r,this.bytes=n}}const pi=({name:e,code:t,encode:r})=>new gi(e,t,r);class gi{constructor(e,t,r){this.name=e,this.code=t,this.encode=r}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?di(this.code,t):t.then((e=>di(this.code,e)))}throw Error("Unknown type, must be binary type")}}const yi=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t)),bi=pi({name:"sha2-256",code:18,encode:yi("SHA-256")}),mi=pi({name:"sha2-512",code:19,encode:yi("SHA-512")});Object.freeze({__proto__:null,sha256:bi,sha512:mi});const wi=tn,vi={code:0,name:"identity",encode:wi,digest:e=>di(0,wi(e))};Object.freeze({__proto__:null,identity:vi}),new TextEncoder,new TextDecoder;const Si={...dn,...pn,...yn,...mn,...Sn,...Tn,...Cn,...Un,...$n,...Vn};function _i(e,t,r,n){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:r},decoder:{decode:n}}}const Ei=_i("utf8","u",(e=>"u"+new TextDecoder("utf8").decode(e)),(e=>(new TextEncoder).encode(e.substring(1)))),Ii=_i("ascii","a",(e=>{let t="a";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t}),(e=>{const t=Zr((e=e.substring(1)).length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t})),Ai={utf8:Ei,"utf-8":Ei,hex:Si.base16,latin1:Ii,ascii:Ii,binary:Ii,...Si};function ki(e,t="utf8"){const r=Ai[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?r.encoder.encode(e).substring(1):globalThis.Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString("utf8")}function xi(e,t="utf8"){const r=Ai[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?r.decoder.decode(`${r.prefix}${e}`):Xr(globalThis.Buffer.from(e,"utf-8"))}function Pi(e){return me(ki(xi(e,$r),Kr))}function Oi(e){return ki(xi(we(e),Kr),$r)}function Ri(e){const t=xi(Jr,Gr),r=Yr+ki(Qr([t,e]),Gr);return[Hr,Vr,r].join(Wr)}function Ti(e){return ki(e,$r)}function Ni(e){const t=e.split(qr),r=Pi(t[0]),n=Pi(t[1]),i=function(e){return xi(e,$r)}(t[2]);return{header:r,payload:n,signature:i,data:xi(t.slice(0,2).join(qr),Fr)}}function Mi(e=dt(32)){const t=zr.getPublicKey(e);return{secretKey:Qr([e,t]),publicKey:t}}var Ci=r(3184),Bi=function(e,t,r){if(r||2===arguments.length)for(var n,i=0,o=t.length;i<o;i++)!n&&i in t||(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))},Li=function(e,t,r){this.name=e,this.version=t,this.os=r,this.type="browser"},Ui=function(e){this.version=e,this.type="node",this.name="node",this.os=Ci.platform},Di=function(e,t,r,n){this.name=e,this.version=t,this.os=r,this.bot=n,this.type="bot-device"},ji=function(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null},zi=function(){this.type="react-native",this.name="react-native",this.version=null,this.os=null},qi=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,$i=3,Ki=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/]],Fi=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function Wi(e){var t=function(e){return""!==e&&Ki.reduce((function(t,r){var n=r[0],i=r[1];if(t)return t;var o=i.exec(e);return!!o&&[n,o]}),!1)}(e);if(!t)return null;var r=t[0],n=t[1];if("searchbot"===r)return new ji;var i=n[1]&&n[1].split(".").join("_").split("_").slice(0,3);i?i.length<$i&&(i=Bi(Bi([],i,!0),function(e){for(var t=[],r=0;r<e;r++)t.push("0");return t}($i-i.length),!0)):i=[];var o=i.join("."),s=function(e){for(var t=0,r=Fi.length;t<r;t++){var n=Fi[t],i=n[0];if(n[1].exec(e))return i}return null}(e),a=qi.exec(e);return a&&a[1]?new Di(r,o,s,a[1]):new Li(r,o,s)}var Hi=r(6122),Vi=r(8797);let Gi=!1,Yi=!1;const Ji={debug:1,default:2,info:2,warning:3,error:4,off:5};let Xi=Ji.default,Zi=null;const Qi=function(){try{const e=[];if(["NFD","NFC","NFKD","NFKC"].forEach((t=>{try{if("test"!=="test".normalize(t))throw new Error("bad normalize")}catch(r){e.push(t)}})),e.length)throw new Error("missing "+e.join(", "));if(String.fromCharCode(233).normalize("NFD")!==String.fromCharCode(101,769))throw new Error("broken implementation")}catch(e){return e.message}return null}();var eo,to,ro,no;(to=eo||(eo={})).DEBUG="DEBUG",to.INFO="INFO",to.WARNING="WARNING",to.ERROR="ERROR",to.OFF="OFF",(no=ro||(ro={})).UNKNOWN_ERROR="UNKNOWN_ERROR",no.NOT_IMPLEMENTED="NOT_IMPLEMENTED",no.UNSUPPORTED_OPERATION="UNSUPPORTED_OPERATION",no.NETWORK_ERROR="NETWORK_ERROR",no.SERVER_ERROR="SERVER_ERROR",no.TIMEOUT="TIMEOUT",no.BUFFER_OVERRUN="BUFFER_OVERRUN",no.NUMERIC_FAULT="NUMERIC_FAULT",no.MISSING_NEW="MISSING_NEW",no.INVALID_ARGUMENT="INVALID_ARGUMENT",no.MISSING_ARGUMENT="MISSING_ARGUMENT",no.UNEXPECTED_ARGUMENT="UNEXPECTED_ARGUMENT",no.CALL_EXCEPTION="CALL_EXCEPTION",no.INSUFFICIENT_FUNDS="INSUFFICIENT_FUNDS",no.NONCE_EXPIRED="NONCE_EXPIRED",no.REPLACEMENT_UNDERPRICED="REPLACEMENT_UNDERPRICED",no.UNPREDICTABLE_GAS_LIMIT="UNPREDICTABLE_GAS_LIMIT",no.TRANSACTION_REPLACED="TRANSACTION_REPLACED",no.ACTION_REJECTED="ACTION_REJECTED";const io="0123456789abcdef";class oo{constructor(e){Object.defineProperty(this,"version",{enumerable:!0,value:e,writable:!1})}_log(e,t){const r=e.toLowerCase();null==Ji[r]&&this.throwArgumentError("invalid log level name","logLevel",e),Xi>Ji[r]||console.log.apply(console,t)}debug(...e){this._log(oo.levels.DEBUG,e)}info(...e){this._log(oo.levels.INFO,e)}warn(...e){this._log(oo.levels.WARNING,e)}makeError(e,t,r){if(Yi)return this.makeError("censored error",t,{});t||(t=oo.errors.UNKNOWN_ERROR),r||(r={});const n=[];Object.keys(r).forEach((e=>{const t=r[e];try{if(t instanceof Uint8Array){let r="";for(let e=0;e<t.length;e++)r+=io[t[e]>>4],r+=io[15&t[e]];n.push(e+"=Uint8Array(0x"+r+")")}else n.push(e+"="+JSON.stringify(t))}catch(t){n.push(e+"="+JSON.stringify(r[e].toString()))}})),n.push(`code=${t}`),n.push(`version=${this.version}`);const i=e;let o="";switch(t){case ro.NUMERIC_FAULT:{o="NUMERIC_FAULT";const t=e;switch(t){case"overflow":case"underflow":case"division-by-zero":o+="-"+t;break;case"negative-power":case"negative-width":o+="-unsupported";break;case"unbound-bitwise-result":o+="-unbound-result"}break}case ro.CALL_EXCEPTION:case ro.INSUFFICIENT_FUNDS:case ro.MISSING_NEW:case ro.NONCE_EXPIRED:case ro.REPLACEMENT_UNDERPRICED:case ro.TRANSACTION_REPLACED:case ro.UNPREDICTABLE_GAS_LIMIT:o=t}o&&(e+=" [ See: https://links.ethers.org/v5-errors-"+o+" ]"),n.length&&(e+=" ("+n.join(", ")+")");const s=new Error(e);return s.reason=i,s.code=t,Object.keys(r).forEach((function(e){s[e]=r[e]})),s}throwError(e,t,r){throw this.makeError(e,t,r)}throwArgumentError(e,t,r){return this.throwError(e,oo.errors.INVALID_ARGUMENT,{argument:t,value:r})}assert(e,t,r,n){e||this.throwError(t,r,n)}assertArgument(e,t,r,n){e||this.throwArgumentError(t,r,n)}checkNormalize(e){null==e&&(e="platform missing String.prototype.normalize"),Qi&&this.throwError("platform missing String.prototype.normalize",oo.errors.UNSUPPORTED_OPERATION,{operation:"String.prototype.normalize",form:Qi})}checkSafeUint53(e,t){"number"==typeof e&&(null==t&&(t="value not safe"),(e<0||e>=9007199254740991)&&this.throwError(t,oo.errors.NUMERIC_FAULT,{operation:"checkSafeInteger",fault:"out-of-safe-range",value:e}),e%1&&this.throwError(t,oo.errors.NUMERIC_FAULT,{operation:"checkSafeInteger",fault:"non-integer",value:e}))}checkArgumentCount(e,t,r){r=r?": "+r:"",e<t&&this.throwError("missing argument"+r,oo.errors.MISSING_ARGUMENT,{count:e,expectedCount:t}),e>t&&this.throwError("too many arguments"+r,oo.errors.UNEXPECTED_ARGUMENT,{count:e,expectedCount:t})}checkNew(e,t){e!==Object&&null!=e||this.throwError("missing new",oo.errors.MISSING_NEW,{name:t.name})}checkAbstract(e,t){e===t?this.throwError("cannot instantiate abstract class "+JSON.stringify(t.name)+" directly; use a sub-class",oo.errors.UNSUPPORTED_OPERATION,{name:e.name,operation:"new"}):e!==Object&&null!=e||this.throwError("missing new",oo.errors.MISSING_NEW,{name:t.name})}static globalLogger(){return Zi||(Zi=new oo("logger/5.7.0")),Zi}static setCensorship(e,t){if(!e&&t&&this.globalLogger().throwError("cannot permanently disable censorship",oo.errors.UNSUPPORTED_OPERATION,{operation:"setCensorship"}),Gi){if(!e)return;this.globalLogger().throwError("error censorship permanent",oo.errors.UNSUPPORTED_OPERATION,{operation:"setCensorship"})}Yi=!!e,Gi=!!t}static setLogLevel(e){const t=Ji[e.toLowerCase()];null!=t?Xi=t:oo.globalLogger().warn("invalid log level - "+e)}static from(e){return new oo(e)}}oo.errors=ro,oo.levels=eo;const so=new oo("bytes/5.7.0");function ao(e){return!!e.toHexString}function co(e){return e.slice||(e.slice=function(){const t=Array.prototype.slice.call(arguments);return co(new Uint8Array(Array.prototype.slice.apply(e,t)))}),e}function uo(e){return"number"==typeof e&&e==e&&e%1==0}function ho(e){if(null==e)return!1;if(e.constructor===Uint8Array)return!0;if("string"==typeof e)return!1;if(!uo(e.length)||e.length<0)return!1;for(let t=0;t<e.length;t++){const r=e[t];if(!uo(r)||r<0||r>=256)return!1}return!0}function lo(e,t){if(t||(t={}),"number"==typeof e){so.checkSafeUint53(e,"invalid arrayify value");const t=[];for(;e;)t.unshift(255&e),e=parseInt(String(e/256));return 0===t.length&&t.push(0),co(new Uint8Array(t))}if(t.allowMissingPrefix&&"string"==typeof e&&"0x"!==e.substring(0,2)&&(e="0x"+e),ao(e)&&(e=e.toHexString()),fo(e)){let r=e.substring(2);r.length%2&&("left"===t.hexPad?r="0"+r:"right"===t.hexPad?r+="0":so.throwArgumentError("hex data is odd-length","value",e));const n=[];for(let e=0;e<r.length;e+=2)n.push(parseInt(r.substring(e,e+2),16));return co(new Uint8Array(n))}return ho(e)?co(new Uint8Array(e)):so.throwArgumentError("invalid arrayify value","value",e)}function fo(e,t){return!("string"!=typeof e||!e.match(/^0x[0-9A-Fa-f]*$/)||t&&e.length!==2+2*t)}const po="0123456789abcdef";function go(e,t){if(t||(t={}),"number"==typeof e){so.checkSafeUint53(e,"invalid hexlify value");let t="";for(;e;)t=po[15&e]+t,e=Math.floor(e/16);return t.length?(t.length%2&&(t="0"+t),"0x"+t):"0x00"}if("bigint"==typeof e)return(e=e.toString(16)).length%2?"0x0"+e:"0x"+e;if(t.allowMissingPrefix&&"string"==typeof e&&"0x"!==e.substring(0,2)&&(e="0x"+e),ao(e))return e.toHexString();if(fo(e))return e.length%2&&("left"===t.hexPad?e="0x0"+e.substring(2):"right"===t.hexPad?e+="0":so.throwArgumentError("hex data is odd-length","value",e)),e.toLowerCase();if(ho(e)){let t="0x";for(let r=0;r<e.length;r++){let n=e[r];t+=po[(240&n)>>4]+po[15&n]}return t}return so.throwArgumentError("invalid hexlify value","value",e)}function yo(e,t,r){return"string"!=typeof e?e=go(e):(!fo(e)||e.length%2)&&so.throwArgumentError("invalid hexData","value",e),t=2+2*t,null!=r?"0x"+e.substring(t,2+2*r):"0x"+e.substring(t)}function bo(e,t){for("string"!=typeof e?e=go(e):fo(e)||so.throwArgumentError("invalid hex string","value",e),e.length>2*t+2&&so.throwArgumentError("value out of range","value",arguments[1]);e.length<2*t+2;)e="0x0"+e.substring(2);return e}function mo(e){const t={r:"0x",s:"0x",_vs:"0x",recoveryParam:0,v:0,yParityAndS:"0x",compact:"0x"};if(fo(r=e)&&!(r.length%2)||ho(r)){let r=lo(e);64===r.length?(t.v=27+(r[32]>>7),r[32]&=127,t.r=go(r.slice(0,32)),t.s=go(r.slice(32,64))):65===r.length?(t.r=go(r.slice(0,32)),t.s=go(r.slice(32,64)),t.v=r[64]):so.throwArgumentError("invalid signature string","signature",e),t.v<27&&(0===t.v||1===t.v?t.v+=27:so.throwArgumentError("signature invalid v byte","signature",e)),t.recoveryParam=1-t.v%2,t.recoveryParam&&(r[32]|=128),t._vs=go(r.slice(32,64))}else{if(t.r=e.r,t.s=e.s,t.v=e.v,t.recoveryParam=e.recoveryParam,t._vs=e._vs,null!=t._vs){const r=function(e,t){(e=lo(e)).length>t&&so.throwArgumentError("value out of range","value",arguments[0]);const r=new Uint8Array(t);return r.set(e,t-e.length),co(r)}(lo(t._vs),32);t._vs=go(r);const n=r[0]>=128?1:0;null==t.recoveryParam?t.recoveryParam=n:t.recoveryParam!==n&&so.throwArgumentError("signature recoveryParam mismatch _vs","signature",e),r[0]&=127;const i=go(r);null==t.s?t.s=i:t.s!==i&&so.throwArgumentError("signature v mismatch _vs","signature",e)}if(null==t.recoveryParam)null==t.v?so.throwArgumentError("signature missing v and recoveryParam","signature",e):0===t.v||1===t.v?t.recoveryParam=t.v:t.recoveryParam=1-t.v%2;else if(null==t.v)t.v=27+t.recoveryParam;else{const r=0===t.v||1===t.v?t.v:1-t.v%2;t.recoveryParam!==r&&so.throwArgumentError("signature recoveryParam mismatch v","signature",e)}null!=t.r&&fo(t.r)?t.r=bo(t.r,32):so.throwArgumentError("signature missing or invalid r","signature",e),null!=t.s&&fo(t.s)?t.s=bo(t.s,32):so.throwArgumentError("signature missing or invalid s","signature",e);const r=lo(t.s);r[0]>=128&&so.throwArgumentError("signature s out of range","signature",e),t.recoveryParam&&(r[0]|=128);const n=go(r);t._vs&&(fo(t._vs)||so.throwArgumentError("signature invalid _vs","signature",e),t._vs=bo(t._vs,32)),null==t._vs?t._vs=n:t._vs!==n&&so.throwArgumentError("signature _vs mismatch v and s","signature",e)}var r;return t.yParityAndS=t._vs,t.compact=t.r+t.yParityAndS.substring(2),t}var wo=r(5530),vo=r.n(wo),So=vo().BN;new oo("bignumber/5.7.0");var _o=r(5938),Eo=r.n(_o);function Io(e){return"0x"+Eo().keccak_256(lo(e))}const Ao=new oo("address/5.7.0");function ko(e){fo(e,20)||Ao.throwArgumentError("invalid address","address",e);const t=(e=e.toLowerCase()).substring(2).split(""),r=new Uint8Array(40);for(let e=0;e<40;e++)r[e]=t[e].charCodeAt(0);const n=lo(Io(r));for(let e=0;e<40;e+=2)n[e>>1]>>4>=8&&(t[e]=t[e].toUpperCase()),(15&n[e>>1])>=8&&(t[e+1]=t[e+1].toUpperCase());return"0x"+t.join("")}const xo={};for(let e=0;e<10;e++)xo[String(e)]=String(e);for(let e=0;e<26;e++)xo[String.fromCharCode(65+e)]=String(10+e);const Po=Math.floor((Oo=9007199254740991,Math.log10?Math.log10(Oo):Math.log(Oo)/Math.LN10));var Oo;function Ro(e){let t=null;if("string"!=typeof e&&Ao.throwArgumentError("invalid address","address",e),e.match(/^(0x)?[0-9a-fA-F]{40}$/))"0x"!==e.substring(0,2)&&(e="0x"+e),t=ko(e),e.match(/([A-F].*[a-f])|([a-f].*[A-F])/)&&t!==e&&Ao.throwArgumentError("bad address checksum","address",e);else if(e.match(/^XE[0-9]{2}[0-9A-Za-z]{30,31}$/)){for(e.substring(2,4)!==function(e){let t=(e=(e=e.toUpperCase()).substring(4)+e.substring(0,2)+"00").split("").map((e=>xo[e])).join("");for(;t.length>=Po;){let e=t.substring(0,Po);t=parseInt(e,10)%97+t.substring(e.length)}let r=String(98-parseInt(t,10)%97);for(;r.length<2;)r="0"+r;return r}(e)&&Ao.throwArgumentError("bad icap checksum","address",e),r=e.substring(4),t=new So(r,36).toString(16);t.length<40;)t="0"+t;t=ko("0x"+t)}else Ao.throwArgumentError("invalid address","address",e);var r;return t}var To=r(7734),No=r.n(To);function Mo(e,t,r){return e(r={path:t,exports:{},require:function(e,t){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}(null==t&&r.path)}},r.exports),r.exports}"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==r.g?r.g:"undefined"!=typeof self&&self;var Co=Bo;function Bo(e,t){if(!e)throw new Error(t||"Assertion failed")}Bo.equal=function(e,t,r){if(e!=t)throw new Error(r||"Assertion failed: "+e+" != "+t)};var Lo=Mo((function(e,t){var r=t;function n(e){return 1===e.length?"0"+e:e}function i(e){for(var t="",r=0;r<e.length;r++)t+=n(e[r].toString(16));return t}r.toArray=function(e,t){if(Array.isArray(e))return e.slice();if(!e)return[];var r=[];if("string"!=typeof e){for(var n=0;n<e.length;n++)r[n]=0|e[n];return r}if("hex"===t)for((e=e.replace(/[^a-z0-9]+/gi,"")).length%2!=0&&(e="0"+e),n=0;n<e.length;n+=2)r.push(parseInt(e[n]+e[n+1],16));else for(n=0;n<e.length;n++){var i=e.charCodeAt(n),o=i>>8,s=255&i;o?r.push(o,s):r.push(s)}return r},r.zero2=n,r.toHex=i,r.encode=function(e,t){return"hex"===t?i(e):e}})),Uo=Mo((function(e,t){var r=t;r.assert=Co,r.toArray=Lo.toArray,r.zero2=Lo.zero2,r.toHex=Lo.toHex,r.encode=Lo.encode,r.getNAF=function(e,t,r){var n=new Array(Math.max(e.bitLength(),r)+1);n.fill(0);for(var i=1<<t+1,o=e.clone(),s=0;s<n.length;s++){var a,c=o.andln(i-1);o.isOdd()?(a=c>(i>>1)-1?(i>>1)-c:c,o.isubn(a)):a=0,n[s]=a,o.iushrn(1)}return n},r.getJSF=function(e,t){var r=[[],[]];e=e.clone(),t=t.clone();for(var n,i=0,o=0;e.cmpn(-i)>0||t.cmpn(-o)>0;){var s,a,c=e.andln(3)+i&3,u=t.andln(3)+o&3;3===c&&(c=-1),3===u&&(u=-1),s=1&c?3!=(n=e.andln(7)+i&7)&&5!==n||2!==u?c:-c:0,r[0].push(s),a=1&u?3!=(n=t.andln(7)+o&7)&&5!==n||2!==c?u:-u:0,r[1].push(a),2*i===s+1&&(i=1-i),2*o===a+1&&(o=1-o),e.iushrn(1),t.iushrn(1)}return r},r.cachedProperty=function(e,t,r){var n="_"+t;e.prototype[t]=function(){return void 0!==this[n]?this[n]:this[n]=r.call(this)}},r.parseBytes=function(e){return"string"==typeof e?r.toArray(e,"hex"):e},r.intFromLE=function(e){return new(vo())(e,"hex","le")}})),Do=Uo.getNAF,jo=Uo.getJSF,zo=Uo.assert;function qo(e,t){this.type=e,this.p=new(vo())(t.p,16),this.red=t.prime?vo().red(t.prime):vo().mont(this.p),this.zero=new(vo())(0).toRed(this.red),this.one=new(vo())(1).toRed(this.red),this.two=new(vo())(2).toRed(this.red),this.n=t.n&&new(vo())(t.n,16),this.g=t.g&&this.pointFromJSON(t.g,t.gRed),this._wnafT1=new Array(4),this._wnafT2=new Array(4),this._wnafT3=new Array(4),this._wnafT4=new Array(4),this._bitLength=this.n?this.n.bitLength():0;var r=this.n&&this.p.div(this.n);!r||r.cmpn(100)>0?this.redN=null:(this._maxwellTrick=!0,this.redN=this.n.toRed(this.red))}var $o=qo;function Ko(e,t){this.curve=e,this.type=t,this.precomputed=null}qo.prototype.point=function(){throw new Error("Not implemented")},qo.prototype.validate=function(){throw new Error("Not implemented")},qo.prototype._fixedNafMul=function(e,t){zo(e.precomputed);var r=e._getDoubles(),n=Do(t,1,this._bitLength),i=(1<<r.step+1)-(r.step%2==0?2:1);i/=3;var o,s,a=[];for(o=0;o<n.length;o+=r.step){s=0;for(var c=o+r.step-1;c>=o;c--)s=(s<<1)+n[c];a.push(s)}for(var u=this.jpoint(null,null,null),h=this.jpoint(null,null,null),l=i;l>0;l--){for(o=0;o<a.length;o++)(s=a[o])===l?h=h.mixedAdd(r.points[o]):s===-l&&(h=h.mixedAdd(r.points[o].neg()));u=u.add(h)}return u.toP()},qo.prototype._wnafMul=function(e,t){var r=4,n=e._getNAFPoints(r);r=n.wnd;for(var i=n.points,o=Do(t,r,this._bitLength),s=this.jpoint(null,null,null),a=o.length-1;a>=0;a--){for(var c=0;a>=0&&0===o[a];a--)c++;if(a>=0&&c++,s=s.dblp(c),a<0)break;var u=o[a];zo(0!==u),s="affine"===e.type?u>0?s.mixedAdd(i[u-1>>1]):s.mixedAdd(i[-u-1>>1].neg()):u>0?s.add(i[u-1>>1]):s.add(i[-u-1>>1].neg())}return"affine"===e.type?s.toP():s},qo.prototype._wnafMulAdd=function(e,t,r,n,i){var o,s,a,c=this._wnafT1,u=this._wnafT2,h=this._wnafT3,l=0;for(o=0;o<n;o++){var d=(a=t[o])._getNAFPoints(e);c[o]=d.wnd,u[o]=d.points}for(o=n-1;o>=1;o-=2){var f=o-1,p=o;if(1===c[f]&&1===c[p]){var g=[t[f],null,null,t[p]];0===t[f].y.cmp(t[p].y)?(g[1]=t[f].add(t[p]),g[2]=t[f].toJ().mixedAdd(t[p].neg())):0===t[f].y.cmp(t[p].y.redNeg())?(g[1]=t[f].toJ().mixedAdd(t[p]),g[2]=t[f].add(t[p].neg())):(g[1]=t[f].toJ().mixedAdd(t[p]),g[2]=t[f].toJ().mixedAdd(t[p].neg()));var y=[-3,-1,-5,-7,0,7,5,1,3],b=jo(r[f],r[p]);for(l=Math.max(b[0].length,l),h[f]=new Array(l),h[p]=new Array(l),s=0;s<l;s++){var m=0|b[0][s],w=0|b[1][s];h[f][s]=y[3*(m+1)+(w+1)],h[p][s]=0,u[f]=g}}else h[f]=Do(r[f],c[f],this._bitLength),h[p]=Do(r[p],c[p],this._bitLength),l=Math.max(h[f].length,l),l=Math.max(h[p].length,l)}var v=this.jpoint(null,null,null),S=this._wnafT4;for(o=l;o>=0;o--){for(var _=0;o>=0;){var E=!0;for(s=0;s<n;s++)S[s]=0|h[s][o],0!==S[s]&&(E=!1);if(!E)break;_++,o--}if(o>=0&&_++,v=v.dblp(_),o<0)break;for(s=0;s<n;s++){var I=S[s];0!==I&&(I>0?a=u[s][I-1>>1]:I<0&&(a=u[s][-I-1>>1].neg()),v="affine"===a.type?v.mixedAdd(a):v.add(a))}}for(o=0;o<n;o++)u[o]=null;return i?v:v.toP()},qo.BasePoint=Ko,Ko.prototype.eq=function(){throw new Error("Not implemented")},Ko.prototype.validate=function(){return this.curve.validate(this)},qo.prototype.decodePoint=function(e,t){e=Uo.toArray(e,t);var r=this.p.byteLength();if((4===e[0]||6===e[0]||7===e[0])&&e.length-1==2*r)return 6===e[0]?zo(e[e.length-1]%2==0):7===e[0]&&zo(e[e.length-1]%2==1),this.point(e.slice(1,1+r),e.slice(1+r,1+2*r));if((2===e[0]||3===e[0])&&e.length-1===r)return this.pointFromX(e.slice(1,1+r),3===e[0]);throw new Error("Unknown point format")},Ko.prototype.encodeCompressed=function(e){return this.encode(e,!0)},Ko.prototype._encode=function(e){var t=this.curve.p.byteLength(),r=this.getX().toArray("be",t);return e?[this.getY().isEven()?2:3].concat(r):[4].concat(r,this.getY().toArray("be",t))},Ko.prototype.encode=function(e,t){return Uo.encode(this._encode(t),e)},Ko.prototype.precompute=function(e){if(this.precomputed)return this;var t={doubles:null,naf:null,beta:null};return t.naf=this._getNAFPoints(8),t.doubles=this._getDoubles(4,e),t.beta=this._getBeta(),this.precomputed=t,this},Ko.prototype._hasDoubles=function(e){if(!this.precomputed)return!1;var t=this.precomputed.doubles;return!!t&&t.points.length>=Math.ceil((e.bitLength()+1)/t.step)},Ko.prototype._getDoubles=function(e,t){if(this.precomputed&&this.precomputed.doubles)return this.precomputed.doubles;for(var r=[this],n=this,i=0;i<t;i+=e){for(var o=0;o<e;o++)n=n.dbl();r.push(n)}return{step:e,points:r}},Ko.prototype._getNAFPoints=function(e){if(this.precomputed&&this.precomputed.naf)return this.precomputed.naf;for(var t=[this],r=(1<<e)-1,n=1===r?null:this.dbl(),i=1;i<r;i++)t[i]=t[i-1].add(n);return{wnd:e,points:t}},Ko.prototype._getBeta=function(){return null},Ko.prototype.dblp=function(e){for(var t=this,r=0;r<e;r++)t=t.dbl();return t};var Fo=Mo((function(e){"function"==typeof Object.create?e.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:e.exports=function(e,t){if(t){e.super_=t;var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e}}})),Wo=Uo.assert;function Ho(e){$o.call(this,"short",e),this.a=new(vo())(e.a,16).toRed(this.red),this.b=new(vo())(e.b,16).toRed(this.red),this.tinv=this.two.redInvm(),this.zeroA=0===this.a.fromRed().cmpn(0),this.threeA=0===this.a.fromRed().sub(this.p).cmpn(-3),this.endo=this._getEndomorphism(e),this._endoWnafT1=new Array(4),this._endoWnafT2=new Array(4)}Fo(Ho,$o);var Vo=Ho;function Go(e,t,r,n){$o.BasePoint.call(this,e,"affine"),null===t&&null===r?(this.x=null,this.y=null,this.inf=!0):(this.x=new(vo())(t,16),this.y=new(vo())(r,16),n&&(this.x.forceRed(this.curve.red),this.y.forceRed(this.curve.red)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.inf=!1)}function Yo(e,t,r,n){$o.BasePoint.call(this,e,"jacobian"),null===t&&null===r&&null===n?(this.x=this.curve.one,this.y=this.curve.one,this.z=new(vo())(0)):(this.x=new(vo())(t,16),this.y=new(vo())(r,16),this.z=new(vo())(n,16)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.zOne=this.z===this.curve.one}Ho.prototype._getEndomorphism=function(e){if(this.zeroA&&this.g&&this.n&&1===this.p.modn(3)){var t,r;if(e.beta)t=new(vo())(e.beta,16).toRed(this.red);else{var n=this._getEndoRoots(this.p);t=(t=n[0].cmp(n[1])<0?n[0]:n[1]).toRed(this.red)}if(e.lambda)r=new(vo())(e.lambda,16);else{var i=this._getEndoRoots(this.n);0===this.g.mul(i[0]).x.cmp(this.g.x.redMul(t))?r=i[0]:(r=i[1],Wo(0===this.g.mul(r).x.cmp(this.g.x.redMul(t))))}return{beta:t,lambda:r,basis:e.basis?e.basis.map((function(e){return{a:new(vo())(e.a,16),b:new(vo())(e.b,16)}})):this._getEndoBasis(r)}}},Ho.prototype._getEndoRoots=function(e){var t=e===this.p?this.red:vo().mont(e),r=new(vo())(2).toRed(t).redInvm(),n=r.redNeg(),i=new(vo())(3).toRed(t).redNeg().redSqrt().redMul(r);return[n.redAdd(i).fromRed(),n.redSub(i).fromRed()]},Ho.prototype._getEndoBasis=function(e){for(var t,r,n,i,o,s,a,c,u,h=this.n.ushrn(Math.floor(this.n.bitLength()/2)),l=e,d=this.n.clone(),f=new(vo())(1),p=new(vo())(0),g=new(vo())(0),y=new(vo())(1),b=0;0!==l.cmpn(0);){var m=d.div(l);c=d.sub(m.mul(l)),u=g.sub(m.mul(f));var w=y.sub(m.mul(p));if(!n&&c.cmp(h)<0)t=a.neg(),r=f,n=c.neg(),i=u;else if(n&&2==++b)break;a=c,d=l,l=c,g=f,f=u,y=p,p=w}o=c.neg(),s=u;var v=n.sqr().add(i.sqr());return o.sqr().add(s.sqr()).cmp(v)>=0&&(o=t,s=r),n.negative&&(n=n.neg(),i=i.neg()),o.negative&&(o=o.neg(),s=s.neg()),[{a:n,b:i},{a:o,b:s}]},Ho.prototype._endoSplit=function(e){var t=this.endo.basis,r=t[0],n=t[1],i=n.b.mul(e).divRound(this.n),o=r.b.neg().mul(e).divRound(this.n),s=i.mul(r.a),a=o.mul(n.a),c=i.mul(r.b),u=o.mul(n.b);return{k1:e.sub(s).sub(a),k2:c.add(u).neg()}},Ho.prototype.pointFromX=function(e,t){(e=new(vo())(e,16)).red||(e=e.toRed(this.red));var r=e.redSqr().redMul(e).redIAdd(e.redMul(this.a)).redIAdd(this.b),n=r.redSqrt();if(0!==n.redSqr().redSub(r).cmp(this.zero))throw new Error("invalid point");var i=n.fromRed().isOdd();return(t&&!i||!t&&i)&&(n=n.redNeg()),this.point(e,n)},Ho.prototype.validate=function(e){if(e.inf)return!0;var t=e.x,r=e.y,n=this.a.redMul(t),i=t.redSqr().redMul(t).redIAdd(n).redIAdd(this.b);return 0===r.redSqr().redISub(i).cmpn(0)},Ho.prototype._endoWnafMulAdd=function(e,t,r){for(var n=this._endoWnafT1,i=this._endoWnafT2,o=0;o<e.length;o++){var s=this._endoSplit(t[o]),a=e[o],c=a._getBeta();s.k1.negative&&(s.k1.ineg(),a=a.neg(!0)),s.k2.negative&&(s.k2.ineg(),c=c.neg(!0)),n[2*o]=a,n[2*o+1]=c,i[2*o]=s.k1,i[2*o+1]=s.k2}for(var u=this._wnafMulAdd(1,n,i,2*o,r),h=0;h<2*o;h++)n[h]=null,i[h]=null;return u},Fo(Go,$o.BasePoint),Ho.prototype.point=function(e,t,r){return new Go(this,e,t,r)},Ho.prototype.pointFromJSON=function(e,t){return Go.fromJSON(this,e,t)},Go.prototype._getBeta=function(){if(this.curve.endo){var e=this.precomputed;if(e&&e.beta)return e.beta;var t=this.curve.point(this.x.redMul(this.curve.endo.beta),this.y);if(e){var r=this.curve,n=function(e){return r.point(e.x.redMul(r.endo.beta),e.y)};e.beta=t,t.precomputed={beta:null,naf:e.naf&&{wnd:e.naf.wnd,points:e.naf.points.map(n)},doubles:e.doubles&&{step:e.doubles.step,points:e.doubles.points.map(n)}}}return t}},Go.prototype.toJSON=function(){return this.precomputed?[this.x,this.y,this.precomputed&&{doubles:this.precomputed.doubles&&{step:this.precomputed.doubles.step,points:this.precomputed.doubles.points.slice(1)},naf:this.precomputed.naf&&{wnd:this.precomputed.naf.wnd,points:this.precomputed.naf.points.slice(1)}}]:[this.x,this.y]},Go.fromJSON=function(e,t,r){"string"==typeof t&&(t=JSON.parse(t));var n=e.point(t[0],t[1],r);if(!t[2])return n;function i(t){return e.point(t[0],t[1],r)}var o=t[2];return n.precomputed={beta:null,doubles:o.doubles&&{step:o.doubles.step,points:[n].concat(o.doubles.points.map(i))},naf:o.naf&&{wnd:o.naf.wnd,points:[n].concat(o.naf.points.map(i))}},n},Go.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+">"},Go.prototype.isInfinity=function(){return this.inf},Go.prototype.add=function(e){if(this.inf)return e;if(e.inf)return this;if(this.eq(e))return this.dbl();if(this.neg().eq(e))return this.curve.point(null,null);if(0===this.x.cmp(e.x))return this.curve.point(null,null);var t=this.y.redSub(e.y);0!==t.cmpn(0)&&(t=t.redMul(this.x.redSub(e.x).redInvm()));var r=t.redSqr().redISub(this.x).redISub(e.x),n=t.redMul(this.x.redSub(r)).redISub(this.y);return this.curve.point(r,n)},Go.prototype.dbl=function(){if(this.inf)return this;var e=this.y.redAdd(this.y);if(0===e.cmpn(0))return this.curve.point(null,null);var t=this.curve.a,r=this.x.redSqr(),n=e.redInvm(),i=r.redAdd(r).redIAdd(r).redIAdd(t).redMul(n),o=i.redSqr().redISub(this.x.redAdd(this.x)),s=i.redMul(this.x.redSub(o)).redISub(this.y);return this.curve.point(o,s)},Go.prototype.getX=function(){return this.x.fromRed()},Go.prototype.getY=function(){return this.y.fromRed()},Go.prototype.mul=function(e){return e=new(vo())(e,16),this.isInfinity()?this:this._hasDoubles(e)?this.curve._fixedNafMul(this,e):this.curve.endo?this.curve._endoWnafMulAdd([this],[e]):this.curve._wnafMul(this,e)},Go.prototype.mulAdd=function(e,t,r){var n=[this,t],i=[e,r];return this.curve.endo?this.curve._endoWnafMulAdd(n,i):this.curve._wnafMulAdd(1,n,i,2)},Go.prototype.jmulAdd=function(e,t,r){var n=[this,t],i=[e,r];return this.curve.endo?this.curve._endoWnafMulAdd(n,i,!0):this.curve._wnafMulAdd(1,n,i,2,!0)},Go.prototype.eq=function(e){return this===e||this.inf===e.inf&&(this.inf||0===this.x.cmp(e.x)&&0===this.y.cmp(e.y))},Go.prototype.neg=function(e){if(this.inf)return this;var t=this.curve.point(this.x,this.y.redNeg());if(e&&this.precomputed){var r=this.precomputed,n=function(e){return e.neg()};t.precomputed={naf:r.naf&&{wnd:r.naf.wnd,points:r.naf.points.map(n)},doubles:r.doubles&&{step:r.doubles.step,points:r.doubles.points.map(n)}}}return t},Go.prototype.toJ=function(){return this.inf?this.curve.jpoint(null,null,null):this.curve.jpoint(this.x,this.y,this.curve.one)},Fo(Yo,$o.BasePoint),Ho.prototype.jpoint=function(e,t,r){return new Yo(this,e,t,r)},Yo.prototype.toP=function(){if(this.isInfinity())return this.curve.point(null,null);var e=this.z.redInvm(),t=e.redSqr(),r=this.x.redMul(t),n=this.y.redMul(t).redMul(e);return this.curve.point(r,n)},Yo.prototype.neg=function(){return this.curve.jpoint(this.x,this.y.redNeg(),this.z)},Yo.prototype.add=function(e){if(this.isInfinity())return e;if(e.isInfinity())return this;var t=e.z.redSqr(),r=this.z.redSqr(),n=this.x.redMul(t),i=e.x.redMul(r),o=this.y.redMul(t.redMul(e.z)),s=e.y.redMul(r.redMul(this.z)),a=n.redSub(i),c=o.redSub(s);if(0===a.cmpn(0))return 0!==c.cmpn(0)?this.curve.jpoint(null,null,null):this.dbl();var u=a.redSqr(),h=u.redMul(a),l=n.redMul(u),d=c.redSqr().redIAdd(h).redISub(l).redISub(l),f=c.redMul(l.redISub(d)).redISub(o.redMul(h)),p=this.z.redMul(e.z).redMul(a);return this.curve.jpoint(d,f,p)},Yo.prototype.mixedAdd=function(e){if(this.isInfinity())return e.toJ();if(e.isInfinity())return this;var t=this.z.redSqr(),r=this.x,n=e.x.redMul(t),i=this.y,o=e.y.redMul(t).redMul(this.z),s=r.redSub(n),a=i.redSub(o);if(0===s.cmpn(0))return 0!==a.cmpn(0)?this.curve.jpoint(null,null,null):this.dbl();var c=s.redSqr(),u=c.redMul(s),h=r.redMul(c),l=a.redSqr().redIAdd(u).redISub(h).redISub(h),d=a.redMul(h.redISub(l)).redISub(i.redMul(u)),f=this.z.redMul(s);return this.curve.jpoint(l,d,f)},Yo.prototype.dblp=function(e){if(0===e)return this;if(this.isInfinity())return this;if(!e)return this.dbl();var t;if(this.curve.zeroA||this.curve.threeA){var r=this;for(t=0;t<e;t++)r=r.dbl();return r}var n=this.curve.a,i=this.curve.tinv,o=this.x,s=this.y,a=this.z,c=a.redSqr().redSqr(),u=s.redAdd(s);for(t=0;t<e;t++){var h=o.redSqr(),l=u.redSqr(),d=l.redSqr(),f=h.redAdd(h).redIAdd(h).redIAdd(n.redMul(c)),p=o.redMul(l),g=f.redSqr().redISub(p.redAdd(p)),y=p.redISub(g),b=f.redMul(y);b=b.redIAdd(b).redISub(d);var m=u.redMul(a);t+1<e&&(c=c.redMul(d)),o=g,a=m,u=b}return this.curve.jpoint(o,u.redMul(i),a)},Yo.prototype.dbl=function(){return this.isInfinity()?this:this.curve.zeroA?this._zeroDbl():this.curve.threeA?this._threeDbl():this._dbl()},Yo.prototype._zeroDbl=function(){var e,t,r;if(this.zOne){var n=this.x.redSqr(),i=this.y.redSqr(),o=i.redSqr(),s=this.x.redAdd(i).redSqr().redISub(n).redISub(o);s=s.redIAdd(s);var a=n.redAdd(n).redIAdd(n),c=a.redSqr().redISub(s).redISub(s),u=o.redIAdd(o);u=(u=u.redIAdd(u)).redIAdd(u),e=c,t=a.redMul(s.redISub(c)).redISub(u),r=this.y.redAdd(this.y)}else{var h=this.x.redSqr(),l=this.y.redSqr(),d=l.redSqr(),f=this.x.redAdd(l).redSqr().redISub(h).redISub(d);f=f.redIAdd(f);var p=h.redAdd(h).redIAdd(h),g=p.redSqr(),y=d.redIAdd(d);y=(y=y.redIAdd(y)).redIAdd(y),e=g.redISub(f).redISub(f),t=p.redMul(f.redISub(e)).redISub(y),r=(r=this.y.redMul(this.z)).redIAdd(r)}return this.curve.jpoint(e,t,r)},Yo.prototype._threeDbl=function(){var e,t,r;if(this.zOne){var n=this.x.redSqr(),i=this.y.redSqr(),o=i.redSqr(),s=this.x.redAdd(i).redSqr().redISub(n).redISub(o);s=s.redIAdd(s);var a=n.redAdd(n).redIAdd(n).redIAdd(this.curve.a),c=a.redSqr().redISub(s).redISub(s);e=c;var u=o.redIAdd(o);u=(u=u.redIAdd(u)).redIAdd(u),t=a.redMul(s.redISub(c)).redISub(u),r=this.y.redAdd(this.y)}else{var h=this.z.redSqr(),l=this.y.redSqr(),d=this.x.redMul(l),f=this.x.redSub(h).redMul(this.x.redAdd(h));f=f.redAdd(f).redIAdd(f);var p=d.redIAdd(d),g=(p=p.redIAdd(p)).redAdd(p);e=f.redSqr().redISub(g),r=this.y.redAdd(this.z).redSqr().redISub(l).redISub(h);var y=l.redSqr();y=(y=(y=y.redIAdd(y)).redIAdd(y)).redIAdd(y),t=f.redMul(p.redISub(e)).redISub(y)}return this.curve.jpoint(e,t,r)},Yo.prototype._dbl=function(){var e=this.curve.a,t=this.x,r=this.y,n=this.z,i=n.redSqr().redSqr(),o=t.redSqr(),s=r.redSqr(),a=o.redAdd(o).redIAdd(o).redIAdd(e.redMul(i)),c=t.redAdd(t),u=(c=c.redIAdd(c)).redMul(s),h=a.redSqr().redISub(u.redAdd(u)),l=u.redISub(h),d=s.redSqr();d=(d=(d=d.redIAdd(d)).redIAdd(d)).redIAdd(d);var f=a.redMul(l).redISub(d),p=r.redAdd(r).redMul(n);return this.curve.jpoint(h,f,p)},Yo.prototype.trpl=function(){if(!this.curve.zeroA)return this.dbl().add(this);var e=this.x.redSqr(),t=this.y.redSqr(),r=this.z.redSqr(),n=t.redSqr(),i=e.redAdd(e).redIAdd(e),o=i.redSqr(),s=this.x.redAdd(t).redSqr().redISub(e).redISub(n),a=(s=(s=(s=s.redIAdd(s)).redAdd(s).redIAdd(s)).redISub(o)).redSqr(),c=n.redIAdd(n);c=(c=(c=c.redIAdd(c)).redIAdd(c)).redIAdd(c);var u=i.redIAdd(s).redSqr().redISub(o).redISub(a).redISub(c),h=t.redMul(u);h=(h=h.redIAdd(h)).redIAdd(h);var l=this.x.redMul(a).redISub(h);l=(l=l.redIAdd(l)).redIAdd(l);var d=this.y.redMul(u.redMul(c.redISub(u)).redISub(s.redMul(a)));d=(d=(d=d.redIAdd(d)).redIAdd(d)).redIAdd(d);var f=this.z.redAdd(s).redSqr().redISub(r).redISub(a);return this.curve.jpoint(l,d,f)},Yo.prototype.mul=function(e,t){return e=new(vo())(e,t),this.curve._wnafMul(this,e)},Yo.prototype.eq=function(e){if("affine"===e.type)return this.eq(e.toJ());if(this===e)return!0;var t=this.z.redSqr(),r=e.z.redSqr();if(0!==this.x.redMul(r).redISub(e.x.redMul(t)).cmpn(0))return!1;var n=t.redMul(this.z),i=r.redMul(e.z);return 0===this.y.redMul(i).redISub(e.y.redMul(n)).cmpn(0)},Yo.prototype.eqXToP=function(e){var t=this.z.redSqr(),r=e.toRed(this.curve.red).redMul(t);if(0===this.x.cmp(r))return!0;for(var n=e.clone(),i=this.curve.redN.redMul(t);;){if(n.iadd(this.curve.n),n.cmp(this.curve.p)>=0)return!1;if(r.redIAdd(i),0===this.x.cmp(r))return!0}},Yo.prototype.inspect=function(){return this.isInfinity()?"<EC JPoint Infinity>":"<EC JPoint x: "+this.x.toString(16,2)+" y: "+this.y.toString(16,2)+" z: "+this.z.toString(16,2)+">"},Yo.prototype.isInfinity=function(){return 0===this.z.cmpn(0)};var Jo=Mo((function(e,t){var r=t;r.base=$o,r.short=Vo,r.mont=null,r.edwards=null})),Xo=Mo((function(e,t){var r,n=t,i=Uo.assert;function o(e){"short"===e.type?this.curve=new Jo.short(e):"edwards"===e.type?this.curve=new Jo.edwards(e):this.curve=new Jo.mont(e),this.g=this.curve.g,this.n=this.curve.n,this.hash=e.hash,i(this.g.validate(),"Invalid curve"),i(this.g.mul(this.n).isInfinity(),"Invalid curve, G*N != O")}function s(e,t){Object.defineProperty(n,e,{configurable:!0,enumerable:!0,get:function(){var r=new o(t);return Object.defineProperty(n,e,{configurable:!0,enumerable:!0,value:r}),r}})}n.PresetCurve=o,s("p192",{type:"short",prime:"p192",p:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff",a:"ffffffff ffffffff ffffffff fffffffe ffffffff fffffffc",b:"64210519 e59c80e7 0fa7e9ab 72243049 feb8deec c146b9b1",n:"ffffffff ffffffff ffffffff 99def836 146bc9b1 b4d22831",hash:No().sha256,gRed:!1,g:["188da80e b03090f6 7cbf20eb 43a18800 f4ff0afd 82ff1012","07192b95 ffc8da78 631011ed 6b24cdd5 73f977a1 1e794811"]}),s("p224",{type:"short",prime:"p224",p:"ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001",a:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff fffffffe",b:"b4050a85 0c04b3ab f5413256 5044b0b7 d7bfd8ba 270b3943 2355ffb4",n:"ffffffff ffffffff ffffffff ffff16a2 e0b8f03e 13dd2945 5c5c2a3d",hash:No().sha256,gRed:!1,g:["b70e0cbd 6bb4bf7f 321390b9 4a03c1d3 56c21122 343280d6 115c1d21","bd376388 b5f723fb 4c22dfe6 cd4375a0 5a074764 44d58199 85007e34"]}),s("p256",{type:"short",prime:null,p:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff ffffffff",a:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff fffffffc",b:"5ac635d8 aa3a93e7 b3ebbd55 769886bc 651d06b0 cc53b0f6 3bce3c3e 27d2604b",n:"ffffffff 00000000 ffffffff ffffffff bce6faad a7179e84 f3b9cac2 fc632551",hash:No().sha256,gRed:!1,g:["6b17d1f2 e12c4247 f8bce6e5 63a440f2 77037d81 2deb33a0 f4a13945 d898c296","4fe342e2 fe1a7f9b 8ee7eb4a 7c0f9e16 2bce3357 6b315ece cbb64068 37bf51f5"]}),s("p384",{type:"short",prime:null,p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 ffffffff",a:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 fffffffc",b:"b3312fa7 e23ee7e4 988e056b e3f82d19 181d9c6e fe814112 0314088f 5013875a c656398d 8a2ed19d 2a85c8ed d3ec2aef",n:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff c7634d81 f4372ddf 581a0db2 48b0a77a ecec196a ccc52973",hash:No().sha384,gRed:!1,g:["aa87ca22 be8b0537 8eb1c71e f320ad74 6e1d3b62 8ba79b98 59f741e0 82542a38 5502f25d bf55296c 3a545e38 72760ab7","3617de4a 96262c6f 5d9e98bf 9292dc29 f8f41dbd 289a147c e9da3113 b5f0b8c0 0a60b1ce 1d7e819d 7a431d7c 90ea0e5f"]}),s("p521",{type:"short",prime:null,p:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff",a:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffc",b:"00000051 953eb961 8e1c9a1f 929a21a0 b68540ee a2da725b 99b315f3 b8b48991 8ef109e1 56193951 ec7e937b 1652c0bd 3bb1bf07 3573df88 3d2c34f1 ef451fd4 6b503f00",n:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffa 51868783 bf2f966b 7fcc0148 f709a5d0 3bb5c9b8 899c47ae bb6fb71e 91386409",hash:No().sha512,gRed:!1,g:["000000c6 858e06b7 0404e9cd 9e3ecb66 2395b442 9c648139 053fb521 f828af60 6b4d3dba a14b5e77 efe75928 fe1dc127 a2ffa8de 3348b3c1 856a429b f97e7e31 c2e5bd66","00000118 39296a78 9a3bc004 5c8a5fb4 2c7d1bd9 98f54449 579b4468 17afbd17 273e662c 97ee7299 5ef42640 c550b901 3fad0761 353c7086 a272c240 88be9476 9fd16650"]}),s("curve25519",{type:"mont",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"76d06",b:"1",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:No().sha256,gRed:!1,g:["9"]}),s("ed25519",{type:"edwards",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"-1",c:"1",d:"52036cee2b6ffe73 8cc740797779e898 00700a4d4141d8ab 75eb4dca135978a3",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:No().sha256,gRed:!1,g:["216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a","6666666666666666666666666666666666666666666666666666666666666658"]});try{r=null.crash()}catch(e){r=void 0}s("secp256k1",{type:"short",prime:"k256",p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f",a:"0",b:"7",n:"ffffffff ffffffff ffffffff fffffffe baaedce6 af48a03b bfd25e8c d0364141",h:"1",hash:No().sha256,beta:"7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee",lambda:"5363ad4cc05c30e0a5261c028812645a122e22ea20816678df02967c1b23bd72",basis:[{a:"3086d221a7d46bcde86c90e49284eb15",b:"-e4437ed6010e88286f547fa90abfe4c3"},{a:"114ca50f7a8e2f3f657c1108d9d44cfd8",b:"3086d221a7d46bcde86c90e49284eb15"}],gRed:!1,g:["79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798","483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8",r]})}));function Zo(e){if(!(this instanceof Zo))return new Zo(e);this.hash=e.hash,this.predResist=!!e.predResist,this.outLen=this.hash.outSize,this.minEntropy=e.minEntropy||this.hash.hmacStrength,this._reseed=null,this.reseedInterval=null,this.K=null,this.V=null;var t=Lo.toArray(e.entropy,e.entropyEnc||"hex"),r=Lo.toArray(e.nonce,e.nonceEnc||"hex"),n=Lo.toArray(e.pers,e.persEnc||"hex");Co(t.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._init(t,r,n)}var Qo=Zo;Zo.prototype._init=function(e,t,r){var n=e.concat(t).concat(r);this.K=new Array(this.outLen/8),this.V=new Array(this.outLen/8);for(var i=0;i<this.V.length;i++)this.K[i]=0,this.V[i]=1;this._update(n),this._reseed=1,this.reseedInterval=281474976710656},Zo.prototype._hmac=function(){return new(No().hmac)(this.hash,this.K)},Zo.prototype._update=function(e){var t=this._hmac().update(this.V).update([0]);e&&(t=t.update(e)),this.K=t.digest(),this.V=this._hmac().update(this.V).digest(),e&&(this.K=this._hmac().update(this.V).update([1]).update(e).digest(),this.V=this._hmac().update(this.V).digest())},Zo.prototype.reseed=function(e,t,r,n){"string"!=typeof t&&(n=r,r=t,t=null),e=Lo.toArray(e,t),r=Lo.toArray(r,n),Co(e.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._update(e.concat(r||[])),this._reseed=1},Zo.prototype.generate=function(e,t,r,n){if(this._reseed>this.reseedInterval)throw new Error("Reseed is required");"string"!=typeof t&&(n=r,r=t,t=null),r&&(r=Lo.toArray(r,n||"hex"),this._update(r));for(var i=[];i.length<e;)this.V=this._hmac().update(this.V).digest(),i=i.concat(this.V);var o=i.slice(0,e);return this._update(r),this._reseed++,Lo.encode(o,t)};var es=Uo.assert;function ts(e,t){this.ec=e,this.priv=null,this.pub=null,t.priv&&this._importPrivate(t.priv,t.privEnc),t.pub&&this._importPublic(t.pub,t.pubEnc)}var rs=ts;ts.fromPublic=function(e,t,r){return t instanceof ts?t:new ts(e,{pub:t,pubEnc:r})},ts.fromPrivate=function(e,t,r){return t instanceof ts?t:new ts(e,{priv:t,privEnc:r})},ts.prototype.validate=function(){var e=this.getPublic();return e.isInfinity()?{result:!1,reason:"Invalid public key"}:e.validate()?e.mul(this.ec.curve.n).isInfinity()?{result:!0,reason:null}:{result:!1,reason:"Public key * N != O"}:{result:!1,reason:"Public key is not a point"}},ts.prototype.getPublic=function(e,t){return"string"==typeof e&&(t=e,e=null),this.pub||(this.pub=this.ec.g.mul(this.priv)),t?this.pub.encode(t,e):this.pub},ts.prototype.getPrivate=function(e){return"hex"===e?this.priv.toString(16,2):this.priv},ts.prototype._importPrivate=function(e,t){this.priv=new(vo())(e,t||16),this.priv=this.priv.umod(this.ec.curve.n)},ts.prototype._importPublic=function(e,t){if(e.x||e.y)return"mont"===this.ec.curve.type?es(e.x,"Need x coordinate"):"short"!==this.ec.curve.type&&"edwards"!==this.ec.curve.type||es(e.x&&e.y,"Need both x and y coordinate"),void(this.pub=this.ec.curve.point(e.x,e.y));this.pub=this.ec.curve.decodePoint(e,t)},ts.prototype.derive=function(e){return e.validate()||es(e.validate(),"public point not validated"),e.mul(this.priv).getX()},ts.prototype.sign=function(e,t,r){return this.ec.sign(e,this,t,r)},ts.prototype.verify=function(e,t){return this.ec.verify(e,t,this)},ts.prototype.inspect=function(){return"<Key priv: "+(this.priv&&this.priv.toString(16,2))+" pub: "+(this.pub&&this.pub.inspect())+" >"};var ns=Uo.assert;function is(e,t){if(e instanceof is)return e;this._importDER(e,t)||(ns(e.r&&e.s,"Signature without r or s"),this.r=new(vo())(e.r,16),this.s=new(vo())(e.s,16),void 0===e.recoveryParam?this.recoveryParam=null:this.recoveryParam=e.recoveryParam)}var os=is;function ss(){this.place=0}function as(e,t){var r=e[t.place++];if(!(128&r))return r;var n=15&r;if(0===n||n>4)return!1;for(var i=0,o=0,s=t.place;o<n;o++,s++)i<<=8,i|=e[s],i>>>=0;return!(i<=127)&&(t.place=s,i)}function cs(e){for(var t=0,r=e.length-1;!e[t]&&!(128&e[t+1])&&t<r;)t++;return 0===t?e:e.slice(t)}function us(e,t){if(t<128)e.push(t);else{var r=1+(Math.log(t)/Math.LN2>>>3);for(e.push(128|r);--r;)e.push(t>>>(r<<3)&255);e.push(t)}}is.prototype._importDER=function(e,t){e=Uo.toArray(e,t);var r=new ss;if(48!==e[r.place++])return!1;var n=as(e,r);if(!1===n)return!1;if(n+r.place!==e.length)return!1;if(2!==e[r.place++])return!1;var i=as(e,r);if(!1===i)return!1;var o=e.slice(r.place,i+r.place);if(r.place+=i,2!==e[r.place++])return!1;var s=as(e,r);if(!1===s)return!1;if(e.length!==s+r.place)return!1;var a=e.slice(r.place,s+r.place);if(0===o[0]){if(!(128&o[1]))return!1;o=o.slice(1)}if(0===a[0]){if(!(128&a[1]))return!1;a=a.slice(1)}return this.r=new(vo())(o),this.s=new(vo())(a),this.recoveryParam=null,!0},is.prototype.toDER=function(e){var t=this.r.toArray(),r=this.s.toArray();for(128&t[0]&&(t=[0].concat(t)),128&r[0]&&(r=[0].concat(r)),t=cs(t),r=cs(r);!(r[0]||128&r[1]);)r=r.slice(1);var n=[2];us(n,t.length),(n=n.concat(t)).push(2),us(n,r.length);var i=n.concat(r),o=[48];return us(o,i.length),o=o.concat(i),Uo.encode(o,e)};var hs=function(){throw new Error("unsupported")},ls=Uo.assert;function ds(e){if(!(this instanceof ds))return new ds(e);"string"==typeof e&&(ls(Object.prototype.hasOwnProperty.call(Xo,e),"Unknown curve "+e),e=Xo[e]),e instanceof Xo.PresetCurve&&(e={curve:e}),this.curve=e.curve.curve,this.n=this.curve.n,this.nh=this.n.ushrn(1),this.g=this.curve.g,this.g=e.curve.g,this.g.precompute(e.curve.n.bitLength()+1),this.hash=e.hash||e.curve.hash}var fs=ds;ds.prototype.keyPair=function(e){return new rs(this,e)},ds.prototype.keyFromPrivate=function(e,t){return rs.fromPrivate(this,e,t)},ds.prototype.keyFromPublic=function(e,t){return rs.fromPublic(this,e,t)},ds.prototype.genKeyPair=function(e){e||(e={});for(var t=new Qo({hash:this.hash,pers:e.pers,persEnc:e.persEnc||"utf8",entropy:e.entropy||hs(this.hash.hmacStrength),entropyEnc:e.entropy&&e.entropyEnc||"utf8",nonce:this.n.toArray()}),r=this.n.byteLength(),n=this.n.sub(new(vo())(2));;){var i=new(vo())(t.generate(r));if(!(i.cmp(n)>0))return i.iaddn(1),this.keyFromPrivate(i)}},ds.prototype._truncateToN=function(e,t){var r=8*e.byteLength()-this.n.bitLength();return r>0&&(e=e.ushrn(r)),!t&&e.cmp(this.n)>=0?e.sub(this.n):e},ds.prototype.sign=function(e,t,r,n){"object"==typeof r&&(n=r,r=null),n||(n={}),t=this.keyFromPrivate(t,r),e=this._truncateToN(new(vo())(e,16));for(var i=this.n.byteLength(),o=t.getPrivate().toArray("be",i),s=e.toArray("be",i),a=new Qo({hash:this.hash,entropy:o,nonce:s,pers:n.pers,persEnc:n.persEnc||"utf8"}),c=this.n.sub(new(vo())(1)),u=0;;u++){var h=n.k?n.k(u):new(vo())(a.generate(this.n.byteLength()));if(!((h=this._truncateToN(h,!0)).cmpn(1)<=0||h.cmp(c)>=0)){var l=this.g.mul(h);if(!l.isInfinity()){var d=l.getX(),f=d.umod(this.n);if(0!==f.cmpn(0)){var p=h.invm(this.n).mul(f.mul(t.getPrivate()).iadd(e));if(0!==(p=p.umod(this.n)).cmpn(0)){var g=(l.getY().isOdd()?1:0)|(0!==d.cmp(f)?2:0);return n.canonical&&p.cmp(this.nh)>0&&(p=this.n.sub(p),g^=1),new os({r:f,s:p,recoveryParam:g})}}}}}},ds.prototype.verify=function(e,t,r,n){e=this._truncateToN(new(vo())(e,16)),r=this.keyFromPublic(r,n);var i=(t=new os(t,"hex")).r,o=t.s;if(i.cmpn(1)<0||i.cmp(this.n)>=0)return!1;if(o.cmpn(1)<0||o.cmp(this.n)>=0)return!1;var s,a=o.invm(this.n),c=a.mul(e).umod(this.n),u=a.mul(i).umod(this.n);return this.curve._maxwellTrick?!(s=this.g.jmulAdd(c,r.getPublic(),u)).isInfinity()&&s.eqXToP(i):!(s=this.g.mulAdd(c,r.getPublic(),u)).isInfinity()&&0===s.getX().umod(this.n).cmp(i)},ds.prototype.recoverPubKey=function(e,t,r,n){ls((3&r)===r,"The recovery param is more than two bits"),t=new os(t,n);var i=this.n,o=new(vo())(e),s=t.r,a=t.s,c=1&r,u=r>>1;if(s.cmp(this.curve.p.umod(this.curve.n))>=0&&u)throw new Error("Unable to find sencond key candinate");s=u?this.curve.pointFromX(s.add(this.curve.n),c):this.curve.pointFromX(s,c);var h=t.r.invm(i),l=i.sub(o).mul(h).umod(i),d=a.mul(h).umod(i);return this.g.mulAdd(l,s,d)},ds.prototype.getKeyRecoveryParam=function(e,t,r,n){if(null!==(t=new os(t,n)).recoveryParam)return t.recoveryParam;for(var i=0;i<4;i++){var o;try{o=this.recoverPubKey(e,t,i)}catch(e){continue}if(o.eq(r))return i}throw new Error("Unable to find valid recovery factor")};var ps=Mo((function(e,t){var r=t;r.version="6.5.4",r.utils=Uo,r.rand=function(){throw new Error("unsupported")},r.curve=Jo,r.curves=Xo,r.ec=fs,r.eddsa=null})).ec;function gs(e,t,r){Object.defineProperty(e,t,{enumerable:!0,value:r,writable:!1})}new oo("properties/5.7.0");const ys=new oo("signing-key/5.7.0");let bs=null;function ms(){return bs||(bs=new ps("secp256k1")),bs}class ws{constructor(e){gs(this,"curve","secp256k1"),gs(this,"privateKey",go(e)),32!==function(e){if("string"!=typeof e)e=go(e);else if(!fo(e)||e.length%2)return null;return(e.length-2)/2}(this.privateKey)&&ys.throwArgumentError("invalid private key","privateKey","[[ REDACTED ]]");const t=ms().keyFromPrivate(lo(this.privateKey));gs(this,"publicKey","0x"+t.getPublic(!1,"hex")),gs(this,"compressedPublicKey","0x"+t.getPublic(!0,"hex")),gs(this,"_isSigningKey",!0)}_addPoint(e){const t=ms().keyFromPublic(lo(this.publicKey)),r=ms().keyFromPublic(lo(e));return"0x"+t.pub.add(r.pub).encodeCompressed("hex")}signDigest(e){const t=ms().keyFromPrivate(lo(this.privateKey)),r=lo(e);32!==r.length&&ys.throwArgumentError("bad digest length","digest",e);const n=t.sign(r,{canonical:!0});return mo({recoveryParam:n.recoveryParam,r:bo("0x"+n.r.toString(16),32),s:bo("0x"+n.s.toString(16),32)})}computeSharedSecret(e){const t=ms().keyFromPrivate(lo(this.privateKey)),r=ms().keyFromPublic(lo(vs(e)));return bo("0x"+t.derive(r.getPublic()).toString(16),32)}static isSigningKey(e){return!(!e||!e._isSigningKey)}}function vs(e,t){const r=lo(e);if(32===r.length){const e=new ws(r);return t?"0x"+ms().keyFromPrivate(r).getPublic(!0,"hex"):e.publicKey}return 33===r.length?t?go(r):"0x"+ms().keyFromPublic(r).getPublic(!1,"hex"):65===r.length?t?"0x"+ms().keyFromPublic(r).getPublic(!0,"hex"):go(r):ys.throwArgumentError("invalid public or private key","key","[REDACTED]")}var Ss,_s;function Es(e=0){return null!=globalThis.Buffer&&null!=globalThis.Buffer.allocUnsafe?globalThis.Buffer.allocUnsafe(e):new Uint8Array(e)}function Is(e,t){t||(t=e.reduce(((e,t)=>e+t.length),0));const r=Es(t);let n=0;for(const t of e)r.set(t,n),n+=t.length;return r}new oo("transactions/5.7.0"),(_s=Ss||(Ss={}))[_s.legacy=0]="legacy",_s[_s.eip2930=1]="eip2930",_s[_s.eip1559=2]="eip1559";const As=function(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<e.length;i++){var o=e.charAt(i),s=o.charCodeAt(0);if(255!==r[s])throw new TypeError(o+" is ambiguous");r[s]=i}var a=e.length,c=e.charAt(0),u=Math.log(a)/Math.log(256),h=Math.log(256)/Math.log(a);function l(e){if("string"!=typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){for(var n=0,i=0;e[t]===c;)n++,t++;for(var o=(e.length-t)*u+1>>>0,s=new Uint8Array(o);e[t];){var h=r[e.charCodeAt(t)];if(255===h)return;for(var l=0,d=o-1;(0!==h||l<i)&&-1!==d;d--,l++)h+=a*s[d]>>>0,s[d]=h%256>>>0,h=h/256>>>0;if(0!==h)throw new Error("Non-zero carry");i=l,t++}if(" "!==e[t]){for(var f=o-i;f!==o&&0===s[f];)f++;for(var p=new Uint8Array(n+(o-f)),g=n;f!==o;)p[g++]=s[f++];return p}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var r=0,n=0,i=0,o=t.length;i!==o&&0===t[i];)i++,r++;for(var s=(o-i)*h+1>>>0,u=new Uint8Array(s);i!==o;){for(var l=t[i],d=0,f=s-1;(0!==l||d<n)&&-1!==f;f--,d++)l+=256*u[f]>>>0,u[f]=l%a>>>0,l=l/a>>>0;if(0!==l)throw new Error("Non-zero carry");n=d,i++}for(var p=s-n;p!==s&&0===u[p];)p++;for(var g=c.repeat(r);p<s;++p)g+=e.charAt(u[p]);return g},decodeUnsafe:l,decode:function(e){var r=l(e);if(r)return r;throw new Error(`Non-${t} character`)}}},ks=(new Uint8Array(0),e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")});class xs{constructor(e,t,r){this.name=e,this.prefix=t,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class Ps{constructor(e,t,r){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=r}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return Rs(this,e)}}class Os{constructor(e){this.decoders=e}or(e){return Rs(this,e)}decode(e){const t=e[0],r=this.decoders[t];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const Rs=(e,t)=>new Os({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class Ts{constructor(e,t,r,n){this.name=e,this.prefix=t,this.baseEncode=r,this.baseDecode=n,this.encoder=new xs(e,t,r),this.decoder=new Ps(e,t,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const Ns=({name:e,prefix:t,encode:r,decode:n})=>new Ts(e,t,r,n),Ms=({prefix:e,name:t,alphabet:r})=>{const{encode:n,decode:i}=As(r,t);return Ns({prefix:e,name:t,encode:n,decode:e=>ks(i(e))})},Cs=({name:e,prefix:t,bitsPerChar:r,alphabet:n})=>Ns({prefix:t,name:e,encode:e=>((e,t,r)=>{const n="="===t[t.length-1],i=(1<<r)-1;let o="",s=0,a=0;for(let n=0;n<e.length;++n)for(a=a<<8|e[n],s+=8;s>r;)s-=r,o+=t[i&a>>s];if(s&&(o+=t[i&a<<r-s]),n)for(;o.length*r&7;)o+="=";return o})(e,n,r),decode:t=>((e,t,r,n)=>{const i={};for(let e=0;e<t.length;++e)i[t[e]]=e;let o=e.length;for(;"="===e[o-1];)--o;const s=new Uint8Array(o*r/8|0);let a=0,c=0,u=0;for(let t=0;t<o;++t){const o=i[e[t]];if(void 0===o)throw new SyntaxError(`Non-${n} character`);c=c<<r|o,a+=r,a>=8&&(a-=8,s[u++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return s})(t,n,r,e)}),Bs=Ns({prefix:"\0",name:"identity",encode:e=>{return t=e,(new TextDecoder).decode(t);var t},decode:e=>(e=>(new TextEncoder).encode(e))(e)}),Ls=Cs({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),Us=Cs({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),Ds=Ms({prefix:"9",name:"base10",alphabet:"0123456789"}),js=Cs({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),zs=Cs({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),qs=Cs({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),$s=Cs({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Ks=Cs({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Fs=Cs({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Ws=Cs({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Hs=Cs({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Vs=Cs({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Gs=Cs({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Ys=Cs({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),Js=Ms({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Xs=Ms({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),Zs=Ms({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Qs=Ms({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),ea=Cs({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),ta=Cs({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),ra=Cs({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),na=Cs({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),ia=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),oa=ia.reduce(((e,t,r)=>(e[r]=t,e)),[]),sa=ia.reduce(((e,t,r)=>(e[t.codePointAt(0)]=r,e)),[]),aa=Ns({prefix:"🚀",name:"base256emoji",encode:function(e){return e.reduce(((e,t)=>e+oa[t]),"")},decode:function(e){const t=[];for(const r of e){const e=sa[r.codePointAt(0)];if(void 0===e)throw new Error(`Non-base256emoji character: ${r}`);t.push(e)}return new Uint8Array(t)}});var ca=128,ua=-128,ha=Math.pow(2,31),la=Math.pow(2,7),da=Math.pow(2,14),fa=Math.pow(2,21),pa=Math.pow(2,28),ga=Math.pow(2,35),ya=Math.pow(2,42),ba=Math.pow(2,49),ma=Math.pow(2,56),wa=Math.pow(2,63);const va=function e(t,r,n){r=r||[];for(var i=n=n||0;t>=ha;)r[n++]=255&t|ca,t/=128;for(;t&ua;)r[n++]=255&t|ca,t>>>=7;return r[n]=0|t,e.bytes=n-i+1,r},Sa=function(e){return e<la?1:e<da?2:e<fa?3:e<pa?4:e<ga?5:e<ya?6:e<ba?7:e<ma?8:e<wa?9:10},_a=(e,t,r=0)=>(va(e,t,r),t),Ea=e=>Sa(e),Ia=(e,t)=>{const r=t.byteLength,n=Ea(e),i=n+Ea(r),o=new Uint8Array(i+r);return _a(e,o,0),_a(r,o,n),o.set(t,i),new Aa(e,r,t,o)};class Aa{constructor(e,t,r,n){this.code=e,this.size=t,this.digest=r,this.bytes=n}}const ka=({name:e,code:t,encode:r})=>new xa(e,t,r);class xa{constructor(e,t,r){this.name=e,this.code=t,this.encode=r}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?Ia(this.code,t):t.then((e=>Ia(this.code,e)))}throw Error("Unknown type, must be binary type")}}const Pa=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t)),Oa=ka({name:"sha2-256",code:18,encode:Pa("SHA-256")}),Ra=ka({name:"sha2-512",code:19,encode:Pa("SHA-512")}),Ta=ks,Na={code:0,name:"identity",encode:Ta,digest:e=>Ia(0,Ta(e))},Ma="raw",Ca=85,Ba=e=>ks(e),La=e=>ks(e),Ua=new TextEncoder,Da=new TextDecoder,ja="json",za=512,qa=e=>Ua.encode(JSON.stringify(e)),$a=e=>JSON.parse(Da.decode(e));Symbol.toStringTag,Symbol.for("nodejs.util.inspect.custom"),Symbol.for("@ipld/js-cid/CID");const Ka={...e,...t,...i,...o,...s,...a,...c,...u,...h,...l};function Fa(e,t,r,n){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:r},decoder:{decode:n}}}const Wa=Fa("utf8","u",(e=>"u"+new TextDecoder("utf8").decode(e)),(e=>(new TextEncoder).encode(e.substring(1)))),Ha=Fa("ascii","a",(e=>{let t="a";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t}),(e=>{const t=Es((e=e.substring(1)).length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t})),Va={utf8:Wa,"utf-8":Wa,hex:Ka.base16,latin1:Ha,ascii:Ha,binary:Ha,...Ka};function Ga(e,t="utf8"){const r=Va[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?r.decoder.decode(`${r.prefix}${e}`):globalThis.Buffer.from(e,"utf8")}function Ya(e,t="utf8"){const r=Va[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?r.encoder.encode(e).substring(1):globalThis.Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString("utf8")}var Ja=r(5679);const Xa={waku:{publish:"waku_publish",batchPublish:"waku_batchPublish",subscribe:"waku_subscribe",batchSubscribe:"waku_batchSubscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe",batchUnsubscribe:"waku_batchUnsubscribe",batchFetchMessages:"waku_batchFetchMessages"},irn:{publish:"irn_publish",batchPublish:"irn_batchPublish",subscribe:"irn_subscribe",batchSubscribe:"irn_batchSubscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe",batchUnsubscribe:"irn_batchUnsubscribe",batchFetchMessages:"irn_batchFetchMessages"},iridium:{publish:"iridium_publish",batchPublish:"iridium_batchPublish",subscribe:"iridium_subscribe",batchSubscribe:"iridium_batchSubscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe",batchUnsubscribe:"iridium_batchUnsubscribe",batchFetchMessages:"iridium_batchFetchMessages"}};var Za=r(3184),Qa=r(1429).Buffer;const ec=":";function tc(e){const[t,r]=e.split(ec);return{namespace:t,reference:r}}function rc(e){const[t,r,n]=e.split(ec);return{namespace:t,reference:r,address:n}}function nc(e,t=[]){const r=[];return Object.keys(e).forEach((n=>{if(t.length&&!t.includes(n))return;const i=e[n];r.push(...i.accounts)})),r}function ic(e,t){return e.includes(":")?[e]:t.chains||[]}const oc="ReactNative",sc={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},ac="js";function cc(){return typeof Za<"u"&&typeof Za.versions<"u"&&typeof Za.versions.node<"u"}function uc(){return!(0,Hi.getDocument)()&&!!(0,Hi.getNavigator)()&&navigator.product===oc}function hc(){return!cc()&&!!(0,Hi.getNavigator)()&&!!(0,Hi.getDocument)()}function lc(){return uc()?sc.reactNative:cc()?sc.node:hc()?sc.browser:sc.unknown}function dc(){var e;try{return uc()&&typeof r.g<"u"&&typeof(null==r.g?void 0:r.g.Application)<"u"?null==(e=r.g.Application)?void 0:e.applicationId:void 0}catch{return}}function fc(){return(0,Vi.g)()||{name:"",description:"",url:"",icons:[""]}}function pc(e,t,n){const i=function(){if(lc()===sc.reactNative&&typeof r.g<"u"&&typeof(null==r.g?void 0:r.g.Platform)<"u"){const{OS:e,Version:t}=r.g.Platform;return[e,t].join("-")}const e=t?Wi(t):"undefined"==typeof document&&"undefined"!=typeof navigator&&"ReactNative"===navigator.product?new zi:"undefined"!=typeof navigator?Wi(navigator.userAgent):void 0!==Ci&&Ci.version?new Ui(Ci.version.slice(1)):null;var t;if(null===e)return"unknown";const n=e.os?e.os.replace(" ","").toLowerCase():"unknown";return"browser"===e.type?[n,e.name,e.version].join("-"):[n,e.version].join("-")}(),o=function(){var e;const t=lc();return t===sc.browser?[t,(null==(e=(0,Hi.getLocation)())?void 0:e.host)||"unknown"].join(":"):t}();return[[e,t].join("-"),[ac,n].join("-"),i,o].join("/")}function gc(e,t){return e.filter((e=>t.includes(e))).length===e.length}function yc(e){return Object.fromEntries(e.entries())}function bc(e){return new Map(Object.entries(e))}function mc(e=K.FIVE_MINUTES,t){const r=(0,K.toMiliseconds)(e||K.FIVE_MINUTES);let n,i,o,s;return{resolve:e=>{o&&n&&(clearTimeout(o),n(e),s=Promise.resolve(e))},reject:e=>{o&&i&&(clearTimeout(o),i(e))},done:()=>new Promise(((e,a)=>{if(s)return e(s);o=setTimeout((()=>{const e=new Error(t);s=Promise.reject(e),a(e)}),r),n=e,i=a}))}}function wc(e,t,r){return new Promise((async(n,i)=>{const o=setTimeout((()=>i(new Error(r))),t);try{n(await e)}catch(e){i(e)}clearTimeout(o)}))}function vc(e,t){if("string"==typeof t&&t.startsWith(`${e}:`))return t;if("topic"===e.toLowerCase()){if("string"!=typeof t)throw new Error('Value must be "string" for expirer target type: topic');return`topic:${t}`}if("id"===e.toLowerCase()){if("number"!=typeof t)throw new Error('Value must be "number" for expirer target type: id');return`id:${t}`}throw new Error(`Unknown expirer target type: ${e}`)}function Sc(e){const[t,r]=e.split(":"),n={id:void 0,topic:void 0};if("topic"===t&&"string"==typeof r)n.topic=r;else{if("id"!==t||!Number.isInteger(Number(r)))throw new Error(`Invalid target, expected id:number or topic:string, got ${t}:${r}`);n.id=Number(r)}return n}function _c(e,t){return(0,K.fromMiliseconds)((t||Date.now())+(0,K.toMiliseconds)(e))}function Ec(e){return Date.now()>=(0,K.toMiliseconds)(e)}function Ic(e,t){return`${e}${t?`:${t}`:""}`}function Ac(e=[],t=[]){return[...new Set([...e,...t])]}function kc(e,t){if(!e.includes(t))return null;const r=e.split(/([&,?,=])/),n=r.indexOf(t);return r[n+2]}function xc(){return typeof crypto<"u"&&null!=crypto&&crypto.randomUUID?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/gu,(e=>{const t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))}function Pc(){return typeof Za<"u"&&"true"===Za.env.IS_VITEST}function Oc(e){return Qa.from(e,"base64").toString("utf-8")}function Rc(e){if(!Number.isSafeInteger(e)||e<0)throw new Error("positive integer expected, got "+e)}function Tc(e,...t){if(!function(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&"Uint8Array"===e.constructor.name}(e))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw new Error("Uint8Array expected of length "+t+", got length="+e.length)}function Nc(e){if("function"!=typeof e||"function"!=typeof e.create)throw new Error("Hash should be wrapped by utils.wrapConstructor");Rc(e.outputLen),Rc(e.blockLen)}function Mc(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function Cc(e,t){Tc(e);const r=t.outputLen;if(e.length<r)throw new Error("digestInto() expects output buffer of length at least "+r)}const Bc=BigInt(2**32-1),Lc=BigInt(32);function Uc(e,t=!1){return t?{h:Number(e&Bc),l:Number(e>>Lc&Bc)}:{h:0|Number(e>>Lc&Bc),l:0|Number(e&Bc)}}const Dc="object"==typeof globalThis&&"crypto"in globalThis?globalThis.crypto:void 0;function jc(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function zc(e,t){return e<<32-t|e>>>t}const qc=68===new Uint8Array(new Uint32Array([287454020]).buffer)[0];function $c(e){return e<<24&4278190080|e<<8&16711680|e>>>8&65280|e>>>24&255}function Kc(e){for(let t=0;t<e.length;t++)e[t]=$c(e[t])}function Fc(e){return"string"==typeof e&&(e=function(e){if("string"!=typeof e)throw new Error("utf8ToBytes expected string, got "+typeof e);return new Uint8Array((new TextEncoder).encode(e))}(e)),Tc(e),e}class Wc{clone(){return this._cloneInto()}}function Hc(e){const t=t=>e().update(Fc(t)).digest(),r=e();return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=()=>e(),t}function Vc(e=32){if(Dc&&"function"==typeof Dc.getRandomValues)return Dc.getRandomValues(new Uint8Array(e));if(Dc&&"function"==typeof Dc.randomBytes)return Dc.randomBytes(e);throw new Error("crypto.getRandomValues must be defined")}const Gc=[],Yc=[],Jc=[],Xc=BigInt(0),Zc=BigInt(1),Qc=BigInt(2),eu=BigInt(7),tu=BigInt(256),ru=BigInt(113);for(let e=0,t=Zc,r=1,n=0;e<24;e++){[r,n]=[n,(2*r+3*n)%5],Gc.push(2*(5*n+r)),Yc.push((e+1)*(e+2)/2%64);let i=Xc;for(let e=0;e<7;e++)t=(t<<Zc^(t>>eu)*ru)%tu,t&Qc&&(i^=Zc<<(Zc<<BigInt(e))-Zc);Jc.push(i)}const[nu,iu]=function(e,t=!1){let r=new Uint32Array(e.length),n=new Uint32Array(e.length);for(let i=0;i<e.length;i++){const{h:o,l:s}=Uc(e[i],t);[r[i],n[i]]=[o,s]}return[r,n]}(Jc,!0),ou=(e,t,r)=>r>32?((e,t,r)=>t<<r-32|e>>>64-r)(e,t,r):((e,t,r)=>e<<r|t>>>32-r)(e,t,r),su=(e,t,r)=>r>32?((e,t,r)=>e<<r-32|t>>>64-r)(e,t,r):((e,t,r)=>t<<r|e>>>32-r)(e,t,r);class au extends Wc{constructor(e,t,r,n=!1,i=24){if(super(),this.blockLen=e,this.suffix=t,this.outputLen=r,this.enableXOF=n,this.rounds=i,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,Rc(r),0>=this.blockLen||this.blockLen>=200)throw new Error("Sha3 supports only keccak-f1600 function");var o;this.state=new Uint8Array(200),this.state32=(o=this.state,new Uint32Array(o.buffer,o.byteOffset,Math.floor(o.byteLength/4)))}keccak(){qc||Kc(this.state32),function(e,t=24){const r=new Uint32Array(10);for(let n=24-t;n<24;n++){for(let t=0;t<10;t++)r[t]=e[t]^e[t+10]^e[t+20]^e[t+30]^e[t+40];for(let t=0;t<10;t+=2){const n=(t+8)%10,i=(t+2)%10,o=r[i],s=r[i+1],a=ou(o,s,1)^r[n],c=su(o,s,1)^r[n+1];for(let r=0;r<50;r+=10)e[t+r]^=a,e[t+r+1]^=c}let t=e[2],i=e[3];for(let r=0;r<24;r++){const n=Yc[r],o=ou(t,i,n),s=su(t,i,n),a=Gc[r];t=e[a],i=e[a+1],e[a]=o,e[a+1]=s}for(let t=0;t<50;t+=10){for(let n=0;n<10;n++)r[n]=e[t+n];for(let n=0;n<10;n++)e[t+n]^=~r[(n+2)%10]&r[(n+4)%10]}e[0]^=nu[n],e[1]^=iu[n]}r.fill(0)}(this.state32,this.rounds),qc||Kc(this.state32),this.posOut=0,this.pos=0}update(e){Mc(this);const{blockLen:t,state:r}=this,n=(e=Fc(e)).length;for(let i=0;i<n;){const o=Math.min(t-this.pos,n-i);for(let t=0;t<o;t++)r[this.pos++]^=e[i++];this.pos===t&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:t,pos:r,blockLen:n}=this;e[r]^=t,128&t&&r===n-1&&this.keccak(),e[n-1]^=128,this.keccak()}writeInto(e){Mc(this,!1),Tc(e),this.finish();const t=this.state,{blockLen:r}=this;for(let n=0,i=e.length;n<i;){this.posOut>=r&&this.keccak();const o=Math.min(r-this.posOut,i-n);e.set(t.subarray(this.posOut,this.posOut+o),n),this.posOut+=o,n+=o}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return Rc(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(Cc(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(e){const{blockLen:t,suffix:r,outputLen:n,rounds:i,enableXOF:o}=this;return e||(e=new au(t,r,n,o,i)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=i,e.suffix=r,e.outputLen=n,e.enableXOF=o,e.destroyed=this.destroyed,e}}const cu=Hc((()=>new au(136,1,32))),uu="https://rpc.walletconnect.org/v1";function hu(e){const t=`Ethereum Signed Message:\n${e.length}`,r=(new TextEncoder).encode(t+e);return"0x"+Qa.from(cu(r)).toString("hex")}async function lu(e,t,r,n,i,o){switch(r.t){case"eip191":return function(e,t,r){return(n=hu(t),i=r,Ro(yo(Io(yo(vs(function(e,t){const r=mo(t),n={r:lo(r.r),s:lo(r.s)};return"0x"+ms().recoverPubKey(lo(e),n,r.recoveryParam).encode("hex",!1)}(lo(n),i)),1)),12))).toLowerCase()===e.toLowerCase();var n,i}(e,t,r.s);case"eip1271":return await async function(e,t,r,n,i,o){const s=tc(n);if(!s.namespace||!s.reference)throw new Error(`isValidEip1271Signature failed: chainId must be in CAIP-2 format, received: ${n}`);try{const s="0x1626ba7e",a="0000000000000000000000000000000000000000000000000000000000000040",c="0000000000000000000000000000000000000000000000000000000000000041",u=r.substring(2),h=s+hu(t).substring(2)+a+c+u,l=await fetch(`${o||uu}/?chainId=${n}&projectId=${i}`,{method:"POST",body:JSON.stringify({id:Date.now()+Math.floor(1e3*Math.random()),jsonrpc:"2.0",method:"eth_call",params:[{to:e,data:h},"latest"]})}),{result:d}=await l.json();return!!d&&d.slice(0,s.length).toLowerCase()===s.toLowerCase()}catch(e){return console.error("isValidEip1271Signature: ",e),!1}}(e,t,r.s,n,i,o);default:throw new Error(`verifySignature failed: Attempted to verify CacaoSignature with unknown type: ${r.t}`)}}var du=Object.defineProperty,fu=Object.defineProperties,pu=Object.getOwnPropertyDescriptors,gu=Object.getOwnPropertySymbols,yu=Object.prototype.hasOwnProperty,bu=Object.prototype.propertyIsEnumerable,mu=(e,t,r)=>t in e?du(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;const wu=e=>e?.split(":"),vu=e=>{const t=e&&wu(e);if(t)return t[2]+":"+t[3]},Su=e=>{const t=e&&wu(e);if(t)return t.pop()};async function _u(e){const{cacao:t,projectId:r}=e,{s:n,p:i}=t,o=Eu(i,i.iss),s=Su(i.iss);return await lu(s,o,n,vu(i.iss),r)}const Eu=(e,t)=>{const r=`${e.domain} wants you to sign in with your Ethereum account:`,n=Su(t);if(!e.aud&&!e.uri)throw new Error("Either `aud` or `uri` is required to construct the message");let i=e.statement||void 0;const o=`URI: ${e.aud||e.uri}`,s=`Version: ${e.version}`,a=`Chain ID: ${(e=>{const t=e&&wu(e);if(t)return e.includes("did:pkh:")?t[3]:t[1]})(t)}`,c=`Nonce: ${e.nonce}`,u=`Issued At: ${e.iat}`,h=e.exp?`Expiration Time: ${e.exp}`:void 0,l=e.nbf?`Not Before: ${e.nbf}`:void 0,d=e.requestId?`Request ID: ${e.requestId}`:void 0,f=e.resources?`Resources:${e.resources.map((e=>`\n- ${e}`)).join("")}`:void 0,p=Tu(e.resources);return p&&(i=function(e="",t){Iu(t);const r="I further authorize the stated URI to perform the following actions on my behalf: ";if(e.includes(r))return e;const n=[];let i=0;return Object.keys(t.att).forEach((e=>{const r=Object.keys(t.att[e]).map((e=>({ability:e.split("/")[0],action:e.split("/")[1]})));r.sort(((e,t)=>e.action.localeCompare(t.action)));const o={};r.forEach((e=>{o[e.ability]||(o[e.ability]=[]),o[e.ability].push(e.action)}));const s=Object.keys(o).map((t=>(i++,`(${i}) '${t}': '${o[t].join("', '")}' for '${e}'.`)));n.push(s.join(", ").replace(".,","."))})),`${e?e+" ":""}${r}${n.join(" ")}`}(i,xu(p))),[r,n,"",i,"",o,s,a,c,u,h,l,d,f].filter((e=>null!=e)).join("\n")};function Iu(e){if(!e)throw new Error("No recap provided, value is undefined");if(!e.att)throw new Error("No `att` property found");const t=Object.keys(e.att);if(null==t||!t.length)throw new Error("No resources found in `att` property");t.forEach((t=>{const r=e.att[t];if(Array.isArray(r))throw new Error(`Resource must be an object: ${t}`);if("object"!=typeof r)throw new Error(`Resource must be an object: ${t}`);if(!Object.keys(r).length)throw new Error(`Resource object is empty: ${t}`);Object.keys(r).forEach((e=>{const t=r[e];if(!Array.isArray(t))throw new Error(`Ability limits ${e} must be an array of objects, found: ${t}`);if(!t.length)throw new Error(`Value of ${e} is empty array, must be an array with objects`);t.forEach((t=>{if("object"!=typeof t)throw new Error(`Ability limits (${e}) must be an array of objects, found: ${t}`)}))}))}))}function Au(e,t,r={}){t=t?.sort(((e,t)=>e.localeCompare(t)));const n=t.map((t=>({[`${e}/${t}`]:[r]})));return Object.assign({},...n)}function ku(e){return Iu(e),`urn:recap:${function(e){return Qa.from(JSON.stringify(e)).toString("base64")}(e).replace(/=/g,"")}`}function xu(e){const t=function(e){return JSON.parse(Qa.from(e,"base64").toString("utf-8"))}(e.replace("urn:recap:",""));return Iu(t),t}function Pu(e,t){const r=function(e,t){Iu(e),Iu(t);const r=Object.keys(e.att).concat(Object.keys(t.att)).sort(((e,t)=>e.localeCompare(t))),n={att:{}};return r.forEach((r=>{var i,o;Object.keys((null==(i=e.att)?void 0:i[r])||{}).concat(Object.keys((null==(o=t.att)?void 0:o[r])||{})).sort(((e,t)=>e.localeCompare(t))).forEach((i=>{var o,s;n.att[r]=((e,t)=>fu(e,pu(t)))(((e,t)=>{for(var r in t||(t={}))yu.call(t,r)&&mu(e,r,t[r]);if(gu)for(var r of gu(t))bu.call(t,r)&&mu(e,r,t[r]);return e})({},n.att[r]),{[i]:(null==(o=e.att[r])?void 0:o[i])||(null==(s=t.att[r])?void 0:s[i])})}))})),n}(xu(e),xu(t));return ku(r)}function Ou(e){var t;const r=xu(e);Iu(r);const n=null==(t=r.att)?void 0:t.eip155;return n?Object.keys(n).map((e=>e.split("/")[1])):[]}function Ru(e){const t=xu(e);Iu(t);const r=[];return Object.values(t.att).forEach((e=>{Object.values(e).forEach((e=>{var t;null!=(t=e?.[0])&&t.chains&&r.push(e[0].chains)}))})),[...new Set(r.flat())]}function Tu(e){if(!e)return;const t=e?.[e.length-1];return function(e){return e&&e.includes("urn:recap:")}(t)?t:void 0}function Nu(e){if(!Number.isSafeInteger(e)||e<0)throw new Error("positive integer expected, got "+e)}function Mu(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&"Uint8Array"===e.constructor.name}function Cu(e,...t){if(!Mu(e))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw new Error("Uint8Array expected of length "+t+", got length="+e.length)}function Bu(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function Lu(e){if("boolean"!=typeof e)throw new Error(`boolean expected, not ${e}`)}const Uu=e=>new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4));if(68!==new Uint8Array(new Uint32Array([287454020]).buffer)[0])throw new Error("Non little-endian hardware is not supported");function Du(e){if("string"==typeof e)e=function(e){if("string"!=typeof e)throw new Error("string expected");return new Uint8Array((new TextEncoder).encode(e))}(e);else{if(!Mu(e))throw new Error("Uint8Array expected, got "+typeof e);e=qu(e)}return e}function ju(e,t,r=!0){if(void 0===t)return new Uint8Array(e);if(t.length!==e)throw new Error("invalid output length, expected "+e+", got: "+t.length);if(r&&!function(e){return e.byteOffset%4==0}(t))throw new Error("invalid output, must be aligned");return t}function zu(e,t,r,n){if("function"==typeof e.setBigUint64)return e.setBigUint64(t,r,n);const i=BigInt(32),o=BigInt(4294967295),s=Number(r>>i&o),a=Number(r&o),c=n?4:0,u=n?0:4;e.setUint32(t+c,s,n),e.setUint32(t+u,a,n)}function qu(e){return Uint8Array.from(e)}function $u(...e){for(let t=0;t<e.length;t++)e[t].fill(0)}const Ku=e=>Uint8Array.from(e.split("").map((e=>e.charCodeAt(0)))),Fu=Ku("expand 16-byte k"),Wu=Ku("expand 32-byte k"),Hu=Uu(Fu),Vu=Uu(Wu);function Gu(e,t){return e<<t|e>>>32-t}function Yu(e){return e.byteOffset%4==0}const Ju=2**32-1,Xu=new Uint32Array,Zu=(e,t)=>255&e[t++]|(255&e[t++])<<8;class Qu{constructor(e){this.blockLen=16,this.outputLen=16,this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.pos=0,this.finished=!1,Cu(e=Du(e),32);const t=Zu(e,0),r=Zu(e,2),n=Zu(e,4),i=Zu(e,6),o=Zu(e,8),s=Zu(e,10),a=Zu(e,12),c=Zu(e,14);this.r[0]=8191&t,this.r[1]=8191&(t>>>13|r<<3),this.r[2]=7939&(r>>>10|n<<6),this.r[3]=8191&(n>>>7|i<<9),this.r[4]=255&(i>>>4|o<<12),this.r[5]=o>>>1&8190,this.r[6]=8191&(o>>>14|s<<2),this.r[7]=8065&(s>>>11|a<<5),this.r[8]=8191&(a>>>8|c<<8),this.r[9]=c>>>5&127;for(let t=0;t<8;t++)this.pad[t]=Zu(e,16+2*t)}process(e,t,r=!1){const n=r?0:2048,{h:i,r:o}=this,s=o[0],a=o[1],c=o[2],u=o[3],h=o[4],l=o[5],d=o[6],f=o[7],p=o[8],g=o[9],y=Zu(e,t+0),b=Zu(e,t+2),m=Zu(e,t+4),w=Zu(e,t+6),v=Zu(e,t+8),S=Zu(e,t+10),_=Zu(e,t+12),E=Zu(e,t+14);let I=i[0]+(8191&y),A=i[1]+(8191&(y>>>13|b<<3)),k=i[2]+(8191&(b>>>10|m<<6)),x=i[3]+(8191&(m>>>7|w<<9)),P=i[4]+(8191&(w>>>4|v<<12)),O=i[5]+(v>>>1&8191),R=i[6]+(8191&(v>>>14|S<<2)),T=i[7]+(8191&(S>>>11|_<<5)),N=i[8]+(8191&(_>>>8|E<<8)),M=i[9]+(E>>>5|n),C=0,B=C+I*s+A*(5*g)+k*(5*p)+x*(5*f)+P*(5*d);C=B>>>13,B&=8191,B+=O*(5*l)+R*(5*h)+T*(5*u)+N*(5*c)+M*(5*a),C+=B>>>13,B&=8191;let L=C+I*a+A*s+k*(5*g)+x*(5*p)+P*(5*f);C=L>>>13,L&=8191,L+=O*(5*d)+R*(5*l)+T*(5*h)+N*(5*u)+M*(5*c),C+=L>>>13,L&=8191;let U=C+I*c+A*a+k*s+x*(5*g)+P*(5*p);C=U>>>13,U&=8191,U+=O*(5*f)+R*(5*d)+T*(5*l)+N*(5*h)+M*(5*u),C+=U>>>13,U&=8191;let D=C+I*u+A*c+k*a+x*s+P*(5*g);C=D>>>13,D&=8191,D+=O*(5*p)+R*(5*f)+T*(5*d)+N*(5*l)+M*(5*h),C+=D>>>13,D&=8191;let j=C+I*h+A*u+k*c+x*a+P*s;C=j>>>13,j&=8191,j+=O*(5*g)+R*(5*p)+T*(5*f)+N*(5*d)+M*(5*l),C+=j>>>13,j&=8191;let z=C+I*l+A*h+k*u+x*c+P*a;C=z>>>13,z&=8191,z+=O*s+R*(5*g)+T*(5*p)+N*(5*f)+M*(5*d),C+=z>>>13,z&=8191;let q=C+I*d+A*l+k*h+x*u+P*c;C=q>>>13,q&=8191,q+=O*a+R*s+T*(5*g)+N*(5*p)+M*(5*f),C+=q>>>13,q&=8191;let $=C+I*f+A*d+k*l+x*h+P*u;C=$>>>13,$&=8191,$+=O*c+R*a+T*s+N*(5*g)+M*(5*p),C+=$>>>13,$&=8191;let K=C+I*p+A*f+k*d+x*l+P*h;C=K>>>13,K&=8191,K+=O*u+R*c+T*a+N*s+M*(5*g),C+=K>>>13,K&=8191;let F=C+I*g+A*p+k*f+x*d+P*l;C=F>>>13,F&=8191,F+=O*h+R*u+T*c+N*a+M*s,C+=F>>>13,F&=8191,C=(C<<2)+C|0,C=C+B|0,B=8191&C,C>>>=13,L+=C,i[0]=B,i[1]=L,i[2]=U,i[3]=D,i[4]=j,i[5]=z,i[6]=q,i[7]=$,i[8]=K,i[9]=F}finalize(){const{h:e,pad:t}=this,r=new Uint16Array(10);let n=e[1]>>>13;e[1]&=8191;for(let t=2;t<10;t++)e[t]+=n,n=e[t]>>>13,e[t]&=8191;e[0]+=5*n,n=e[0]>>>13,e[0]&=8191,e[1]+=n,n=e[1]>>>13,e[1]&=8191,e[2]+=n,r[0]=e[0]+5,n=r[0]>>>13,r[0]&=8191;for(let t=1;t<10;t++)r[t]=e[t]+n,n=r[t]>>>13,r[t]&=8191;r[9]-=8192;let i=(1^n)-1;for(let e=0;e<10;e++)r[e]&=i;i=~i;for(let t=0;t<10;t++)e[t]=e[t]&i|r[t];e[0]=65535&(e[0]|e[1]<<13),e[1]=65535&(e[1]>>>3|e[2]<<10),e[2]=65535&(e[2]>>>6|e[3]<<7),e[3]=65535&(e[3]>>>9|e[4]<<4),e[4]=65535&(e[4]>>>12|e[5]<<1|e[6]<<14),e[5]=65535&(e[6]>>>2|e[7]<<11),e[6]=65535&(e[7]>>>5|e[8]<<8),e[7]=65535&(e[8]>>>8|e[9]<<5);let o=e[0]+t[0];e[0]=65535&o;for(let r=1;r<8;r++)o=(e[r]+t[r]|0)+(o>>>16)|0,e[r]=65535&o;$u(r)}update(e){Bu(this);const{buffer:t,blockLen:r}=this,n=(e=Du(e)).length;for(let i=0;i<n;){const o=Math.min(r-this.pos,n-i);if(o!==r)t.set(e.subarray(i,i+o),this.pos),this.pos+=o,i+=o,this.pos===r&&(this.process(t,0,!1),this.pos=0);else for(;r<=n-i;i+=r)this.process(e,i)}return this}destroy(){$u(this.h,this.r,this.buffer,this.pad)}digestInto(e){Bu(this),function(e,t){Cu(e);const r=t.outputLen;if(e.length<r)throw new Error("digestInto() expects output buffer of length at least "+r)}(e,this),this.finished=!0;const{buffer:t,h:r}=this;let{pos:n}=this;if(n){for(t[n++]=1;n<16;n++)t[n]=0;this.process(t,0,!0)}this.finalize();let i=0;for(let t=0;t<8;t++)e[i++]=r[t]>>>0,e[i++]=r[t]>>>8;return e}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const r=e.slice(0,t);return this.destroy(),r}}const eh=function(e){const t=(t,r)=>e(r).update(Du(t)).digest(),r=e(new Uint8Array(32));return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=t=>e(t),t}((e=>new Qu(e))),th=function(e){const{allowShortKeys:t,extendNonceFn:r,counterLength:n,counterRight:i,rounds:o}=function(e,t){if(null==t||"object"!=typeof t)throw new Error("options must be defined");return Object.assign({allowShortKeys:!1,counterLength:8,counterRight:!1,rounds:20},t)}(0,{counterRight:!1,counterLength:4,allowShortKeys:!1});return Nu(n),Nu(o),Lu(i),Lu(t),(s,a,c,u,h=0)=>{Cu(s),Cu(a),Cu(c);const l=c.length;if(void 0===u&&(u=new Uint8Array(l)),Cu(u),Nu(h),h<0||h>=Ju)throw new Error("arx: counter overflow");if(u.length<l)throw new Error(`arx: output (${u.length}) is shorter than data (${l})`);const d=[];let f,p,g=s.length;if(32===g)d.push(f=qu(s)),p=Vu;else{if(16!==g||!t)throw new Error(`arx: invalid 32-byte key, got length=${g}`);f=new Uint8Array(32),f.set(s),f.set(s,16),p=Hu,d.push(f)}Yu(a)||d.push(a=qu(a));const y=Uu(f);if(r){if(24!==a.length)throw new Error("arx: extended nonce must be 24 bytes");r(p,y,Uu(a.subarray(0,16)),y),a=a.subarray(16)}const b=16-n;if(b!==a.length)throw new Error(`arx: nonce must be ${b} or 16 bytes`);if(12!==b){const e=new Uint8Array(12);e.set(a,i?0:12-a.length),a=e,d.push(a)}const m=Uu(a);return function(e,t,r,n,i,o,s,a){const c=i.length,u=new Uint8Array(64),h=Uu(u),l=Yu(i)&&Yu(o),d=l?Uu(i):Xu,f=l?Uu(o):Xu;for(let p=0;p<c;s++){if(e(t,r,n,h,s,a),s>=Ju)throw new Error("arx: counter overflow");const g=Math.min(64,c-p);if(l&&64===g){const e=p/4;if(p%4!=0)throw new Error("arx: invalid block position");for(let t,r=0;r<16;r++)t=e+r,f[t]=d[t]^h[r];p+=64}else{for(let e,t=0;t<g;t++)e=p+t,o[e]=i[e]^u[t];p+=g}}}(e,p,y,m,c,u,h,o),$u(...d),u}}((function(e,t,r,n,i,o=20){let s=e[0],a=e[1],c=e[2],u=e[3],h=t[0],l=t[1],d=t[2],f=t[3],p=t[4],g=t[5],y=t[6],b=t[7],m=i,w=r[0],v=r[1],S=r[2],_=s,E=a,I=c,A=u,k=h,x=l,P=d,O=f,R=p,T=g,N=y,M=b,C=m,B=w,L=v,U=S;for(let e=0;e<o;e+=2)_=_+k|0,C=Gu(C^_,16),R=R+C|0,k=Gu(k^R,12),_=_+k|0,C=Gu(C^_,8),R=R+C|0,k=Gu(k^R,7),E=E+x|0,B=Gu(B^E,16),T=T+B|0,x=Gu(x^T,12),E=E+x|0,B=Gu(B^E,8),T=T+B|0,x=Gu(x^T,7),I=I+P|0,L=Gu(L^I,16),N=N+L|0,P=Gu(P^N,12),I=I+P|0,L=Gu(L^I,8),N=N+L|0,P=Gu(P^N,7),A=A+O|0,U=Gu(U^A,16),M=M+U|0,O=Gu(O^M,12),A=A+O|0,U=Gu(U^A,8),M=M+U|0,O=Gu(O^M,7),_=_+x|0,U=Gu(U^_,16),N=N+U|0,x=Gu(x^N,12),_=_+x|0,U=Gu(U^_,8),N=N+U|0,x=Gu(x^N,7),E=E+P|0,C=Gu(C^E,16),M=M+C|0,P=Gu(P^M,12),E=E+P|0,C=Gu(C^E,8),M=M+C|0,P=Gu(P^M,7),I=I+O|0,B=Gu(B^I,16),R=R+B|0,O=Gu(O^R,12),I=I+O|0,B=Gu(B^I,8),R=R+B|0,O=Gu(O^R,7),A=A+k|0,L=Gu(L^A,16),T=T+L|0,k=Gu(k^T,12),A=A+k|0,L=Gu(L^A,8),T=T+L|0,k=Gu(k^T,7);let D=0;n[D++]=s+_|0,n[D++]=a+E|0,n[D++]=c+I|0,n[D++]=u+A|0,n[D++]=h+k|0,n[D++]=l+x|0,n[D++]=d+P|0,n[D++]=f+O|0,n[D++]=p+R|0,n[D++]=g+T|0,n[D++]=y+N|0,n[D++]=b+M|0,n[D++]=m+C|0,n[D++]=w+B|0,n[D++]=v+L|0,n[D++]=S+U|0})),rh=new Uint8Array(16),nh=(e,t)=>{e.update(t);const r=t.length%16;r&&e.update(rh.subarray(r))},ih=new Uint8Array(32);function oh(e,t,r,n,i){const o=e(t,r,ih),s=eh.create(o);i&&nh(s,i),nh(s,n);const a=new Uint8Array(16),c=(e=>new DataView(e.buffer,e.byteOffset,e.byteLength))(a);zu(c,0,BigInt(i?i.length:0),!0),zu(c,8,BigInt(n.length),!0),s.update(a);const u=s.digest();return $u(o,a),u}const sh=((e,t)=>{function r(r,...n){if(Cu(r),void 0!==e.nonceLength){const t=n[0];if(!t)throw new Error("nonce / iv required");e.varSizeNonce?Cu(t):Cu(t,e.nonceLength)}const i=e.tagLength;i&&void 0!==n[1]&&Cu(n[1]);const o=t(r,...n),s=(e,t)=>{if(void 0!==t){if(2!==e)throw new Error("cipher output not supported");Cu(t)}};let a=!1;return{encrypt(e,t){if(a)throw new Error("cannot encrypt() twice with same key + nonce");return a=!0,Cu(e),s(o.encrypt.length,t),o.encrypt(e,t)},decrypt(e,t){if(Cu(e),i&&e.length<i)throw new Error("invalid ciphertext length: smaller than tagLength="+i);return s(o.decrypt.length,t),o.decrypt(e,t)}}}return Object.assign(r,e),r})({blockSize:64,nonceLength:12,tagLength:16},(e=>(t,r,n)=>({encrypt(i,o){const s=i.length;(o=ju(s+16,o,!1)).set(i);const a=o.subarray(0,-16);e(t,r,a,a,1);const c=oh(e,t,r,a,n);return o.set(c,s),$u(c),o},decrypt(i,o){o=ju(i.length-16,o,!1);const s=i.subarray(0,-16),a=i.subarray(-16),c=oh(e,t,r,s,n);if(!function(e,t){if(e.length!==t.length)return!1;let r=0;for(let n=0;n<e.length;n++)r|=e[n]^t[n];return 0===r}(a,c))throw new Error("invalid tag");return o.set(i.subarray(0,-16)),e(t,r,o,o,1),$u(c),o}}))(th));class ah extends Wc{constructor(e,t){super(),this.finished=!1,this.destroyed=!1,Nc(e);const r=Fc(t);if(this.iHash=e.create(),"function"!=typeof this.iHash.update)throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const n=this.blockLen,i=new Uint8Array(n);i.set(r.length>n?e.create().update(r).digest():r);for(let e=0;e<i.length;e++)i[e]^=54;this.iHash.update(i),this.oHash=e.create();for(let e=0;e<i.length;e++)i[e]^=106;this.oHash.update(i),i.fill(0)}update(e){return Mc(this),this.iHash.update(e),this}digestInto(e){Mc(this),Tc(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:t,iHash:r,finished:n,destroyed:i,blockLen:o,outputLen:s}=this;return e.finished=n,e.destroyed=i,e.blockLen=o,e.outputLen=s,e.oHash=t._cloneInto(e.oHash),e.iHash=r._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const ch=(e,t,r)=>new ah(e,t).update(r).digest();ch.create=(e,t)=>new ah(e,t);const uh=new Uint8Array([0]),hh=new Uint8Array;function lh(e,t,r){return e&t^~e&r}function dh(e,t,r){return e&t^e&r^t&r}class fh extends Wc{constructor(e,t,r,n){super(),this.blockLen=e,this.outputLen=t,this.padOffset=r,this.isLE=n,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=jc(this.buffer)}update(e){Mc(this);const{view:t,buffer:r,blockLen:n}=this,i=(e=Fc(e)).length;for(let o=0;o<i;){const s=Math.min(n-this.pos,i-o);if(s!==n)r.set(e.subarray(o,o+s),this.pos),this.pos+=s,o+=s,this.pos===n&&(this.process(t,0),this.pos=0);else{const t=jc(e);for(;n<=i-o;o+=n)this.process(t,o)}}return this.length+=e.length,this.roundClean(),this}digestInto(e){Mc(this),Cc(e,this),this.finished=!0;const{buffer:t,view:r,blockLen:n,isLE:i}=this;let{pos:o}=this;t[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>n-o&&(this.process(r,0),o=0);for(let e=o;e<n;e++)t[e]=0;(function(e,t,r,n){if("function"==typeof e.setBigUint64)return e.setBigUint64(t,r,n);const i=BigInt(32),o=BigInt(4294967295),s=Number(r>>i&o),a=Number(r&o),c=n?4:0,u=n?0:4;e.setUint32(t+c,s,n),e.setUint32(t+u,a,n)})(r,n-8,BigInt(8*this.length),i),this.process(r,0);const s=jc(e),a=this.outputLen;if(a%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const c=a/4,u=this.get();if(c>u.length)throw new Error("_sha2: outputLen bigger than state");for(let e=0;e<c;e++)s.setUint32(4*e,u[e],i)}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const r=e.slice(0,t);return this.destroy(),r}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:t,buffer:r,length:n,finished:i,destroyed:o,pos:s}=this;return e.length=n,e.pos=s,e.finished=i,e.destroyed=o,n%t&&e.buffer.set(r),e}}const ph=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),gh=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),yh=new Uint32Array(64);class bh extends fh{constructor(){super(64,32,8,!1),this.A=0|gh[0],this.B=0|gh[1],this.C=0|gh[2],this.D=0|gh[3],this.E=0|gh[4],this.F=0|gh[5],this.G=0|gh[6],this.H=0|gh[7]}get(){const{A:e,B:t,C:r,D:n,E:i,F:o,G:s,H:a}=this;return[e,t,r,n,i,o,s,a]}set(e,t,r,n,i,o,s,a){this.A=0|e,this.B=0|t,this.C=0|r,this.D=0|n,this.E=0|i,this.F=0|o,this.G=0|s,this.H=0|a}process(e,t){for(let r=0;r<16;r++,t+=4)yh[r]=e.getUint32(t,!1);for(let e=16;e<64;e++){const t=yh[e-15],r=yh[e-2],n=zc(t,7)^zc(t,18)^t>>>3,i=zc(r,17)^zc(r,19)^r>>>10;yh[e]=i+yh[e-7]+n+yh[e-16]|0}let{A:r,B:n,C:i,D:o,E:s,F:a,G:c,H:u}=this;for(let e=0;e<64;e++){const t=u+(zc(s,6)^zc(s,11)^zc(s,25))+lh(s,a,c)+ph[e]+yh[e]|0,h=(zc(r,2)^zc(r,13)^zc(r,22))+dh(r,n,i)|0;u=c,c=a,a=s,s=o+t|0,o=i,i=n,n=r,r=t+h|0}r=r+this.A|0,n=n+this.B|0,i=i+this.C|0,o=o+this.D|0,s=s+this.E|0,a=a+this.F|0,c=c+this.G|0,u=u+this.H|0,this.set(r,n,i,o,s,a,c,u)}roundClean(){yh.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}const mh=Hc((()=>new bh)),wh=BigInt(0);function vh(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&"Uint8Array"===e.constructor.name}function Sh(e){if(!vh(e))throw new Error("Uint8Array expected")}const _h=Array.from({length:256},((e,t)=>t.toString(16).padStart(2,"0"))),Eh={_0:48,_9:57,A:65,F:70,a:97,f:102};function Ih(e){return e>=Eh._0&&e<=Eh._9?e-Eh._0:e>=Eh.A&&e<=Eh.F?e-(Eh.A-10):e>=Eh.a&&e<=Eh.f?e-(Eh.a-10):void 0}function Ah(e){if("string"!=typeof e)throw new Error("hex string expected, got "+typeof e);const t=e.length,r=t/2;if(t%2)throw new Error("hex string expected, got unpadded hex of length "+t);const n=new Uint8Array(r);for(let t=0,i=0;t<r;t++,i+=2){const r=Ih(e.charCodeAt(i)),o=Ih(e.charCodeAt(i+1));if(void 0===r||void 0===o){const t=e[i]+e[i+1];throw new Error('hex string expected, got non-hex character "'+t+'" at index '+i)}n[t]=16*r+o}return n}function kh(e){return Sh(e),function(e){if("string"!=typeof e)throw new Error("hex string expected, got "+typeof e);return""===e?wh:BigInt("0x"+e)}(function(e){Sh(e);let t="";for(let r=0;r<e.length;r++)t+=_h[e[r]];return t}(Uint8Array.from(e).reverse()))}function xh(e,t,r){let n;if("string"==typeof t)try{n=Ah(t)}catch(t){throw new Error(e+" must be hex string or Uint8Array, cause: "+t)}else{if(!vh(t))throw new Error(e+" must be hex string or Uint8Array");n=Uint8Array.from(t)}const i=n.length;if("number"==typeof r&&i!==r)throw new Error(e+" of length "+r+" expected, got "+i);return n}const Ph=e=>"bigint"==typeof e&&wh<=e;function Oh(e,t,r,n){if(!function(e,t,r){return Ph(e)&&Ph(t)&&Ph(r)&&t<=e&&e<r}(t,r,n))throw new Error("expected valid "+e+": "+r+" <= n < "+n+", got "+t)}const Rh={bigint:e=>"bigint"==typeof e,function:e=>"function"==typeof e,boolean:e=>"boolean"==typeof e,string:e=>"string"==typeof e,stringOrUint8Array:e=>"string"==typeof e||vh(e),isSafeInteger:e=>Number.isSafeInteger(e),array:e=>Array.isArray(e),field:(e,t)=>t.Fp.isValid(e),hash:e=>"function"==typeof e&&Number.isSafeInteger(e.outputLen)},Th=BigInt(0),Nh=BigInt(1);function Mh(e,t){const r=e%t;return r>=Th?r:t+r}function Ch(e,t,r){let n=e;for(;t-- >Th;)n*=n,n%=r;return n}BigInt(0),BigInt(1),BigInt(0),BigInt(1),BigInt(2),BigInt(8);const Bh=BigInt(0),Lh=BigInt(1);const Uh=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949");BigInt(0);const Dh=BigInt(1),jh=BigInt(2),zh=BigInt(3),qh=BigInt(5);BigInt(8);const $h=function(e){const t=function(e){return function(e,t,r={}){const n=(t,r,n)=>{const i=Rh[r];if("function"!=typeof i)throw new Error("invalid validator function");const o=e[t];if(!(n&&void 0===o||i(o,e)))throw new Error("param "+String(t)+" is invalid. Expected "+r+", got "+o)};for(const[e,r]of Object.entries(t))n(e,r,!1);for(const[e,t]of Object.entries(r))n(e,t,!0)}(e,{a:"bigint"},{montgomeryBits:"isSafeInteger",nByteLength:"isSafeInteger",adjustScalarBytes:"function",domain:"function",powPminus2:"function",Gu:"bigint"}),Object.freeze({...e})}(e),{P:r}=t,n=e=>Mh(e,r),i=t.montgomeryBits,o=Math.ceil(i/8),s=t.nByteLength,a=t.adjustScalarBytes||(e=>e),c=t.powPminus2||(e=>function(e,t,r){if(t<Th)throw new Error("invalid exponent, negatives unsupported");if(r<=Th)throw new Error("invalid modulus");if(r===Nh)return Th;let n=Nh;for(;t>Th;)t&Nh&&(n=n*e%r),e=e*e%r,t>>=Nh;return n}(e,r-BigInt(2),r));function u(e,t,r){const i=n(e*(t-r));return[t=n(t-i),r=n(r+i)]}const h=(t.a-BigInt(2))/BigInt(4);function l(e){return function(e,t){return function(e,t){return Ah(e.toString(16).padStart(2*t,"0"))}(e,t).reverse()}(n(e),o)}function d(e,t){const d=function(e){const t=xh("u coordinate",e,o);return 32===s&&(t[31]&=127),kh(t)}(t),f=function(e){const t=xh("scalar",e),r=t.length;if(r!==o&&r!==s)throw new Error("invalid scalar, expected "+o+" or "+s+" bytes, got "+r);return kh(a(t))}(e),p=function(e,t){Oh("u",e,Bh,r),Oh("scalar",t,Bh,r);const o=t,s=e;let a,l=Lh,d=Bh,f=e,p=Lh,g=Bh;for(let e=BigInt(i-1);e>=Bh;e--){const t=o>>e&Lh;g^=t,a=u(g,l,f),l=a[0],f=a[1],a=u(g,d,p),d=a[0],p=a[1],g=t;const r=l+d,i=n(r*r),c=l-d,y=n(c*c),b=i-y,m=f+p,w=n((f-p)*r),v=n(m*c),S=w+v,_=w-v;f=n(S*S),p=n(s*n(_*_)),l=n(i*y),d=n(b*(i+n(h*b)))}a=u(g,l,f),l=a[0],f=a[1],a=u(g,d,p),d=a[0],p=a[1];const y=c(d);return n(l*y)}(d,f);if(p===Bh)throw new Error("invalid private or public key received");return l(p)}const f=l(t.Gu);function p(e){return d(e,f)}return{scalarMult:d,scalarMultBase:p,getSharedSecret:(e,t)=>d(e,t),getPublicKey:e=>p(e),utils:{randomPrivateKey:()=>t.randomBytes(t.nByteLength)},GuBytes:f}}({P:Uh,a:BigInt(486662),montgomeryBits:255,nByteLength:32,Gu:BigInt(9),powPminus2:e=>{const t=Uh,{pow_p_5_8:r,b2:n}=function(e){const t=BigInt(10),r=BigInt(20),n=BigInt(40),i=BigInt(80),o=Uh,s=e*e%o*e%o,a=Ch(s,jh,o)*s%o,c=Ch(a,Dh,o)*e%o,u=Ch(c,qh,o)*c%o,h=Ch(u,t,o)*u%o,l=Ch(h,r,o)*h%o,d=Ch(l,n,o)*l%o,f=Ch(d,i,o)*d%o,p=Ch(f,i,o)*d%o,g=Ch(p,t,o)*u%o;return{pow_p_5_8:Ch(g,jh,o)*e%o,b2:s}}(e);return Mh(Ch(r,zh,t)*n,t)},adjustScalarBytes:function(e){return e[0]&=248,e[31]&=127,e[31]|=64,e},randomBytes:Vc}),Kh="base10",Fh="base16",Wh="base64pad",Hh="base64url",Vh="utf8";function Gh(){return Ya(Vc(32),Fh)}function Yh(e){return Ya(mh(Ga(e,Fh)),Fh)}function Jh(e){return Ya(mh(Ga(e,Vh)),Fh)}function Xh(e){return Ga(`${e}`,Kh)}function Zh(e){return Number(Ya(e,Kh))}function Qh(e){const{encoding:t=Wh}=e;if(2===Zh(e.type))return Ya(Is([e.type,e.sealed]),t);if(1===Zh(e.type)){if(typeof e.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return Ya(Is([e.type,e.senderPublicKey,e.iv,e.sealed]),t)}return Ya(Is([e.type,e.iv,e.sealed]),t)}function el(e){const{encoded:t,encoding:r=Wh}=e,n=Ga(t,r),i=n.slice(0,1);if(1===Zh(i)){const e=33,t=e+12,r=n.slice(1,e),o=n.slice(e,t);return{type:i,sealed:n.slice(t),iv:o,senderPublicKey:r}}if(2===Zh(i))return{type:i,sealed:n.slice(1),iv:Vc(12)};const o=n.slice(1,13);return{type:i,sealed:n.slice(13),iv:o}}function tl(e){const t=e?.type||0;if(1===t){if(typeof e?.senderPublicKey>"u")throw new Error("missing sender public key");if(typeof e?.receiverPublicKey>"u")throw new Error("missing receiver public key")}return{type:t,senderPublicKey:e?.senderPublicKey,receiverPublicKey:e?.receiverPublicKey}}function rl(e){return 1===e.type&&"string"==typeof e.senderPublicKey&&"string"==typeof e.receiverPublicKey}function nl(e){return 2===e.type}function il(e){return e?.relay||{protocol:"irn"}}function ol(e){const t=Xa[e];if(typeof t>"u")throw new Error(`Relay Protocol not supported: ${e}`);return t}function sl(e,t="-"){const r={},n="relay"+t;return Object.keys(e).forEach((t=>{if(t.startsWith(n)){const i=t.replace(n,""),o=e[t];r[i]=o}})),r}function al(e){if(!e.includes("wc:")){const t=Oc(e);null!=t&&t.includes("wc:")&&(e=t)}const t=(e=(e=e.includes("wc://")?e.replace("wc://",""):e).includes("wc:")?e.replace("wc:",""):e).indexOf(":"),r=-1!==e.indexOf("?")?e.indexOf("?"):void 0,n=e.substring(0,t),i=e.substring(t+1,r).split("@"),o=typeof r<"u"?e.substring(r):"",s=new URLSearchParams(o),a={};s.forEach(((e,t)=>{a[t]=e}));const c="string"==typeof a.methods?a.methods.split(","):void 0;return{protocol:n,topic:cl(i[0]),version:parseInt(i[1],10),symKey:a.symKey,relay:sl(a),methods:c,expiryTimestamp:a.expiryTimestamp?parseInt(a.expiryTimestamp,10):void 0}}function cl(e){return e.startsWith("//")?e.substring(2):e}function ul(e){const t=new URLSearchParams,r=function(e,t="-"){const r={};return Object.keys(e).forEach((n=>{const i="relay"+t+n;e[n]&&(r[i]=e[n])})),r}(e.relay);Object.keys(r).sort().forEach((e=>{t.set(e,r[e])})),t.set("symKey",e.symKey),e.expiryTimestamp&&t.set("expiryTimestamp",e.expiryTimestamp.toString()),e.methods&&t.set("methods",e.methods.join(","));const n=t.toString();return`${e.protocol}:${e.topic}@${e.version}?${n}`}function hl(e,t,r){return`${e}?wc_ev=${r}&topic=${t}`}function ll(e){const t=[];return e.forEach((e=>{const[r,n]=e.split(":");t.push(`${r}:${n}`)})),t}function dl(e,t){const r=function(e){const t={};return e?.forEach((e=>{const[r,n]=e.split(":");t[r]||(t[r]={accounts:[],chains:[],events:[]}),t[r].accounts.push(e),t[r].chains.push(`${r}:${n}`)})),t}(t=t.map((e=>e.replace("did:pkh:",""))));for(const[t,n]of Object.entries(r))n.methods?n.methods=Ac(n.methods,e):n.methods=e,n.events=["chainChanged","accountsChanged"];return r}Object.defineProperty,Object.defineProperties,Object.getOwnPropertyDescriptors,Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;const fl={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},pl={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function gl(e,t){const{message:r,code:n}=pl[e];return{message:t?`${r} ${t}`:r,code:n}}function yl(e,t){const{message:r,code:n}=fl[e];return{message:t?`${r} ${t}`:r,code:n}}function bl(e,t){return!!Array.isArray(e)&&(!(typeof t<"u"&&e.length)||e.every(t))}function ml(e){return Object.getPrototypeOf(e)===Object.prototype&&Object.keys(e).length}function wl(e){return typeof e>"u"}function vl(e,t){return!(!t||!wl(e))||"string"==typeof e&&!!e.trim().length}function Sl(e,t){return!(!t||!wl(e))||"number"==typeof e&&!isNaN(e)}function _l(e){return!(!vl(e,!1)||!e.includes(":"))&&2===e.split(":").length}function El(e){let t=!0;return bl(e)?e.length&&(t=e.every((e=>vl(e,!1)))):t=!1,t}function Il(e,t){let r=null;return Object.values(e).forEach((e=>{if(r)return;const n=function(e,t){let r=null;return El(e?.methods)?El(e?.events)||(r=yl("UNSUPPORTED_EVENTS",`${t}, events should be an array of strings or empty array for no events`)):r=yl("UNSUPPORTED_METHODS",`${t}, methods should be an array of strings or empty array for no methods`),r}(e,`${t}, namespace`);n&&(r=n)})),r}function Al(e,t){let r=null;if(e&&ml(e)){const n=Il(e,t);n&&(r=n);const i=function(e,t){let r=null;return Object.values(e).forEach((e=>{if(r)return;const n=function(e,t){let r=null;return bl(e)?e.forEach((e=>{r||function(e){if(vl(e,!1)&&e.includes(":")){const t=e.split(":");if(3===t.length){const e=t[0]+":"+t[1];return!!t[2]&&_l(e)}}return!1}(e)||(r=yl("UNSUPPORTED_ACCOUNTS",`${t}, account ${e} should be a string and conform to "namespace:chainId:address" format`))})):r=yl("UNSUPPORTED_ACCOUNTS",`${t}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),r}(e?.accounts,`${t} namespace`);n&&(r=n)})),r}(e,t);i&&(r=i)}else r=gl("MISSING_OR_INVALID",`${t}, namespaces should be an object with data`);return r}function kl(e){return vl(e.protocol,!0)}function xl(e){return typeof e<"u"&&null!==typeof e}function Pl(e,t){return!(!_l(t)||!function(e){const t=[];return Object.values(e).forEach((e=>{t.push(...ll(e.accounts))})),t}(e).includes(t))}function Ol(e,t,r){let n=null;const i=function(e){const t={};return Object.keys(e).forEach((r=>{var n;r.includes(":")?t[r]=e[r]:null==(n=e[r].chains)||n.forEach((n=>{t[n]={methods:e[r].methods,events:e[r].events}}))})),t}(e),o=function(e){const t={};return Object.keys(e).forEach((r=>{if(r.includes(":"))t[r]=e[r];else{const n=ll(e[r].accounts);n?.forEach((n=>{t[n]={accounts:e[r].accounts.filter((e=>e.includes(`${n}:`))),methods:e[r].methods,events:e[r].events}}))}})),t}(t),s=Object.keys(i),a=Object.keys(o),c=Rl(Object.keys(e)),u=Rl(Object.keys(t)),h=c.filter((e=>!u.includes(e)));return h.length&&(n=gl("NON_CONFORMING_NAMESPACES",`${r} namespaces keys don't satisfy requiredNamespaces.\n      Required: ${h.toString()}\n      Received: ${Object.keys(t).toString()}`)),gc(s,a)||(n=gl("NON_CONFORMING_NAMESPACES",`${r} namespaces chains don't satisfy required namespaces.\n      Required: ${s.toString()}\n      Approved: ${a.toString()}`)),Object.keys(t).forEach((e=>{if(!e.includes(":")||n)return;const i=ll(t[e].accounts);i.includes(e)||(n=gl("NON_CONFORMING_NAMESPACES",`${r} namespaces accounts don't satisfy namespace accounts for ${e}\n        Required: ${e}\n        Approved: ${i.toString()}`))})),s.forEach((e=>{n||(gc(i[e].methods,o[e].methods)?gc(i[e].events,o[e].events)||(n=gl("NON_CONFORMING_NAMESPACES",`${r} namespaces events don't satisfy namespace events for ${e}`)):n=gl("NON_CONFORMING_NAMESPACES",`${r} namespaces methods don't satisfy namespace methods for ${e}`))})),n}function Rl(e){return[...new Set(e.map((e=>e.includes(":")?e.split(":")[0]:e)))]}function Tl(){const e=lc();return new Promise((t=>{switch(e){case sc.browser:t(hc()&&navigator?.onLine);break;case sc.reactNative:t(async function(){if(uc()&&typeof r.g<"u"&&null!=r.g&&r.g.NetInfo){const e=await(null==r.g?void 0:r.g.NetInfo.fetch());return e?.isConnected}return!0}());break;case sc.node:default:t(!0)}}))}const Nl={};class Ml{static get(e){return Nl[e]}static set(e,t){Nl[e]=t}static delete(e){delete Nl[e]}}const Cl="PARSE_ERROR",Bl="INVALID_REQUEST",Ll="METHOD_NOT_FOUND",Ul="INVALID_PARAMS",Dl="INTERNAL_ERROR",jl="SERVER_ERROR",zl=[-32700,-32600,-32601,-32602,-32603],ql={[Cl]:{code:-32700,message:"Parse error"},[Bl]:{code:-32600,message:"Invalid Request"},[Ll]:{code:-32601,message:"Method not found"},[Ul]:{code:-32602,message:"Invalid params"},[Dl]:{code:-32603,message:"Internal error"},[jl]:{code:-32e3,message:"Server error"}},$l=jl;function Kl(e){return Object.keys(ql).includes(e)?ql[e]:ql[$l]}var Fl=r(2552);function Wl(e=3){return Date.now()*Math.pow(10,e)+Math.floor(Math.random()*Math.pow(10,e))}function Hl(e=6){return BigInt(Wl(e))}function Vl(e,t,r){return{id:r||Wl(),jsonrpc:"2.0",method:e,params:t}}function Gl(e,t){return{id:e,jsonrpc:"2.0",result:t}}function Yl(e,t,r){return{id:e,jsonrpc:"2.0",error:Jl(t,r)}}function Jl(e,t){return void 0===e?Kl(Dl):("string"==typeof e&&(e=Object.assign(Object.assign({},Kl(jl)),{message:e})),void 0!==t&&(e.data=t),r=e.code,zl.includes(r)&&(e=function(e){const t=Object.values(ql).find((t=>t.code===e));return t||ql[$l]}(e.code)),e);var r}class Xl{}class Zl extends Xl{constructor(){super()}}class Ql extends Zl{constructor(e){super()}}function ed(e){return function(e,t){const r=function(e){const t=e.match(new RegExp(/^\w+:/,"gi"));if(t&&t.length)return t[0]}(e);return void 0!==r&&new RegExp(t).test(r)}(e,"^wss?:")}function td(e){return"object"==typeof e&&"id"in e&&"jsonrpc"in e&&"2.0"===e.jsonrpc}function rd(e){return td(e)&&"method"in e}function nd(e){return td(e)&&(id(e)||od(e))}function id(e){return"result"in e}function od(e){return"error"in e}class sd extends Ql{constructor(e){super(e),this.events=new q.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(e),this.connection.connected&&this.registerEventListeners()}async connect(e=this.connection){await this.open(e)}async disconnect(){await this.close()}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async request(e,t){return this.requestStrict(Vl(e.method,e.params||[],e.id||Hl().toString()),t)}async requestStrict(e,t){return new Promise((async(r,n)=>{if(!this.connection.connected)try{await this.open()}catch(e){n(e)}this.events.on(`${e.id}`,(e=>{od(e)?n(e.error):r(e.result)}));try{await this.connection.send(e,t)}catch(e){n(e)}}))}setConnection(e=this.connection){return e}onPayload(e){this.events.emit("payload",e),nd(e)?this.events.emit(`${e.id}`,e):this.events.emit("message",{type:e.method,data:e.params})}onClose(e){e&&3e3===e.code&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${e.code} ${e.reason?`(${e.reason})`:""}`)),this.events.emit("disconnect")}async open(e=this.connection){this.connection===e&&this.connection.connected||(this.connection.connected&&this.close(),"string"==typeof e&&(await this.connection.open(e),e=this.connection),this.connection=this.setConnection(e),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",(e=>this.onPayload(e))),this.connection.on("close",(e=>this.onClose(e))),this.connection.on("error",(e=>this.events.emit("error",e))),this.connection.on("register_error",(e=>this.onClose())),this.hasRegisteredEventListeners=!0)}}const ad=e=>e.split("?")[0],cd=typeof WebSocket<"u"?WebSocket:typeof r.g<"u"&&typeof r.g.WebSocket<"u"?r.g.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:typeof self<"u"&&typeof self.WebSocket<"u"?self.WebSocket:r(753);class ud{constructor(e){if(this.url=e,this.events=new q.EventEmitter,this.registering=!1,!ed(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);this.url=e}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async open(e=this.url){await this.register(e)}async close(){return new Promise(((e,t)=>{typeof this.socket>"u"?t(new Error("Connection already closed")):(this.socket.onclose=t=>{this.onClose(t),e()},this.socket.close())}))}async send(e){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(we(e))}catch(t){this.onError(e.id,t)}}register(e=this.url){if(!ed(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);if(this.registering){const e=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=e||this.events.listenerCount("open")>=e)&&this.events.setMaxListeners(e+1),new Promise(((e,t)=>{this.events.once("register_error",(e=>{this.resetMaxListeners(),t(e)})),this.events.once("open",(()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return t(new Error("WebSocket connection is missing or invalid"));e(this.socket)}))}))}return this.url=e,this.registering=!0,new Promise(((t,n)=>{const i=(0,Fl.isReactNative)()?void 0:{rejectUnauthorized:(s=e,!new RegExp("wss?://localhost(:d{2,5})?").test(s))},o=new cd(e,[],i);var s;typeof WebSocket<"u"||typeof r.g<"u"&&typeof r.g.WebSocket<"u"||typeof window<"u"&&typeof window.WebSocket<"u"||typeof self<"u"&&typeof self.WebSocket<"u"?o.onerror=e=>{const t=e;n(this.emitError(t.error))}:o.on("error",(e=>{n(this.emitError(e))})),o.onopen=()=>{this.onOpen(o),t(o)}}))}onOpen(e){e.onmessage=e=>this.onPayload(e),e.onclose=e=>this.onClose(e),this.socket=e,this.registering=!1,this.events.emit("open")}onClose(e){this.socket=void 0,this.registering=!1,this.events.emit("close",e)}onPayload(e){if(typeof e.data>"u")return;const t="string"==typeof e.data?me(e.data):e.data;this.events.emit("payload",t)}onError(e,t){const r=this.parseError(t),n=Yl(e,r.message||r.toString());this.events.emit("payload",n)}parseError(e,t=this.url){return function(e,t){return e.message.includes("getaddrinfo ENOTFOUND")||e.message.includes("connect ECONNREFUSED")?new Error(`Unavailable WS RPC url at ${t}`):e}(e,ad(t))}resetMaxListeners(){this.events.getMaxListeners()>10&&this.events.setMaxListeners(10)}emitError(e){const t=this.parseError(new Error(e?.message||`WebSocket connection failed for host: ${ad(this.url)}`));return this.events.emit("register_error",t),t}}var hd=r(6780),ld=r.n(hd);const dd="core",fd=`wc@2:${dd}:`,pd={database:":memory:"},gd="client_ed25519_seed",yd=K.ONE_DAY,bd=K.SIX_HOURS,md="wss://relay.walletconnect.org",wd="relayer_message",vd="relayer_message_ack",Sd="relayer_connection_stalled",_d="relayer_publish",Ed="payload",Id="connect",Ad="disconnect",kd="error",xd="2.18.0",Pd={link_mode:"link_mode",relay:"relay"},Od="WALLETCONNECT_LINK_MODE_APPS",Rd="subscription_created",Td="subscription_deleted",Nd=1e3*K.FIVE_SECONDS,Md={wc_pairingDelete:{req:{ttl:K.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:K.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:K.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:K.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:K.ONE_DAY,prompt:!1,tag:0},res:{ttl:K.ONE_DAY,prompt:!1,tag:0}}},Cd="pairing_create",Bd="pairing_delete",Ld="history_created",Ud="history_updated",Dd="history_deleted",jd="expirer_created",zd="expirer_deleted",qd="expirer_expired",$d="https://verify.walletconnect.org",Kd=$d,Fd=`${Kd}/v3`,Wd=["https://verify.walletconnect.com",$d],Hd="malformed_pairing_uri",Vd="session_approve_started";var Gd=function(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<e.length;i++){var o=e.charAt(i),s=o.charCodeAt(0);if(255!==r[s])throw new TypeError(o+" is ambiguous");r[s]=i}var a=e.length,c=e.charAt(0),u=Math.log(a)/Math.log(256),h=Math.log(256)/Math.log(a);function l(e){if("string"!=typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){for(var n=0,i=0;e[t]===c;)n++,t++;for(var o=(e.length-t)*u+1>>>0,s=new Uint8Array(o);e[t];){var h=r[e.charCodeAt(t)];if(255===h)return;for(var l=0,d=o-1;(0!==h||l<i)&&-1!==d;d--,l++)h+=a*s[d]>>>0,s[d]=h%256>>>0,h=h/256>>>0;if(0!==h)throw new Error("Non-zero carry");i=l,t++}if(" "!==e[t]){for(var f=o-i;f!==o&&0===s[f];)f++;for(var p=new Uint8Array(n+(o-f)),g=n;f!==o;)p[g++]=s[f++];return p}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var r=0,n=0,i=0,o=t.length;i!==o&&0===t[i];)i++,r++;for(var s=(o-i)*h+1>>>0,u=new Uint8Array(s);i!==o;){for(var l=t[i],d=0,f=s-1;(0!==l||d<n)&&-1!==f;f--,d++)l+=256*u[f]>>>0,u[f]=l%a>>>0,l=l/a>>>0;if(0!==l)throw new Error("Non-zero carry");n=d,i++}for(var p=s-n;p!==s&&0===u[p];)p++;for(var g=c.repeat(r);p<s;++p)g+=e.charAt(u[p]);return g},decodeUnsafe:l,decode:function(e){var r=l(e);if(r)return r;throw new Error(`Non-${t} character`)}}};const Yd=e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")};class Jd{constructor(e,t,r){this.name=e,this.prefix=t,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class Xd{constructor(e,t,r){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=r}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return Qd(this,e)}}class Zd{constructor(e){this.decoders=e}or(e){return Qd(this,e)}decode(e){const t=e[0],r=this.decoders[t];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const Qd=(e,t)=>new Zd({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class ef{constructor(e,t,r,n){this.name=e,this.prefix=t,this.baseEncode=r,this.baseDecode=n,this.encoder=new Jd(e,t,r),this.decoder=new Xd(e,t,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const tf=({name:e,prefix:t,encode:r,decode:n})=>new ef(e,t,r,n),rf=({prefix:e,name:t,alphabet:r})=>{const{encode:n,decode:i}=Gd(r,t);return tf({prefix:e,name:t,encode:n,decode:e=>Yd(i(e))})},nf=({name:e,prefix:t,bitsPerChar:r,alphabet:n})=>tf({prefix:t,name:e,encode:e=>((e,t,r)=>{const n="="===t[t.length-1],i=(1<<r)-1;let o="",s=0,a=0;for(let n=0;n<e.length;++n)for(a=a<<8|e[n],s+=8;s>r;)s-=r,o+=t[i&a>>s];if(s&&(o+=t[i&a<<r-s]),n)for(;o.length*r&7;)o+="=";return o})(e,n,r),decode:t=>((e,t,r,n)=>{const i={};for(let e=0;e<t.length;++e)i[t[e]]=e;let o=e.length;for(;"="===e[o-1];)--o;const s=new Uint8Array(o*r/8|0);let a=0,c=0,u=0;for(let t=0;t<o;++t){const o=i[e[t]];if(void 0===o)throw new SyntaxError(`Non-${n} character`);c=c<<r|o,a+=r,a>=8&&(a-=8,s[u++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return s})(t,n,r,e)}),of=tf({prefix:"\0",name:"identity",encode:e=>(e=>(new TextDecoder).decode(e))(e),decode:e=>(e=>(new TextEncoder).encode(e))(e)});var sf=Object.freeze({__proto__:null,identity:of});const af=nf({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var cf=Object.freeze({__proto__:null,base2:af});const uf=nf({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var hf=Object.freeze({__proto__:null,base8:uf});const lf=rf({prefix:"9",name:"base10",alphabet:"0123456789"});var df=Object.freeze({__proto__:null,base10:lf});const ff=nf({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),pf=nf({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var gf=Object.freeze({__proto__:null,base16:ff,base16upper:pf});const yf=nf({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),bf=nf({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),mf=nf({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),wf=nf({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),vf=nf({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Sf=nf({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),_f=nf({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Ef=nf({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),If=nf({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var Af=Object.freeze({__proto__:null,base32:yf,base32upper:bf,base32pad:mf,base32padupper:wf,base32hex:vf,base32hexupper:Sf,base32hexpad:_f,base32hexpadupper:Ef,base32z:If});const kf=rf({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),xf=rf({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var Pf=Object.freeze({__proto__:null,base36:kf,base36upper:xf});const Of=rf({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Rf=rf({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var Tf=Object.freeze({__proto__:null,base58btc:Of,base58flickr:Rf});const Nf=nf({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Mf=nf({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Cf=nf({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Bf=nf({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var Lf=Object.freeze({__proto__:null,base64:Nf,base64pad:Mf,base64url:Cf,base64urlpad:Bf});const Uf=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),Df=Uf.reduce(((e,t,r)=>(e[r]=t,e)),[]),jf=Uf.reduce(((e,t,r)=>(e[t.codePointAt(0)]=r,e)),[]),zf=tf({prefix:"🚀",name:"base256emoji",encode:function(e){return e.reduce(((e,t)=>e+Df[t]),"")},decode:function(e){const t=[];for(const r of e){const e=jf[r.codePointAt(0)];if(void 0===e)throw new Error(`Non-base256emoji character: ${r}`);t.push(e)}return new Uint8Array(t)}});var qf=Object.freeze({__proto__:null,base256emoji:zf}),$f=128,Kf=-128,Ff=Math.pow(2,31),Wf=Math.pow(2,7),Hf=Math.pow(2,14),Vf=Math.pow(2,21),Gf=Math.pow(2,28),Yf=Math.pow(2,35),Jf=Math.pow(2,42),Xf=Math.pow(2,49),Zf=Math.pow(2,56),Qf=Math.pow(2,63),ep=function e(t,r,n){r=r||[];for(var i=n=n||0;t>=Ff;)r[n++]=255&t|$f,t/=128;for(;t&Kf;)r[n++]=255&t|$f,t>>>=7;return r[n]=0|t,e.bytes=n-i+1,r},tp=function(e){return e<Wf?1:e<Hf?2:e<Vf?3:e<Gf?4:e<Yf?5:e<Jf?6:e<Xf?7:e<Zf?8:e<Qf?9:10};const rp=(e,t,r=0)=>(ep(e,t,r),t),np=e=>tp(e),ip=(e,t)=>{const r=t.byteLength,n=np(e),i=n+np(r),o=new Uint8Array(i+r);return rp(e,o,0),rp(r,o,n),o.set(t,i),new op(e,r,t,o)};class op{constructor(e,t,r,n){this.code=e,this.size=t,this.digest=r,this.bytes=n}}const sp=({name:e,code:t,encode:r})=>new ap(e,t,r);class ap{constructor(e,t,r){this.name=e,this.code=t,this.encode=r}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?ip(this.code,t):t.then((e=>ip(this.code,e)))}throw Error("Unknown type, must be binary type")}}const cp=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t)),up=sp({name:"sha2-256",code:18,encode:cp("SHA-256")}),hp=sp({name:"sha2-512",code:19,encode:cp("SHA-512")});Object.freeze({__proto__:null,sha256:up,sha512:hp});const lp=Yd,dp={code:0,name:"identity",encode:lp,digest:e=>ip(0,lp(e))};Object.freeze({__proto__:null,identity:dp}),new TextEncoder,new TextDecoder;const fp={...sf,...cf,...hf,...df,...gf,...Af,...Pf,...Tf,...Lf,...qf};function pp(e,t,r,n){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:r},decoder:{decode:n}}}const gp=pp("utf8","u",(e=>"u"+new TextDecoder("utf8").decode(e)),(e=>(new TextEncoder).encode(e.substring(1)))),yp=pp("ascii","a",(e=>{let t="a";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t}),(e=>{const t=function(e=0){return null!=globalThis.Buffer&&null!=globalThis.Buffer.allocUnsafe?globalThis.Buffer.allocUnsafe(e):new Uint8Array(e)}((e=e.substring(1)).length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t})),bp={utf8:gp,"utf-8":gp,hex:fp.base16,latin1:yp,ascii:yp,binary:yp,...fp};class mp{constructor(e,t){this.core=e,this.logger=t,this.keychain=new Map,this.name="keychain",this.version="0.3",this.initialized=!1,this.storagePrefix=fd,this.init=async()=>{if(!this.initialized){const e=await this.getKeyChain();typeof e<"u"&&(this.keychain=e),this.initialized=!0}},this.has=e=>(this.isInitialized(),this.keychain.has(e)),this.set=async(e,t)=>{this.isInitialized(),this.keychain.set(e,t),await this.persist()},this.get=e=>{this.isInitialized();const t=this.keychain.get(e);if(typeof t>"u"){const{message:t}=gl("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(t)}return t},this.del=async e=>{this.isInitialized(),this.keychain.delete(e),await this.persist()},this.core=e,this.logger=He(t,this.name)}get context(){return We(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setKeyChain(e){await this.core.storage.setItem(this.storageKey,yc(e))}async getKeyChain(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?bc(e):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:e}=gl("NOT_INITIALIZED",this.name);throw new Error(e)}}}class wp{constructor(e,t,r){this.core=e,this.logger=t,this.name="crypto",this.randomSessionIdentifier=Gh(),this.initialized=!1,this.init=async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)},this.hasKeys=e=>(this.isInitialized(),this.keychain.has(e)),this.getClientId=async()=>(this.isInitialized(),Ri(Mi(await this.getClientSeed()).publicKey)),this.generateKeyPair=()=>{this.isInitialized();const e=function(){const e=$h.utils.randomPrivateKey(),t=$h.getPublicKey(e);return{privateKey:Ya(e,Fh),publicKey:Ya(t,Fh)}}();return this.setPrivateKey(e.publicKey,e.privateKey)},this.signJWT=async e=>{this.isInitialized();const t=Mi(await this.getClientSeed()),r=this.randomSessionIdentifier,n=yd;return await async function(e,t,r,n,i=(0,K.fromMiliseconds)(Date.now())){const o={alg:"EdDSA",typ:"JWT"},s={iss:Ri(n.publicKey),sub:e,aud:t,iat:i,exp:i+r},a=function(e){return xi([Oi(e.header),Oi(e.payload)].join(qr),Fr)}({header:o,payload:s});return function(e){return[Oi(e.header),Oi(e.payload),Ti(e.signature)].join(qr)}({header:o,payload:s,signature:zr.sign(a,n.secretKey.slice(0,32))})}(r,e,n,t)},this.generateSharedKey=(e,t,r)=>{this.isInitialized();const n=function(e,t){const r=$h.getSharedSecret(Ga(e,Fh),Ga(t,Fh));return Ya(((e,t,r,n,i)=>function(e,t,r,n=32){if(Nc(e),Rc(n),n>255*e.outputLen)throw new Error("Length should be <= 255*HashLen");const i=Math.ceil(n/e.outputLen);void 0===r&&(r=hh);const o=new Uint8Array(i*e.outputLen),s=ch.create(e,t),a=s._cloneInto(),c=new Uint8Array(s.outputLen);for(let t=0;t<i;t++)uh[0]=t+1,a.update(0===t?hh:c).update(r).update(uh).digestInto(c),o.set(c,e.outputLen*t),s._cloneInto(a);return s.destroy(),a.destroy(),c.fill(0),uh.fill(0),o.slice(0,n)}(e,function(e,t,r){return Nc(e),void 0===r&&(r=new Uint8Array(e.outputLen)),ch(e,Fc(r),Fc(t))}(e,t,r),n,i))(mh,r,void 0,void 0,32),Fh)}(this.getPrivateKey(e),t);return this.setSymKey(n,r)},this.setSymKey=async(e,t)=>{this.isInitialized();const r=t||Yh(e);return await this.keychain.set(r,e),r},this.deleteKeyPair=async e=>{this.isInitialized(),await this.keychain.del(e)},this.deleteSymKey=async e=>{this.isInitialized(),await this.keychain.del(e)},this.encode=async(e,t,r)=>{this.isInitialized();const n=tl(r),i=we(t);if(nl(n))return function(e,t){const r=Xh(2),n=Vc(12);return Qh({type:r,sealed:Ga(e,Vh),iv:n,encoding:t})}(i,r?.encoding);if(rl(n)){const t=n.senderPublicKey,r=n.receiverPublicKey;e=await this.generateSharedKey(t,r)}const o=this.getSymKey(e),{type:s,senderPublicKey:a}=n;return function(e){const t=Xh(typeof e.type<"u"?e.type:0);if(1===Zh(t)&&typeof e.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const r=typeof e.senderPublicKey<"u"?Ga(e.senderPublicKey,Fh):void 0,n=typeof e.iv<"u"?Ga(e.iv,Fh):Vc(12),i=Ga(e.symKey,Fh);return Qh({type:t,sealed:sh(i,n).encrypt(Ga(e.message,Vh)),iv:n,senderPublicKey:r,encoding:e.encoding})}({type:s,symKey:o,message:i,senderPublicKey:a,encoding:r?.encoding})},this.decode=async(e,t,r)=>{this.isInitialized();const n=function(e,t){const r=el({encoded:e,encoding:t?.encoding});return tl({type:Zh(r.type),senderPublicKey:typeof r.senderPublicKey<"u"?Ya(r.senderPublicKey,Fh):void 0,receiverPublicKey:t?.receiverPublicKey})}(t,r);if(nl(n)){const e=function(e,t){const{sealed:r}=el({encoded:e,encoding:t});return Ya(r,Vh)}(t,r?.encoding);return me(e)}if(rl(n)){const t=n.receiverPublicKey,r=n.senderPublicKey;e=await this.generateSharedKey(t,r)}try{const n=function(e){const t=Ga(e.symKey,Fh),{sealed:r,iv:n}=el(e),i=sh(t,n).decrypt(r);if(null===i)throw new Error("Failed to decrypt");return Ya(i,Vh)}({symKey:this.getSymKey(e),encoded:t,encoding:r?.encoding});return me(n)}catch(t){this.logger.error(`Failed to decode message from topic: '${e}', clientId: '${await this.getClientId()}'`),this.logger.error(t)}},this.getPayloadType=(e,t=Wh)=>Zh(el({encoded:e,encoding:t}).type),this.getPayloadSenderPublicKey=(e,t=Wh)=>{const r=el({encoded:e,encoding:t});return r.senderPublicKey?Ya(r.senderPublicKey,Fh):void 0},this.core=e,this.logger=He(t,this.name),this.keychain=r||new mp(this.core,this.logger)}get context(){return We(this.logger)}async setPrivateKey(e,t){return await this.keychain.set(e,t),e}getPrivateKey(e){return this.keychain.get(e)}async getClientSeed(){let e="";try{e=this.keychain.get(gd)}catch{e=Gh(),await this.keychain.set(gd,e)}return function(e,t="utf8"){const r=bp[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?r.decoder.decode(`${r.prefix}${e}`):globalThis.Buffer.from(e,"utf8")}(e,"base16")}getSymKey(e){return this.keychain.get(e)}isInitialized(){if(!this.initialized){const{message:e}=gl("NOT_INITIALIZED",this.name);throw new Error(e)}}}class vp extends Ye{constructor(e,t){super(e,t),this.logger=e,this.core=t,this.messages=new Map,this.name="messages",this.version="0.3",this.initialized=!1,this.storagePrefix=fd,this.init=async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const e=await this.getRelayerMessages();typeof e<"u"&&(this.messages=e),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(e){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(e)}finally{this.initialized=!0}}},this.set=async(e,t)=>{this.isInitialized();const r=Jh(t);let n=this.messages.get(e);return typeof n>"u"&&(n={}),typeof n[r]<"u"||(n[r]=t,this.messages.set(e,n),await this.persist()),r},this.get=e=>{this.isInitialized();let t=this.messages.get(e);return typeof t>"u"&&(t={}),t},this.has=(e,t)=>(this.isInitialized(),typeof this.get(e)[Jh(t)]<"u"),this.del=async e=>{this.isInitialized(),this.messages.delete(e),await this.persist()},this.logger=He(e,this.name),this.core=t}get context(){return We(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setRelayerMessages(e){await this.core.storage.setItem(this.storageKey,yc(e))}async getRelayerMessages(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?bc(e):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){const{message:e}=gl("NOT_INITIALIZED",this.name);throw new Error(e)}}}var Sp=Object.defineProperty,_p=Object.defineProperties,Ep=Object.getOwnPropertyDescriptors,Ip=Object.getOwnPropertySymbols,Ap=Object.prototype.hasOwnProperty,kp=Object.prototype.propertyIsEnumerable,xp=(e,t,r)=>t in e?Sp(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Pp=(e,t)=>{for(var r in t||(t={}))Ap.call(t,r)&&xp(e,r,t[r]);if(Ip)for(var r of Ip(t))kp.call(t,r)&&xp(e,r,t[r]);return e},Op=(e,t)=>_p(e,Ep(t));class Rp extends Je{constructor(e,t){super(e,t),this.relayer=e,this.logger=t,this.events=new q.EventEmitter,this.name="publisher",this.queue=new Map,this.publishTimeout=(0,K.toMiliseconds)(K.ONE_MINUTE),this.initialPublishTimeout=(0,K.toMiliseconds)(15*K.ONE_SECOND),this.needsTransportRestart=!1,this.publish=async(e,t,r)=>{var n;this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:e,message:t,opts:r}});const i=r?.ttl||bd,o=il(r),s=r?.prompt||!1,a=r?.tag||0,c=r?.id||Hl().toString(),u={topic:e,message:t,opts:{ttl:i,relay:o,prompt:s,tag:a,id:c,attestation:r?.attestation}},h=`Failed to publish payload, please try again. id:${c} tag:${a}`;try{const n=new Promise((async n=>{const o=({id:e})=>{u.opts.id===e&&(this.removeRequestFromQueue(e),this.relayer.events.removeListener(_d,o),n(u))};this.relayer.events.on(_d,o);const h=wc(new Promise(((n,o)=>{this.rpcPublish({topic:e,message:t,ttl:i,prompt:s,tag:a,id:c,attestation:r?.attestation}).then(n).catch((e=>{this.logger.warn(e,e?.message),o(e)}))})),this.initialPublishTimeout,`Failed initial publish, retrying.... id:${c} tag:${a}`);try{await h,this.events.removeListener(_d,o)}catch(e){this.queue.set(c,Op(Pp({},u),{attempt:1})),this.logger.warn(e,e?.message)}}));this.logger.trace({type:"method",method:"publish",params:{id:c,topic:e,message:t,opts:r}}),await wc(n,this.publishTimeout,h)}catch(e){if(this.logger.debug("Failed to Publish Payload"),this.logger.error(e),null!=(n=r?.internal)&&n.throwOnFailedPublish)throw e}finally{this.queue.delete(c)}},this.on=(e,t)=>{this.events.on(e,t)},this.once=(e,t)=>{this.events.once(e,t)},this.off=(e,t)=>{this.events.off(e,t)},this.removeListener=(e,t)=>{this.events.removeListener(e,t)},this.relayer=e,this.logger=He(t,this.name),this.registerEventListeners()}get context(){return We(this.logger)}async rpcPublish(e){var t,r,n,i;const{topic:o,message:s,ttl:a=bd,prompt:c,tag:u,id:h,attestation:l}=e,d={method:ol(il().protocol).publish,params:{topic:o,message:s,ttl:a,prompt:c,tag:u,attestation:l},id:h};wl(null==(t=d.params)?void 0:t.prompt)&&(null==(r=d.params)||delete r.prompt),wl(null==(n=d.params)?void 0:n.tag)&&(null==(i=d.params)||delete i.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:d});const f=await this.relayer.request(d);return this.relayer.events.emit(_d,e),this.logger.debug("Successfully Published Payload"),f}removeRequestFromQueue(e){this.queue.delete(e)}checkQueue(){this.queue.forEach((async(e,t)=>{const r=e.attempt+1;this.queue.set(t,Op(Pp({},e),{attempt:r}));const{topic:n,message:i,opts:o,attestation:s}=e;this.logger.warn({},`Publisher: queue->publishing: ${e.opts.id}, tag: ${e.opts.tag}, attempt: ${r}`),await this.rpcPublish({topic:n,message:i,ttl:o.ttl,prompt:o.prompt,tag:o.tag,id:o.id,attestation:s}),this.logger.warn({},`Publisher: queue->published: ${e.opts.id}`)}))}registerEventListeners(){this.relayer.core.heartbeat.on(V,(()=>{if(this.needsTransportRestart)return this.needsTransportRestart=!1,void this.relayer.events.emit(Sd);this.checkQueue()})),this.relayer.on(vd,(e=>{this.removeRequestFromQueue(e.id.toString())}))}}class Tp{constructor(){this.map=new Map,this.set=(e,t)=>{const r=this.get(e);this.exists(e,t)||this.map.set(e,[...r,t])},this.get=e=>this.map.get(e)||[],this.exists=(e,t)=>this.get(e).includes(t),this.delete=(e,t)=>{if(typeof t>"u")return void this.map.delete(e);if(!this.map.has(e))return;const r=this.get(e);if(!this.exists(e,t))return;const n=r.filter((e=>e!==t));n.length?this.map.set(e,n):this.map.delete(e)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}}var Np=Object.defineProperty,Mp=Object.defineProperties,Cp=Object.getOwnPropertyDescriptors,Bp=Object.getOwnPropertySymbols,Lp=Object.prototype.hasOwnProperty,Up=Object.prototype.propertyIsEnumerable,Dp=(e,t,r)=>t in e?Np(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,jp=(e,t)=>{for(var r in t||(t={}))Lp.call(t,r)&&Dp(e,r,t[r]);if(Bp)for(var r of Bp(t))Up.call(t,r)&&Dp(e,r,t[r]);return e},zp=(e,t)=>Mp(e,Cp(t));class qp extends Qe{constructor(e,t){super(e,t),this.relayer=e,this.logger=t,this.subscriptions=new Map,this.topicMap=new Tp,this.events=new q.EventEmitter,this.name="subscription",this.version="0.3",this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pollingInterval=20,this.storagePrefix=fd,this.subscribeTimeout=(0,K.toMiliseconds)(K.ONE_MINUTE),this.initialSubscribeTimeout=(0,K.toMiliseconds)(15*K.ONE_SECOND),this.batchSubscribeTopicsLimit=500,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),this.registerEventListeners(),this.clientId=await this.relayer.core.crypto.getClientId(),await this.restore()),this.initialized=!0},this.subscribe=async(e,t)=>{this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:e,opts:t}});try{const r=il(t),n={topic:e,relay:r,transportType:t?.transportType};this.pending.set(e,n);const i=await this.rpcSubscribe(e,r,t);return"string"==typeof i&&(this.onSubscribe(i,n),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:e,opts:t}})),i}catch(e){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(e),e}},this.unsubscribe=async(e,t)=>{await this.restartToComplete(),this.isInitialized(),typeof t?.id<"u"?await this.unsubscribeById(e,t.id,t):await this.unsubscribeByTopic(e,t)},this.isSubscribed=async e=>{if(this.topics.includes(e))return!0;const t=`${this.pendingSubscriptionWatchLabel}_${e}`;return await new Promise(((r,n)=>{const i=new K.Watch;i.start(t);const o=setInterval((()=>{(!this.pending.has(e)&&this.topics.includes(e)||this.cached.some((t=>t.topic===e)))&&(clearInterval(o),i.stop(t),r(!0)),i.elapsed(t)>=Nd&&(clearInterval(o),i.stop(t),n(new Error("Subscription resolution timeout")))}),this.pollingInterval)})).catch((()=>!1))},this.on=(e,t)=>{this.events.on(e,t)},this.once=(e,t)=>{this.events.once(e,t)},this.off=(e,t)=>{this.events.off(e,t)},this.removeListener=(e,t)=>{this.events.removeListener(e,t)},this.start=async()=>{await this.onConnect()},this.stop=async()=>{await this.onDisconnect()},this.restart=async()=>{await this.restore(),await this.onRestart()},this.checkPending=async()=>{if(!(0!==this.pending.size||this.initialized&&this.relayer.connected))return;const e=[];this.pending.forEach((t=>{e.push(t)})),await this.batchSubscribe(e)},this.registerEventListeners=()=>{this.relayer.core.heartbeat.on(V,(async()=>{await this.checkPending()})),this.events.on(Rd,(async e=>{const t=Rd;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),await this.persist()})),this.events.on(Td,(async e=>{const t=Td;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),await this.persist()}))},this.relayer=e,this.logger=He(t,this.name),this.clientId=""}get context(){return We(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.relayer.core.customStoragePrefix+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(e,t){let r=!1;try{r=this.getSubscription(e).topic===t}catch{}return r}reset(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(e,t){const r=this.topicMap.get(e);await Promise.all(r.map((async r=>await this.unsubscribeById(e,r,t))))}async unsubscribeById(e,t,r){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:t,opts:r}});try{const n=il(r);await this.rpcUnsubscribe(e,t,n);const i=yl("USER_DISCONNECTED",`${this.name}, ${e}`);await this.onUnsubscribe(e,t,i),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:t,opts:r}})}catch(e){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(e),e}}async rpcSubscribe(e,t,r){var n;r?.transportType===Pd.relay&&await this.restartToComplete();const i={method:ol(t.protocol).subscribe,params:{topic:e}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:i});const o=null==(n=r?.internal)?void 0:n.throwOnFailedPublish;try{const t=this.getSubscriptionId(e);if(r?.transportType===Pd.link_mode)return setTimeout((()=>{(this.relayer.connected||this.relayer.connecting)&&this.relayer.request(i).catch((e=>this.logger.warn(e)))}),(0,K.toMiliseconds)(K.ONE_SECOND)),t;const n=new Promise((async t=>{const r=n=>{n.topic===e&&(this.events.removeListener(Rd,r),t(n.id))};this.events.on(Rd,r);try{const n=await wc(new Promise(((e,t)=>{this.relayer.request(i).catch((e=>{this.logger.warn(e,e?.message),t(e)})).then(e)})),this.initialSubscribeTimeout,`Subscribing to ${e} failed, please try again`);this.events.removeListener(Rd,r),t(n)}catch{}})),s=await wc(n,this.subscribeTimeout,`Subscribing to ${e} failed, please try again`);if(!s&&o)throw new Error(`Subscribing to ${e} failed, please try again`);return s?t:null}catch(e){if(this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(Sd),o)throw e}return null}async rpcBatchSubscribe(e){if(!e.length)return;const t={method:ol(e[0].relay.protocol).batchSubscribe,params:{topics:e.map((e=>e.topic))}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:t});try{await await wc(new Promise((e=>{this.relayer.request(t).catch((e=>this.logger.warn(e))).then(e)})),this.subscribeTimeout,"rpcBatchSubscribe failed, please try again")}catch{this.relayer.events.emit(Sd)}}async rpcBatchFetchMessages(e){if(!e.length)return;const t={method:ol(e[0].relay.protocol).batchFetchMessages,params:{topics:e.map((e=>e.topic))}};let r;this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:t});try{r=await await wc(new Promise(((e,r)=>{this.relayer.request(t).catch((e=>{this.logger.warn(e),r(e)})).then(e)})),this.subscribeTimeout,"rpcBatchFetchMessages failed, please try again")}catch{this.relayer.events.emit(Sd)}return r}rpcUnsubscribe(e,t,r){const n={method:ol(r.protocol).unsubscribe,params:{topic:e,id:t}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n}),this.relayer.request(n)}onSubscribe(e,t){this.setSubscription(e,zp(jp({},t),{id:e})),this.pending.delete(t.topic)}onBatchSubscribe(e){e.length&&e.forEach((e=>{this.setSubscription(e.id,jp({},e)),this.pending.delete(e.topic)}))}async onUnsubscribe(e,t,r){this.events.removeAllListeners(t),this.hasSubscription(t,e)&&this.deleteSubscription(t,r),await this.relayer.messages.del(e)}async setRelayerSubscriptions(e){await this.relayer.core.storage.setItem(this.storageKey,e)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(e,t){this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:e,subscription:t}),this.addSubscription(e,t)}addSubscription(e,t){this.subscriptions.set(e,jp({},t)),this.topicMap.set(t.topic,e),this.events.emit(Rd,t)}getSubscription(e){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:e});const t=this.subscriptions.get(e);if(!t){const{message:t}=gl("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(t)}return t}deleteSubscription(e,t){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:e,reason:t});const r=this.getSubscription(e);this.subscriptions.delete(e),this.topicMap.delete(r.topic,e),this.events.emit(Td,zp(jp({},r),{reason:t}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit("subscription_sync")}async onRestart(){if(this.cached.length){const e=[...this.cached],t=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let r=0;r<t;r++){const t=e.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(t)}}this.events.emit("subscription_resubscribed")}async restore(){try{const e=await this.getRelayerSubscriptions();if(typeof e>"u"||!e.length)return;if(this.subscriptions.size){const{message:e}=gl("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(e),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(e)}this.cached=e,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(e){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(e)}}async batchSubscribe(e){e.length&&(await this.rpcBatchSubscribe(e),this.onBatchSubscribe(e.map((e=>zp(jp({},e),{id:this.getSubscriptionId(e.topic)})))))}async batchFetchMessages(e){if(!e.length)return;this.logger.trace(`Fetching batch messages for ${e.length} subscriptions`);const t=await this.rpcBatchFetchMessages(e);t&&t.messages&&(await function(e){return new Promise((t=>setTimeout(t,e)))}((0,K.toMiliseconds)(K.ONE_SECOND)),await this.relayer.handleBatchMessageEvents(t.messages))}async onConnect(){await this.restart(),this.reset()}onDisconnect(){this.onDisable()}isInitialized(){if(!this.initialized){const{message:e}=gl("NOT_INITIALIZED",this.name);throw new Error(e)}}async restartToComplete(){!this.relayer.connected&&!this.relayer.connecting&&await this.relayer.transportOpen()}getSubscriptionId(e){return Jh(e+this.clientId)}}var $p=Object.defineProperty,Kp=Object.getOwnPropertySymbols,Fp=Object.prototype.hasOwnProperty,Wp=Object.prototype.propertyIsEnumerable,Hp=(e,t,r)=>t in e?$p(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Vp=(e,t)=>{for(var r in t||(t={}))Fp.call(t,r)&&Hp(e,r,t[r]);if(Kp)for(var r of Kp(t))Wp.call(t,r)&&Hp(e,r,t[r]);return e};class Gp extends Xe{constructor(e){super(e),this.protocol="wc",this.version=2,this.events=new q.EventEmitter,this.name="relayer",this.transportExplicitlyClosed=!1,this.initialized=!1,this.connectionAttemptInProgress=!1,this.hasExperiencedNetworkDisruption=!1,this.heartBeatTimeout=(0,K.toMiliseconds)(K.THIRTY_SECONDS+K.FIVE_SECONDS),this.requestsInFlight=[],this.connectTimeout=(0,K.toMiliseconds)(15*K.ONE_SECOND),this.request=async e=>{var t,r;this.logger.debug("Publishing Request Payload");const n=e.id||Hl().toString();await this.toEstablishConnection();try{this.logger.trace({id:n,method:e.method,topic:null==(t=e.params)?void 0:t.topic},"relayer.request - publishing...");const i=`${n}:${(null==(r=e.params)?void 0:r.tag)||""}`;this.requestsInFlight.push(i);const o=await this.provider.request(e);return this.requestsInFlight=this.requestsInFlight.filter((e=>e!==i)),o}catch(e){throw this.logger.debug(`Failed to Publish Request: ${n}`),e}},this.resetPingTimeout=()=>{if(cc())try{clearTimeout(this.pingTimeout),this.pingTimeout=setTimeout((()=>{var e,t,r;this.logger.debug({},"pingTimeout: Connection stalled, terminating..."),null==(r=null==(t=null==(e=this.provider)?void 0:e.connection)?void 0:t.socket)||r.terminate()}),this.heartBeatTimeout)}catch(e){this.logger.warn(e,e?.message)}},this.onPayloadHandler=e=>{this.onProviderPayload(e),this.resetPingTimeout()},this.onConnectHandler=()=>{this.logger.warn({},"Relayer connected 🛜"),this.startPingTimeout(),this.events.emit("relayer_connect")},this.onDisconnectHandler=()=>{this.logger.warn({},"Relayer disconnected 🛑"),this.requestsInFlight=[],this.onProviderDisconnect()},this.onProviderErrorHandler=e=>{this.logger.fatal(e,`Fatal socket error: ${e?.message}`),this.events.emit("relayer_error",e),this.logger.fatal("Fatal socket error received, closing transport"),this.transportClose()},this.registerProviderListeners=()=>{this.provider.on(Ed,this.onPayloadHandler),this.provider.on(Id,this.onConnectHandler),this.provider.on(Ad,this.onDisconnectHandler),this.provider.on(kd,this.onProviderErrorHandler)},this.core=e.core,this.logger=typeof e.logger<"u"&&"string"!=typeof e.logger?He(e.logger,this.name):Pe()(Fe({level:e.logger||"error"})),this.messages=new vp(this.logger,e.core),this.subscriber=new qp(this,this.logger),this.publisher=new Rp(this,this.logger),this.relayUrl=e?.relayUrl||md,this.projectId=e.projectId,uc()&&typeof r.g<"u"&&typeof(null==r.g?void 0:r.g.Platform)<"u"&&"android"===(null==r.g?void 0:r.g.Platform.OS)?this.packageName=dc():uc()&&typeof r.g<"u"&&typeof(null==r.g?void 0:r.g.Platform)<"u"&&"ios"===(null==r.g?void 0:r.g.Platform.OS)&&(this.bundleId=dc()),this.provider={}}async init(){if(this.logger.trace("Initialized"),this.registerEventListeners(),await Promise.all([this.messages.init(),this.subscriber.init()]),this.initialized=!0,this.subscriber.cached.length>0)try{await this.transportOpen()}catch(e){this.logger.warn(e,e?.message)}}get context(){return We(this.logger)}get connected(){var e,t,r;return 1===(null==(r=null==(t=null==(e=this.provider)?void 0:e.connection)?void 0:t.socket)?void 0:r.readyState)}get connecting(){var e,t,r;return 0===(null==(r=null==(t=null==(e=this.provider)?void 0:e.connection)?void 0:t.socket)?void 0:r.readyState)}async publish(e,t,r){this.isInitialized(),await this.publisher.publish(e,t,r),await this.recordMessageEvent({topic:e,message:t,publishedAt:Date.now(),transportType:Pd.relay})}async subscribe(e,t){var r,n,i;this.isInitialized(),(null==t||!t.transportType||"relay"===t?.transportType)&&await this.toEstablishConnection();const o=typeof(null==(r=t?.internal)?void 0:r.throwOnFailedPublish)>"u"||(null==(n=t?.internal)?void 0:n.throwOnFailedPublish);let s,a=(null==(i=this.subscriber.topicMap.get(e))?void 0:i[0])||"";const c=t=>{t.topic===e&&(this.subscriber.off(Rd,c),s())};return await Promise.all([new Promise((e=>{s=e,this.subscriber.on(Rd,c)})),new Promise((async(r,n)=>{a=await this.subscriber.subscribe(e,Vp({internal:{throwOnFailedPublish:o}},t)).catch((e=>{o&&n(e)}))||a,r()}))]),a}async unsubscribe(e,t){this.isInitialized(),await this.subscriber.unsubscribe(e,t)}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async transportDisconnect(){this.provider.disconnect&&(this.hasExperiencedNetworkDisruption||this.connected)?await wc(this.provider.disconnect(),2e3,"provider.disconnect()").catch((()=>this.onProviderDisconnect())):this.onProviderDisconnect()}async transportClose(){this.transportExplicitlyClosed=!0,await this.transportDisconnect()}async transportOpen(e){if(this.connectPromise?(this.logger.debug({},"Waiting for existing connection attempt to resolve..."),await this.connectPromise,this.logger.debug({},"Existing connection attempt resolved")):(this.connectPromise=new Promise((async(t,r)=>{await this.connect(e).then(t).catch(r).finally((()=>{this.connectPromise=void 0}))})),await this.connectPromise),!this.connected)throw new Error(`Couldn't establish socket connection to the relay server: ${this.relayUrl}`)}async restartTransport(e){this.logger.debug({},"Restarting transport..."),!this.connectionAttemptInProgress&&(this.relayUrl=e||this.relayUrl,await this.confirmOnlineStateOrThrow(),await this.transportClose(),await this.transportOpen())}async confirmOnlineStateOrThrow(){if(!await Tl())throw new Error("No internet connection detected. Please restart your network and try again.")}async handleBatchMessageEvents(e){if(0===e?.length)return void this.logger.trace("Batch message events is empty. Ignoring...");const t=e.sort(((e,t)=>e.publishedAt-t.publishedAt));this.logger.debug(`Batch of ${t.length} message events sorted`);for(const e of t)try{await this.onMessageEvent(e)}catch(e){this.logger.warn(e,"Error while processing batch message event: "+e?.message)}this.logger.trace(`Batch of ${t.length} message events processed`)}async onLinkMessageEvent(e,t){const{topic:r}=e;if(!t.sessionExists){const e={topic:r,expiry:_c(K.FIVE_MINUTES),relay:{protocol:"irn"},active:!1};await this.core.pairing.pairings.set(r,e)}this.events.emit(wd,e),await this.recordMessageEvent(e)}async connect(e){await this.confirmOnlineStateOrThrow(),e&&e!==this.relayUrl&&(this.relayUrl=e,await this.transportDisconnect()),this.connectionAttemptInProgress=!0,this.transportExplicitlyClosed=!1;let t=1;for(;t<6;){try{this.logger.debug({},`Connecting to ${this.relayUrl}, attempt: ${t}...`),await this.createProvider(),await new Promise((async(e,t)=>{const r=()=>{t(new Error("Connection interrupted while trying to subscribe"))};this.provider.once(Ad,r),await wc(new Promise(((e,t)=>{this.provider.connect().then(e).catch(t)})),this.connectTimeout,`Socket stalled when trying to connect to ${this.relayUrl}`).catch((e=>{t(e)})).finally((()=>{this.provider.off(Ad,r),clearTimeout(this.reconnectTimeout),this.reconnectTimeout=void 0})),await new Promise((async(e,t)=>{const r=()=>{t(new Error("Connection interrupted while trying to subscribe"))};this.provider.once(Ad,r),await this.subscriber.start().then(e).catch(t).finally((()=>{this.provider.off(Ad,r)}))})),this.hasExperiencedNetworkDisruption=!1,e()}))}catch(e){await this.subscriber.stop();const t=e;this.logger.warn({},t.message),this.hasExperiencedNetworkDisruption=!0}finally{this.connectionAttemptInProgress=!1}if(this.connected){this.logger.debug({},`Connected to ${this.relayUrl} successfully on attempt: ${t}`);break}await new Promise((e=>setTimeout(e,(0,K.toMiliseconds)(1*t)))),t++}}startPingTimeout(){var e,t,r,n,i;if(cc())try{null!=(t=null==(e=this.provider)?void 0:e.connection)&&t.socket&&(null==(i=null==(n=null==(r=this.provider)?void 0:r.connection)?void 0:n.socket)||i.on("ping",(()=>{this.resetPingTimeout()}))),this.resetPingTimeout()}catch(e){this.logger.warn(e,e?.message)}}async createProvider(){this.provider.connection&&this.unregisterProviderListeners();const e=await this.core.crypto.signJWT(this.relayUrl);this.provider=new sd(new ud(function({protocol:e,version:t,relayUrl:r,sdkVersion:n,auth:i,projectId:o,useOnCloseEvent:s,bundleId:a,packageName:c}){const u=r.split("?"),h={auth:i,ua:pc(e,t,n),projectId:o,useOnCloseEvent:s||void 0,packageName:c||void 0,bundleId:a||void 0},l=function(e,t){const r=new URLSearchParams(e);for(const e of Object.keys(t).sort())if(t.hasOwnProperty(e)){const n=t[e];void 0!==n&&r.set(e,n)}return r.toString()}(u[1]||"",h);return u[0]+"?"+l}({sdkVersion:xd,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:e,useOnCloseEvent:!0,bundleId:this.bundleId,packageName:this.packageName}))),this.registerProviderListeners()}async recordMessageEvent(e){const{topic:t,message:r}=e;await this.messages.set(t,r)}async shouldIgnoreMessageEvent(e){const{topic:t,message:r}=e;if(!r||0===r.length)return this.logger.warn(`Ignoring invalid/empty message: ${r}`),!0;if(!await this.subscriber.isSubscribed(t))return this.logger.warn(`Ignoring message for non-subscribed topic ${t}`),!0;const n=this.messages.has(t,r);return n&&this.logger.warn(`Ignoring duplicate message: ${r}`),n}async onProviderPayload(e){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:e}),rd(e)){if(!e.method.endsWith("_subscription"))return;const t=e.params,{topic:r,message:n,publishedAt:i,attestation:o}=t.data,s={topic:r,message:n,publishedAt:i,transportType:Pd.relay,attestation:o};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(Vp({type:"event",event:t.id},s)),this.events.emit(t.id,s),await this.acknowledgePayload(e),await this.onMessageEvent(s)}else nd(e)&&this.events.emit(vd,e)}async onMessageEvent(e){await this.shouldIgnoreMessageEvent(e)||(this.events.emit(wd,e),await this.recordMessageEvent(e))}async acknowledgePayload(e){const t=Gl(e.id,!0);await this.provider.connection.send(t)}unregisterProviderListeners(){this.provider.off(Ed,this.onPayloadHandler),this.provider.off(Id,this.onConnectHandler),this.provider.off(Ad,this.onDisconnectHandler),this.provider.off(kd,this.onProviderErrorHandler),clearTimeout(this.pingTimeout)}async registerEventListeners(){let e=await Tl();!function(e){switch(lc()){case sc.browser:!function(e){!uc()&&hc()&&(window.addEventListener("online",(()=>e(!0))),window.addEventListener("offline",(()=>e(!1))))}(e);break;case sc.reactNative:!function(e){uc()&&typeof r.g<"u"&&null!=r.g&&r.g.NetInfo&&r.g?.NetInfo.addEventListener((t=>e(t?.isConnected)))}(e);case sc.node:}}((async t=>{e!==t&&(e=t,t?await this.transportOpen().catch((e=>this.logger.error(e,e?.message))):(this.hasExperiencedNetworkDisruption=!0,await this.transportDisconnect(),this.transportExplicitlyClosed=!1))}))}async onProviderDisconnect(){await this.subscriber.stop(),clearTimeout(this.pingTimeout),this.events.emit("relayer_disconnect"),this.connectionAttemptInProgress=!1,!this.transportExplicitlyClosed&&(this.reconnectTimeout||this.connectPromise||(this.reconnectTimeout=setTimeout((async()=>{clearTimeout(this.reconnectTimeout),await this.transportOpen().catch((e=>this.logger.error(e,e?.message)))}),(0,K.toMiliseconds)(.1))))}isInitialized(){if(!this.initialized){const{message:e}=gl("NOT_INITIALIZED",this.name);throw new Error(e)}}async toEstablishConnection(){await this.confirmOnlineStateOrThrow(),!this.connected&&await this.transportOpen()}}var Yp=Object.defineProperty,Jp=Object.getOwnPropertySymbols,Xp=Object.prototype.hasOwnProperty,Zp=Object.prototype.propertyIsEnumerable,Qp=(e,t,r)=>t in e?Yp(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,eg=(e,t)=>{for(var r in t||(t={}))Xp.call(t,r)&&Qp(e,r,t[r]);if(Jp)for(var r of Jp(t))Zp.call(t,r)&&Qp(e,r,t[r]);return e};class tg extends Ze{constructor(e,t,r,n=fd,i=void 0){super(e,t,r,n),this.core=e,this.logger=t,this.name=r,this.map=new Map,this.version="0.3",this.cached=[],this.initialized=!1,this.storagePrefix=fd,this.recentlyDeleted=[],this.recentlyDeletedLimit=200,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach((e=>{this.getKey&&null!==e&&!wl(e)?this.map.set(this.getKey(e),e):function(e){var t;return null==(t=e?.proposer)?void 0:t.publicKey}(e)?this.map.set(e.id,e):function(e){return e?.topic}(e)&&this.map.set(e.topic,e)})),this.cached=[],this.initialized=!0)},this.set=async(e,t)=>{this.isInitialized(),this.map.has(e)?await this.update(e,t):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:e,value:t}),this.map.set(e,t),await this.persist())},this.get=e=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:e}),this.getData(e)),this.getAll=e=>(this.isInitialized(),e?this.values.filter((t=>Object.keys(e).every((r=>ld()(t[r],e[r]))))):this.values),this.update=async(e,t)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:e,update:t});const r=eg(eg({},this.getData(e)),t);this.map.set(e,r),await this.persist()},this.delete=async(e,t)=>{this.isInitialized(),this.map.has(e)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:e,reason:t}),this.map.delete(e),this.addToRecentlyDeleted(e),await this.persist())},this.logger=He(t,this.name),this.storagePrefix=n,this.getKey=i}get context(){return We(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}addToRecentlyDeleted(e){this.recentlyDeleted.push(e),this.recentlyDeleted.length>=this.recentlyDeletedLimit&&this.recentlyDeleted.splice(0,this.recentlyDeletedLimit/2)}async setDataStore(e){await this.core.storage.setItem(this.storageKey,e)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(e){const t=this.map.get(e);if(!t){if(this.recentlyDeleted.includes(e)){const{message:t}=gl("MISSING_OR_INVALID",`Record was recently deleted - ${this.name}: ${e}`);throw this.logger.error(t),new Error(t)}const{message:t}=gl("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(t),new Error(t)}return t}async persist(){await this.setDataStore(this.values)}async restore(){try{const e=await this.getDataStore();if(typeof e>"u"||!e.length)return;if(this.map.size){const{message:e}=gl("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(e),new Error(e)}this.cached=e,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(e){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(e)}}isInitialized(){if(!this.initialized){const{message:e}=gl("NOT_INITIALIZED",this.name);throw new Error(e)}}}class rg{constructor(e,t){this.core=e,this.logger=t,this.name="pairing",this.version="0.3",this.events=new($()),this.initialized=!1,this.storagePrefix=fd,this.ignoredPayloadTypes=[1],this.registeredMethods=[],this.init=async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))},this.register=({methods:e})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...e])]},this.create=async e=>{this.isInitialized();const t=Gh(),r=await this.core.crypto.setSymKey(t),n=_c(K.FIVE_MINUTES),i={protocol:"irn"},o={topic:r,expiry:n,relay:i,active:!1,methods:e?.methods},s=ul({protocol:this.core.protocol,version:this.core.version,topic:r,symKey:t,relay:i,expiryTimestamp:n,methods:e?.methods});return this.events.emit(Cd,o),this.core.expirer.set(r,n),await this.pairings.set(r,o),await this.core.relayer.subscribe(r,{transportType:e?.transportType}),{topic:r,uri:s}},this.pair=async e=>{this.isInitialized();const t=this.core.eventClient.createEvent({properties:{topic:e?.uri,trace:["pairing_started"]}});this.isValidPair(e,t);const{topic:r,symKey:n,relay:i,expiryTimestamp:o,methods:s}=al(e.uri);let a;if(t.props.properties.topic=r,t.addTrace("pairing_uri_validation_success"),t.addTrace("pairing_uri_not_expired"),this.pairings.keys.includes(r)){if(a=this.pairings.get(r),t.addTrace("existing_pairing"),a.active)throw t.setError("active_pairing_already_exists"),new Error(`Pairing already exists: ${r}. Please try again with a new connection URI.`);t.addTrace("pairing_not_expired")}const c=o||_c(K.FIVE_MINUTES),u={topic:r,relay:i,expiry:c,active:!1,methods:s};this.core.expirer.set(r,c),await this.pairings.set(r,u),t.addTrace("store_new_pairing"),e.activatePairing&&await this.activate({topic:r}),this.events.emit(Cd,u),t.addTrace("emit_inactive_pairing"),this.core.crypto.keychain.has(r)||await this.core.crypto.setSymKey(n,r),t.addTrace("subscribing_pairing_topic");try{await this.core.relayer.confirmOnlineStateOrThrow()}catch{t.setError("no_internet_connection")}try{await this.core.relayer.subscribe(r,{relay:i})}catch(e){throw t.setError("subscribe_pairing_topic_failure"),e}return t.addTrace("subscribe_pairing_topic_success"),u},this.activate=async({topic:e})=>{this.isInitialized();const t=_c(K.FIVE_MINUTES);this.core.expirer.set(e,t),await this.pairings.update(e,{active:!0,expiry:t})},this.ping=async e=>{this.isInitialized(),await this.isValidPing(e),this.logger.warn("ping() is deprecated and will be removed in the next major release.");const{topic:t}=e;if(this.pairings.keys.includes(t)){const e=await this.sendRequest(t,"wc_pairingPing",{}),{done:r,resolve:n,reject:i}=mc();this.events.once(Ic("pairing_ping",e),(({error:e})=>{e?i(e):n()})),await r()}},this.updateExpiry=async({topic:e,expiry:t})=>{this.isInitialized(),await this.pairings.update(e,{expiry:t})},this.updateMetadata=async({topic:e,metadata:t})=>{this.isInitialized(),await this.pairings.update(e,{peerMetadata:t})},this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=async e=>{this.isInitialized(),await this.isValidDisconnect(e);const{topic:t}=e;this.pairings.keys.includes(t)&&(await this.sendRequest(t,"wc_pairingDelete",yl("USER_DISCONNECTED")),await this.deletePairing(t))},this.formatUriFromPairing=e=>{this.isInitialized();const{topic:t,relay:r,expiry:n,methods:i}=e,o=this.core.crypto.keychain.get(t);return ul({protocol:this.core.protocol,version:this.core.version,topic:t,symKey:o,relay:r,expiryTimestamp:n,methods:i})},this.sendRequest=async(e,t,r)=>{const n=Vl(t,r),i=await this.core.crypto.encode(e,n),o=Md[t].req;return this.core.history.set(e,n),this.core.relayer.publish(e,i,o),n.id},this.sendResult=async(e,t,r)=>{const n=Gl(e,r),i=await this.core.crypto.encode(t,n),o=await this.core.history.get(t,e),s=Md[o.request.method].res;await this.core.relayer.publish(t,i,s),await this.core.history.resolve(n)},this.sendError=async(e,t,r)=>{const n=Yl(e,r),i=await this.core.crypto.encode(t,n),o=await this.core.history.get(t,e),s=Md[o.request.method]?Md[o.request.method].res:Md.unregistered_method.res;await this.core.relayer.publish(t,i,s),await this.core.history.resolve(n)},this.deletePairing=async(e,t)=>{await this.core.relayer.unsubscribe(e),await Promise.all([this.pairings.delete(e,yl("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(e),t?Promise.resolve():this.core.expirer.del(e)])},this.cleanup=async()=>{const e=this.pairings.getAll().filter((e=>Ec(e.expiry)));await Promise.all(e.map((e=>this.deletePairing(e.topic))))},this.onRelayEventRequest=e=>{const{topic:t,payload:r}=e;switch(r.method){case"wc_pairingPing":return this.onPairingPingRequest(t,r);case"wc_pairingDelete":return this.onPairingDeleteRequest(t,r);default:return this.onUnknownRpcMethodRequest(t,r)}},this.onRelayEventResponse=async e=>{const{topic:t,payload:r}=e,n=(await this.core.history.get(t,r.id)).request.method;return"wc_pairingPing"===n?this.onPairingPingResponse(t,r):this.onUnknownRpcMethodResponse(n)},this.onPairingPingRequest=async(e,t)=>{const{id:r}=t;try{this.isValidPing({topic:e}),await this.sendResult(r,e,!0),this.events.emit("pairing_ping",{id:r,topic:e})}catch(t){await this.sendError(r,e,t),this.logger.error(t)}},this.onPairingPingResponse=(e,t)=>{const{id:r}=t;setTimeout((()=>{id(t)?this.events.emit(Ic("pairing_ping",r),{}):od(t)&&this.events.emit(Ic("pairing_ping",r),{error:t.error})}),500)},this.onPairingDeleteRequest=async(e,t)=>{const{id:r}=t;try{this.isValidDisconnect({topic:e}),await this.deletePairing(e),this.events.emit(Bd,{id:r,topic:e})}catch(t){await this.sendError(r,e,t),this.logger.error(t)}},this.onUnknownRpcMethodRequest=async(e,t)=>{const{id:r,method:n}=t;try{if(this.registeredMethods.includes(n))return;const t=yl("WC_METHOD_UNSUPPORTED",n);await this.sendError(r,e,t),this.logger.error(t)}catch(t){await this.sendError(r,e,t),this.logger.error(t)}},this.onUnknownRpcMethodResponse=e=>{this.registeredMethods.includes(e)||this.logger.error(yl("WC_METHOD_UNSUPPORTED",e))},this.isValidPair=(e,t)=>{var r;if(!xl(e)){const{message:r}=gl("MISSING_OR_INVALID",`pair() params: ${e}`);throw t.setError(Hd),new Error(r)}if(!function(e){function t(e){try{return typeof new URL(e)<"u"}catch{return!1}}try{if(vl(e,!1))return!!t(e)||t(Oc(e))}catch{}return!1}(e.uri)){const{message:r}=gl("MISSING_OR_INVALID",`pair() uri: ${e.uri}`);throw t.setError(Hd),new Error(r)}const n=al(e?.uri);if(null==(r=n?.relay)||!r.protocol){const{message:e}=gl("MISSING_OR_INVALID","pair() uri#relay-protocol");throw t.setError(Hd),new Error(e)}if(null==n||!n.symKey){const{message:e}=gl("MISSING_OR_INVALID","pair() uri#symKey");throw t.setError(Hd),new Error(e)}if(null!=n&&n.expiryTimestamp&&(0,K.toMiliseconds)(n?.expiryTimestamp)<Date.now()){t.setError("pairing_expired");const{message:e}=gl("EXPIRED","pair() URI has expired. Please try again with a new connection URI.");throw new Error(e)}},this.isValidPing=async e=>{if(!xl(e)){const{message:t}=gl("MISSING_OR_INVALID",`ping() params: ${e}`);throw new Error(t)}const{topic:t}=e;await this.isValidPairingTopic(t)},this.isValidDisconnect=async e=>{if(!xl(e)){const{message:t}=gl("MISSING_OR_INVALID",`disconnect() params: ${e}`);throw new Error(t)}const{topic:t}=e;await this.isValidPairingTopic(t)},this.isValidPairingTopic=async e=>{if(!vl(e,!1)){const{message:t}=gl("MISSING_OR_INVALID",`pairing topic should be a string: ${e}`);throw new Error(t)}if(!this.pairings.keys.includes(e)){const{message:t}=gl("NO_MATCHING_KEY",`pairing topic doesn't exist: ${e}`);throw new Error(t)}if(Ec(this.pairings.get(e).expiry)){await this.deletePairing(e);const{message:t}=gl("EXPIRED",`pairing topic: ${e}`);throw new Error(t)}},this.core=e,this.logger=He(t,this.name),this.pairings=new tg(this.core,this.logger,this.name,this.storagePrefix)}get context(){return We(this.logger)}isInitialized(){if(!this.initialized){const{message:e}=gl("NOT_INITIALIZED",this.name);throw new Error(e)}}registerRelayerEvents(){this.core.relayer.on(wd,(async e=>{const{topic:t,message:r,transportType:n}=e;if(!this.pairings.keys.includes(t)||n===Pd.link_mode||this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(r)))return;const i=await this.core.crypto.decode(t,r);try{rd(i)?(this.core.history.set(t,i),this.onRelayEventRequest({topic:t,payload:i})):nd(i)&&(await this.core.history.resolve(i),await this.onRelayEventResponse({topic:t,payload:i}),this.core.history.delete(t,i.id))}catch(e){this.logger.error(e)}}))}registerExpirerEvents(){this.core.expirer.on(qd,(async e=>{const{topic:t}=Sc(e.target);t&&this.pairings.keys.includes(t)&&(await this.deletePairing(t,!0),this.events.emit("pairing_expire",{topic:t}))}))}}class ng extends Ge{constructor(e,t){super(e,t),this.core=e,this.logger=t,this.records=new Map,this.events=new q.EventEmitter,this.name="history",this.version="0.3",this.cached=[],this.initialized=!1,this.storagePrefix=fd,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach((e=>this.records.set(e.id,e))),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.set=(e,t,r)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:e,request:t,chainId:r}),this.records.has(t.id))return;const n={id:t.id,topic:e,request:{method:t.method,params:t.params||null},chainId:r,expiry:_c(K.THIRTY_DAYS)};this.records.set(n.id,n),this.persist(),this.events.emit(Ld,n)},this.resolve=async e=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:e}),!this.records.has(e.id))return;const t=await this.getRecord(e.id);typeof t.response>"u"&&(t.response=od(e)?{error:e.error}:{result:e.result},this.records.set(t.id,t),this.persist(),this.events.emit(Ud,t))},this.get=async(e,t)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:e,id:t}),await this.getRecord(t)),this.delete=(e,t)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:t}),this.values.forEach((r=>{if(r.topic===e){if(typeof t<"u"&&r.id!==t)return;this.records.delete(r.id),this.events.emit(Dd,r)}})),this.persist()},this.exists=async(e,t)=>(this.isInitialized(),!!this.records.has(t)&&(await this.getRecord(t)).topic===e),this.on=(e,t)=>{this.events.on(e,t)},this.once=(e,t)=>{this.events.once(e,t)},this.off=(e,t)=>{this.events.off(e,t)},this.removeListener=(e,t)=>{this.events.removeListener(e,t)},this.logger=He(t,this.name)}get context(){return We(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const e=[];return this.values.forEach((t=>{if(typeof t.response<"u")return;const r={topic:t.topic,request:Vl(t.request.method,t.request.params,t.id),chainId:t.chainId};return e.push(r)})),e}async setJsonRpcRecords(e){await this.core.storage.setItem(this.storageKey,e)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(e){this.isInitialized();const t=this.records.get(e);if(!t){const{message:t}=gl("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(t)}return t}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit("history_sync")}async restore(){try{const e=await this.getJsonRpcRecords();if(typeof e>"u"||!e.length)return;if(this.records.size){const{message:e}=gl("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(e),new Error(e)}this.cached=e,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(e){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(e)}}registerEventListeners(){this.events.on(Ld,(e=>{const t=Ld;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e})})),this.events.on(Ud,(e=>{const t=Ud;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e})})),this.events.on(Dd,(e=>{const t=Dd;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e})})),this.core.heartbeat.on(V,(()=>{this.cleanup()}))}cleanup(){try{this.isInitialized();let e=!1;this.records.forEach((t=>{(0,K.toMiliseconds)(t.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${t.id}`),this.records.delete(t.id),this.events.emit(Dd,t,!1),e=!0)})),e&&this.persist()}catch(e){this.logger.warn(e)}}isInitialized(){if(!this.initialized){const{message:e}=gl("NOT_INITIALIZED",this.name);throw new Error(e)}}}class ig extends et{constructor(e,t){super(e,t),this.core=e,this.logger=t,this.expirations=new Map,this.events=new q.EventEmitter,this.name="expirer",this.version="0.3",this.cached=[],this.initialized=!1,this.storagePrefix=fd,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach((e=>this.expirations.set(e.target,e))),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.has=e=>{try{const t=this.formatTarget(e);return typeof this.getExpiration(t)<"u"}catch{return!1}},this.set=(e,t)=>{this.isInitialized();const r=this.formatTarget(e),n={target:r,expiry:t};this.expirations.set(r,n),this.checkExpiry(r,n),this.events.emit(jd,{target:r,expiration:n})},this.get=e=>{this.isInitialized();const t=this.formatTarget(e);return this.getExpiration(t)},this.del=e=>{if(this.isInitialized(),this.has(e)){const t=this.formatTarget(e),r=this.getExpiration(t);this.expirations.delete(t),this.events.emit(zd,{target:t,expiration:r})}},this.on=(e,t)=>{this.events.on(e,t)},this.once=(e,t)=>{this.events.once(e,t)},this.off=(e,t)=>{this.events.off(e,t)},this.removeListener=(e,t)=>{this.events.removeListener(e,t)},this.logger=He(t,this.name)}get context(){return We(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(e){if("string"==typeof e)return function(e){return vc("topic",e)}(e);if("number"==typeof e)return function(e){return vc("id",e)}(e);const{message:t}=gl("UNKNOWN_TYPE","Target type: "+typeof e);throw new Error(t)}async setExpirations(e){await this.core.storage.setItem(this.storageKey,e)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit("expirer_sync")}async restore(){try{const e=await this.getExpirations();if(typeof e>"u"||!e.length)return;if(this.expirations.size){const{message:e}=gl("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(e),new Error(e)}this.cached=e,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(e){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(e)}}getExpiration(e){const t=this.expirations.get(e);if(!t){const{message:t}=gl("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.warn(t),new Error(t)}return t}checkExpiry(e,t){const{expiry:r}=t;(0,K.toMiliseconds)(r)-Date.now()<=0&&this.expire(e,t)}expire(e,t){this.expirations.delete(e),this.events.emit(qd,{target:e,expiration:t})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach(((e,t)=>this.checkExpiry(t,e)))}registerEventListeners(){this.core.heartbeat.on(V,(()=>this.checkExpirations())),this.events.on(jd,(e=>{const t=jd;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()})),this.events.on(qd,(e=>{const t=qd;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()})),this.events.on(zd,(e=>{const t=zd;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()}))}isInitialized(){if(!this.initialized){const{message:e}=gl("NOT_INITIALIZED",this.name);throw new Error(e)}}}class og extends tt{constructor(e,t,r){super(e,t,r),this.core=e,this.logger=t,this.store=r,this.name="verify-api",this.verifyUrlV3=Fd,this.storagePrefix=fd,this.version=2,this.init=async()=>{var e;this.isDevEnv||(this.publicKey=await this.store.getItem(this.storeKey),this.publicKey&&(0,K.toMiliseconds)(null==(e=this.publicKey)?void 0:e.expiresAt)<Date.now()&&(this.logger.debug("verify v2 public key expired"),await this.removePublicKey()))},this.register=async e=>{if(!hc()||this.isDevEnv)return;const t=window.location.origin,{id:r,decryptedId:n}=e,i=`${this.verifyUrlV3}/attestation?projectId=${this.core.projectId}&origin=${t}&id=${r}&decryptedId=${n}`;try{const e=(0,Hi.getDocument)(),t=this.startAbortTimer(5*K.ONE_SECOND),n=await new Promise(((n,o)=>{const s=()=>{window.removeEventListener("message",c),e.body.removeChild(a),o("attestation aborted")};this.abortController.signal.addEventListener("abort",s);const a=e.createElement("iframe");a.src=i,a.style.display="none",a.addEventListener("error",s,{signal:this.abortController.signal});const c=i=>{if(i.data&&"string"==typeof i.data)try{const o=JSON.parse(i.data);if("verify_attestation"===o.type){if(Ni(o.attestation).payload.id!==r)return;clearInterval(t),e.body.removeChild(a),this.abortController.signal.removeEventListener("abort",s),window.removeEventListener("message",c),n(null===o.attestation?"":o.attestation)}}catch(e){this.logger.warn(e)}};e.body.appendChild(a),window.addEventListener("message",c,{signal:this.abortController.signal})}));return this.logger.debug("jwt attestation",n),n}catch(e){this.logger.warn(e)}return""},this.resolve=async e=>{if(this.isDevEnv)return"";const{attestationId:t,hash:r,encryptedId:n}=e;if(""===t)return void this.logger.debug("resolve: attestationId is empty, skipping");if(t){if(Ni(t).payload.id!==n)return;const e=await this.isValidJwtAttestation(t);if(e)return e.isVerified?e:void this.logger.warn("resolve: jwt attestation: origin url not verified")}if(!r)return;const i=this.getVerifyUrl(e?.verifyUrl);return this.fetchAttestation(r,i)},this.fetchAttestation=async(e,t)=>{this.logger.debug(`resolving attestation: ${e} from url: ${t}`);const r=this.startAbortTimer(5*K.ONE_SECOND),n=await fetch(`${t}/attestation/${e}?v2Supported=true`,{signal:this.abortController.signal});return clearTimeout(r),200===n.status?await n.json():void 0},this.getVerifyUrl=e=>{let t=e||Kd;return Wd.includes(t)||(this.logger.info(`verify url: ${t}, not included in trusted list, assigning default: ${Kd}`),t=Kd),t},this.fetchPublicKey=async()=>{try{this.logger.debug(`fetching public key from: ${this.verifyUrlV3}`);const e=this.startAbortTimer(K.FIVE_SECONDS),t=await fetch(`${this.verifyUrlV3}/public-key`,{signal:this.abortController.signal});return clearTimeout(e),await t.json()}catch(e){this.logger.warn(e)}},this.persistPublicKey=async e=>{this.logger.debug("persisting public key to local storage",e),await this.store.setItem(this.storeKey,e),this.publicKey=e},this.removePublicKey=async()=>{this.logger.debug("removing verify v2 public key from storage"),await this.store.removeItem(this.storeKey),this.publicKey=void 0},this.isValidJwtAttestation=async e=>{const t=await this.getPublicKey();try{if(t)return this.validateAttestation(e,t)}catch(e){this.logger.error(e),this.logger.warn("error validating attestation")}const r=await this.fetchAndPersistPublicKey();try{if(r)return this.validateAttestation(e,r)}catch(e){this.logger.error(e),this.logger.warn("error validating attestation")}},this.getPublicKey=async()=>this.publicKey?this.publicKey:await this.fetchAndPersistPublicKey(),this.fetchAndPersistPublicKey=async()=>{if(this.fetchPromise)return await this.fetchPromise,this.publicKey;this.fetchPromise=new Promise((async e=>{const t=await this.fetchPublicKey();t&&(await this.persistPublicKey(t),e(t))}));const e=await this.fetchPromise;return this.fetchPromise=void 0,e},this.validateAttestation=(e,t)=>{const r=function(e,t){const[r,n,i]=e.split("."),o=function(e){return Qa.from(function(e){let t=e.replace(/-/g,"+").replace(/_/g,"/");const r=t.length%4;return r>0&&(t+="=".repeat(4-r)),t}(e),"base64")}(i);if(64!==o.length)throw new Error("Invalid signature length");const s=o.slice(0,32).toString("hex"),a=o.slice(32,64).toString("hex"),c=mh(`${r}.${n}`),u=function(e){return new Ja.ec("p256").keyFromPublic({x:Qa.from(e.x,"base64").toString("hex"),y:Qa.from(e.y,"base64").toString("hex")},"hex")}(t),h=Ya(c,Fh);if(!u.verify(h,{r:s,s:a}))throw new Error("Invalid signature");return Ni(e).payload}(e,t.publicKey),n={hasExpired:(0,K.toMiliseconds)(r.exp)<Date.now(),payload:r};if(n.hasExpired)throw this.logger.warn("resolve: jwt attestation expired"),new Error("JWT attestation expired");return{origin:n.payload.origin,isScam:n.payload.isScam,isVerified:n.payload.isVerified}},this.logger=He(t,this.name),this.abortController=new AbortController,this.isDevEnv=Pc(),this.init()}get storeKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//verify:public:key"}get context(){return We(this.logger)}startAbortTimer(e){return this.abortController=new AbortController,setTimeout((()=>this.abortController.abort()),(0,K.toMiliseconds)(e))}}class sg extends rt{constructor(e,t){super(e,t),this.projectId=e,this.logger=t,this.context="echo",this.registerDeviceToken=async e=>{const{clientId:t,token:r,notificationType:n,enableEncrypted:i=!1}=e,o=`https://echo.walletconnect.com/${this.projectId}/clients`;await fetch(o,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({client_id:t,type:n,token:r,always_raw:i})})},this.logger=He(t,this.context)}}var ag=Object.defineProperty,cg=Object.getOwnPropertySymbols,ug=Object.prototype.hasOwnProperty,hg=Object.prototype.propertyIsEnumerable,lg=(e,t,r)=>t in e?ag(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,dg=(e,t)=>{for(var r in t||(t={}))ug.call(t,r)&&lg(e,r,t[r]);if(cg)for(var r of cg(t))hg.call(t,r)&&lg(e,r,t[r]);return e};class fg extends nt{constructor(e,t,r=!0){super(e,t,r),this.core=e,this.logger=t,this.context="event-client",this.storagePrefix=fd,this.storageVersion=.1,this.events=new Map,this.shouldPersist=!1,this.init=async()=>{if(!Pc())try{const e={eventId:xc(),timestamp:Date.now(),domain:this.getAppDomain(),props:{event:"INIT",type:"",properties:{client_id:await this.core.crypto.getClientId(),user_agent:pc(this.core.relayer.protocol,this.core.relayer.version,xd)}}};await this.sendEvent([e])}catch(e){this.logger.warn(e)}},this.createEvent=e=>{const{event:t="ERROR",type:r="",properties:{topic:n,trace:i}}=e,o=xc(),s=this.core.projectId||"",a=Date.now(),c=dg({eventId:o,timestamp:a,props:{event:t,type:r,properties:{topic:n,trace:i}},bundleId:s,domain:this.getAppDomain()},this.setMethods(o));return this.telemetryEnabled&&(this.events.set(o,c),this.shouldPersist=!0),c},this.getEvent=e=>{const{eventId:t,topic:r}=e;if(t)return this.events.get(t);const n=Array.from(this.events.values()).find((e=>e.props.properties.topic===r));return n?dg(dg({},n),this.setMethods(n.eventId)):void 0},this.deleteEvent=e=>{const{eventId:t}=e;this.events.delete(t),this.shouldPersist=!0},this.setEventListeners=()=>{this.core.heartbeat.on(V,(async()=>{this.shouldPersist&&await this.persist(),this.events.forEach((e=>{(0,K.fromMiliseconds)(Date.now())-(0,K.fromMiliseconds)(e.timestamp)>86400&&(this.events.delete(e.eventId),this.shouldPersist=!0)}))}))},this.setMethods=e=>({addTrace:t=>this.addTrace(e,t),setError:t=>this.setError(e,t)}),this.addTrace=(e,t)=>{const r=this.events.get(e);r&&(r.props.properties.trace.push(t),this.events.set(e,r),this.shouldPersist=!0)},this.setError=(e,t)=>{const r=this.events.get(e);r&&(r.props.type=t,r.timestamp=Date.now(),this.events.set(e,r),this.shouldPersist=!0)},this.persist=async()=>{await this.core.storage.setItem(this.storageKey,Array.from(this.events.values())),this.shouldPersist=!1},this.restore=async()=>{try{const e=await this.core.storage.getItem(this.storageKey)||[];if(!e.length)return;e.forEach((e=>{this.events.set(e.eventId,dg(dg({},e),this.setMethods(e.eventId)))}))}catch(e){this.logger.warn(e)}},this.submit=async()=>{if(!this.telemetryEnabled||0===this.events.size)return;const e=[];for(const[t,r]of this.events)r.props.type&&e.push(r);if(0!==e.length)try{if((await this.sendEvent(e)).ok)for(const t of e)this.events.delete(t.eventId),this.shouldPersist=!0}catch(e){this.logger.warn(e)}},this.sendEvent=async e=>{const t=this.getAppDomain()?"":"&sp=desktop";return await fetch(`https://pulse.walletconnect.org/batch?projectId=${this.core.projectId}&st=events_sdk&sv=js-${xd}${t}`,{method:"POST",body:JSON.stringify(e)})},this.getAppDomain=()=>fc().url,this.logger=He(t,this.context),this.telemetryEnabled=r,r?this.restore().then((async()=>{await this.submit(),this.setEventListeners()})):this.persist()}get storageKey(){return this.storagePrefix+this.storageVersion+this.core.customStoragePrefix+"//"+this.context}}var pg=Object.defineProperty,gg=Object.getOwnPropertySymbols,yg=Object.prototype.hasOwnProperty,bg=Object.prototype.propertyIsEnumerable,mg=(e,t,r)=>t in e?pg(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,wg=(e,t)=>{for(var r in t||(t={}))yg.call(t,r)&&mg(e,r,t[r]);if(gg)for(var r of gg(t))bg.call(t,r)&&mg(e,r,t[r]);return e};class vg extends Ve{constructor(e){var t;super(e),this.protocol="wc",this.version=2,this.name=dd,this.events=new q.EventEmitter,this.initialized=!1,this.on=(e,t)=>this.events.on(e,t),this.once=(e,t)=>this.events.once(e,t),this.off=(e,t)=>this.events.off(e,t),this.removeListener=(e,t)=>this.events.removeListener(e,t),this.dispatchEnvelope=({topic:e,message:t,sessionExists:r})=>{if(!e||!t)return;const n={topic:e,message:t,publishedAt:Date.now(),transportType:Pd.link_mode};this.relayer.onLinkMessageEvent(n,{sessionExists:r})},this.projectId=e?.projectId,this.relayUrl=e?.relayUrl||md,this.customStoragePrefix=null!=e&&e.customStoragePrefix?`:${e.customStoragePrefix}`:"";const r=Fe({level:"string"==typeof e?.logger&&e.logger?e.logger:"error",name:dd}),{logger:n,chunkLoggerController:i}=function(e){return typeof e.loggerOverride<"u"&&"string"!=typeof e.loggerOverride?{logger:e.loggerOverride,chunkLoggerController:null}:typeof window<"u"?function(e){var t,r;const n=new Me(null==(t=e.opts)?void 0:t.level,e.maxSizeInBytes);return{logger:Pe()(Ke($e({},e.opts),{level:"trace",browser:Ke($e({},null==(r=e.opts)?void 0:r.browser),{write:e=>n.write(e)})})),chunkLoggerController:n}}(e):function(e){var t;const r=new Ce(null==(t=e.opts)?void 0:t.level,e.maxSizeInBytes);return{logger:Pe()(Ke($e({},e.opts),{level:"trace"}),r),chunkLoggerController:r}}(e)}({opts:r,maxSizeInBytes:e?.maxLogBlobSizeInBytes,loggerOverride:e?.logger});this.logChunkController=i,null!=(t=this.logChunkController)&&t.downloadLogsBlobInBrowser&&(window.downloadLogsBlobInBrowser=async()=>{var e,t;null!=(e=this.logChunkController)&&e.downloadLogsBlobInBrowser&&(null==(t=this.logChunkController)||t.downloadLogsBlobInBrowser({clientId:await this.crypto.getClientId()}))}),this.logger=He(n,this.name),this.heartbeat=new G,this.crypto=new wp(this,this.logger,e?.keychain),this.history=new ng(this,this.logger),this.expirer=new ig(this,this.logger),this.storage=null!=e&&e.storage?e.storage:new ke(wg(wg({},pd),e?.storageOptions)),this.relayer=new Gp({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new rg(this,this.logger),this.verify=new og(this,this.logger,this.storage),this.echoClient=new sg(this.projectId||"",this.logger),this.linkModeSupportedApps=[],this.eventClient=new fg(this,this.logger,e?.telemetryEnabled)}static async init(e){const t=new vg(e);await t.initialize();const r=await t.crypto.getClientId();return await t.storage.setItem("WALLETCONNECT_CLIENT_ID",r),t}get context(){return We(this.logger)}async start(){this.initialized||await this.initialize()}async getLogsBlob(){var e;return null==(e=this.logChunkController)?void 0:e.logsToBlob({clientId:await this.crypto.getClientId()})}async addLinkModeSupportedApp(e){this.linkModeSupportedApps.includes(e)||(this.linkModeSupportedApps.push(e),await this.storage.setItem(Od,this.linkModeSupportedApps))}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.linkModeSupportedApps=await this.storage.getItem(Od)||[],this.initialized=!0,this.logger.info("Core Initialization Success")}catch(e){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,e),this.logger.error(e.message),e}}}const Sg=vg,_g="client",Eg=`wc@2:${_g}:`,Ig=_g,Ag="WALLETCONNECT_DEEPLINK_CHOICE",kg=K.SEVEN_DAYS,xg={wc_sessionPropose:{req:{ttl:K.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:K.FIVE_MINUTES,prompt:!1,tag:1101},reject:{ttl:K.FIVE_MINUTES,prompt:!1,tag:1120},autoReject:{ttl:K.FIVE_MINUTES,prompt:!1,tag:1121}},wc_sessionSettle:{req:{ttl:K.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:K.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:K.ONE_DAY,prompt:!1,tag:1104},res:{ttl:K.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:K.ONE_DAY,prompt:!1,tag:1106},res:{ttl:K.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:K.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:K.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:K.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:K.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:K.ONE_DAY,prompt:!1,tag:1112},res:{ttl:K.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:K.ONE_DAY,prompt:!1,tag:1114},res:{ttl:K.ONE_DAY,prompt:!1,tag:1115}},wc_sessionAuthenticate:{req:{ttl:K.ONE_HOUR,prompt:!0,tag:1116},res:{ttl:K.ONE_HOUR,prompt:!1,tag:1117},reject:{ttl:K.FIVE_MINUTES,prompt:!1,tag:1118},autoReject:{ttl:K.FIVE_MINUTES,prompt:!1,tag:1119}}},Pg={min:K.FIVE_MINUTES,max:K.SEVEN_DAYS},Og="IDLE",Rg="ACTIVE",Tg=["wc_sessionPropose","wc_sessionRequest","wc_authRequest","wc_sessionAuthenticate"],Ng="wc@1.5:auth:",Mg=`${Ng}:PUB_KEY`;var Cg=Object.defineProperty,Bg=Object.defineProperties,Lg=Object.getOwnPropertyDescriptors,Ug=Object.getOwnPropertySymbols,Dg=Object.prototype.hasOwnProperty,jg=Object.prototype.propertyIsEnumerable,zg=(e,t,r)=>t in e?Cg(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,qg=(e,t)=>{for(var r in t||(t={}))Dg.call(t,r)&&zg(e,r,t[r]);if(Ug)for(var r of Ug(t))jg.call(t,r)&&zg(e,r,t[r]);return e},$g=(e,t)=>Bg(e,Lg(t));class Kg extends ot{constructor(e){super(e),this.name="engine",this.events=new($()),this.initialized=!1,this.requestQueue={state:Og,queue:[]},this.sessionRequestQueue={state:Og,queue:[]},this.requestQueueDelay=K.ONE_SECOND,this.expectedPairingMethodMap=new Map,this.recentlyDeletedMap=new Map,this.recentlyDeletedLimit=200,this.relayMessageCache=[],this.init=async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.registerPairingEvents(),await this.registerLinkModeListeners(),this.client.core.pairing.register({methods:Object.keys(xg)}),this.initialized=!0,setTimeout((()=>{this.sessionRequestQueue.queue=this.getPendingSessionRequests(),this.processSessionRequestQueue()}),(0,K.toMiliseconds)(this.requestQueueDelay)))},this.connect=async e=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();const t=$g(qg({},e),{requiredNamespaces:e.requiredNamespaces||{},optionalNamespaces:e.optionalNamespaces||{}});await this.isValidConnect(t);const{pairingTopic:r,requiredNamespaces:n,optionalNamespaces:i,sessionProperties:o,relays:s}=t;let a,c=r,u=!1;try{if(c){const e=this.client.core.pairing.pairings.get(c);this.client.logger.warn("connect() with existing pairing topic is deprecated and will be removed in the next major release."),u=e.active}}catch(e){throw this.client.logger.error(`connect() -> pairing.get(${c}) failed`),e}if(!c||!u){const{topic:e,uri:t}=await this.client.core.pairing.create();c=e,a=t}if(!c){const{message:e}=gl("NO_MATCHING_KEY",`connect() pairing topic: ${c}`);throw new Error(e)}const h=await this.client.core.crypto.generateKeyPair(),l=xg.wc_sessionPropose.req.ttl||K.FIVE_MINUTES,d=_c(l),f=qg({requiredNamespaces:n,optionalNamespaces:i,relays:s??[{protocol:"irn"}],proposer:{publicKey:h,metadata:this.client.metadata},expiryTimestamp:d,pairingTopic:c},o&&{sessionProperties:o}),{reject:p,resolve:g,done:y}=mc(l,"Proposal expired");this.events.once(Ic("session_connect"),(async({error:e,session:t})=>{if(e)p(e);else if(t){t.self.publicKey=h;const e=$g(qg({},t),{pairingTopic:f.pairingTopic,requiredNamespaces:f.requiredNamespaces,optionalNamespaces:f.optionalNamespaces,transportType:Pd.relay});await this.client.session.set(t.topic,e),await this.setExpiry(t.topic,t.expiry),c&&await this.client.core.pairing.updateMetadata({topic:c,metadata:t.peer.metadata}),this.cleanupDuplicatePairings(e),g(e)}}));const b=await this.sendRequest({topic:c,method:"wc_sessionPropose",params:f,throwOnFailedPublish:!0});return await this.setProposal(b,qg({id:b},f)),{uri:a,approval:y}},this.pair=async e=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{return await this.client.core.pairing.pair(e)}catch(e){throw this.client.logger.error("pair() failed"),e}},this.approve=async e=>{var t,r,n;const i=this.client.core.eventClient.createEvent({properties:{topic:null==(t=e?.id)?void 0:t.toString(),trace:[Vd]}});try{this.isInitialized(),await this.confirmOnlineStateOrThrow()}catch(e){throw i.setError("no_internet_connection"),e}try{await this.isValidProposalId(e?.id)}catch(t){throw this.client.logger.error(`approve() -> proposal.get(${e?.id}) failed`),i.setError("proposal_not_found"),t}try{await this.isValidApprove(e)}catch(e){throw this.client.logger.error("approve() -> isValidApprove() failed"),i.setError("session_approve_namespace_validation_failure"),e}const{id:o,relayProtocol:s,namespaces:a,sessionProperties:c,sessionConfig:u}=e,h=this.client.proposal.get(o);this.client.core.eventClient.deleteEvent({eventId:i.eventId});const{pairingTopic:l,proposer:d,requiredNamespaces:f,optionalNamespaces:p}=h;let g=null==(r=this.client.core.eventClient)?void 0:r.getEvent({topic:l});g||(g=null==(n=this.client.core.eventClient)?void 0:n.createEvent({type:Vd,properties:{topic:l,trace:[Vd,"session_namespaces_validation_success"]}}));const y=await this.client.core.crypto.generateKeyPair(),b=d.publicKey,m=await this.client.core.crypto.generateSharedKey(y,b),w=qg(qg({relay:{protocol:s??"irn"},namespaces:a,controller:{publicKey:y,metadata:this.client.metadata},expiry:_c(kg)},c&&{sessionProperties:c}),u&&{sessionConfig:u}),v=Pd.relay;g.addTrace("subscribing_session_topic");try{await this.client.core.relayer.subscribe(m,{transportType:v})}catch(e){throw g.setError("subscribe_session_topic_failure"),e}g.addTrace("subscribe_session_topic_success");const S=$g(qg({},w),{topic:m,requiredNamespaces:f,optionalNamespaces:p,pairingTopic:l,acknowledged:!1,self:w.controller,peer:{publicKey:d.publicKey,metadata:d.metadata},controller:y,transportType:Pd.relay});await this.client.session.set(m,S),g.addTrace("store_session");try{g.addTrace("publishing_session_settle"),await this.sendRequest({topic:m,method:"wc_sessionSettle",params:w,throwOnFailedPublish:!0}).catch((e=>{throw g?.setError("session_settle_publish_failure"),e})),g.addTrace("session_settle_publish_success"),g.addTrace("publishing_session_approve"),await this.sendResult({id:o,topic:l,result:{relay:{protocol:s??"irn"},responderPublicKey:y},throwOnFailedPublish:!0}).catch((e=>{throw g?.setError("session_approve_publish_failure"),e})),g.addTrace("session_approve_publish_success")}catch(e){throw this.client.logger.error(e),this.client.session.delete(m,yl("USER_DISCONNECTED")),await this.client.core.relayer.unsubscribe(m),e}return this.client.core.eventClient.deleteEvent({eventId:g.eventId}),await this.client.core.pairing.updateMetadata({topic:l,metadata:d.metadata}),await this.client.proposal.delete(o,yl("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:l}),await this.setExpiry(m,_c(kg)),{topic:m,acknowledged:()=>Promise.resolve(this.client.session.get(m))}},this.reject=async e=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidReject(e)}catch(e){throw this.client.logger.error("reject() -> isValidReject() failed"),e}const{id:t,reason:r}=e;let n;try{n=this.client.proposal.get(t).pairingTopic}catch(e){throw this.client.logger.error(`reject() -> proposal.get(${t}) failed`),e}n&&(await this.sendError({id:t,topic:n,error:r,rpcOpts:xg.wc_sessionPropose.reject}),await this.client.proposal.delete(t,yl("USER_DISCONNECTED")))},this.update=async e=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidUpdate(e)}catch(e){throw this.client.logger.error("update() -> isValidUpdate() failed"),e}const{topic:t,namespaces:r}=e,{done:n,resolve:i,reject:o}=mc(),s=Wl(),a=Hl().toString(),c=this.client.session.get(t).namespaces;return this.events.once(Ic("session_update",s),(({error:e})=>{e?o(e):i()})),await this.client.session.update(t,{namespaces:r}),await this.sendRequest({topic:t,method:"wc_sessionUpdate",params:{namespaces:r},throwOnFailedPublish:!0,clientRpcId:s,relayRpcId:a}).catch((e=>{this.client.logger.error(e),this.client.session.update(t,{namespaces:c}),o(e)})),{acknowledged:n}},this.extend=async e=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidExtend(e)}catch(e){throw this.client.logger.error("extend() -> isValidExtend() failed"),e}const{topic:t}=e,r=Wl(),{done:n,resolve:i,reject:o}=mc();return this.events.once(Ic("session_extend",r),(({error:e})=>{e?o(e):i()})),await this.setExpiry(t,_c(kg)),this.sendRequest({topic:t,method:"wc_sessionExtend",params:{},clientRpcId:r,throwOnFailedPublish:!0}).catch((e=>{o(e)})),{acknowledged:n}},this.request=async e=>{this.isInitialized();try{await this.isValidRequest(e)}catch(e){throw this.client.logger.error("request() -> isValidRequest() failed"),e}const{chainId:t,request:n,topic:i,expiry:o=xg.wc_sessionRequest.req.ttl}=e,s=this.client.session.get(i);s?.transportType===Pd.relay&&await this.confirmOnlineStateOrThrow();const a=Wl(),c=Hl().toString(),{done:u,resolve:h,reject:l}=mc(o,"Request expired. Please try again.");this.events.once(Ic("session_request",a),(({error:e,result:t})=>{e?l(e):h(t)}));const d=this.getAppLinkIfEnabled(s.peer.metadata,s.transportType);return d?(await this.sendRequest({clientRpcId:a,relayRpcId:c,topic:i,method:"wc_sessionRequest",params:{request:$g(qg({},n),{expiryTimestamp:_c(o)}),chainId:t},expiry:o,throwOnFailedPublish:!0,appLink:d}).catch((e=>l(e))),this.client.events.emit("session_request_sent",{topic:i,request:n,chainId:t,id:a}),await u()):await Promise.all([new Promise((async e=>{await this.sendRequest({clientRpcId:a,relayRpcId:c,topic:i,method:"wc_sessionRequest",params:{request:$g(qg({},n),{expiryTimestamp:_c(o)}),chainId:t},expiry:o,throwOnFailedPublish:!0}).catch((e=>l(e))),this.client.events.emit("session_request_sent",{topic:i,request:n,chainId:t,id:a}),e()})),new Promise((async e=>{var t;if(null==(t=s.sessionConfig)||!t.disableDeepLink){const e=await async function(e,t){let r="";try{if(hc()&&(r=localStorage.getItem(t),r))return r;r=await e.getItem(t)}catch(e){console.error(e)}return r}(this.client.core.storage,Ag);await async function({id:e,topic:t,wcDeepLink:n}){var i;try{if(!n)return;const o="string"==typeof n?JSON.parse(n):n,s=o?.href;if("string"!=typeof s)return;const a=function(e,t,r){const n=`requestId=${t}&sessionTopic=${r}`;e.endsWith("/")&&(e=e.slice(0,-1));let i=`${e}`;return i=e.startsWith("https://t.me")?`${i}${e.includes("?")?"&startapp=":"?startapp="}${function(e,t=!1){const r=Qa.from(e).toString("base64");return t?r.replace(/[=]/g,""):r}(n,!0)}`:`${i}/wc?${n}`,i}(s,e,t),c=lc();if(c===sc.browser){if(null==(i=(0,Hi.getDocument)())||!i.hasFocus())return void console.warn("Document does not have focus, skipping deeplink.");!function(e){let t="_self";!function(){try{return window.self!==window.top}catch{return!1}}()?(typeof window<"u"&&(!!window.TelegramWebviewProxy||!!window.Telegram||!!window.TelegramWebviewProxyProto)||e.startsWith("https://")||e.startsWith("http://"))&&(t="_blank"):t="_top",window.open(e,t,"noreferrer noopener")}(a)}else c===sc.reactNative&&typeof(null==r.g?void 0:r.g.Linking)<"u"&&await r.g.Linking.openURL(a)}catch(e){console.error(e)}}({id:a,topic:i,wcDeepLink:e})}e()})),u()]).then((e=>e[2]))},this.respond=async e=>{this.isInitialized(),await this.isValidRespond(e);const{topic:t,response:r}=e,{id:n}=r,i=this.client.session.get(t);i.transportType===Pd.relay&&await this.confirmOnlineStateOrThrow();const o=this.getAppLinkIfEnabled(i.peer.metadata,i.transportType);id(r)?await this.sendResult({id:n,topic:t,result:r.result,throwOnFailedPublish:!0,appLink:o}):od(r)&&await this.sendError({id:n,topic:t,error:r.error,appLink:o}),this.cleanupAfterResponse(e)},this.ping=async e=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidPing(e)}catch(e){throw this.client.logger.error("ping() -> isValidPing() failed"),e}const{topic:t}=e;if(this.client.session.keys.includes(t)){const e=Wl(),r=Hl().toString(),{done:n,resolve:i,reject:o}=mc();this.events.once(Ic("session_ping",e),(({error:e})=>{e?o(e):i()})),await Promise.all([this.sendRequest({topic:t,method:"wc_sessionPing",params:{},throwOnFailedPublish:!0,clientRpcId:e,relayRpcId:r}),n()])}else this.client.core.pairing.pairings.keys.includes(t)&&(this.client.logger.warn("ping() on pairing topic is deprecated and will be removed in the next major release."),await this.client.core.pairing.ping({topic:t}))},this.emit=async e=>{this.isInitialized(),await this.confirmOnlineStateOrThrow(),await this.isValidEmit(e);const{topic:t,event:r,chainId:n}=e,i=Hl().toString(),o=Wl();await this.sendRequest({topic:t,method:"wc_sessionEvent",params:{event:r,chainId:n},throwOnFailedPublish:!0,relayRpcId:i,clientRpcId:o})},this.disconnect=async e=>{this.isInitialized(),await this.confirmOnlineStateOrThrow(),await this.isValidDisconnect(e);const{topic:t}=e;if(this.client.session.keys.includes(t))await this.sendRequest({topic:t,method:"wc_sessionDelete",params:yl("USER_DISCONNECTED"),throwOnFailedPublish:!0}),await this.deleteSession({topic:t,emitEvent:!1});else{if(!this.client.core.pairing.pairings.keys.includes(t)){const{message:e}=gl("MISMATCHED_TOPIC",`Session or pairing topic not found: ${t}`);throw new Error(e)}await this.client.core.pairing.disconnect({topic:t})}},this.find=e=>(this.isInitialized(),this.client.session.getAll().filter((t=>function(e,t){const{requiredNamespaces:r}=t,n=Object.keys(e.namespaces),i=Object.keys(r);let o=!0;return!!gc(i,n)&&(n.forEach((t=>{const{accounts:n,methods:i,events:s}=e.namespaces[t],a=ll(n),c=r[t];gc(ic(t,c),a)&&gc(c.methods,i)&&gc(c.events,s)||(o=!1)})),o)}(t,e)))),this.getPendingSessionRequests=()=>this.client.pendingRequest.getAll(),this.authenticate=async(e,t)=>{var r;this.isInitialized(),this.isValidAuthenticate(e);const n=t&&this.client.core.linkModeSupportedApps.includes(t)&&(null==(r=this.client.metadata.redirect)?void 0:r.linkMode),i=n?Pd.link_mode:Pd.relay;i===Pd.relay&&await this.confirmOnlineStateOrThrow();const{chains:o,statement:s="",uri:a,domain:c,nonce:u,type:h,exp:l,nbf:d,methods:f=[],expiry:p}=e,g=[...e.resources||[]],{topic:y,uri:b}=await this.client.core.pairing.create({methods:["wc_sessionAuthenticate"],transportType:i});this.client.logger.info({message:"Generated new pairing",pairing:{topic:y,uri:b}});const m=await this.client.core.crypto.generateKeyPair(),w=Yh(m);if(await Promise.all([this.client.auth.authKeys.set(Mg,{responseTopic:w,publicKey:m}),this.client.auth.pairingTopics.set(w,{topic:w,pairingTopic:y})]),await this.client.core.relayer.subscribe(w,{transportType:i}),this.client.logger.info(`sending request to new pairing topic: ${y}`),f.length>0){const{namespace:e}=tc(o[0]);let t=function(e,t,r){const n=function(e,t,r,n={}){return r?.sort(((e,t)=>e.localeCompare(t))),{att:{[e]:Au(t,r,n)}}}(e,t,r);return ku(n)}(e,"request",f);Tu(g)&&(t=Pu(t,g.pop())),g.push(t)}const v=p&&p>xg.wc_sessionAuthenticate.req.ttl?p:xg.wc_sessionAuthenticate.req.ttl,S={authPayload:{type:h??"caip122",chains:o,statement:s,aud:a,domain:c,version:"1",nonce:u,iat:(new Date).toISOString(),exp:l,nbf:d,resources:g},requester:{publicKey:m,metadata:this.client.metadata},expiryTimestamp:_c(v)},_={requiredNamespaces:{},optionalNamespaces:{eip155:{chains:o,methods:[...new Set(["personal_sign",...f])],events:["chainChanged","accountsChanged"]}},relays:[{protocol:"irn"}],pairingTopic:y,proposer:{publicKey:m,metadata:this.client.metadata},expiryTimestamp:_c(xg.wc_sessionPropose.req.ttl)},{done:E,resolve:I,reject:A}=mc(v,"Request expired"),k=async({error:e,session:t})=>{if(this.events.off(Ic("session_request",P),x),e)A(e);else if(t){t.self.publicKey=m,await this.client.session.set(t.topic,t),await this.setExpiry(t.topic,t.expiry),y&&await this.client.core.pairing.updateMetadata({topic:y,metadata:t.peer.metadata});const e=this.client.session.get(t.topic);await this.deleteProposal(O),I({session:e})}},x=async e=>{var r,n,o;if(await this.deletePendingAuthRequest(P,{message:"fulfilled",code:0}),e.error){const t=yl("WC_METHOD_UNSUPPORTED","wc_sessionAuthenticate");return e.error.code===t.code?void 0:(this.events.off(Ic("session_connect"),k),A(e.error.message))}await this.deleteProposal(O),this.events.off(Ic("session_connect"),k);const{cacaos:s,responder:a}=e.result,c=[],u=[];for(const e of s){await _u({cacao:e,projectId:this.client.core.projectId})||(this.client.logger.error(e,"Signature verification failed"),A(yl("SESSION_SETTLEMENT_FAILED","Signature verification failed")));const{p:t}=e,r=Tu(t.resources),n=[vu(t.iss)],i=Su(t.iss);if(r){const e=Ou(r),t=Ru(r);c.push(...e),n.push(...t)}for(const e of n)u.push(`${e}:${i}`)}const h=await this.client.core.crypto.generateSharedKey(m,a.publicKey);let l;c.length>0&&(l={topic:h,acknowledged:!0,self:{publicKey:m,metadata:this.client.metadata},peer:a,controller:a.publicKey,expiry:_c(kg),requiredNamespaces:{},optionalNamespaces:{},relay:{protocol:"irn"},pairingTopic:y,namespaces:dl([...new Set(c)],[...new Set(u)]),transportType:i},await this.client.core.relayer.subscribe(h,{transportType:i}),await this.client.session.set(h,l),y&&await this.client.core.pairing.updateMetadata({topic:y,metadata:a.metadata}),l=this.client.session.get(h)),null!=(r=this.client.metadata.redirect)&&r.linkMode&&null!=(n=a.metadata.redirect)&&n.linkMode&&null!=(o=a.metadata.redirect)&&o.universal&&t&&(this.client.core.addLinkModeSupportedApp(a.metadata.redirect.universal),this.client.session.update(h,{transportType:Pd.link_mode})),I({auths:s,session:l})},P=Wl(),O=Wl();let R;this.events.once(Ic("session_connect"),k),this.events.once(Ic("session_request",P),x);try{if(n){const e=Vl("wc_sessionAuthenticate",S,P);this.client.core.history.set(y,e);const r=await this.client.core.crypto.encode("",e,{type:2,encoding:Hh});R=hl(t,y,r)}else await Promise.all([this.sendRequest({topic:y,method:"wc_sessionAuthenticate",params:S,expiry:e.expiry,throwOnFailedPublish:!0,clientRpcId:P}),this.sendRequest({topic:y,method:"wc_sessionPropose",params:_,expiry:xg.wc_sessionPropose.req.ttl,throwOnFailedPublish:!0,clientRpcId:O})])}catch(e){throw this.events.off(Ic("session_connect"),k),this.events.off(Ic("session_request",P),x),e}return await this.setProposal(O,qg({id:O},_)),await this.setAuthRequest(P,{request:$g(qg({},S),{verifyContext:{}}),pairingTopic:y,transportType:i}),{uri:R??b,response:E}},this.approveSessionAuthenticate=async e=>{const{id:t,auths:r}=e,n=this.client.core.eventClient.createEvent({properties:{topic:t.toString(),trace:["authenticated_session_approve_started"]}});try{this.isInitialized()}catch(e){throw n.setError("no_internet_connection"),e}const i=this.getPendingAuthRequest(t);if(!i)throw n.setError("authenticated_session_pending_request_not_found"),new Error(`Could not find pending auth request with id ${t}`);const o=i.transportType||Pd.relay;o===Pd.relay&&await this.confirmOnlineStateOrThrow();const s=i.requester.publicKey,a=await this.client.core.crypto.generateKeyPair(),c=Yh(s),u={type:1,receiverPublicKey:s,senderPublicKey:a},h=[],l=[];for(const e of r){if(!await _u({cacao:e,projectId:this.client.core.projectId})){n.setError("invalid_cacao");const e=yl("SESSION_SETTLEMENT_FAILED","Signature verification failed");throw await this.sendError({id:t,topic:c,error:e,encodeOpts:u}),new Error(e.message)}n.addTrace("cacaos_verified");const{p:r}=e,i=Tu(r.resources),o=[vu(r.iss)],s=Su(r.iss);if(i){const e=Ou(i),t=Ru(i);h.push(...e),o.push(...t)}for(const e of o)l.push(`${e}:${s}`)}const d=await this.client.core.crypto.generateSharedKey(a,s);let f;if(n.addTrace("create_authenticated_session_topic"),h?.length>0){f={topic:d,acknowledged:!0,self:{publicKey:a,metadata:this.client.metadata},peer:{publicKey:s,metadata:i.requester.metadata},controller:s,expiry:_c(kg),authentication:r,requiredNamespaces:{},optionalNamespaces:{},relay:{protocol:"irn"},pairingTopic:i.pairingTopic,namespaces:dl([...new Set(h)],[...new Set(l)]),transportType:o},n.addTrace("subscribing_authenticated_session_topic");try{await this.client.core.relayer.subscribe(d,{transportType:o})}catch(e){throw n.setError("subscribe_authenticated_session_topic_failure"),e}n.addTrace("subscribe_authenticated_session_topic_success"),await this.client.session.set(d,f),n.addTrace("store_authenticated_session"),await this.client.core.pairing.updateMetadata({topic:i.pairingTopic,metadata:i.requester.metadata})}n.addTrace("publishing_authenticated_session_approve");try{await this.sendResult({topic:c,id:t,result:{cacaos:r,responder:{publicKey:a,metadata:this.client.metadata}},encodeOpts:u,throwOnFailedPublish:!0,appLink:this.getAppLinkIfEnabled(i.requester.metadata,o)})}catch(e){throw n.setError("authenticated_session_approve_publish_failure"),e}return await this.client.auth.requests.delete(t,{message:"fulfilled",code:0}),await this.client.core.pairing.activate({topic:i.pairingTopic}),this.client.core.eventClient.deleteEvent({eventId:n.eventId}),{session:f}},this.rejectSessionAuthenticate=async e=>{this.isInitialized();const{id:t,reason:r}=e,n=this.getPendingAuthRequest(t);if(!n)throw new Error(`Could not find pending auth request with id ${t}`);n.transportType===Pd.relay&&await this.confirmOnlineStateOrThrow();const i=n.requester.publicKey,o=await this.client.core.crypto.generateKeyPair(),s=Yh(i),a={type:1,receiverPublicKey:i,senderPublicKey:o};await this.sendError({id:t,topic:s,error:r,encodeOpts:a,rpcOpts:xg.wc_sessionAuthenticate.reject,appLink:this.getAppLinkIfEnabled(n.requester.metadata,n.transportType)}),await this.client.auth.requests.delete(t,{message:"rejected",code:0}),await this.client.proposal.delete(t,yl("USER_DISCONNECTED"))},this.formatAuthMessage=e=>{this.isInitialized();const{request:t,iss:r}=e;return Eu(t,r)},this.processRelayMessageCache=()=>{setTimeout((async()=>{if(0!==this.relayMessageCache.length)for(;this.relayMessageCache.length>0;)try{const e=this.relayMessageCache.shift();e&&await this.onRelayMessage(e)}catch(e){this.client.logger.error(e)}}),50)},this.cleanupDuplicatePairings=async e=>{if(e.pairingTopic)try{const t=this.client.core.pairing.pairings.get(e.pairingTopic),r=this.client.core.pairing.pairings.getAll().filter((r=>{var n,i;return(null==(n=r.peerMetadata)?void 0:n.url)&&(null==(i=r.peerMetadata)?void 0:i.url)===e.peer.metadata.url&&r.topic&&r.topic!==t.topic}));if(0===r.length)return;this.client.logger.info(`Cleaning up ${r.length} duplicate pairing(s)`),await Promise.all(r.map((e=>this.client.core.pairing.disconnect({topic:e.topic})))),this.client.logger.info("Duplicate pairings clean up finished")}catch(e){this.client.logger.error(e)}},this.deleteSession=async e=>{var t;const{topic:r,expirerHasDeleted:n=!1,emitEvent:i=!0,id:o=0}=e,{self:s}=this.client.session.get(r);await this.client.core.relayer.unsubscribe(r),await this.client.session.delete(r,yl("USER_DISCONNECTED")),this.addToRecentlyDeleted(r,"session"),this.client.core.crypto.keychain.has(s.publicKey)&&await this.client.core.crypto.deleteKeyPair(s.publicKey),this.client.core.crypto.keychain.has(r)&&await this.client.core.crypto.deleteSymKey(r),n||this.client.core.expirer.del(r),this.client.core.storage.removeItem(Ag).catch((e=>this.client.logger.warn(e))),this.getPendingSessionRequests().forEach((e=>{e.topic===r&&this.deletePendingSessionRequest(e.id,yl("USER_DISCONNECTED"))})),r===(null==(t=this.sessionRequestQueue.queue[0])?void 0:t.topic)&&(this.sessionRequestQueue.state=Og),i&&this.client.events.emit("session_delete",{id:o,topic:r})},this.deleteProposal=async(e,t)=>{if(t)try{const t=this.client.proposal.get(e),r=this.client.core.eventClient.getEvent({topic:t.pairingTopic});r?.setError("proposal_expired")}catch{}await Promise.all([this.client.proposal.delete(e,yl("USER_DISCONNECTED")),t?Promise.resolve():this.client.core.expirer.del(e)]),this.addToRecentlyDeleted(e,"proposal")},this.deletePendingSessionRequest=async(e,t,r=!1)=>{await Promise.all([this.client.pendingRequest.delete(e,t),r?Promise.resolve():this.client.core.expirer.del(e)]),this.addToRecentlyDeleted(e,"request"),this.sessionRequestQueue.queue=this.sessionRequestQueue.queue.filter((t=>t.id!==e)),r&&(this.sessionRequestQueue.state=Og,this.client.events.emit("session_request_expire",{id:e}))},this.deletePendingAuthRequest=async(e,t,r=!1)=>{await Promise.all([this.client.auth.requests.delete(e,t),r?Promise.resolve():this.client.core.expirer.del(e)])},this.setExpiry=async(e,t)=>{this.client.session.keys.includes(e)&&(this.client.core.expirer.set(e,t),await this.client.session.update(e,{expiry:t}))},this.setProposal=async(e,t)=>{this.client.core.expirer.set(e,_c(xg.wc_sessionPropose.req.ttl)),await this.client.proposal.set(e,t)},this.setAuthRequest=async(e,t)=>{const{request:r,pairingTopic:n,transportType:i=Pd.relay}=t;this.client.core.expirer.set(e,r.expiryTimestamp),await this.client.auth.requests.set(e,{authPayload:r.authPayload,requester:r.requester,expiryTimestamp:r.expiryTimestamp,id:e,pairingTopic:n,verifyContext:r.verifyContext,transportType:i})},this.setPendingSessionRequest=async e=>{const{id:t,topic:r,params:n,verifyContext:i}=e,o=n.request.expiryTimestamp||_c(xg.wc_sessionRequest.req.ttl);this.client.core.expirer.set(t,o),await this.client.pendingRequest.set(t,{id:t,topic:r,params:n,verifyContext:i})},this.sendRequest=async e=>{const{topic:t,method:n,params:i,expiry:o,relayRpcId:s,clientRpcId:a,throwOnFailedPublish:c,appLink:u}=e,h=Vl(n,i,a);let l;const d=!!u;try{const e=d?Hh:Wh;l=await this.client.core.crypto.encode(t,h,{encoding:e})}catch(e){throw await this.cleanup(),this.client.logger.error(`sendRequest() -> core.crypto.encode() for topic ${t} failed`),e}let f;if(Tg.includes(n)){const e=Jh(JSON.stringify(h)),t=Jh(l);f=await this.client.core.verify.register({id:t,decryptedId:e})}const p=xg[n].req;if(p.attestation=f,o&&(p.ttl=o),s&&(p.id=s),this.client.core.history.set(t,h),d){const e=hl(u,t,l);await r.g.Linking.openURL(e,this.client.name)}else{const e=xg[n].req;o&&(e.ttl=o),s&&(e.id=s),c?(e.internal=$g(qg({},e.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(t,l,e)):this.client.core.relayer.publish(t,l,e).catch((e=>this.client.logger.error(e)))}return h.id},this.sendResult=async e=>{const{id:t,topic:n,result:i,throwOnFailedPublish:o,encodeOpts:s,appLink:a}=e,c=Gl(t,i);let u;const h=a&&typeof(null==r.g?void 0:r.g.Linking)<"u";try{const e=h?Hh:Wh;u=await this.client.core.crypto.encode(n,c,$g(qg({},s||{}),{encoding:e}))}catch(e){throw await this.cleanup(),this.client.logger.error(`sendResult() -> core.crypto.encode() for topic ${n} failed`),e}let l;try{l=await this.client.core.history.get(n,t)}catch(e){throw this.client.logger.error(`sendResult() -> history.get(${n}, ${t}) failed`),e}if(h){const e=hl(a,n,u);await r.g.Linking.openURL(e,this.client.name)}else{const e=xg[l.request.method].res;o?(e.internal=$g(qg({},e.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(n,u,e)):this.client.core.relayer.publish(n,u,e).catch((e=>this.client.logger.error(e)))}await this.client.core.history.resolve(c)},this.sendError=async e=>{const{id:t,topic:n,error:i,encodeOpts:o,rpcOpts:s,appLink:a}=e,c=Yl(t,i);let u;const h=a&&typeof(null==r.g?void 0:r.g.Linking)<"u";try{const e=h?Hh:Wh;u=await this.client.core.crypto.encode(n,c,$g(qg({},o||{}),{encoding:e}))}catch(e){throw await this.cleanup(),this.client.logger.error(`sendError() -> core.crypto.encode() for topic ${n} failed`),e}let l;try{l=await this.client.core.history.get(n,t)}catch(e){throw this.client.logger.error(`sendError() -> history.get(${n}, ${t}) failed`),e}if(h){const e=hl(a,n,u);await r.g.Linking.openURL(e,this.client.name)}else{const e=s||xg[l.request.method].res;this.client.core.relayer.publish(n,u,e)}await this.client.core.history.resolve(c)},this.cleanup=async()=>{const e=[],t=[];this.client.session.getAll().forEach((t=>{let r=!1;Ec(t.expiry)&&(r=!0),this.client.core.crypto.keychain.has(t.topic)||(r=!0),r&&e.push(t.topic)})),this.client.proposal.getAll().forEach((e=>{Ec(e.expiryTimestamp)&&t.push(e.id)})),await Promise.all([...e.map((e=>this.deleteSession({topic:e}))),...t.map((e=>this.deleteProposal(e)))])},this.onRelayEventRequest=async e=>{this.requestQueue.queue.push(e),await this.processRequestsQueue()},this.processRequestsQueue=async()=>{if(this.requestQueue.state!==Rg){for(this.client.logger.info(`Request queue starting with ${this.requestQueue.queue.length} requests`);this.requestQueue.queue.length>0;){this.requestQueue.state=Rg;const e=this.requestQueue.queue.shift();if(e)try{await this.processRequest(e)}catch(e){this.client.logger.warn(e)}}this.requestQueue.state=Og}else this.client.logger.info("Request queue already active, skipping...")},this.processRequest=async e=>{const{topic:t,payload:r,attestation:n,transportType:i,encryptedId:o}=e,s=r.method;if(!this.shouldIgnorePairingRequest({topic:t,requestMethod:s}))switch(s){case"wc_sessionPropose":return await this.onSessionProposeRequest({topic:t,payload:r,attestation:n,encryptedId:o});case"wc_sessionSettle":return await this.onSessionSettleRequest(t,r);case"wc_sessionUpdate":return await this.onSessionUpdateRequest(t,r);case"wc_sessionExtend":return await this.onSessionExtendRequest(t,r);case"wc_sessionPing":return await this.onSessionPingRequest(t,r);case"wc_sessionDelete":return await this.onSessionDeleteRequest(t,r);case"wc_sessionRequest":return await this.onSessionRequest({topic:t,payload:r,attestation:n,encryptedId:o,transportType:i});case"wc_sessionEvent":return await this.onSessionEventRequest(t,r);case"wc_sessionAuthenticate":return await this.onSessionAuthenticateRequest({topic:t,payload:r,attestation:n,encryptedId:o,transportType:i});default:return this.client.logger.info(`Unsupported request method ${s}`)}},this.onRelayEventResponse=async e=>{const{topic:t,payload:r,transportType:n}=e,i=(await this.client.core.history.get(t,r.id)).request.method;switch(i){case"wc_sessionPropose":return this.onSessionProposeResponse(t,r,n);case"wc_sessionSettle":return this.onSessionSettleResponse(t,r);case"wc_sessionUpdate":return this.onSessionUpdateResponse(t,r);case"wc_sessionExtend":return this.onSessionExtendResponse(t,r);case"wc_sessionPing":return this.onSessionPingResponse(t,r);case"wc_sessionRequest":return this.onSessionRequestResponse(t,r);case"wc_sessionAuthenticate":return this.onSessionAuthenticateResponse(t,r);default:return this.client.logger.info(`Unsupported response method ${i}`)}},this.onRelayEventUnknownPayload=e=>{const{topic:t}=e,{message:r}=gl("MISSING_OR_INVALID",`Decoded payload on topic ${t} is not identifiable as a JSON-RPC request or a response.`);throw new Error(r)},this.shouldIgnorePairingRequest=e=>{const{topic:t,requestMethod:r}=e,n=this.expectedPairingMethodMap.get(t);return!(!n||n.includes(r)||!(n.includes("wc_sessionAuthenticate")&&this.client.events.listenerCount("session_authenticate")>0))},this.onSessionProposeRequest=async e=>{const{topic:t,payload:r,attestation:n,encryptedId:i}=e,{params:o,id:s}=r;try{const e=this.client.core.eventClient.getEvent({topic:t});0===this.client.events.listenerCount("session_proposal")&&(console.warn("No listener for session_proposal event"),e?.setError("proposal_listener_not_found")),this.isValidConnect(qg({},r.params));const a=o.expiryTimestamp||_c(xg.wc_sessionPropose.req.ttl),c=qg({id:s,pairingTopic:t,expiryTimestamp:a},o);await this.setProposal(s,c);const u=await this.getVerifyContext({attestationId:n,hash:Jh(JSON.stringify(r)),encryptedId:i,metadata:c.proposer.metadata});e?.addTrace("emit_session_proposal"),this.client.events.emit("session_proposal",{id:s,params:c,verifyContext:u})}catch(e){await this.sendError({id:s,topic:t,error:e,rpcOpts:xg.wc_sessionPropose.autoReject}),this.client.logger.error(e)}},this.onSessionProposeResponse=async(e,t,r)=>{const{id:n}=t;if(id(t)){const{result:i}=t;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:i});const o=this.client.proposal.get(n);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:o});const s=o.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:s});const a=i.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:a});const c=await this.client.core.crypto.generateSharedKey(s,a);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:c});const u=await this.client.core.relayer.subscribe(c,{transportType:r});this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:u}),await this.client.core.pairing.activate({topic:e})}else if(od(t)){await this.client.proposal.delete(n,yl("USER_DISCONNECTED"));const e=Ic("session_connect");if(0===this.events.listenerCount(e))throw new Error(`emitting ${e} without any listeners, 954`);this.events.emit(Ic("session_connect"),{error:t.error})}},this.onSessionSettleRequest=async(e,t)=>{const{id:r,params:n}=t;try{this.isValidSessionSettleRequest(n);const{relay:r,controller:i,expiry:o,namespaces:s,sessionProperties:a,sessionConfig:c}=t.params,u=$g(qg(qg({topic:e,relay:r,expiry:o,namespaces:s,acknowledged:!0,pairingTopic:"",requiredNamespaces:{},optionalNamespaces:{},controller:i.publicKey,self:{publicKey:"",metadata:this.client.metadata},peer:{publicKey:i.publicKey,metadata:i.metadata}},a&&{sessionProperties:a}),c&&{sessionConfig:c}),{transportType:Pd.relay}),h=Ic("session_connect");if(0===this.events.listenerCount(h))throw new Error(`emitting ${h} without any listeners 997`);this.events.emit(Ic("session_connect"),{session:u}),await this.sendResult({id:t.id,topic:e,result:!0,throwOnFailedPublish:!0})}catch(t){await this.sendError({id:r,topic:e,error:t}),this.client.logger.error(t)}},this.onSessionSettleResponse=async(e,t)=>{const{id:r}=t;id(t)?(await this.client.session.update(e,{acknowledged:!0}),this.events.emit(Ic("session_approve",r),{})):od(t)&&(await this.client.session.delete(e,yl("USER_DISCONNECTED")),this.events.emit(Ic("session_approve",r),{error:t.error}))},this.onSessionUpdateRequest=async(e,t)=>{const{params:r,id:n}=t;try{const t=`${e}_session_update`,i=Ml.get(t);if(i&&this.isRequestOutOfSync(i,n))return this.client.logger.warn(`Discarding out of sync request - ${n}`),void this.sendError({id:n,topic:e,error:yl("INVALID_UPDATE_REQUEST")});this.isValidUpdate(qg({topic:e},r));try{Ml.set(t,n),await this.client.session.update(e,{namespaces:r.namespaces}),await this.sendResult({id:n,topic:e,result:!0,throwOnFailedPublish:!0})}catch(e){throw Ml.delete(t),e}this.client.events.emit("session_update",{id:n,topic:e,params:r})}catch(t){await this.sendError({id:n,topic:e,error:t}),this.client.logger.error(t)}},this.isRequestOutOfSync=(e,t)=>t.toString().slice(0,-3)<e.toString().slice(0,-3),this.onSessionUpdateResponse=(e,t)=>{const{id:r}=t,n=Ic("session_update",r);if(0===this.events.listenerCount(n))throw new Error(`emitting ${n} without any listeners`);id(t)?this.events.emit(Ic("session_update",r),{}):od(t)&&this.events.emit(Ic("session_update",r),{error:t.error})},this.onSessionExtendRequest=async(e,t)=>{const{id:r}=t;try{this.isValidExtend({topic:e}),await this.setExpiry(e,_c(kg)),await this.sendResult({id:r,topic:e,result:!0,throwOnFailedPublish:!0}),this.client.events.emit("session_extend",{id:r,topic:e})}catch(t){await this.sendError({id:r,topic:e,error:t}),this.client.logger.error(t)}},this.onSessionExtendResponse=(e,t)=>{const{id:r}=t,n=Ic("session_extend",r);if(0===this.events.listenerCount(n))throw new Error(`emitting ${n} without any listeners`);id(t)?this.events.emit(Ic("session_extend",r),{}):od(t)&&this.events.emit(Ic("session_extend",r),{error:t.error})},this.onSessionPingRequest=async(e,t)=>{const{id:r}=t;try{this.isValidPing({topic:e}),await this.sendResult({id:r,topic:e,result:!0,throwOnFailedPublish:!0}),this.client.events.emit("session_ping",{id:r,topic:e})}catch(t){await this.sendError({id:r,topic:e,error:t}),this.client.logger.error(t)}},this.onSessionPingResponse=(e,t)=>{const{id:r}=t,n=Ic("session_ping",r);if(0===this.events.listenerCount(n))throw new Error(`emitting ${n} without any listeners`);setTimeout((()=>{id(t)?this.events.emit(Ic("session_ping",r),{}):od(t)&&this.events.emit(Ic("session_ping",r),{error:t.error})}),500)},this.onSessionDeleteRequest=async(e,t)=>{const{id:r}=t;try{this.isValidDisconnect({topic:e,reason:t.params}),Promise.all([new Promise((t=>{this.client.core.relayer.once(_d,(async()=>{t(await this.deleteSession({topic:e,id:r}))}))})),this.sendResult({id:r,topic:e,result:!0,throwOnFailedPublish:!0}),this.cleanupPendingSentRequestsForTopic({topic:e,error:yl("USER_DISCONNECTED")})]).catch((e=>this.client.logger.error(e)))}catch(e){this.client.logger.error(e)}},this.onSessionRequest=async e=>{var t,r,n;const{topic:i,payload:o,attestation:s,encryptedId:a,transportType:c}=e,{id:u,params:h}=o;try{await this.isValidRequest(qg({topic:i},h));const e=this.client.session.get(i),o={id:u,topic:i,params:h,verifyContext:await this.getVerifyContext({attestationId:s,hash:Jh(JSON.stringify(Vl("wc_sessionRequest",h,u))),encryptedId:a,metadata:e.peer.metadata,transportType:c})};await this.setPendingSessionRequest(o),c===Pd.link_mode&&null!=(t=e.peer.metadata.redirect)&&t.universal&&this.client.core.addLinkModeSupportedApp(null==(r=e.peer.metadata.redirect)?void 0:r.universal),null!=(n=this.client.signConfig)&&n.disableRequestQueue?this.emitSessionRequest(o):(this.addSessionRequestToSessionRequestQueue(o),this.processSessionRequestQueue())}catch(e){await this.sendError({id:u,topic:i,error:e}),this.client.logger.error(e)}},this.onSessionRequestResponse=(e,t)=>{const{id:r}=t,n=Ic("session_request",r);if(0===this.events.listenerCount(n))throw new Error(`emitting ${n} without any listeners`);id(t)?this.events.emit(Ic("session_request",r),{result:t.result}):od(t)&&this.events.emit(Ic("session_request",r),{error:t.error})},this.onSessionEventRequest=async(e,t)=>{const{id:r,params:n}=t;try{const t=`${e}_session_event_${n.event.name}`,i=Ml.get(t);if(i&&this.isRequestOutOfSync(i,r))return void this.client.logger.info(`Discarding out of sync request - ${r}`);this.isValidEmit(qg({topic:e},n)),this.client.events.emit("session_event",{id:r,topic:e,params:n}),Ml.set(t,r)}catch(t){await this.sendError({id:r,topic:e,error:t}),this.client.logger.error(t)}},this.onSessionAuthenticateResponse=(e,t)=>{const{id:r}=t;this.client.logger.trace({type:"method",method:"onSessionAuthenticateResponse",topic:e,payload:t}),id(t)?this.events.emit(Ic("session_request",r),{result:t.result}):od(t)&&this.events.emit(Ic("session_request",r),{error:t.error})},this.onSessionAuthenticateRequest=async e=>{var t;const{topic:r,payload:n,attestation:i,encryptedId:o,transportType:s}=e;try{const{requester:e,authPayload:a,expiryTimestamp:c}=n.params,u=await this.getVerifyContext({attestationId:i,hash:Jh(JSON.stringify(n)),encryptedId:o,metadata:e.metadata,transportType:s}),h={requester:e,pairingTopic:r,id:n.id,authPayload:a,verifyContext:u,expiryTimestamp:c};await this.setAuthRequest(n.id,{request:h,pairingTopic:r,transportType:s}),s===Pd.link_mode&&null!=(t=e.metadata.redirect)&&t.universal&&this.client.core.addLinkModeSupportedApp(e.metadata.redirect.universal),this.client.events.emit("session_authenticate",{topic:r,params:n.params,id:n.id,verifyContext:u})}catch(e){this.client.logger.error(e);const t=n.params.requester.publicKey,i=await this.client.core.crypto.generateKeyPair(),o=this.getAppLinkIfEnabled(n.params.requester.metadata,s),a={type:1,receiverPublicKey:t,senderPublicKey:i};await this.sendError({id:n.id,topic:r,error:e,encodeOpts:a,rpcOpts:xg.wc_sessionAuthenticate.autoReject,appLink:o})}},this.addSessionRequestToSessionRequestQueue=e=>{this.sessionRequestQueue.queue.push(e)},this.cleanupAfterResponse=e=>{this.deletePendingSessionRequest(e.response.id,{message:"fulfilled",code:0}),setTimeout((()=>{this.sessionRequestQueue.state=Og,this.processSessionRequestQueue()}),(0,K.toMiliseconds)(this.requestQueueDelay))},this.cleanupPendingSentRequestsForTopic=({topic:e,error:t})=>{const r=this.client.core.history.pending;r.length>0&&r.filter((t=>t.topic===e&&"wc_sessionRequest"===t.request.method)).forEach((e=>{const r=Ic("session_request",e.request.id);if(0===this.events.listenerCount(r))throw new Error(`emitting ${r} without any listeners`);this.events.emit(Ic("session_request",e.request.id),{error:t})}))},this.processSessionRequestQueue=()=>{if(this.sessionRequestQueue.state===Rg)return void this.client.logger.info("session request queue is already active.");const e=this.sessionRequestQueue.queue[0];if(e)try{this.sessionRequestQueue.state=Rg,this.emitSessionRequest(e)}catch(e){this.client.logger.error(e)}else this.client.logger.info("session request queue is empty.")},this.emitSessionRequest=e=>{this.client.events.emit("session_request",e)},this.onPairingCreated=e=>{if(e.methods&&this.expectedPairingMethodMap.set(e.topic,e.methods),e.active)return;const t=this.client.proposal.getAll().find((t=>t.pairingTopic===e.topic));t&&this.onSessionProposeRequest({topic:e.topic,payload:Vl("wc_sessionPropose",{requiredNamespaces:t.requiredNamespaces,optionalNamespaces:t.optionalNamespaces,relays:t.relays,proposer:t.proposer,sessionProperties:t.sessionProperties},t.id)})},this.isValidConnect=async e=>{if(!xl(e)){const{message:t}=gl("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(e)}`);throw new Error(t)}const{pairingTopic:t,requiredNamespaces:r,optionalNamespaces:n,sessionProperties:i,relays:o}=e;if(wl(t)||await this.isValidPairingTopic(t),!function(e){let t=!1;return e?e&&bl(e)&&e.length&&e.forEach((e=>{t=kl(e)})):t=!0,t}(o)){const{message:e}=gl("MISSING_OR_INVALID",`connect() relays: ${o}`);throw new Error(e)}!wl(r)&&0!==ml(r)&&this.validateNamespaces(r,"requiredNamespaces"),!wl(n)&&0!==ml(n)&&this.validateNamespaces(n,"optionalNamespaces"),wl(i)||this.validateSessionProps(i,"sessionProperties")},this.validateNamespaces=(e,t)=>{const r=function(e,t,r){let n=null;if(e&&ml(e)){const i=Il(e,t);i&&(n=i);const o=function(e,t,r){let n=null;return Object.entries(e).forEach((([e,i])=>{if(n)return;const o=function(e,t,r){let n=null;return bl(t)&&t.length?t.forEach((e=>{n||_l(e)||(n=yl("UNSUPPORTED_CHAINS",`${r}, chain ${e} should be a string and conform to "namespace:chainId" format`))})):_l(e)||(n=yl("UNSUPPORTED_CHAINS",`${r}, chains must be defined as "namespace:chainId" e.g. "eip155:1": {...} in the namespace key OR as an array of CAIP-2 chainIds e.g. eip155: { chains: ["eip155:1", "eip155:5"] }`)),n}(e,ic(e,i),`${t} ${r}`);o&&(n=o)})),n}(e,t,r);o&&(n=o)}else n=gl("MISSING_OR_INVALID",`${t}, ${r} should be an object with data`);return n}(e,"connect()",t);if(r)throw new Error(r.message)},this.isValidApprove=async e=>{if(!xl(e))throw new Error(gl("MISSING_OR_INVALID",`approve() params: ${e}`).message);const{id:t,namespaces:r,relayProtocol:n,sessionProperties:i}=e;this.checkRecentlyDeleted(t),await this.isValidProposalId(t);const o=this.client.proposal.get(t),s=Al(r,"approve()");if(s)throw new Error(s.message);const a=Ol(o.requiredNamespaces,r,"approve()");if(a)throw new Error(a.message);if(!vl(n,!0)){const{message:e}=gl("MISSING_OR_INVALID",`approve() relayProtocol: ${n}`);throw new Error(e)}wl(i)||this.validateSessionProps(i,"sessionProperties")},this.isValidReject=async e=>{if(!xl(e)){const{message:t}=gl("MISSING_OR_INVALID",`reject() params: ${e}`);throw new Error(t)}const{id:t,reason:r}=e;if(this.checkRecentlyDeleted(t),await this.isValidProposalId(t),!function(e){return!!(e&&"object"==typeof e&&e.code&&Sl(e.code,!1)&&e.message&&vl(e.message,!1))}(r)){const{message:e}=gl("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(r)}`);throw new Error(e)}},this.isValidSessionSettleRequest=e=>{if(!xl(e)){const{message:t}=gl("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${e}`);throw new Error(t)}const{relay:t,controller:r,namespaces:n,expiry:i}=e;if(!kl(t)){const{message:e}=gl("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(e)}const o=function(e){let t=null;return vl(e?.publicKey,!1)||(t=gl("MISSING_OR_INVALID","onSessionSettleRequest() controller public key should be a string")),t}(r);if(o)throw new Error(o.message);const s=Al(n,"onSessionSettleRequest()");if(s)throw new Error(s.message);if(Ec(i)){const{message:e}=gl("EXPIRED","onSessionSettleRequest()");throw new Error(e)}},this.isValidUpdate=async e=>{if(!xl(e)){const{message:t}=gl("MISSING_OR_INVALID",`update() params: ${e}`);throw new Error(t)}const{topic:t,namespaces:r}=e;this.checkRecentlyDeleted(t),await this.isValidSessionTopic(t);const n=this.client.session.get(t),i=Al(r,"update()");if(i)throw new Error(i.message);const o=Ol(n.requiredNamespaces,r,"update()");if(o)throw new Error(o.message)},this.isValidExtend=async e=>{if(!xl(e)){const{message:t}=gl("MISSING_OR_INVALID",`extend() params: ${e}`);throw new Error(t)}const{topic:t}=e;this.checkRecentlyDeleted(t),await this.isValidSessionTopic(t)},this.isValidRequest=async e=>{if(!xl(e)){const{message:t}=gl("MISSING_OR_INVALID",`request() params: ${e}`);throw new Error(t)}const{topic:t,request:r,chainId:n,expiry:i}=e;this.checkRecentlyDeleted(t),await this.isValidSessionTopic(t);const{namespaces:o}=this.client.session.get(t);if(!Pl(o,n)){const{message:e}=gl("MISSING_OR_INVALID",`request() chainId: ${n}`);throw new Error(e)}if(!function(e){return!(wl(e)||!vl(e.method,!1))}(r)){const{message:e}=gl("MISSING_OR_INVALID",`request() ${JSON.stringify(r)}`);throw new Error(e)}if(!function(e,t,r){return!!vl(r,!1)&&function(e,t){const r=[];return Object.values(e).forEach((e=>{ll(e.accounts).includes(t)&&r.push(...e.methods)})),r}(e,t).includes(r)}(o,n,r.method)){const{message:e}=gl("MISSING_OR_INVALID",`request() method: ${r.method}`);throw new Error(e)}if(i&&!function(e,t){return Sl(e,!1)&&e<=t.max&&e>=t.min}(i,Pg)){const{message:e}=gl("MISSING_OR_INVALID",`request() expiry: ${i}. Expiry must be a number (in seconds) between ${Pg.min} and ${Pg.max}`);throw new Error(e)}},this.isValidRespond=async e=>{var t;if(!xl(e)){const{message:t}=gl("MISSING_OR_INVALID",`respond() params: ${e}`);throw new Error(t)}const{topic:r,response:n}=e;try{await this.isValidSessionTopic(r)}catch(r){throw null!=(t=e?.response)&&t.id&&this.cleanupAfterResponse(e),r}if(!function(e){return!(wl(e)||wl(e.result)&&wl(e.error)||!Sl(e.id,!1)||!vl(e.jsonrpc,!1))}(n)){const{message:e}=gl("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(n)}`);throw new Error(e)}},this.isValidPing=async e=>{if(!xl(e)){const{message:t}=gl("MISSING_OR_INVALID",`ping() params: ${e}`);throw new Error(t)}const{topic:t}=e;await this.isValidSessionOrPairingTopic(t)},this.isValidEmit=async e=>{if(!xl(e)){const{message:t}=gl("MISSING_OR_INVALID",`emit() params: ${e}`);throw new Error(t)}const{topic:t,event:r,chainId:n}=e;await this.isValidSessionTopic(t);const{namespaces:i}=this.client.session.get(t);if(!Pl(i,n)){const{message:e}=gl("MISSING_OR_INVALID",`emit() chainId: ${n}`);throw new Error(e)}if(!function(e){return!(wl(e)||!vl(e.name,!1))}(r)){const{message:e}=gl("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(r)}`);throw new Error(e)}if(!function(e,t,r){return!!vl(r,!1)&&function(e,t){const r=[];return Object.values(e).forEach((e=>{ll(e.accounts).includes(t)&&r.push(...e.events)})),r}(e,t).includes(r)}(i,n,r.name)){const{message:e}=gl("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(r)}`);throw new Error(e)}},this.isValidDisconnect=async e=>{if(!xl(e)){const{message:t}=gl("MISSING_OR_INVALID",`disconnect() params: ${e}`);throw new Error(t)}const{topic:t}=e;await this.isValidSessionOrPairingTopic(t)},this.isValidAuthenticate=e=>{const{chains:t,uri:r,domain:n,nonce:i}=e;if(!Array.isArray(t)||0===t.length)throw new Error("chains is required and must be a non-empty array");if(!vl(r,!1))throw new Error("uri is required parameter");if(!vl(n,!1))throw new Error("domain is required parameter");if(!vl(i,!1))throw new Error("nonce is required parameter");if([...new Set(t.map((e=>tc(e).namespace)))].length>1)throw new Error("Multi-namespace requests are not supported. Please request single namespace only.");const{namespace:o}=tc(t[0]);if("eip155"!==o)throw new Error("Only eip155 namespace is supported for authenticated sessions. Please use .connect() for non-eip155 chains.")},this.getVerifyContext=async e=>{const{attestationId:t,hash:r,encryptedId:n,metadata:i,transportType:o}=e,s={verified:{verifyUrl:i.verifyUrl||Kd,validation:"UNKNOWN",origin:i.url||""}};try{if(o===Pd.link_mode){const e=this.getAppLinkIfEnabled(i,o);return s.verified.validation=e&&new URL(e).origin===new URL(i.url).origin?"VALID":"INVALID",s}const e=await this.client.core.verify.resolve({attestationId:t,hash:r,encryptedId:n,verifyUrl:i.verifyUrl});e&&(s.verified.origin=e.origin,s.verified.isScam=e.isScam,s.verified.validation=e.origin===new URL(i.url).origin?"VALID":"INVALID")}catch(e){this.client.logger.warn(e)}return this.client.logger.debug(`Verify context: ${JSON.stringify(s)}`),s},this.validateSessionProps=(e,t)=>{Object.values(e).forEach((e=>{if(!vl(e,!1)){const{message:r}=gl("MISSING_OR_INVALID",`${t} must be in Record<string, string> format. Received: ${JSON.stringify(e)}`);throw new Error(r)}}))},this.getPendingAuthRequest=e=>{const t=this.client.auth.requests.get(e);return"object"==typeof t?t:void 0},this.addToRecentlyDeleted=(e,t)=>{if(this.recentlyDeletedMap.set(e,t),this.recentlyDeletedMap.size>=this.recentlyDeletedLimit){let e=0;const t=this.recentlyDeletedLimit/2;for(const r of this.recentlyDeletedMap.keys()){if(e++>=t)break;this.recentlyDeletedMap.delete(r)}}},this.checkRecentlyDeleted=e=>{const t=this.recentlyDeletedMap.get(e);if(t){const{message:r}=gl("MISSING_OR_INVALID",`Record was recently deleted - ${t}: ${e}`);throw new Error(r)}},this.isLinkModeEnabled=(e,t)=>{var n,i,o,s,a,c,u,h,l;return!(!e||t!==Pd.link_mode)&&!0===(null==(i=null==(n=this.client.metadata)?void 0:n.redirect)?void 0:i.linkMode)&&void 0!==(null==(s=null==(o=this.client.metadata)?void 0:o.redirect)?void 0:s.universal)&&""!==(null==(c=null==(a=this.client.metadata)?void 0:a.redirect)?void 0:c.universal)&&void 0!==(null==(u=e?.redirect)?void 0:u.universal)&&""!==(null==(h=e?.redirect)?void 0:h.universal)&&!0===(null==(l=e?.redirect)?void 0:l.linkMode)&&this.client.core.linkModeSupportedApps.includes(e.redirect.universal)&&typeof(null==r.g?void 0:r.g.Linking)<"u"},this.getAppLinkIfEnabled=(e,t)=>{var r;return this.isLinkModeEnabled(e,t)?null==(r=e?.redirect)?void 0:r.universal:void 0},this.handleLinkModeMessage=({url:e})=>{if(!e||!e.includes("wc_ev")||!e.includes("topic"))return;const t=kc(e,"topic")||"",r=decodeURIComponent(kc(e,"wc_ev")||""),n=this.client.session.keys.includes(t);n&&this.client.session.update(t,{transportType:Pd.link_mode}),this.client.core.dispatchEnvelope({topic:t,message:r,sessionExists:n})},this.registerLinkModeListeners=async()=>{var e;if(Pc()||uc()&&null!=(e=this.client.metadata.redirect)&&e.linkMode){const e=null==r.g?void 0:r.g.Linking;if(typeof e<"u"){e.addEventListener("url",this.handleLinkModeMessage,this.client.name);const t=await e.getInitialURL();t&&setTimeout((()=>{this.handleLinkModeMessage({url:t})}),50)}}}}isInitialized(){if(!this.initialized){const{message:e}=gl("NOT_INITIALIZED",this.name);throw new Error(e)}}async confirmOnlineStateOrThrow(){await this.client.core.relayer.confirmOnlineStateOrThrow()}registerRelayerEvents(){this.client.core.relayer.on(wd,(e=>{!this.initialized||this.relayMessageCache.length>0?this.relayMessageCache.push(e):this.onRelayMessage(e)}))}async onRelayMessage(e){const{topic:t,message:r,attestation:n,transportType:i}=e,{publicKey:o}=this.client.auth.authKeys.keys.includes(Mg)?this.client.auth.authKeys.get(Mg):{responseTopic:void 0,publicKey:void 0},s=await this.client.core.crypto.decode(t,r,{receiverPublicKey:o,encoding:i===Pd.link_mode?Hh:Wh});try{rd(s)?(this.client.core.history.set(t,s),this.onRelayEventRequest({topic:t,payload:s,attestation:n,transportType:i,encryptedId:Jh(r)})):nd(s)?(await this.client.core.history.resolve(s),await this.onRelayEventResponse({topic:t,payload:s,transportType:i}),this.client.core.history.delete(t,s.id)):this.onRelayEventUnknownPayload({topic:t,payload:s,transportType:i})}catch(e){this.client.logger.error(e)}}registerExpirerEvents(){this.client.core.expirer.on(qd,(async e=>{const{topic:t,id:r}=Sc(e.target);return r&&this.client.pendingRequest.keys.includes(r)?await this.deletePendingSessionRequest(r,gl("EXPIRED"),!0):r&&this.client.auth.requests.keys.includes(r)?await this.deletePendingAuthRequest(r,gl("EXPIRED"),!0):void(t?this.client.session.keys.includes(t)&&(await this.deleteSession({topic:t,expirerHasDeleted:!0}),this.client.events.emit("session_expire",{topic:t})):r&&(await this.deleteProposal(r,!0),this.client.events.emit("proposal_expire",{id:r})))}))}registerPairingEvents(){this.client.core.pairing.events.on(Cd,(e=>this.onPairingCreated(e))),this.client.core.pairing.events.on(Bd,(e=>{this.addToRecentlyDeleted(e.topic,"pairing")}))}isValidPairingTopic(e){if(!vl(e,!1)){const{message:t}=gl("MISSING_OR_INVALID",`pairing topic should be a string: ${e}`);throw new Error(t)}if(!this.client.core.pairing.pairings.keys.includes(e)){const{message:t}=gl("NO_MATCHING_KEY",`pairing topic doesn't exist: ${e}`);throw new Error(t)}if(Ec(this.client.core.pairing.pairings.get(e).expiry)){const{message:t}=gl("EXPIRED",`pairing topic: ${e}`);throw new Error(t)}}async isValidSessionTopic(e){if(!vl(e,!1)){const{message:t}=gl("MISSING_OR_INVALID",`session topic should be a string: ${e}`);throw new Error(t)}if(this.checkRecentlyDeleted(e),!this.client.session.keys.includes(e)){const{message:t}=gl("NO_MATCHING_KEY",`session topic doesn't exist: ${e}`);throw new Error(t)}if(Ec(this.client.session.get(e).expiry)){await this.deleteSession({topic:e});const{message:t}=gl("EXPIRED",`session topic: ${e}`);throw new Error(t)}if(!this.client.core.crypto.keychain.has(e)){const{message:t}=gl("MISSING_OR_INVALID",`session topic does not exist in keychain: ${e}`);throw await this.deleteSession({topic:e}),new Error(t)}}async isValidSessionOrPairingTopic(e){if(this.checkRecentlyDeleted(e),this.client.session.keys.includes(e))await this.isValidSessionTopic(e);else{if(!this.client.core.pairing.pairings.keys.includes(e)){if(vl(e,!1)){const{message:t}=gl("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${e}`);throw new Error(t)}{const{message:t}=gl("MISSING_OR_INVALID",`session or pairing topic should be a string: ${e}`);throw new Error(t)}}this.isValidPairingTopic(e)}}async isValidProposalId(e){if(!function(e){return"number"==typeof e}(e)){const{message:t}=gl("MISSING_OR_INVALID",`proposal id should be a number: ${e}`);throw new Error(t)}if(!this.client.proposal.keys.includes(e)){const{message:t}=gl("NO_MATCHING_KEY",`proposal id doesn't exist: ${e}`);throw new Error(t)}if(Ec(this.client.proposal.get(e).expiryTimestamp)){await this.deleteProposal(e);const{message:t}=gl("EXPIRED",`proposal id: ${e}`);throw new Error(t)}}}class Fg extends tg{constructor(e,t){super(e,t,"proposal",Eg),this.core=e,this.logger=t}}class Wg extends tg{constructor(e,t){super(e,t,"session",Eg),this.core=e,this.logger=t}}class Hg extends tg{constructor(e,t){super(e,t,"request",Eg,(e=>e.id)),this.core=e,this.logger=t}}class Vg extends tg{constructor(e,t){super(e,t,"authKeys",Ng,(()=>Mg)),this.core=e,this.logger=t}}class Gg extends tg{constructor(e,t){super(e,t,"pairingTopics",Ng),this.core=e,this.logger=t}}class Yg extends tg{constructor(e,t){super(e,t,"requests",Ng,(e=>e.id)),this.core=e,this.logger=t}}class Jg{constructor(e,t){this.core=e,this.logger=t,this.authKeys=new Vg(this.core,this.logger),this.pairingTopics=new Gg(this.core,this.logger),this.requests=new Yg(this.core,this.logger)}async init(){await this.authKeys.init(),await this.pairingTopics.init(),await this.requests.init()}}class Xg extends it{constructor(e){super(e),this.protocol="wc",this.version=2,this.name=Ig,this.events=new q.EventEmitter,this.on=(e,t)=>this.events.on(e,t),this.once=(e,t)=>this.events.once(e,t),this.off=(e,t)=>this.events.off(e,t),this.removeListener=(e,t)=>this.events.removeListener(e,t),this.removeAllListeners=e=>this.events.removeAllListeners(e),this.connect=async e=>{try{return await this.engine.connect(e)}catch(e){throw this.logger.error(e.message),e}},this.pair=async e=>{try{return await this.engine.pair(e)}catch(e){throw this.logger.error(e.message),e}},this.approve=async e=>{try{return await this.engine.approve(e)}catch(e){throw this.logger.error(e.message),e}},this.reject=async e=>{try{return await this.engine.reject(e)}catch(e){throw this.logger.error(e.message),e}},this.update=async e=>{try{return await this.engine.update(e)}catch(e){throw this.logger.error(e.message),e}},this.extend=async e=>{try{return await this.engine.extend(e)}catch(e){throw this.logger.error(e.message),e}},this.request=async e=>{try{return await this.engine.request(e)}catch(e){throw this.logger.error(e.message),e}},this.respond=async e=>{try{return await this.engine.respond(e)}catch(e){throw this.logger.error(e.message),e}},this.ping=async e=>{try{return await this.engine.ping(e)}catch(e){throw this.logger.error(e.message),e}},this.emit=async e=>{try{return await this.engine.emit(e)}catch(e){throw this.logger.error(e.message),e}},this.disconnect=async e=>{try{return await this.engine.disconnect(e)}catch(e){throw this.logger.error(e.message),e}},this.find=e=>{try{return this.engine.find(e)}catch(e){throw this.logger.error(e.message),e}},this.getPendingSessionRequests=()=>{try{return this.engine.getPendingSessionRequests()}catch(e){throw this.logger.error(e.message),e}},this.authenticate=async(e,t)=>{try{return await this.engine.authenticate(e,t)}catch(e){throw this.logger.error(e.message),e}},this.formatAuthMessage=e=>{try{return this.engine.formatAuthMessage(e)}catch(e){throw this.logger.error(e.message),e}},this.approveSessionAuthenticate=async e=>{try{return await this.engine.approveSessionAuthenticate(e)}catch(e){throw this.logger.error(e.message),e}},this.rejectSessionAuthenticate=async e=>{try{return await this.engine.rejectSessionAuthenticate(e)}catch(e){throw this.logger.error(e.message),e}},this.name=e?.name||Ig,this.metadata=e?.metadata||fc(),this.signConfig=e?.signConfig;const t=typeof e?.logger<"u"&&"string"!=typeof e?.logger?e.logger:Pe()(Fe({level:e?.logger||"error"}));this.core=e?.core||new Sg(e),this.logger=He(t,this.name),this.session=new Wg(this.core,this.logger),this.proposal=new Fg(this.core,this.logger),this.pendingRequest=new Hg(this.core,this.logger),this.engine=new Kg(this),this.auth=new Jg(this.core,this.logger)}static async init(e){const t=new Xg(e);return await t.initialize(),t}get context(){return We(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.auth.init(),await this.engine.init(),this.logger.info("SignClient Initialization Success"),setTimeout((()=>{this.engine.processRelayMessageCache()}),(0,K.toMiliseconds)(K.ONE_SECOND))}catch(e){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(e.message),e}}}function Zg(e,t,r){try{Reflect.apply(e,t,r)}catch(e){setTimeout((()=>{throw e}))}}class Qg extends q.EventEmitter{emit(e,...t){let r="error"===e;const n=this._events;if(void 0!==n)r=r&&void 0===n.error;else if(!r)return!1;if(r){let e;if(t.length>0&&([e]=t),e instanceof Error)throw e;const r=new Error("Unhandled error."+(e?` (${e.message})`:""));throw r.context=e,r}const i=n[e];if(void 0===i)return!1;if("function"==typeof i)Zg(i,this,t);else{const e=i.length,r=function(e){const t=e.length,r=new Array(t);for(let n=0;n<t;n+=1)r[n]=e[n];return r}(i);for(let n=0;n<e;n+=1)Zg(r[n],this,t)}return!0}}const ey={MAINNET:"mainnet",TESTNET:"testnet",CYAN:"cyan",AQUA:"aqua",CELESTE:"celeste"},ty=w(w({},{SAPPHIRE_DEVNET:"sapphire_devnet",SAPPHIRE_MAINNET:"sapphire_mainnet"}),ey),ry={AUTH:"auth",WALLET_CONNECT_V2:"wallet-connect-v2",SFA:"sfa"},ny=w({TORUS_SOLANA:"torus-solana"},ry),iy=w({TORUS_EVM:"torus-evm",COINBASE:"coinbase"},ry),oy=w(w({},iy),ny),sy=(ny.TORUS_SOLANA,iy.TORUS_EVM,iy.COINBASE,"external"),ay={NOT_READY:"not_ready",READY:"ready",CONNECTING:"connecting",CONNECTED:"connected",DISCONNECTED:"disconnected",ERRORED:"errored"},cy=w(w({},ay),{},{ADAPTER_DATA_UPDATED:"adapter_data_updated",CACHE_CLEAR:"cache_clear"});class uy extends Qg{constructor(e={}){super(),b(this,"adapterData",{}),b(this,"sessionTime",86400),b(this,"clientId",void 0),b(this,"web3AuthNetwork",ty.MAINNET),b(this,"useCoreKitKey",void 0),b(this,"rehydrated",!1),b(this,"chainConfig",null),b(this,"knownChainConfigs",{}),b(this,"adapterNamespace",void 0),b(this,"currentChainNamespace",void 0),b(this,"type",void 0),b(this,"name",void 0),b(this,"status",void 0),this.setAdapterSettings(e)}get chainConfigProxy(){return this.chainConfig?w({},this.chainConfig):null}get connnected(){return this.status===ay.CONNECTED}setAdapterSettings(e){if(this.status===ay.READY)return;null!=e&&e.sessionTime&&(this.sessionTime=e.sessionTime),null!=e&&e.clientId&&(this.clientId=e.clientId),null!=e&&e.web3AuthNetwork&&(this.web3AuthNetwork=e.web3AuthNetwork),void 0!==(null==e?void 0:e.useCoreKitKey)&&(this.useCoreKitKey=e.useCoreKitKey);const t=e.chainConfig;if(t){if(!t.chainNamespace)throw k.notReady("ChainNamespace is required while setting chainConfig");this.currentChainNamespace=t.chainNamespace;const e=w(w({},R(t.chainNamespace,t.chainId,this.clientId)||{}),t);this.chainConfig=e,this.addChainConfig(e)}}checkConnectionRequirements(){if(this.name!==oy.WALLET_CONNECT_V2||this.status!==ay.CONNECTING){if(this.status===ay.CONNECTING)throw k.notReady("Already connecting");if(this.status===ay.CONNECTED)throw x.connectionError("Already connected");if(this.status!==ay.READY)throw x.connectionError("Wallet adapter is not ready yet, Please wait for init function to resolve before calling connect/connectTo function")}}checkInitializationRequirements(){if(!this.clientId)throw k.invalidParams("Please initialize Web3Auth with a valid clientId in constructor");if(!this.chainConfig)throw k.invalidParams("rpcTarget is required in chainConfig");if(!this.chainConfig.rpcTarget&&this.chainConfig.chainNamespace!==v.OTHER)throw k.invalidParams("rpcTarget is required in chainConfig");if(!this.chainConfig.chainId&&this.chainConfig.chainNamespace!==v.OTHER)throw k.invalidParams("chainID is required in chainConfig");if(this.status!==ay.NOT_READY){if(this.status===ay.CONNECTED)throw k.notReady("Already connected");if(this.status===ay.READY)throw k.notReady("Adapter is already initialized")}}checkDisconnectionRequirements(){if(this.status!==ay.CONNECTED)throw x.disconnectionError("Not connected with wallet")}checkAddChainRequirements(e,t=!1){if(!t&&!this.provider)throw x.notConnectedError("Not connected with wallet.");if(this.currentChainNamespace!==e.chainNamespace)throw P.chainNamespaceNotAllowed("This adapter doesn't support this chainNamespace")}checkSwitchChainRequirements({chainId:e},t=!1){if(!t&&!this.provider)throw x.notConnectedError("Not connected with wallet.");if(!this.knownChainConfigs[e])throw x.chainConfigNotAdded("Invalid chainId")}updateAdapterData(e){this.adapterData=e,this.emit(cy.ADAPTER_DATA_UPDATED,{adapterName:this.name,data:e})}addChainConfig(e){const t=this.knownChainConfigs[e.chainId];this.knownChainConfigs[e.chainId]=w(w({},t||{}),e)}getChainConfig(e){return this.knownChainConfigs[e]||null}}var hy=C().getLogger("web3auth-logger");class ly extends Error{}function dy(e){let t,r=!1,n=0;try{t=window[e],r=!0,n=t.length;const i="__storage_test__";return t.setItem(i,i),t.removeItem(i),!0}catch(e){const t=e;return!(!t||22!==t.code&&1014!==t.code&&"QuotaExceededError"!==t.name&&"NS_ERROR_DOM_QUOTA_REACHED"!==t.name||!r||0===n)}}ly.prototype.name="InvalidTokenError";const fy=e=>{let t=e.toLowerCase();return t=t.split("|")[0],t=t.replace(/-/g," "),t=t.replace(/\s+/g," "),t=t.replace(/wallet$/i,"").trim(),t=t.replace(/\s/g,"-"),t},py=e=>{const t=function(e,t){if("string"!=typeof e)throw new ly("Invalid token specified: must be a string");t||(t={});const r=!0===t.header?0:1,n=e.split(".")[r];if("string"!=typeof n)throw new ly(`Invalid token specified: missing part #${r+1}`);let i;try{i=function(e){let t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw new Error("base64 string is not of the correct length")}try{return function(e){return decodeURIComponent(atob(e).replace(/(.)/g,((e,t)=>{let r=t.charCodeAt(0).toString(16).toUpperCase();return r.length<2&&(r="0"+r),"%"+r})))}(t)}catch(e){return atob(t)}}(n)}catch(e){throw new ly(`Invalid token specified: invalid base64 for part #${r+1} (${e.message})`)}try{return JSON.parse(i)}catch(e){throw new ly(`Invalid token specified: invalid json for part #${r+1} (${e.message})`)}}(e);return!t.exp||t.exp<Math.floor(Date.now()/1e3)},gy=(e,t)=>dy("localStorage")?localStorage.getItem(`${e.toLowerCase()}_${t}`):null,yy=(e,t,r)=>dy("localStorage")?localStorage.setItem(`${e.toLowerCase()}_${t}`,r):null;var by=r(8649),my=r.n(by);let wy=function(e){return e.ETH_SEND_TRANSACTION="eth_sendTransaction",e.ETH_SIGN_TRANSACTION="eth_signTransaction",e.ETH_SIGN="eth_sign",e.PERSONAL_SIGN="personal_sign",e.ETH_SIGN_TYPED_DATA="eth_signTypedData",e.ETH_SIGN_TYPED_DATA_V3="eth_signTypedData_v3",e.ETH_SIGN_TYPED_DATA_V4="eth_signTypedData_v4",e.ADD_ETHEREUM_CHAIN="wallet_addEthereumChain",e.SWITCH_ETHEREUM_CHAIN="wallet_switchEthereumChain",e}({}),vy=function(e){return e.SIGN_TRANSACTION="solana_signTransaction",e.SIGN_MESSAGE="solana_signMessage",e}({}),Sy=function(e){return e.ETH_CHAIN_CHANGED="chainChanged",e.ETH_ACCOUNTS_CHANGED="accountsChanged",e}({}),_y=function(e){return e.SOL_CHAIN_CHANGED="chainChanged",e.SOL_ACCOUNTS_CHANGED="accountsChanged",e}({});const Ey={"0x65":"5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp","0x66":"4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z","0x67":"EtWTRABZaYq6iMfeYKouRu166VU2xqa1"},Iy=e=>{const{document:t}=e,r=t.querySelector('head > meta[property="og:site_name"]');if(r)return r.content;const n=t.querySelector('head > meta[name="title"]');return n?n.content:t.title&&t.title.length>0?t.title:e.location.hostname};function Ay(e){return new Promise(((t,r)=>{try{const r=document.createElement("img");r.onload=()=>t(!0),r.onerror=()=>t(!1),r.src=e}catch(e){r(e)}}))}async function ky(e){const{document:t}=e;let r=t.querySelector('head > link[rel="shortcut icon"]');return r&&await Ay(r.href)?r.href:(r=Array.from(t.querySelectorAll('head > link[rel="icon"]')).find((e=>Boolean(e.href)))||null,r&&await Ay(r.href)?r.href:null)}const xy=e=>{switch(e){case v.EIP155:return Object.values(wy);case v.SOLANA:return Object.values(vy);default:throw new Error(`No default methods for namespace: ${e}`)}},Py=e=>{switch(e){case v.EIP155:return Object.values(Sy);case v.SOLANA:return Object.values(_y);default:throw new Error(`No default events for namespace: ${e}`)}},Oy=e=>{const t=(e=>{const t=[];return e.forEach((e=>{const[r]=e.split(":");t.includes(r)||t.push(r)})),t})(e);return Object.fromEntries(t.map((t=>[t,{methods:xy(t),chains:e.filter((e=>e.startsWith(t))),events:Py(t)}])))};var Ry=r(3551),Ty=r.n(Ry);const Ny=-32e3,My=-32001,Cy=-32002,By=-32003,Ly=-32004,Uy=-32005,Dy=-32700,jy=-32600,zy=-32601,qy=-32602,$y=-32603,Ky=4900,Fy={"-32700":{standard:"JSON RPC 2.0",message:"Invalid JSON was received by the server. An error occurred on the server while parsing the JSON text."},"-32600":{standard:"JSON RPC 2.0",message:"The JSON sent is not a valid Request object."},"-32601":{standard:"JSON RPC 2.0",message:"The method does not exist / is not available."},"-32602":{standard:"JSON RPC 2.0",message:"Invalid method parameter(s)."},"-32603":{standard:"JSON RPC 2.0",message:"Internal JSON-RPC error."},"-32000":{standard:"EIP-1474",message:"Invalid input."},"-32001":{standard:"EIP-1474",message:"Resource not found."},"-32002":{standard:"EIP-1474",message:"Resource unavailable."},"-32003":{standard:"EIP-1474",message:"Transaction rejected."},"-32004":{standard:"EIP-1474",message:"Method not supported."},"-32005":{standard:"EIP-1474",message:"Request limit exceeded."},4001:{standard:"EIP-1193",message:"User rejected the request."},4100:{standard:"EIP-1193",message:"The requested account and/or method has not been authorized by the user."},4200:{standard:"EIP-1193",message:"The requested method is not supported by this Ethereum provider."},4900:{standard:"EIP-1193",message:"The provider is disconnected from all chains."},4901:{standard:"EIP-1193",message:"The provider is disconnected from the specified chain."}},Wy="Unspecified error message. This is a bug, please report it.",Hy="Unspecified server error.";function Vy(e){return Number.isInteger(e)}function Gy(e){return"string"==typeof e&&e.length>0}function Yy(e){return Boolean(e)&&"object"==typeof e&&!Array.isArray(e)}function Jy(e){const t=e;return!(!t||!Vy(t.code)||!Gy(t.message)||t.stack&&!Gy(t.stack))}function Xy(e,t=Wy){if(Vy(e)){const t=e.toString();if(Object.hasOwn(Fy,t))return Fy[t].message;if(function(e){return e>=-32099&&e<=-32e3}(e))return Hy}return t}const Zy={code:$y,message:Xy($y)};function Qy(e){try{JSON.parse(JSON.stringify(e,((e,t)=>{if("__proto__"===e||"constructor"===e)throw new Error("Not valid json");if("function"==typeof t||"symbol"==typeof t)throw new Error("Not valid json");return t})),((e,t)=>{if("__proto__"!==e&&"constructor"!==e)return t}))}catch(e){return!1}return!0}function eb(e){return Object.getOwnPropertyNames(e).reduce(((t,r)=>{const n=e[r];return Qy(n)&&(t[r]=n),t}),{})}function tb(e){return Array.isArray(e)?e.map((e=>Qy(e)?e:Yy(e)?eb(e):null)):Yy(e)?eb(e):Qy(e)?e:null}function rb(e,{fallbackError:t=Zy,shouldIncludeStack:r=!0}={}){if(!Jy(t))throw new Error("Must provide fallback error with integer number code and string message.");const n=function(e,t){if(e&&"object"==typeof e&&"serialize"in e&&"function"==typeof e.serialize)return e.serialize();if(Jy(e))return e;const r=tb(e);return w(w({},t),{},{data:{cause:r}})}(e,t);return r||delete n.stack,n}function nb(e,t){if("[Circular]"!==t)return t}class ib extends Error{constructor(e,t,r){if(!Number.isInteger(e))throw new Error('"code" must be an integer.');if(!t||"string"!=typeof t)throw new Error('"message" must be a non-empty string.');!function(e){return Yy(e)&&Object.hasOwn(e,"cause")&&Yy(e.cause)}(r)?(super(t),b(this,"cause",void 0),b(this,"code",void 0),b(this,"data",void 0)):(super(t,{cause:r.cause}),b(this,"cause",void 0),b(this,"code",void 0),b(this,"data",void 0),Object.hasOwn(this,"cause")||Object.assign(this,{cause:r.cause})),void 0!==r&&(this.data=r),this.code=e,this.cause=null==r?void 0:r.cause}serialize(){const e={code:this.code,message:this.message};return void 0!==this.data&&(e.data=this.data,function(e){if("object"!=typeof e||null===e)return!1;try{let t=e;for(;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}catch(e){return!1}}(this.data)&&(e.data.cause=tb(this.data.cause))),this.stack&&(e.stack=this.stack),e}toString(){return Ty()(this.serialize(),{replacer:nb,space:2})}}class ob extends ib{constructor(e,t,r){if(!function(e){return Number.isInteger(e)&&e>=1e3&&e<=4999}(e))throw new Error('"code" must be an integer such that: 1000 <= code <= 4999');super(e,t,r)}}function sb(e){if(e){if("string"==typeof e)return[e];if("object"==typeof e&&!Array.isArray(e)){const{message:t,data:r}=e;if(t&&"string"!=typeof t)throw new Error("Must specify string message.");return[null!=t?t:void 0,r]}}return[]}function ab(e,t){const[r,n]=sb(t);return new ib(e,null!=r?r:Xy(e),n)}function cb(e,t){const[r,n]=sb(t);return new ob(e,null!=r?r:Xy(e),n)}const ub={parse:e=>ab(Dy,e),invalidRequest:e=>ab(jy,e),invalidParams:e=>ab(qy,e),methodNotFound:e=>ab(zy,e),internal:e=>ab($y,e),server:e=>{if(!e||"object"!=typeof e||Array.isArray(e))throw new Error("Ethereum RPC Server errors must provide single object argument.");const{code:t}=e;if(!Number.isInteger(t)||t>-32005||t<-32099)throw new Error('"code" must be an integer such that: -32099 <= code <= -32005');return ab(t,e)},invalidInput:e=>ab(Ny,e),resourceNotFound:e=>ab(My,e),resourceUnavailable:e=>ab(Cy,e),transactionRejected:e=>ab(By,e),methodNotSupported:e=>ab(Ly,e),limitExceeded:e=>ab(Uy,e)},hb=e=>cb(Ky,e),lb=e=>{if(!e||"object"!=typeof e||Array.isArray(e))throw new Error("Ethereum Provider custom errors must provide single object argument.");const{code:t,message:r,data:n}=e;if(!r||"string"!=typeof r)throw new Error('"message" must be a nonempty string');return new ob(t,r,n)};r(1432);const db=C().getLogger("auth");db.setLevel("error");class fb extends Error{constructor({code:e,message:t,data:r}){if(!Number.isInteger(e))throw new Error("code must be an integer");if(!t||"string"!=typeof t)throw new Error("message must be string");super(t),b(this,"code",void 0),b(this,"data",void 0),this.code=e,void 0!==r&&(this.data=r)}toString(){return Ty()({code:this.code,message:this.message,data:this.data,stack:this.stack})}}function pb(e){const{message:t="",code:r=-32603,stack:n="Stack trace is not available.",data:i=""}=e,o=parseInt((null==r?void 0:r.toString())||"-32603");return{message:t||(null==e?void 0:e.toString())||Xy(o),code:o,stack:n,data:i||t||(null==e?void 0:e.toString())}}class gb extends Qg{constructor(){super(),b(this,"_middleware",void 0),this._middleware=[]}static async _runAllMiddleware(e,t,r){const n=[];let i=null,o=!1;for(const s of r)if([i,o]=await gb._runMiddleware(e,t,s,n),o)break;return[i,o,n.reverse()]}static _runMiddleware(e,t,r,n){return new Promise((i=>{const o=e=>{const r=e||t.error;r&&("object"==typeof r&&!1===Object.keys(r).includes("stack")&&(r.stack="Stack trace is not available."),db.error(r),t.error=rb(r,{shouldIncludeStack:!0,fallbackError:pb(r)})),i([r,!0])},s=e=>{t.error?o(t.error):(e&&("function"!=typeof e&&o(new fb({code:-32603,message:"JRPCEngine: 'next' return handlers must be functions"})),n.push(e)),i([null,!1]))};try{r(e,t,s,o)}catch(e){o(e)}}))}static async _runReturnHandlers(e){for(const t of e)await new Promise(((e,r)=>{t((t=>t?r(t):e()))}))}static _checkForCompletion(e,t,r){if(!("result"in t)&&!("error"in t))throw new fb({code:-32603,message:"Response has no error or result for request"});if(!r)throw new fb({code:-32603,message:"Nothing ended request"})}push(e){this._middleware.push(e)}handle(e,t){if(t&&"function"!=typeof t)throw new Error('"callback" must be a function if provided.');return Array.isArray(e)?t?this._handleBatch(e,t):this._handleBatch(e):t?this._handle(e,t):this._promiseHandle(e)}asMiddleware(){return async(e,t,r,n)=>{try{const[i,o,s]=await gb._runAllMiddleware(e,t,this._middleware);return o?(await gb._runReturnHandlers(s),n(i)):r((async e=>{try{await gb._runReturnHandlers(s)}catch(t){return e(t)}return e()}))}catch(e){return n(e)}}}async _handleBatch(e,t){try{const r=await Promise.all(e.map(this._promiseHandle.bind(this)));return t?t(null,r):r}catch(e){if(t)return t(e);throw e}}_promiseHandle(e){return new Promise(((t,r)=>{this._handle(e,((e,n)=>{e&&void 0===n?r(e):t(n)})).catch(r)}))}async _handle(e,t){if(!e||Array.isArray(e)||"object"!=typeof e){const e=new fb({code:-32603,message:"request must be plain object"});return t(e,{id:void 0,jsonrpc:"2.0",error:e})}if("string"!=typeof e.method){const r=new fb({code:-32603,message:"method must be string"});return t(r,{id:e.id,jsonrpc:"2.0",error:r})}const r=w({},e),n={id:r.id,jsonrpc:r.jsonrpc};let i=null;try{await this._processRequest(r,n)}catch(e){i=e}return i&&(delete n.result,n.error||("object"==typeof i&&!1===Object.keys(i).includes("stack")&&(i.stack="Stack trace is not available."),db.error(i),n.error=rb(i,{shouldIncludeStack:!0,fallbackError:pb(i)}))),t(i,n)}async _processRequest(e,t){const[r,n,i]=await gb._runAllMiddleware(e,t,this._middleware);if(gb._checkForCompletion(e,t,n),await gb._runReturnHandlers(i),r)throw r}}function yb(e){const t=new gb;return e.forEach((e=>{t.push(e)})),t.asMiddleware()}function bb(e){const t=new Qg;return t.sendAsync=async t=>{const r=await e.handle(t);if(r.error){"object"==typeof r.error&&!1===Object.keys(r.error).includes("stack")&&(r.error.stack="Stack trace is not available."),db.error(r.error);const e=rb(r.error,{fallbackError:pb(r.error),shouldIncludeStack:!0});throw ub.internal(e)}return r.result},t.send=(t,r)=>{if("function"!=typeof r)throw new Error('Must provide callback to "send" method.');e.handle(t,r)},e.on&&e.on("notification",(e=>{t.emit("data",null,e)})),t.request=async e=>{const r=w(w({},e),{},{id:Math.random().toString(36).slice(2),jsonrpc:"2.0"});return await t.sendAsync(r)},t}class mb extends Qg{constructor({config:e={},state:t={}}){super(),b(this,"defaultConfig",{}),b(this,"defaultState",{}),b(this,"disabled",!1),b(this,"name","BaseController"),b(this,"initialConfig",void 0),b(this,"initialState",void 0),b(this,"internalConfig",this.defaultConfig),b(this,"internalState",this.defaultState),this.initialState=t,this.initialConfig=e}get config(){return this.internalConfig}get state(){return this.internalState}configure(e,t=!1,r=!0){if(r){this.internalConfig=t?e:Object.assign(this.internalConfig,e);for(const e in this.internalConfig)void 0!==this.internalConfig[e]&&(this[e]=this.internalConfig[e])}else for(const t in e)void 0!==this.internalConfig[t]&&(this.internalConfig[t]=e[t],this[t]=e[t])}update(e,t=!1){this.internalState=w(t?{}:w({},this.internalState),e),this.emit("store",this.internalState)}initialize(){return this.internalState=this.defaultState,this.internalConfig=this.defaultConfig,this.configure(this.initialConfig),this.update(this.initialState),this}}const wb=()=>!0,vb=["newListener","removeListener"],Sb=e=>!vb.includes(e);class _b extends mb{constructor({config:e,state:t}){if(super({config:e,state:t}),b(this,"_providerEngineProxy",null),b(this,"keyExportFlagSetByCode",!1),!e.chainConfig)throw k.invalidProviderConfigError("Please provide chainConfig");if(!e.chainConfig.chainId)throw k.invalidProviderConfigError("Please provide chainId inside chainConfig");if(!e.chainConfig.rpcTarget)throw k.invalidProviderConfigError("Please provide rpcTarget inside chainConfig");"boolean"==typeof e.keyExportEnabled&&(this.keyExportFlagSetByCode=!0),this.defaultState={chainId:"loading"},this.defaultConfig={chainConfig:e.chainConfig,networks:{[e.chainConfig.chainId]:e.chainConfig},keyExportEnabled:"boolean"!=typeof e.keyExportEnabled||e.keyExportEnabled},super.initialize()}get currentChainConfig(){return this.config.chainConfig}get provider(){return this._providerEngineProxy}get chainId(){return this.state.chainId}set provider(e){throw new Error("Method not implemented.")}async request(e){var t;if(!e||"object"!=typeof e||Array.isArray(e))throw ub.invalidRequest({message:O.invalidRequestArgs().message,data:w(w({},e||{}),{},{cause:O.invalidRequestArgs().message})});const{method:r,params:n}=e;if("string"!=typeof r||0===r.length)throw ub.invalidRequest({message:O.invalidRequestMethod().message,data:w(w({},e||{}),{},{cause:O.invalidRequestMethod().message})});if(void 0!==n&&!Array.isArray(n)&&("object"!=typeof n||null===n))throw ub.invalidRequest({message:O.invalidRequestParams().message,data:w(w({},e||{}),{},{cause:O.invalidRequestParams().message})});return null===(t=this.provider)||void 0===t?void 0:t.request(e)}sendAsync(e,t){return t?this.send(e,t):this.request(e)}send(e,t){this.request(e).then((e=>t(null,{result:e}))).catch((e=>t(e,null)))}addChain(e){if(!e.chainId)throw ub.invalidParams("chainId is required");if(!e.rpcTarget)throw ub.invalidParams("chainId is required");this.configure({networks:w(w({},this.config.networks),{},{[e.chainId]:e})})}getChainConfig(e){var t;const r=null===(t=this.config.networks)||void 0===t?void 0:t[e];if(!r)throw ub.invalidRequest(`Chain ${e} is not supported, please add chainConfig for it`);return r}updateProviderEngineProxy(e){this._providerEngineProxy?this._providerEngineProxy.setTarget(e):this._providerEngineProxy=function(e){let t={}.eventFilter||wb;if("string"==typeof t&&"skipInternal"===t&&(t=Sb),"function"!=typeof t)throw new Error("createEventEmitterProxy - Invalid eventFilter");let r=e,n=e=>{if(r===e)return;const n=r;r=e,n.eventNames().filter(t).forEach((t=>{(function(e,t){return void 0!==e.rawListeners?e.rawListeners(t):e.listeners(t)})(n,t).forEach((r=>{e.on(t,r)}))})),n.removeAllListeners()};return new Proxy({},{get:(e,t)=>"setTarget"===t?n:r[t],set:(e,t,i)=>"setTarget"===t?(n=i,!0):(r[t]=i,!0),has:(e,t)=>"_"!==t[0]&&t in r})}(e)}setKeyExportFlag(e){this.keyExportFlagSetByCode||this.configure({keyExportEnabled:e})}getProviderEngineProxy(){return this._providerEngineProxy}}function Eb(e){return(t,r,n,i)=>{const o=e[t.method];return void 0===o?n():"function"==typeof o?o(t,r,n,i):(r.result=o,i())}}function Ib(e){return async(t,r,n,i)=>{let o;const s=new Promise((e=>{o=e}));let a=null,c=!1;const u=async()=>{c=!0,n((e=>{a=e,o()})),await s};try{await e(t,r,u),c?(await s,a(null)):i(null)}catch(e){const t=e;a?a(t):i(t)}}}function Ab({getAccounts:e,getPrivateKey:t,getPublicKey:r,processEthSignMessage:n,processPersonalMessage:i,processTransaction:o,processSignTransaction:s,processTypedMessageV4:a}){if(!e)throw new Error("opts.getAccounts is required");async function c(t,r){if("string"==typeof t&&t.length>0){const n=(await e(r)).map((e=>e.toLowerCase())),i=t.toLowerCase();if(n.includes(i))return i}throw ub.invalidParams({message:"Invalid parameters: must provide an Ethereum address."})}async function u(t,r){r.result=await e(t)}async function h(e,r){if(!t)throw ub.methodNotSupported();r.result=await t(e)}async function l(e,t){if(!r)throw ub.methodNotSupported();t.result=await r(e)}return Eb({eth_accounts:Ib(u),eth_requestAccounts:Ib(u),eth_private_key:Ib(h),eth_public_key:Ib(l),public_key:Ib(l),private_key:Ib(h),eth_sendTransaction:Ib((async function(e,t){if(!o)throw ub.methodNotSupported();const r=e.params[0]||{from:""};r.from=await c(r.from,e),t.result=await o(r,e)})),eth_signTransaction:Ib((async function(e,t){if(!s)throw ub.methodNotSupported();const r=e.params[0]||{from:""};r.from=await c(r.from,e),t.result=await s(r,e)})),eth_sign:Ib((async function(e,t){if(!n)throw ub.methodNotSupported();let r=e.params;const i=e.params[2]||{};if(Array.isArray(e.params)){if(2!==e.params.length)throw new Error(`WalletMiddleware - incorrect params for ${e.method} method. expected [address, message]`);const t=e.params;r={from:t[0],data:t[1]}}r=w(w({},i),r),t.result=await n(r,e)})),eth_signTypedData_v4:Ib((async function(e,t){if(!a)throw ub.methodNotSupported();if(null==e||!e.params)throw new Error("WalletMiddleware - missing params");let r=e.params;if(Array.isArray(e.params)){if(2!==e.params.length)throw new Error(`WalletMiddleware - incorrect params for ${e.method} method. expected [address, typedData]`);const t=e.params;r={from:t[0],data:t[1]}}t.result=await a(r,e)})),personal_sign:Ib((async function(e,t){if(!i)throw ub.methodNotSupported();let r=e.params;const n=e.params[2]||{};if(Array.isArray(e.params)){if(!(e.params.length>=2))throw new Error(`WalletMiddleware - incorrect params for ${e.method} method. expected [message, address]`);const t=e.params;if("object"==typeof t[0]){const{challenge:e,address:n}=t[0];r={from:n,data:e}}else{const e=t[0];r={from:t[1],data:e}}}r=w(w({},n),r),t.result=await i(r,e)}))})}const kb=["Gateway timeout","ETIMEDOUT","failed to parse response body","Failed to fetch"];function xb(e){switch(e.status){case 405:throw ub.methodNotFound();case 418:throw ub.internal({message:"Request is being rate limited.",data:{cause:e}});case 503:case 504:throw ub.internal({message:"Gateway timeout. The request took too long to process.This can happen when querying over too wide a block range.",data:{cause:e}})}}function Pb(e){return new Promise((t=>{setTimeout(t,e)}))}function Ob(e,t){if(200!==e.status)throw ub.internal({message:`Non-200 status code: '${e.status}'`,data:t});var r;if(t.error)throw ub.internal({data:t.error,message:null===(r=t.error)||void 0===r?void 0:r.message});return t.result}function Rb({rpcTarget:e,originHttpHeaderKey:t}){return Ib((async(r,n,i)=>{const{fetchUrl:o,fetchParams:s}=function({req:e,rpcTarget:t,originHttpHeaderKey:r}){const n=new URL(t),i={id:e.id,jsonrpc:e.jsonrpc,method:e.method,params:e.params},o=e.origin,s={method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(i)};return r&&o&&(s.headers[r]=o),{fetchUrl:n.href,fetchParams:s}}({req:r,rpcTarget:e,originHttpHeaderKey:t});for(let e=0;e<5;e++){try{const e=await fetch(o,s);xb(e);const t=await e.json(),r=Ob(e,t);return void(n.result=r)}catch(e){const t=(e.message||e).toString();if(!kb.some((e=>t.includes(e))))throw e}await Pb(1e3)}}))}function Tb(e){return(t,r,n,i)=>"eth_chainId"===t.method?(r.result=e,i()):n()}function Nb(e){return(t,r,n,i)=>"eth_provider_config"===t.method?(r.result=e,i()):n()}function Mb({getAccounts:e}){return Ib((async(t,r,n)=>{const{method:i}=t;if("getAccounts"!==i)return n();if(!e)throw new Error("WalletMiddleware - opts.getAccounts not provided");const o=await e(t);r.result=o}))}function Cb({requestAccounts:e}){return Ib((async(t,r,n)=>{const{method:i}=t;if("requestAccounts"!==i)return n();if(!e)throw new Error("WalletMiddleware - opts.requestAccounts not provided");const o=await e(t);r.result=o}))}function Bb(e,t){return Ib((async(r,n,i)=>{const{method:o}=r;if(o!==e)return i();if(!t)throw new Error(`WalletMiddleware - ${e} not provided`);const s=await t(r);n.result=s}))}function Lb(e){return(t,r,n,i)=>"solana_chainId"===t.method?(r.result=e,i()):n()}function Ub(e){return(t,r,n,i)=>"solana_provider_config"===t.method?(r.result=e,i()):n()}function Db(e){const{chainId:t}=e;return yb([Lb(t),Ub(e)])}var jb,zb=r(1429).Buffer;async function qb(e){if(e.session.length){const t=e.session.keys.length-1;return e.session.get(e.session.keys[t])}return null}function $b(e){return e.startsWith("solana:")}async function Kb(e,t,r,n){const i=await qb(e);if(!i)throw hb();return"undefined"!=typeof window&&/Mobi|Android|iPhone|iPad|iPod|Opera Mini|IEMobile|WPDesktop/i.test(window.navigator.userAgent)&&i.peer.metadata.redirect&&i.peer.metadata.redirect.native&&window.open(i.peer.metadata.redirect.native,"_blank"),e.request({topic:i.topic,chainId:t,request:{method:r,params:$b(t)?w(w({},n),{},{pubkey:i.self.publicKey}):n}})}async function Fb(e){const t=await qb(e);if(!t)throw hb();const r=nc(t.namespaces);if(r&&r.length)return[...new Set(r.map((e=>rc(e).address)))];throw x.connectionError("Failed to get accounts")}class Wb extends _b{constructor({clientId:e,config:t,state:r,connector:n}){super({config:{chainConfig:t.chainConfig,skipLookupNetwork:!!t.skipLookupNetwork},state:w(w({},r||{}),{},{chainId:"loading",accounts:[]})}),b(this,"connector",null),b(this,"clientId",void 0),this.connector=n||null,this.clientId=e}async enable(){if(!this.connector)throw lb({message:"Connector is not initialized, pass wallet connect connector in constructor",code:4902});return await this.setupProvider(this.connector),this._providerEngineProxy.request({method:"eth_accounts"})}async setupProvider(e){this.onConnectorStateUpdate(e),await this.setupEngine(e)}async switchChain({chainId:e}){if(!this.connector)throw lb({message:"Connector is not initialized, pass wallet connect connector in constructor",code:4902});const t=this.getChainConfig(e),{chainId:r}=this.config.chainConfig,n=parseInt(r,16);await async function({connector:e,chainId:t,newChainId:r}){await Kb(e,`eip155:${t}`,"wallet_switchEthereumChain",[{chainId:r}])}({connector:this.connector,chainId:n,newChainId:e}),this.configure({chainConfig:t}),await this.setupEngine(this.connector),this.lookupNetwork(this.connector)}async addChain(e){const{chainId:t}=this.config.chainConfig,r=parseInt(t,16);await async function({connector:e,chainId:t,chainConfig:r}){await Kb(e,`eip155:${t}`,"wallet_addEthereumChain",[r])}({connector:this.connector,chainId:r,chainConfig:{chainId:e.chainId,chainName:e.displayName,nativeCurrency:{name:e.tickerName,symbol:e.ticker.toLocaleUpperCase(),decimals:e.decimals||18},rpcUrls:[e.rpcTarget],blockExplorerUrls:[e.blockExplorerUrl],iconUrls:[e.logo]}}),super.addChain(e)}async lookupNetwork(e){const t=this.config.chainConfig.chainId;return this.update({chainId:t}),this.emit("chainChanged",t),this.emit("connect",{chainId:t}),this.config.chainConfig.chainId}async setupEngine(e){if(this.config.chainConfig.chainNamespace===v.EIP155)return this.setupEthEngine(e);if(this.config.chainConfig.chainNamespace===v.SOLANA)return this.setupSolEngine(e);throw new Error(`Unsupported chainNamespace: ${this.config.chainConfig.chainNamespace}`)}async setupEthEngine(e){const{chainId:t}=this.config.chainConfig,r=function({connector:e,chainId:t}){return{getPrivateKey:async()=>{throw ub.methodNotSupported()},getPublicKey:async()=>{throw ub.methodNotSupported()},getAccounts:async t=>Fb(e),processTransaction:async(r,n)=>await Kb(e,`eip155:${t}`,"eth_sendTransaction",[r]),processSignTransaction:async(r,n)=>await Kb(e,`eip155:${t}`,"eth_signTransaction",[r]),processEthSignMessage:async(r,n)=>await Kb(e,`eip155:${t}`,"eth_sign",[r.from,r.data]),processPersonalMessage:async(r,n)=>await Kb(e,`eip155:${t}`,"personal_sign",[r.data,r.from]),processTypedMessageV4:async r=>await Kb(e,`eip155:${t}`,"eth_signTypedData_v4",[r.from,r.data])}}({connector:e,chainId:parseInt(t,16)}),n=await Fb(e);this.update({accounts:n||[]});const i=function(e){const{getAccounts:t,getPrivateKey:r,getPublicKey:n,processTransaction:i,processSignTransaction:o,processEthSignMessage:s,processTypedMessageV4:a,processPersonalMessage:c}=e;return yb([Eb({eth_syncing:!1}),Ab({getAccounts:t,getPrivateKey:r,getPublicKey:n,processTransaction:i,processEthSignMessage:s,processSignTransaction:o,processTypedMessageV4:a,processPersonalMessage:c})])}(r),o=this.getEthChainSwitchMiddleware(),s=new gb,{networkMiddleware:a}=function(e){const{chainId:t,rpcTarget:r}=e,n=Rb({rpcTarget:r});return{networkMiddleware:yb([Tb(t),Nb(e),n]),fetchMiddleware:n}}(this.config.chainConfig);s.push(i),s.push(o),s.push(a);const c=bb(s);this.updateProviderEngineProxy(c)}async setupSolEngine(e){const{chainId:t}=this.config.chainConfig,n=function({connector:e,chainId:t}){return{requestAccounts:async t=>Fb(e),getPrivateKey:async()=>{throw ub.methodNotSupported()},getSecretKey:async()=>{throw ub.methodNotSupported()},getPublicKey:async()=>{throw ub.methodNotSupported()},getAccounts:async t=>Fb(e),signAllTransactions:async e=>{throw ub.methodNotSupported()},signAndSendTransaction:async e=>{throw ub.methodNotSupported()},signMessage:async r=>{const n=await Kb(e,`solana:${Ey[t]}`,"solana_signMessage",{message:my().encode(r.params.message)});return my().decode(n.signature)},signTransaction:async n=>{const[{PublicKey:i},o]=await Promise.all([Promise.resolve().then(r.bind(r,3893)),Fb(e)]);if(0===o.length)throw hb();const s=await Kb(e,`solana:${Ey[t]}`,"solana_signTransaction",{transaction:n.params.message.serialize({requireAllSignatures:!1}).toString("base64")}),a=n.params.message;return a.addSignature(new i(o[0]),zb.from(my().decode(s.signature))),a}}}({connector:e,chainId:t}),i=await Fb(e);this.update({accounts:i||[]});const o=function(e){const{getAccounts:t,requestAccounts:r,signTransaction:n,signAndSendTransaction:i,signAllTransactions:o,signMessage:s,getPrivateKey:a,getSecretKey:c,getPublicKey:u}=e;return yb([Cb({requestAccounts:r}),Mb({getAccounts:t}),Bb("signTransaction",n),Bb("signAndSendTransaction",i),Bb("signAllTransactions",o),Bb("signMessage",s),Bb("solanaPrivateKey",a),Bb("private_key",a),Bb("public_key",u),Bb("solanaPublicKey",u),Bb("solanaSecretKey",c)])}(n),s=new gb,{networkMiddleware:a}=function(e){const{rpcTarget:t}=e,r=Rb({rpcTarget:t});return{networkMiddleware:yb([Db(e),r]),fetchMiddleware:r}}(this.config.chainConfig);s.push(o),s.push(a);const c=bb(s);this.updateProviderEngineProxy(c)}getEthChainSwitchMiddleware(){return function({addChain:e,switchChain:t}){return Eb({wallet_addEthereumChain:Ib((async function(t,r){var n;const i=null!==(n=t.params)&&void 0!==n&&n.length?t.params[0]:void 0;if(!i)throw ub.invalidParams("Missing chain params");if(!i.chainId)throw ub.invalidParams("Missing chainId in chainParams");if(!i.rpcUrls||0===i.rpcUrls.length)throw ub.invalidParams("Missing rpcUrls in chainParams");if(!i.nativeCurrency)throw ub.invalidParams("Missing nativeCurrency in chainParams");r.result=await e(i)})),wallet_switchEthereumChain:Ib((async function(e,r){var n;const i=null!==(n=e.params)&&void 0!==n&&n.length?e.params[0]:void 0;if(!i)throw ub.invalidParams("Missing chainId");r.result=await t(i)}))})}({addChain:async e=>{const{chainId:t,chainName:r,rpcUrls:n,blockExplorerUrls:i,nativeCurrency:o,iconUrls:s}=e;this.addChain({chainNamespace:v.EIP155,chainId:t,ticker:(null==o?void 0:o.symbol)||"ETH",tickerName:(null==o?void 0:o.name)||"Ether",displayName:r,rpcTarget:n[0],blockExplorerUrl:(null==i?void 0:i[0])||"",decimals:(null==o?void 0:o.decimals)||18,logo:(null==s?void 0:s[0])||"https://images.toruswallet.io/eth.svg"})},switchChain:async e=>{const{chainId:t}=e;await this.switchChain({chainId:t})}})}connectedTopic(){var e;if(!this.connector)throw x.notConnectedError("Wallet connect connector is not connected");if(null!==(e=this.connector)&&void 0!==e&&null!==(e=e.session)&&void 0!==e&&e.length){var t;const e=this.connector.session.keys.length-1;return null===(t=this.connector.session.get(this.connector.session.keys[e]))||void 0===t?void 0:t.topic}}checkIfAccountAllowed(e){if(!this.connector||!this.connectedTopic())return!1;const t=nc(this.connector.session.get(this.connectedTopic()).namespaces);let r=!1;for(const i of t){var n;if((null===(n=rc(i).address)||void 0===n?void 0:n.toLowerCase())===(null==e?void 0:e.toLowerCase())){r=!0;break}}return r}async onConnectorStateUpdate(e){e.events.on("session_event",(async t=>{if(hy.debug("session_event data",t),!this.provider)throw x.notConnectedError("Wallet connect connector is not connected");const{event:r}=t.params,{name:n,data:i}=r||{};if("accountsChanged"===n&&null!=i&&i.length&&this.state.accounts[0]!==i[0]&&this.checkIfAccountAllowed(i[0])&&(this.update({accounts:i}),this.emit("accountsChanged",i)),"chainChanged"===r.name){if(!i)return;const t=`0x${i.toString(16)}`;if(t&&this.state.chainId!==t){const r=R(v.EIP155,t,this.clientId);this.configure({chainConfig:w(w({},r),{},{chainId:t,chainNamespace:v.EIP155})}),await this.setupEngine(e)}}}))}}jb=Wb,b(Wb,"getProviderInstance",(async e=>{const t=new jb({clientId:e.clientId,config:{chainConfig:e.chainConfig,skipLookupNetwork:e.skipLookupNetwork}});return await t.setupProvider(e.connector),t}));var Hb=r(1429).Buffer;class Vb extends uy{constructor(e={}){super(e),b(this,"name",oy.WALLET_CONNECT_V2),b(this,"adapterNamespace","multichain"),b(this,"currentChainNamespace",v.OTHER),b(this,"type",sy),b(this,"adapterOptions",{}),b(this,"status",ay.NOT_READY),b(this,"adapterData",{uri:""}),b(this,"connector",null),b(this,"activeSession",null),b(this,"wcProvider",null),this.adapterOptions=w({},e),this.setAdapterSettings(e)}get connected(){return!!this.activeSession}get provider(){return this.status!==ay.NOT_READY&&this.wcProvider?this.wcProvider:null}set provider(e){throw new Error("Not implemented")}async init(e){var t,r,n;super.checkInitializationRequirements();const i=null===(t=this.adapterOptions.adapterSettings)||void 0===t||null===(t=t.walletConnectInitOptions)||void 0===t?void 0:t.projectId;if(!i)throw k.invalidParams("Wallet connect project id is required in wallet connect v2 adapter");const o=await(async(e,t,r)=>{if(e===v.EIP155||e===v.SOLANA){const n=await(async()=>({name:Iy(window),icon:await ky(window)}))(),i={walletConnectInitOptions:{projectId:r,relayUrl:"wss://relay.walletconnect.com",metadata:{name:n.name,description:n.name,url:window.location.origin,icons:[n.icon||""]}}},o=t.map((t=>`${e}:${e===v.SOLANA?Ey[t]:parseInt(t,16)}`));return{adapterSettings:i,loginSettings:{optionalNamespaces:Oy(o)}}}throw new Error(`Unsupported chain namespace: ${e}`)})(null===(r=this.chainConfig)||void 0===r?void 0:r.chainNamespace,[null===(n=this.chainConfig)||void 0===n?void 0:n.chainId],i);this.adapterOptions.loginSettings&&0!==Object.keys(this.adapterOptions.loginSettings).length||(this.adapterOptions.loginSettings=o.loginSettings),this.adapterOptions.adapterSettings=N()(o.adapterSettings||{},this.adapterOptions.adapterSettings||{});const{adapterSettings:s}=this.adapterOptions;if(this.connector=await Xg.init(null==s?void 0:s.walletConnectInitOptions),this.wcProvider=new Wb({clientId:this.clientId,config:{chainConfig:this.chainConfig},connector:this.connector}),this.emit(cy.READY,oy.WALLET_CONNECT_V2),this.status=ay.READY,hy.debug("initializing wallet connect v2 adapter"),e.autoConnect)if(await this.checkForPersistedSession(),this.connected){this.rehydrated=!0;try{await this.onConnectHandler()}catch(e){hy.error("wallet auto connect",e),this.emit(cy.ERRORED,e)}}else this.status=ay.NOT_READY,this.emit(cy.CACHE_CLEAR)}async connect(){if(super.checkConnectionRequirements(),!this.connector)throw k.notReady("Wallet adapter is not ready yet");try{return this.connected?(await this.onConnectHandler(),this.provider):(this.status!==ay.CONNECTING&&await this.createNewSession(),this.provider)}catch(e){throw hy.error("Wallet connect v2 adapter error while connecting",e),this.status=ay.READY,this.rehydrated=!0,this.emit(cy.ERRORED,e),e instanceof A?e:x.connectionError(`Failed to login with wallet connect: ${(null==e?void 0:e.message)||""}`,e)}}setAdapterSettings(e){var t,r,n,i,o;super.setAdapterSettings(e);const{qrcodeModal:s,walletConnectInitOptions:a}=(null==e?void 0:e.adapterSettings)||{};this.adapterOptions=w(w({},this.adapterOptions),{},{adapterSettings:null!==(t=null===(r=this.adapterOptions)||void 0===r?void 0:r.adapterSettings)&&void 0!==t?t:{},loginSettings:null!==(n=null===(i=this.adapterOptions)||void 0===i?void 0:i.loginSettings)&&void 0!==n?n:{}}),s&&(this.adapterOptions.adapterSettings.qrcodeModal=s),a&&(this.adapterOptions.adapterSettings.walletConnectInitOptions=w(w({},null!==(o=this.adapterOptions.adapterSettings.walletConnectInitOptions)&&void 0!==o?o:{}),a));const{loginSettings:c}=e;c&&(this.adapterOptions.loginSettings=w(w({},this.adapterOptions.loginSettings||{}),c))}async addChain(e,t=!1){var r;super.checkAddChainRequirements(e,t),await(null===(r=this.wcProvider)||void 0===r?void 0:r.addChain(e)),this.addChainConfig(e)}async switchChain(e,t=!1){var r;super.checkSwitchChainRequirements(e,t),await(null===(r=this.wcProvider)||void 0===r?void 0:r.switchChain({chainId:e.chainId})),this.setAdapterSettings({chainConfig:this.getChainConfig(e.chainId)})}async getUserInfo(){if(!this.connected)throw x.notConnectedError("Not connected with wallet, Please login/connect first");return{}}async disconnect(e={cleanup:!1,sessionRemovedByWallet:!1}){var t,r;const{cleanup:n}=e;if(!this.connector||!this.connected||null===(t=this.activeSession)||void 0===t||!t.topic)throw x.notConnectedError("Not connected with wallet");e.sessionRemovedByWallet||await this.connector.disconnect({topic:null===(r=this.activeSession)||void 0===r?void 0:r.topic,reason:yl("USER_DISCONNECTED")}),this.rehydrated=!1,n?(this.connector=null,this.status=ay.NOT_READY,this.wcProvider=null):this.status=ay.READY,this.activeSession=null,this.emit(cy.DISCONNECTED)}async authenticateUser(){if(!this.provider||this.status!==ay.CONNECTED)throw x.notConnectedError();const{chainNamespace:e,chainId:t}=this.chainConfig,r=await this.provider.request({method:e===v.EIP155?"eth_accounts":"getAccounts"});if(r&&r.length>0){const n=gy(r[0],this.name);if(n&&!py(n))return{idToken:n};const i={domain:window.location.origin,uri:window.location.href,address:r[0],chainId:parseInt(t,16),version:"1",nonce:Math.random().toString(36).slice(2),issuedAt:(new Date).toISOString()},o=await j(i,e),s=await this._getSignedMessage(o,r,e),a=await z(e,s,o,this.name,this.sessionTime,this.clientId,this.web3AuthNetwork);return yy(r[0],this.name,a),{idToken:a}}throw x.notConnectedError("Not connected with wallet, Please login/connect first")}async enableMFA(){throw new Error("Method Not implemented")}async manageMFA(){throw new Error("Method Not implemented")}cleanupPendingPairings(){if(!this.connector)throw k.notReady("Wallet adapter is not ready yet");const e=this.connector.pairing.getAll({active:!1});bl(e)&&e.forEach((e=>{this.connector&&this.connector.pairing.delete(e.topic,yl("USER_DISCONNECTED"))}))}async checkForPersistedSession(){if(!this.connector)throw k.notReady("Wallet adapter is not ready yet");if(this.connector.session.length){const e=this.connector.session.keys.length-1;this.activeSession=this.connector.session.get(this.connector.session.keys[e])}return this.activeSession}async createNewSession(e={forceNewSession:!1}){try{var t,r,n;if(!this.connector)throw k.notReady("Wallet adapter is not ready yet");if(!this.adapterOptions.loginSettings||0===Object.keys(this.adapterOptions.loginSettings).length)throw k.notReady("login settings are not set yet");this.status=ay.CONNECTING,this.emit(cy.CONNECTING,{adapter:oy.WALLET_CONNECT_V2}),e.forceNewSession&&null!==(t=this.activeSession)&&void 0!==t&&t.topic&&await this.connector.disconnect({topic:null===(n=this.activeSession)||void 0===n?void 0:n.topic,reason:yl("USER_DISCONNECTED")});const{uri:i,approval:o}=await this.connector.connect(this.adapterOptions.loginSettings),s=null===(r=this.adapterOptions)||void 0===r||null===(r=r.adapterSettings)||void 0===r?void 0:r.qrcodeModal;if(i)if(s)try{await s.openModal({uri:i}),hy.debug("EVENT","QR Code Modal closed"),this.status=ay.READY,this.emit(cy.READY,oy.WALLET_CONNECT_V2)}catch(e){hy.error("unable to open qr code modal")}else this.updateAdapterData({uri:i});hy.info("awaiting session approval from wallet");const a=await o();this.activeSession=a,await this.onConnectHandler(),s&&s.closeModal()}catch(e){var i;if(null!==(i=e.message)&&void 0!==i&&i.toLowerCase().includes("proposal expired")){if(hy.info("current adapter status: ",this.status),this.status===ay.CONNECTING)return hy.info("retrying to create new wallet connect session since proposal expired"),this.createNewSession({forceNewSession:!0});if(this.status===ay.READY)return void hy.info("ignoring proposal expired error since some other adapter is connected")}throw hy.error("error while creating new wallet connect session",e),this.emit(cy.ERRORED,e),e}}async onConnectHandler(){var e;if(!this.connector||!this.wcProvider)throw k.notReady("Wallet adapter is not ready yet");if(!this.chainConfig)throw k.invalidParams("Chain config is not set");this.subscribeEvents(),null!==(e=this.adapterOptions.adapterSettings)&&void 0!==e&&e.qrcodeModal&&(this.wcProvider=new Wb({clientId:this.clientId,config:{chainConfig:this.chainConfig,skipLookupNetwork:!0},connector:this.connector})),await this.wcProvider.setupProvider(this.connector),this.cleanupPendingPairings(),this.status=ay.CONNECTED,this.emit(cy.CONNECTED,{adapter:oy.WALLET_CONNECT_V2,reconnected:this.rehydrated,provider:this.provider})}subscribeEvents(){if(!this.connector)throw k.notReady("Wallet adapter is not ready yet");this.connector.events.on("session_update",(({topic:e,params:t})=>{if(!this.connector)return;const{namespaces:r}=t,n=w(w({},this.connector.session.get(e)),{},{namespaces:r});this.activeSession=n})),this.connector.events.on("session_delete",(()=>{this.disconnect({sessionRemovedByWallet:!0})}))}async _getSignedMessage(e,t,r){const n=await this.provider.request({method:r===v.EIP155?"personal_sign":"signMessage",params:r===v.EIP155?[e,t[0]]:{message:Hb.from(e)}});return r===v.SOLANA?my().encode(n):n}}function Gb(){const e=new Set;let t=[];const r=()=>function(){if("undefined"==typeof window)return;const r=r=>{return n=r.detail,void(t.some((({info:e})=>e.uuid===n.info.uuid))||(t=[...t,n],e.forEach((e=>e(t,{added:[n]})))));var n};return window.addEventListener("eip6963:announceProvider",r),window.dispatchEvent(new CustomEvent("eip6963:requestProvider")),()=>window.removeEventListener("eip6963:announceProvider",r)}();let n=r();return{_listeners:()=>e,clear(){e.forEach((e=>e([],{removed:[...t]}))),t=[]},destroy(){this.clear(),e.clear(),n?.()},findProvider:({rdns:e})=>t.find((t=>t.info.rdns===e)),getProviders:()=>t,reset(){this.clear(),n?.(),n=r()},subscribe:(r,{emitImmediately:n}={})=>(e.add(r),n&&r(t,{added:t}),()=>e.delete(r))}}var Yb=r(1429).Buffer;class Jb extends uy{async init(e){this.chainConfig||(this.chainConfig=R(v.EIP155,1,this.clientId))}async authenticateUser(){if(!this.provider||this.status!==ay.CONNECTED)throw x.notConnectedError();const{chainNamespace:e,chainId:t}=this.chainConfig,r=await this.provider.request({method:"eth_accounts"});if(r&&r.length>0){const n=gy(r[0],this.name);if(n&&!py(n))return{idToken:n};const i={domain:window.location.origin,uri:window.location.href,address:r[0],chainId:parseInt(t,16),version:"1",nonce:Math.random().toString(36).slice(2),issuedAt:(new Date).toISOString()},o=await j(i,e),s=`0x${Yb.from(o,"utf8").toString("hex")}`,a=await this.provider.request({method:"personal_sign",params:[s,r[0]]}),c=await z(e,a,o,this.name,this.sessionTime,this.clientId,this.web3AuthNetwork);return yy(r[0],this.name,c),{idToken:c}}throw x.notConnectedError("Not connected with wallet, Please login/connect first")}async disconnectSession(){super.checkDisconnectionRequirements();const e=await this.provider.request({method:"eth_accounts"});var t,r;e&&e.length>0&&(t=e[0],r=this.name,dy("localStorage")&&localStorage.removeItem(`${t.toLowerCase()}_${r}`))}async disconnect(){this.rehydrated=!1,this.emit(cy.DISCONNECTED)}}class Xb extends Jb{constructor(e){super(e),b(this,"adapterNamespace","eip155"),b(this,"currentChainNamespace",v.EIP155),b(this,"type",sy),b(this,"name",void 0),b(this,"isInjected",!0),b(this,"status",ay.NOT_READY),b(this,"injectedProvider",null),this.name=e.name,this.injectedProvider=e.provider}get provider(){return this.status!==ay.NOT_READY&&this.injectedProvider?this.injectedProvider:null}set provider(e){throw new Error("Not implemented")}async init(e={}){await super.init(e),super.checkInitializationRequirements(),this.status=ay.READY,this.emit(cy.READY,this.name);try{hy.debug(`initializing ${this.name} injected adapter`),e.autoConnect&&(this.rehydrated=!0,await this.connect())}catch(e){this.emit(cy.ERRORED,e)}}async connect(){if(super.checkConnectionRequirements(),!this.injectedProvider)throw x.connectionError("Injected provider is not available");if(!this.chainConfig)throw x.connectionError("Chain config is not available");this.status=ay.CONNECTING,this.emit(cy.CONNECTING,{adapter:this.name});try{if(await this.injectedProvider.request({method:"eth_requestAccounts"}),this.injectedProvider.chainId!==this.chainConfig.chainId)try{await this.switchChain(this.chainConfig,!0)}catch(e){await this.addChain(this.chainConfig,!0),await this.switchChain(this.chainConfig,!0)}this.status=ay.CONNECTED;const e=t=>{var r;0===t.length&&(this.disconnect(),null!==(r=this.injectedProvider)&&void 0!==r&&r.removeListener&&this.injectedProvider.removeListener("accountsChanged",e))};return this.injectedProvider.on("accountsChanged",e),this.emit(cy.CONNECTED,{adapter:this.name,reconnected:this.rehydrated,provider:this.injectedProvider}),this.injectedProvider}catch(e){if(this.status=ay.READY,this.rehydrated=!1,this.emit(cy.ERRORED,e),e instanceof A)throw e;throw x.connectionError(`Failed to login with ${this.name} injected wallet`)}}async disconnect(e={cleanup:!1}){if(!this.injectedProvider)throw x.connectionError("Injected provider is not available");await super.disconnectSession(),void 0!==this.injectedProvider.removeAllListeners&&this.injectedProvider.removeAllListeners();try{await this.injectedProvider.request({method:"wallet_revokePermissions",params:[{eth_accounts:{}}]})}catch(e){}e.cleanup?(this.status=ay.NOT_READY,this.injectedProvider=null):this.status=ay.READY,await super.disconnect()}async getUserInfo(){if(this.status!==ay.CONNECTED)throw x.notConnectedError("Not connected with wallet, Please login/connect first");return{}}async addChain(e,t=!1){if(!this.injectedProvider)throw x.connectionError("Injected provider is not available");super.checkAddChainRequirements(e,t),await this.injectedProvider.request({method:"wallet_addEthereumChain",params:[{chainId:e.chainId,chainName:e.displayName,rpcUrls:[e.rpcTarget],blockExplorerUrls:[e.blockExplorerUrl],nativeCurrency:{name:e.tickerName,symbol:e.ticker,decimals:e.decimals||18},iconUrls:[e.logo]}]}),this.addChainConfig(e)}async switchChain(e,t=!1){if(!this.injectedProvider)throw x.connectionError("Injected provider is not available");super.checkSwitchChainRequirements(e,t),await this.injectedProvider.request({method:"wallet_switchEthereumChain",params:[{chainId:e.chainId}]}),this.setAdapterSettings({chainConfig:this.getChainConfig(e.chainId)})}async enableMFA(){throw new Error("Method Not implemented")}async manageMFA(){throw new Error("Method Not implemented")}}const Zb=e=>{const{options:t}=e,{clientId:r,chainConfig:n,sessionTime:i,web3AuthNetwork:o,useCoreKitKey:s}=t;if(!Object.values(v).includes(n.chainNamespace))throw k.invalidParams(`Invalid chainNamespace: ${n.chainNamespace}`);const a=w(w({},R(n.chainNamespace,null==n?void 0:n.chainId,r)),n||{});return Gb().getProviders().map((e=>new Xb({name:fy(e.info.name),provider:e.provider,chainConfig:a,clientId:r,sessionTime:i,web3AuthNetwork:o,useCoreKitKey:s})))},Qb=e=>{const{options:t}=e,{clientId:r,chainConfig:n,sessionTime:i,web3AuthNetwork:o,useCoreKitKey:s}=t;if(!Object.values(v).includes(n.chainNamespace))throw k.invalidParams(`Invalid chainNamespace: ${n.chainNamespace}`);const a=w(w({},R(n.chainNamespace,null==n?void 0:n.chainId,r)),n||{}),c=new Vb({chainConfig:a,clientId:r,sessionTime:i,web3AuthNetwork:o,useCoreKitKey:s,adapterSettings:{walletConnectInitOptions:{}}});return[...Zb({options:t}),c]}})(),n})()));